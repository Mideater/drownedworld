{"version":3,"file":"module.js","sources":["src/constants/constants.js","src/systems/dnd4e.js","src/systems/dnd5e.js","src/systems/dnd5e-2.0.3.js","src/systems/pf1.js","src/systems/pf2e.js","src/systems/ds4.js","src/systems/d35e.js","src/systems/sfrpg.js","src/systems/swade.js","src/systems/tormenta20.js","src/systems/wfrp4e.js","src/systems/splittermond.js","src/systems/forbidden-lands.js","src/systems/icrpg.js","src/systems/swse.js","src/systems/sw5e.js","src/systems/fallout.js","src/systems/cyberpunk-red-core.js","src/systems/knave.js","src/systems/t2k4e.js","src/systems/yzecoriolis.js","src/systems/kamigakari.js","src/systems/symbaroum.js","src/systems/wwn.js","src/systems/cyphersystem.js","src/systems/ptu.js","src/systems/dcc.js","src/systems/a5e.js","src/systems/dark-heresy.js","src/systems/naheulbeuk.js","src/systems/icrpgme.js","src/systems.js","node_modules/svelte/internal/index.mjs","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/util/index.js","node_modules/svelte/store/index.mjs","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/index.js","node_modules/svelte/easing/index.mjs","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/math/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/animation/AnimationControl.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/animation/AnimationManager.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/constants.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/convertRelative.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/animation/AnimationAPI.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/animation/AnimationGroupControl.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/animation/AnimationGroupAPI.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/initial/Centered.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/initial/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/PositionChangeSet.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/PositionData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/PositionStateAPI.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/StyleCache.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/transform/TransformData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/validators/AdapterValidators.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/validators/BasicBounds.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/validators/TransformBounds.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/validators/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/transform/Transforms.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/update/UpdateElementData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/animate/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/update/UpdateElementManager.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/position/Position.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/ApplicationState.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/GetSvelteData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/loadSvelteConfig.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/SvelteReactive.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/SvelteApplication.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/cssVariables.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/action/index.js","node_modules/svelte/transition/index.mjs","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/transition/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/TJSGlassPane.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/AppShellContextInternal.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/helper/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSHeaderButton.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSApplicationHeader.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSFocusWrap.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/ResizableHandle.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/ApplicationShell.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/dialog/DialogContent.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/dialog/DialogShell.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/TJSDialogData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/TJSDialog.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/index.js","src/applications/settings-app/Setting.svelte","src/applications/components/FilePicker.svelte","src/applications/components/DropZone.svelte","src/applications/editors/currencies-editor/CurrencyList.svelte","src/applications/editors/currencies-editor/currency-store.js","src/applications/editors/currencies-editor/currencies-editor-shell.svelte","src/applications/editors/Editor.js","src/applications/editors/currencies-editor/currencies-editor.js","src/applications/editors/item-filters-editor/item-filters-editor.svelte","src/applications/editors/item-filters-editor/item-filters-editor.js","src/applications/editors/string-list-editor/string-list-editor.svelte","src/applications/editors/string-list-editor/string-list-editor.js","src/applications/components/SliderInput.svelte","src/applications/editors/price-modifiers-editor/price-modifiers-editor-shell.svelte","src/applications/editors/price-modifiers-editor/price-modifiers-editor.js","node_modules/svelte/animate/index.mjs","node_modules/svelte-dnd-action/src/helpers/dispatcher.js","node_modules/svelte-dnd-action/src/constants.js","node_modules/svelte-dnd-action/src/helpers/intersection.js","node_modules/svelte-dnd-action/src/helpers/listUtil.js","node_modules/svelte-dnd-action/src/helpers/scroller.js","node_modules/svelte-dnd-action/src/helpers/util.js","node_modules/svelte-dnd-action/src/helpers/observer.js","node_modules/svelte-dnd-action/src/helpers/windowScroller.js","node_modules/svelte-dnd-action/src/helpers/svelteNodeClone.js","node_modules/svelte-dnd-action/src/helpers/styler.js","node_modules/svelte-dnd-action/src/pointerAction.js","node_modules/svelte-dnd-action/src/helpers/aria.js","node_modules/svelte-dnd-action/src/keyboardAction.js","node_modules/svelte-dnd-action/src/action.js","src/helpers/sharing-utilities.js","src/applications/dialogs/drop-item-dialog/drop-item-dialog-shell.svelte","src/applications/dialogs/drop-item-dialog/drop-item-dialog.js","src/applications/item-pile-inventory-app/ListEntry.svelte","src/applications/item-pile-inventory-app/ItemList.svelte","src/applications/dialogs/drop-currency-dialog/drop-currency-dialog-shell.svelte","src/applications/dialogs/drop-currency-dialog/drop-currency-dialog.js","src/applications/item-pile-inventory-app/CurrencyList.svelte","src/applications/components/ActorPicker.svelte","src/plugins/base-plugin.js","src/helpers/transaction.js","src/plugins/simple-calendar.js","src/plugins/levels-3d-preview.js","src/plugins/rarity-colors.js","src/plugins/main.js","src/stores/pile-item.js","src/stores/item-pile-store.js","src/applications/item-pile-inventory-app/CategorizedItemList.svelte","src/applications/item-pile-inventory-app/item-pile-inventory-shell.svelte","src/applications/components/Tabs.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/fvtt/index.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/internal/cssVariables.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/prosemirror/index.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/editor/prosemirror/TJSProseMirror.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/label/TJSToggleLabel.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/menu/TJSMenu.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/menu/context/TJSContextMenuImpl.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/index.js","src/applications/components/PriceSelector.svelte","src/applications/dialogs/trade-merchant-item-dialog/trade-merchant-item-dialog-shell.svelte","src/applications/dialogs/trade-merchant-item-dialog/trade-merchant-item-dialog.js","src/applications/merchant-app/CustomColumn.svelte","src/applications/merchant-app/ItemEntry.svelte","src/applications/merchant-app/QuantityColumn.svelte","src/applications/item-editor/ItemPriceStore.js","src/applications/components/MacroSelector.svelte","src/applications/components/CustomCategoryInput.svelte","src/applications/item-editor/item-editor-shell.svelte","src/applications/item-editor/item-editor.js","src/applications/merchant-app/EntryButtons.svelte","src/stores/merchant-store.js","src/applications/dialogs/text-editor-dialog/text-editor-dialog-shell.svelte","src/applications/dialogs/text-editor-dialog/text-editor-dialog.js","src/applications/merchant-app/MerchantLeftPane.svelte","src/applications/merchant-app/MerchantItemEntry.svelte","src/applications/merchant-app/CategoryHeader.svelte","src/applications/merchant-app/MerchantItemTab.svelte","src/applications/components/CustomDialog.svelte","src/applications/merchant-app/MerchantPopulateItemsTab.svelte","src/applications/components/CurrencyListEntry.svelte","src/applications/components/CurrencyList.svelte","src/applications/merchant-app/MerchantFooter.svelte","src/applications/merchant-app/MerchantRightPane.svelte","src/applications/merchant-app/MerchantTopBar.svelte","src/applications/merchant-app/merchant-app-shell.svelte","src/applications/dialogs/user-select-dialog/user-select-dialog-shell.svelte","src/applications/dialogs/user-select-dialog/user-select-dialog.js","src/applications/merchant-app/merchant-app.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/application/TJSContextMenu.js","src/applications/components/Grid/grid-utils.js","src/applications/components/Grid/GridItem.svelte","src/applications/components/Grid/Grid.svelte","src/applications/vault-app/VaultItemEntry.svelte","src/stores/vault-store.js","src/applications/vault-app/VaultExpanderEntry.svelte","src/applications/editors/vault-access-editor/vault-access-editor-shell.svelte","src/applications/editors/vault-access-editor/vault-access-editor.js","src/applications/item-pile-config/settings/vault.svelte","src/applications/components/FloatingElement/FloatingElementImpl.svelte","src/applications/components/FloatingElement/FloatingElement.js","src/applications/vault-app/vault-shell.svelte","src/applications/vault-app/vault-app.js","src/applications/item-pile-config/settings/main.svelte","src/applications/editors/item-type-price-modifiers-editor/item-type-price-modifiers-editor.svelte","src/applications/editors/item-type-price-modifiers-editor/item-type-price-modifiers-editor.js","src/applications/components/PropertyPathInput.svelte","src/applications/editors/merchant-columns-editor/merchant-columns-editor-shell.svelte","src/applications/editors/merchant-columns-editor/merchant-columns-editor.js","src/applications/item-pile-config/settings/merchant.svelte","src/applications/item-pile-config/settings/itempile.svelte","src/applications/item-pile-config/settings/container.svelte","src/applications/item-pile-config/settings/sharing.svelte","src/applications/item-pile-config/settings/custom.svelte","src/applications/item-pile-config/item-pile-config.svelte","src/applications/item-pile-config/item-pile-config.js","src/applications/item-pile-inventory-app/item-pile-inventory-app.js","src/applications/dialogs/give-items-dialog/give-items-shell.svelte","src/API/private-api.js","src/hotkeys.js","src/helpers/caches.js","src/helpers/pile-utilities.js","src/applications/components/PriceList.svelte","src/applications/editors/price-preset-editor/price-preset-editor-shell.svelte","src/applications/editors/price-preset-editor/price-preset-editor.js","src/applications/editors/unstackable-item-types-editor/unstackable-item-types-editor.svelte","src/applications/editors/unstackable-item-types-editor/unstackable-item-types-editor.js","src/applications/editors/styles-editor/styles-editor.svelte","src/applications/editors/styles-editor/styles-editor.js","src/applications/editors/vault-styles-editor/StyleEntry.svelte","src/applications/editors/vault-styles-editor/vault-styles-editor.svelte","src/applications/editors/vault-styles-editor/vault-styles-editor.js","src/applications/editors/index.js","src/applications/settings-app/SettingButton.svelte","src/applications/settings-app/settings-shell.svelte","src/applications/settings-app/settings-app.js","src/settings.js","src/constants/settings.js","src/helpers/utilities.js","src/applications/trade-dialogs/ActorDropSelect.svelte","src/applications/trade-dialogs/trade-dialog-prompt.svelte","node_modules/svelte/motion/index.mjs","src/applications/trade-dialogs/trade-dialog-request.svelte","src/applications/trade-dialogs/trade-dialogs.js","src/applications/trading-app/trade-store.js","src/applications/trading-app/TradeEntry.svelte","src/applications/trading-app/trading-app-shell.svelte","src/applications/trading-app/trading-app.js","src/API/trade-api.js","src/API/chat-api.js","src/socket.js","src/helpers/helpers.js","src/foundry-ui-overrides.js","src/libwrapper.js","src/API/api.js","src/migrations.js","src/module.js"],"sourcesContent":["const module_name = \"item-piles\";\r\nconst module_path = `modules/${module_name}/`;\r\nconst baseFlag = `flags.${module_name}.`\r\n\r\nconst CONSTANTS = {\r\n\r\n  MODULE_NAME: module_name,\r\n  PATH: module_path,\r\n\r\n  FLAGS: {\r\n    VERSION: baseFlag + \"version\",\r\n    PILE: baseFlag + \"data\",\r\n    LOG: baseFlag + \"log\",\r\n    SHARING: baseFlag + \"sharing\",\r\n    ITEM: baseFlag + \"item\",\r\n    PUBLIC_TRADE_ID: baseFlag + \"publicTradeId\",\r\n    TRADE_USERS: baseFlag + \"tradeUsers\",\r\n    TEMPORARY_ITEM: baseFlag + \"temporary_item\"\r\n  },\r\n\r\n  ITEM_DEFAULTS: {\r\n    // Merchants\r\n    hidden: false,\r\n    notForSale: false,\r\n    infiniteQuantity: \"default\",\r\n    displayQuantity: \"default\",\r\n    free: false,\r\n    keepZeroQuantity: false,\r\n    disableNormalCost: false,\r\n    cantBeSoldToMerchants: false,\r\n    isService: false,\r\n    keepOnMerchant: false,\r\n    macro: \"\",\r\n    customCategory: \"\",\r\n    prices: [],\r\n\r\n    // Vaults\r\n    vaultExpander: false,\r\n    vaultSlot: null,\r\n    addsCols: 0,\r\n    addsRows: 0,\r\n    x: null,\r\n    y: null,\r\n    width: 1,\r\n    height: 1,\r\n    canStack: \"default\"\r\n  },\r\n\r\n  PILE_TYPES: {\r\n    PILE: \"pile\",\r\n    CONTAINER: \"container\",\r\n    MERCHANT: \"merchant\",\r\n    VAULT: \"vault\"\r\n  },\r\n\r\n  VAULT_LOGGING_TYPES: {\r\n    USER_ACTOR: \"user_actor\",\r\n    USER: \"user\",\r\n    ACTOR: \"actor\",\r\n  },\r\n\r\n  CUSTOM_PILE_TYPES: {},\r\n\r\n  PILE_DEFAULTS: {\r\n    // Core settings\r\n    enabled: false,\r\n    type: \"pile\",\r\n    distance: 1,\r\n    macro: \"\",\r\n    deleteWhenEmpty: \"default\",\r\n    canInspectItems: true,\r\n    displayItemTypes: false,\r\n    description: \"\",\r\n\r\n    // Overrides\r\n    overrideItemFilters: false,\r\n    overrideCurrencies: false,\r\n    overrideSecondaryCurrencies: false,\r\n\r\n    // Token settings\r\n    displayOne: false,\r\n    showItemName: false,\r\n    overrideSingleItemScale: false,\r\n    singleItemScale: 1.0,\r\n\r\n    // Sharing settings\r\n    shareItemsEnabled: false,\r\n    shareCurrenciesEnabled: true,\r\n    takeAllEnabled: false,\r\n    splitAllEnabled: true,\r\n    activePlayers: false,\r\n\r\n    // Container settings\r\n    closed: false,\r\n    locked: false,\r\n    closedImage: \"\",\r\n    closedImages: [],\r\n    emptyImage: \"\",\r\n    emptyImages: [],\r\n    openedImage: \"\",\r\n    openedImages: [],\r\n    lockedImage: \"\",\r\n    lockedImages: [],\r\n    closeSound: \"\",\r\n    closeSounds: [],\r\n    openSound: \"\",\r\n    openSounds: [],\r\n    lockedSound: \"\",\r\n    lockedSounds: [],\r\n    unlockedSound: \"\",\r\n    unlockedSounds: [],\r\n\r\n    // Merchant settings\r\n    merchantImage: \"\",\r\n    infiniteQuantity: false,\r\n    infiniteCurrencies: true,\r\n    purchaseOnly: false,\r\n    hideNewItems: false,\r\n    hideItemsWithZeroCost: false,\r\n    keepZeroQuantity: false,\r\n    onlyAcceptBasePrice: true,\r\n    displayQuantity: \"yes\",\r\n    buyPriceModifier: 1,\r\n    sellPriceModifier: 0.5,\r\n    itemTypePriceModifiers: [],\r\n    actorPriceModifiers: [],\r\n    tablesForPopulate: [],\r\n    merchantColumns: [],\r\n    openTimes: {\r\n      enabled: false,\r\n      status: \"open\",\r\n      /*\r\n      auto = rely on simple calendar\r\n      open = always open\r\n      closed = always closed\r\n       */\r\n      open: {\r\n        hour: 9,\r\n        minute: 0\r\n      },\r\n      close: {\r\n        hour: 18,\r\n        minute: 0\r\n      },\r\n    },\r\n    closedDays: [],\r\n    closedHolidays: [],\r\n    refreshItemsOnOpen: false,\r\n    refreshItemsDays: [],\r\n    refreshItemsHolidays: [],\r\n\r\n    // Vault settings\r\n    cols: 10,\r\n    rows: 5,\r\n    vaultExpansion: false,\r\n    baseExpansionCols: 0,\r\n    baseExpansionRows: 0,\r\n    vaultAccess: [],\r\n    logVaultActions: false,\r\n    vaultLogType: \"user_actor\",\r\n    canStackItems: true\r\n  }\r\n}\r\n\r\nCONSTANTS.ITEM_FORCED_UNIQUE_KEYS = [\"vaultExpander\", \"isService\"]\r\n  .map(val => CONSTANTS.FLAGS.ITEM + \".\" + val);\r\n\r\nconst prefix = (string) => (strings, ...expressions) => `${string}-${strings.reduce((a, c, i) => a + expressions[i - 1] + c)}`\r\nconst module = prefix(CONSTANTS.MODULE_NAME);\r\n\r\nCONSTANTS.HOOKS = {\r\n  READY: module`ready`,\r\n  RESET_SETTINGS: module`resetSettings`,\r\n  PRE_TRANSFER_EVERYTHING: module`preTransferEverything`,\r\n  TRANSFER_EVERYTHING: module`transferEverything`,\r\n  PRE_OPEN_INTERFACE: module`preOpenInterface`,\r\n  OPEN_INTERFACE: module`openInterface`,\r\n  PRE_CLOSE_INTERFACE: module`preCloseInterface`,\r\n  CLOSE_INTERFACE: module`closeInterface`,\r\n  PILE: {\r\n    PRE_CREATE: module`preCreateItemPile`,\r\n    CREATE: module`createItemPile`,\r\n    PRE_UPDATE: module`preUpdateItemPile`,\r\n    UPDATE: module`updateItemPile`,\r\n    PRE_DELETE: module`preDeleteItemPile`,\r\n    DELETE: module`deleteItemPile`,\r\n    PRE_CLOSE: module`preCloseItemPile`,\r\n    CLOSE: module`closeItemPile`,\r\n    PRE_OPEN: module`preOpenItemPile`,\r\n    OPEN: module`openItemPile`,\r\n    PRE_LOCK: module`preLockItemPile`,\r\n    LOCK: module`lockItemPile`,\r\n    PRE_UNLOCK: module`preUnlockItemPile`,\r\n    UNLOCK: module`unlockItemPile`,\r\n    PRE_RATTLE: module`preRattleItemPile`,\r\n    RATTLE: module`rattleItemPile`,\r\n    PRE_TURN_INTO: module`preTurnIntoItemPiles`,\r\n    TURN_INTO: module`turnIntoItemPiles`,\r\n    PRE_REVERT_FROM: module`preRevertFromItemPiles`,\r\n    REVERT_FROM: module`revertFromItemPiles`,\r\n    PRE_SPLIT_INVENTORY: module`preSplitItemPileContent`,\r\n    SPLIT_INVENTORY: module`splitItemPileContent`,\r\n    PRE_CLICK: module`preClickItemPile`,\r\n    PRE_DIRECTORY_CLICK: module`preClickDirectoryItemPile`,\r\n    PRE_RIGHT_CLICK_ITEM: module`preRightClickItem`\r\n  },\r\n  ITEM: {\r\n    PRE_DROP_DETERMINED: module`preDropItemDetermined`,\r\n    PRE_DROP: module`preDropItem`,\r\n    DROP: module`dropItem`,\r\n    PRE_TRANSFER: module`preTransferItems`,\r\n    TRANSFER: module`transferItems`,\r\n    PRE_ADD: module`preAddItems`,\r\n    ADD: module`addItems`,\r\n    PRE_REMOVE: module`preRemoveItems`,\r\n    REMOVE: module`removeItems`,\r\n    PRE_TRANSFER_ALL: module`preTransferAllItems`,\r\n    TRANSFER_ALL: module`transferAllItems`,\r\n    PRE_CALC_TRADE: module`preCalculateTradeItems`,\r\n    PRE_TRADE: module`preTradeItems`,\r\n    TRADE: module`tradeItems`,\r\n    PRE_GIVE: module`preGiveItem`,\r\n    GIVE: module`giveItem`,\r\n  },\r\n  CURRENCY: {\r\n    PRE_TRANSFER: module`preTransferCurrencies`,\r\n    TRANSFER: module`transferCurrencies`,\r\n    PRE_ADD: module`preAddCurrencies`,\r\n    ADD: module`addCurrencies`,\r\n    PRE_REMOVE: module`preRemoveCurrencies`,\r\n    REMOVE: module`removeCurrencies`,\r\n    PRE_TRANSFER_ALL: module`preTransferAllCurrencies`,\r\n    TRANSFER_ALL: module`transferAllCurrencies`,\r\n  },\r\n  ATTRIBUTE: {\r\n    PRE_TRANSFER: module`preTransferAttributes`,\r\n    TRANSFER: module`transferAttributes`,\r\n    PRE_SET: module`preSetAttributes`,\r\n    SET: module`setAttributes`,\r\n    PRE_ADD: module`preAddAttributes`,\r\n    ADD: module`addAttributes`,\r\n    PRE_REMOVE: module`preRemoveAttributes`,\r\n    REMOVE: module`removeAttributes`,\r\n    PRE_TRANSFER_ALL: module`preTransferAllAttributes`,\r\n    TRANSFER_ALL: module`transferAllAttributes`,\r\n  },\r\n  TRADE: {\r\n    STARTED: module`tradeStarted`,\r\n    COMPLETE: module`tradeComplete`\r\n  }\r\n}\r\n\r\nObject.freeze(CONSTANTS);\r\n\r\nexport default CONSTANTS;\r\n","export default {\r\n\r\n    \"VERSION\": \"1.0.4\",\r\n  \r\n    // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n    \"ACTOR_CLASS_TYPE\": \"Player Character\",\r\n  \r\n    // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n    \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n  \r\n    // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n    \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n  \r\n    // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n    \"ITEM_FILTERS\": [\r\n      {\r\n        \"path\": \"type\",\r\n        \"filters\": \"classFeats,feat,raceFeats,pathFeats,destinyFeats,ritual,power\"\r\n      }\r\n    ],\r\n  \r\n    // This function is an optional system handler that specifically transforms an item when it is added to actors\r\n    \"ITEM_TRANSFORMER\": async (itemData) => {\r\n      [\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\r\n        if (itemData?.system?.[key] !== undefined) {\r\n          delete itemData.system[key];\r\n        }\r\n      });\r\n      setProperty(itemData, \"system.attunement\", false);\r\n       return itemData;\r\n    },\r\n    \r\n    // Item similarities determines how item piles detect similarities and differences in the system\r\n    \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n  \r\n    // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n    // In the case of attributes, the path is relative to the \"actor.system\"\r\n    // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n    \"CURRENCIES\": [\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.CurrencyAD\",\r\n        img: \"icons/commodities/gems/gem-faceted-round-white.webp\",\r\n        abbreviation: \"{#}AD\",\r\n        data: {\r\n          path: \"system.currency.ad\"\r\n        },\r\n        primary: false,\r\n        exchangeRate: 10000\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.CurrencyPP\",\r\n        img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n        abbreviation: \"{#}PP\",\r\n        data: {\r\n          path: \"system.currency.pp\"\r\n        },\r\n        primary: false,\r\n        exchangeRate: 100\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.CurrencyGP\",\r\n        img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n        abbreviation: \"{#}GP\",\r\n        data: {\r\n          path: \"system.currency.gp\",\r\n        },\r\n        primary: true,\r\n        exchangeRate: 1\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.CurrencySP\",\r\n        img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n        abbreviation: \"{#}SP\",\r\n        data: {\r\n          path: \"system.currency.sp\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 0.1\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.CurrencyCP\",\r\n        img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n        abbreviation: \"{#}CP\",\r\n        data: {\r\n          path: \"system.currency.cp\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 0.01\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.RitualCompAR\",\r\n        img: \"icons/commodities/materials/bowl-powder-teal.webp\",\r\n        abbreviation: \"{#}AR\",\r\n        data: {\r\n          path: \"system.ritualcomp.ar\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 1\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.RitualCompMS\",\r\n        img: \"icons/commodities/materials/bowl-liquid-white.webp\",\r\n        abbreviation: \"{#}MS\",\r\n        data: {\r\n          path: \"system.ritualcomp.ms\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 1\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.RitualCompRH\",\r\n        img: \"icons/commodities/materials/plant-sprout-seed-brown-green.webp\",\r\n        abbreviation: \"{#}RH\",\r\n        data: {\r\n          path: \"system.ritualcomp.rh\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 1\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.RitualCompSI\",\r\n        img: \"icons/commodities/materials/bowl-liquid-red.webp\",\r\n        abbreviation: \"{#}SI\",\r\n        data: {\r\n          path: \"system.ritualcomp.si\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 1\r\n      },\r\n      {\r\n        type: \"attribute\",\r\n        name: \"DND4EBETA.RitualCompRS\",\r\n        img: \"icons/commodities/gems/gem-faceted-cushion-teal.webp\",\r\n        abbreviation: \"{#}RS\",\r\n        data: {\r\n          path: \"system.ritualcomp.rs\",\r\n        },\r\n        primary: false,\r\n        exchangeRate: 1\r\n      }\r\n    ]\r\n  }\r\n  ","export default {\n\n  \"VERSION\": \"1.0.5\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"character\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price.value\",\n\n  // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"spell,feat,class,subclass,background\"\n    },\n    {\n      \"path\": \"system.weaponType\",\n      \"filters\": \"natural\"\n    }\n  ],\n\n  // This function is an optional system handler that specifically transforms an item when it is added to actors\n  \"ITEM_TRANSFORMER\": async (itemData) => {\n    [\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\n      if (itemData?.system?.[key] !== undefined) {\n        delete itemData.system[key];\n      }\n    });\n    setProperty(itemData, \"system.attunement\", Math.min(CONFIG.DND5E.attunementTypes.REQUIRED, itemData?.system?.attunement ?? 0));\n    if (itemData.type === \"spell\") {\n      try {\n        const scroll = await Item.implementation.createScrollFromSpell(itemData);\n        itemData = scroll.toObject();\n      } catch (err) {\n      }\n    }\n    return itemData;\n  },\n\n  // This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n  \"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n    const overallCost = Number(getProperty(item, \"system.price.value\")) ?? 0;\n    const priceDenomination = getProperty(item, \"system.price.denomination\");\n    if (priceDenomination) {\n      const currencyDenomination = currencies.find(currency => {\n        return currency.abbreviation.toLowerCase().includes(priceDenomination);\n      });\n      if (currencyDenomination) {\n        return overallCost * currencyDenomination.exchangeRate;\n      }\n    }\n    return overallCost ?? 0;\n  },\n\n  \"PILE_DEFAULTS\": {\n    merchantColumns: [{\n      label: \"Rarity\",\n      path: \"system.rarity\",\n      formatting: \"{#}\",\n      mapping: {\n        \"common\": \"DND5E.ItemRarityCommon\",\n        \"uncommon\": \"DND5E.ItemRarityUncommon\",\n        \"rare\": \"DND5E.ItemRarityRare\",\n        \"veryrare\": \"DND5E.ItemRarityVeryRare\",\n        \"legendary\": \"DND5E.ItemRarityLegendary\",\n        \"artifact\": \"DND5E.ItemRarityArtifact\"\n      }\n    }]\n  },\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n  // In the case of attributes, the path is relative to the \"actor.system\"\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyPP\",\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n      abbreviation: \"{#}PP\",\n      data: {\n        path: \"system.currency.pp\"\n      },\n      primary: false,\n      exchangeRate: 10\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyGP\",\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n      abbreviation: \"{#}GP\",\n      data: {\n        path: \"system.currency.gp\",\n      },\n      primary: true,\n      exchangeRate: 1\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyEP\",\n      img: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n      abbreviation: \"{#}EP\",\n      data: {\n        path: \"system.currency.ep\",\n      },\n      primary: false,\n      exchangeRate: 0.5\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencySP\",\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n      abbreviation: \"{#}SP\",\n      data: {\n        path: \"system.currency.sp\",\n      },\n      primary: false,\n      exchangeRate: 0.1\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyCP\",\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n      abbreviation: \"{#}CP\",\n      data: {\n        path: \"system.currency.cp\",\n      },\n      primary: false,\n      exchangeRate: 0.01\n    }\n  ],\n\n  \"VAULT_STYLES\": [\n    {\n      path: \"system.rarity\",\n      value: \"artifact\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,191,0,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"legendary\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"veryRare\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"rare\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"uncommon\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,255,9,1)\"\n      }\n    }\n  ]\n}\n","export default {\n\n  \"VERSION\": \"1.0.3\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"character\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n  // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"spell,feat,class,subclass,background\"\n    },\n    {\n      \"path\": \"system.weaponType\",\n      \"filters\": \"natural\"\n    }\n  ],\n\n  // This function is an optional system handler that specifically transforms an item when it is added to actors\n  \"ITEM_TRANSFORMER\": async (itemData) => {\n    [\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\n      if (itemData?.system?.[key] !== undefined) {\n        delete itemData.system[key];\n      }\n    });\n    setProperty(itemData, \"system.attunement\", Math.min(CONFIG.DND5E.attunementTypes.REQUIRED, itemData?.system?.attunement ?? 0));\n    if (itemData.type === \"spell\") {\n      try {\n        const scroll = await Item.implementation.createScrollFromSpell(itemData);\n        itemData = scroll.toObject();\n      } catch (err) {\n      }\n    }\n    return itemData;\n  },\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n  // In the case of attributes, the path is relative to the \"actor.system\"\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyPP\",\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n      abbreviation: \"{#}PP\",\n      data: {\n        path: \"system.currency.pp\"\n      },\n      primary: false,\n      exchangeRate: 10\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyGP\",\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n      abbreviation: \"{#}GP\",\n      data: {\n        path: \"system.currency.gp\",\n      },\n      primary: true,\n      exchangeRate: 1\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyEP\",\n      img: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n      abbreviation: \"{#}EP\",\n      data: {\n        path: \"system.currency.ep\",\n      },\n      primary: false,\n      exchangeRate: 0.5\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencySP\",\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n      abbreviation: \"{#}SP\",\n      data: {\n        path: \"system.currency.sp\",\n      },\n      primary: false,\n      exchangeRate: 0.1\n    },\n    {\n      type: \"attribute\",\n      name: \"DND5E.CurrencyCP\",\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n      abbreviation: \"{#}CP\",\n      data: {\n        path: \"system.currency.cp\",\n      },\n      primary: false,\n      exchangeRate: 0.01\n    }\n  ],\n\n  VAULT_STYLES: [\n    {\n      path: \"system.rarity\",\n      value: \"artifact\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,191,0,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"legendary\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"veryRare\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"rare\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\n      }\n    },\n    {\n      path: \"system.rarity\",\n      value: \"uncommon\",\n      styling: {\n        \"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,255,9,1)\"\n      }\n    }\n  ]\n}\n","export default {\r\n  \r\n  \"VERSION\": \"1.0.3\",\r\n  \r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"npc\",\r\n  \r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n  \r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n  \r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"attack,buff,class,feat,race,spell\"\r\n    }\r\n  ],\r\n  \r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n  \r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"PF1.CurrencyPlatinumP\",\r\n      img: \"systems/pf1/icons/items/inventory/coins-silver.jpg\",\r\n      abbreviation: \"{#}PP\",\r\n      data: {\r\n        path: \"system.currency.pp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 10\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"PF1.CurrencyGoldP\",\r\n      img: \"systems/pf1/icons/items/inventory/coin-gold.jpg\",\r\n      abbreviation: \"{#}G\",\r\n      data: {\r\n        path: \"system.currency.gp\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"PF1.CurrencySilverP\",\r\n      img: \"systems/pf1/icons/items/inventory/coin-silver.jpg\",\r\n      abbreviation: \"{#}SP\",\r\n      data: {\r\n        path: \"system.currency.sp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"PF1.CurrencyCopperP\",\r\n      img: \"systems/pf1/icons/items/inventory/coin-copper.jpg\",\r\n      abbreviation: \"{#}C\",\r\n      data: {\r\n        path: \"system.currency.cp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}","export default {\r\n\r\n  \"VERSION\": \"1.0.4\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"loot\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // The quantity for price attribute is the path to the attribute on each item that determine how many you get for its price\r\n  \"QUANTITY_FOR_PRICE_ATTRIBUTE\": \"system.price.per\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [{\r\n    \"path\": \"type\",\r\n    \"filters\": 'action,ancestry,background,class,condition,deity,effect,feat,heritage,lore,melee,spell,spellcastingEntry'\r\n  }],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.temporary.value\"],\r\n\r\n  // This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\r\n  \"ITEM_COST_TRANSFORMER\": (item) => {\r\n    const itemCost = getProperty(item, \"system.price\");\r\n    const { copperValue } = new game.pf2e.Coins(itemCost?.value ?? {});\r\n    return copperValue / 100;\r\n  },\r\n\r\n  \"PILE_DEFAULTS\": {\r\n    merchantColumns: [{\r\n      \"label\": \"Rarity\",\r\n      \"path\": \"system.traits.rarity\",\r\n      \"formatting\": \"{#}\",\r\n      \"mapping\": {\r\n        \"common\": \"PF2E.TraitCommon\",\r\n        \"uncommon\": \"PF2E.TraitUncommon\",\r\n        \"rare\": \"PF2E.TraitRare\",\r\n        \"unique\": \"PF2E.TraitUnique\"\r\n      }\r\n    }, {\r\n      \"label\": \"Bulk\",\r\n      \"path\": \"system.bulk.value\",\r\n      \"formatting\": \"{#}\",\r\n      \"mapping\": { \"0\": \"\" }\r\n    }]\r\n  },\r\n\r\n  \"TOKEN_FLAG_DEFAULTS\": {\r\n    flags: {\r\n      pf2e: {\r\n        linkToActorSize: false,\r\n        autoscale: false\r\n      }\r\n    }\r\n  },\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()`, put it into `data.item`, and strip out any module data\r\n  \"CURRENCIES\": [{\r\n    type: \"item\",\r\n    name: \"Platinum Pieces\",\r\n    img: \"systems/pf2e/icons/equipment/treasure/currency/platinum-pieces.webp\",\r\n    abbreviation: \"{#}PP\",\r\n    data: {\r\n      uuid: \"Compendium.pf2e.equipment-srd.JuNPeK5Qm1w6wpb4\"\r\n    },\r\n    primary: false,\r\n    exchangeRate: 10\r\n  }, {\r\n    type: \"item\",\r\n    name: \"Gold Pieces\",\r\n    img: \"systems/pf2e/icons/equipment/treasure/currency/gold-pieces.webp\",\r\n    abbreviation: \"{#}GP\",\r\n    data: {\r\n      uuid: \"Compendium.pf2e.equipment-srd.B6B7tBWJSqOBz5zz\"\r\n    },\r\n    primary: true,\r\n    exchangeRate: 1\r\n  }, {\r\n    type: \"item\",\r\n    name: \"Silver Pieces\",\r\n    img: \"systems/pf2e/icons/equipment/treasure/currency/silver-pieces.webp\",\r\n    abbreviation: \"{#}SP\",\r\n    data: {\r\n      uuid: \"Compendium.pf2e.equipment-srd.5Ew82vBF9YfaiY9f\"\r\n    },\r\n    primary: false,\r\n    exchangeRate: 0.1\r\n  }, {\r\n    type: \"item\",\r\n    name: \"Copper Pieces\",\r\n    img: \"systems/pf2e/icons/equipment/treasure/currency/copper-pieces.webp\",\r\n    abbreviation: \"{#}CP\",\r\n    data: {\r\n      uuid: \"Compendium.pf2e.equipment-srd.lzJ8AVhRcbFul5fh\"\r\n    },\r\n    primary: false,\r\n    exchangeRate: 0.01\r\n  }]\r\n}\r\n","// Item Piles Definitions for Foundry VTT Game System Dungeonslayers 4\n\nexport default {\n  \n  \"VERSION\": \"1.0.2\",\n  \n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"character\",\n  \n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n  \n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n  \n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"spell,talent,racialAbility,language,alphabet,specialCreatureAbility\"\n    }\n  ],\n  \n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n  \n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n  // In the case of attributes, the path is relative to the \"actor.system\"\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"DS4.CharacterCurrencyGold\",\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n      abbreviation: \"{#}G\",\n      data: {\n        path: \"system.currency.gold\",\n      },\n      primary: true,\n      exchangeRate: 1\n    },\n    {\n      type: \"attribute\",\n      name: \"DS4.CharacterCurrencySilver\",\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n      abbreviation: \"{#}S\",\n      data: {\n        path: \"system.currency.silver\",\n      },\n      primary: false,\n      exchangeRate: 0.1\n    },\n    {\n      type: \"attribute\",\n      name: \"DS4.CharacterCurrencyCopper\",\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n      abbreviation: \"{#}C\",\n      data: {\n        path: \"system.currency.copper\",\n      },\n      primary: false,\n      exchangeRate: 0.01\n    }\n  ]\n}","export default {\r\n  \r\n  \"VERSION\": \"1.0.2\",\r\n  \r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"npc\",\r\n  \r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n  \r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n  \r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"spell,feat,class,race,attack,full-attack,buff,aura,alignment,enhancement,damage-type,material\"\r\n    }\r\n  ],\r\n  \r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n  \r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"DND5E.CurrencyPP\",\r\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n      abbreviation: \"{#}PP\",\r\n      data: {\r\n        path: \"system.currency.pp\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 10\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"DND5E.CurrencyGP\",\r\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n      abbreviation: \"{#}GP\",\r\n      data: {\r\n        path: \"system.currency.gp\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"DND5E.CurrencySP\",\r\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n      abbreviation: \"{#}SP\",\r\n      data: {\r\n        path: \"system.currency.sp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"DND5E.CurrencyCP\",\r\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n      abbreviation: \"{#}CP\",\r\n      data: {\r\n        path: \"system.currency.cp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}","export default {\n\n  \"VERSION\": \"1.0.2\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"npc2\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"attack,buff,class,feat,race,spell\"\n    }\n  ],\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"SFRPG.Currencies.Credits\",\n      img: \"systems/sfrpg/icons/equipment/goods/credstick.webp\",\n      abbreviation: \"{#}C\",\n      data: {\n        path: \"system.currency.credit\",\n      },\n      primary: true,\n      exchangeRate: 1\n    },\n    {\n      type: \"attribute\",\n      name: \"SFRPG.Currencies.UPBs\",\n      img: \"systems/sfrpg/icons/equipment/goods/upb.webp\",\n      abbreviation: \"{#} UBP\",\n      data: {\n        path: \"system.currency.upb\",\n      },\n      primary: false,\n      exchangeRate: 1\n    }\n  ],\n\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\n}\n","export default {\r\n\r\n  \"VERSION\": \"1.0.4\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"edge,hindrance,skill,power,ability\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"SWADE.Currency\",\r\n      img: \"icons/svg/coins.svg\",\r\n      abbreviation: \"{#}T\",\r\n      data: {\r\n        path: \"system.details.currency\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n\r\n}\r\n","export default {\r\n  \r\n  \"VERSION\": \"1.0.2\",\r\n  \r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n  \r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.qtd\",\r\n  \r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price.gc\",\r\n  \r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"magia,poder,classe\"\r\n    },\r\n    {\r\n      \"path\": \"system.tipoUso\",\r\n      \"filters\": \"nat\"\r\n    }\r\n  ],\r\n  \r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n  \r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Ouro\",\r\n      img: \"icons/commodities/currency/coin-embossed-insect-gold.webp\",\r\n      abbreviation: \"{#}O\",\r\n      data: {\r\n        path: \"system.dinheiro.to\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Prata\",\r\n      img: \"icons/commodities/currency/coin-embossed-unicorn-silver.webp\",\r\n      abbreviation: \"{#}P\",\r\n      data: {\r\n        path: \"system.dinheiro.tp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Cobre\",\r\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n      abbreviation: \"{#}C\",\r\n      data: {\r\n        path: \"system.dinheiro.tc\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}","import CONSTANTS from \"../constants/constants.js\";\r\n\r\nexport default {\r\n\r\n  \"VERSION\": \"1.0.6\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity.value\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"career,container,critical,disease,injury,mutation,prayer,psychology,talent,skill,spell,trait,extendedTest,vehicleMod,cargo\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\r\n  \"ITEM_COST_TRANSFORMER\": (item) => {\r\n    let overallCost = 0;\r\n    const prices = getProperty(item, \"system.price\");\r\n    overallCost += (Number(prices?.[\"gc\"]) ?? 0);\r\n    overallCost += (Number(prices?.[\"ss\"]) ?? 0) * 0.05;\r\n    overallCost += (Number(prices?.[\"bp\"]) ?? 0) * 0.004166667;\r\n    return overallCost;\r\n  },\r\n\r\n  \"PILE_TYPE_DEFAULTS\": {\r\n    [CONSTANTS.PILE_TYPES.MERCHANT]: {\r\n      merchantColumns: [{\r\n        label: \"Availability\",\r\n        path: \"system.availability.value\"\r\n      }],\r\n    }\r\n  },\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"item\",\r\n      name: \"Gold Crown\",\r\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n      abbreviation: \"{#}GC\",\r\n      data: {\r\n        item: {\r\n          \"name\": \"Gold Crown\",\r\n          \"type\": \"money\",\r\n          \"img\": \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n          \"system\": {\r\n            \"quantity\": { \"type\": \"Number\", \"label\": \"Quantity\", \"value\": 1 },\r\n            \"encumbrance\": { \"type\": \"Number\", \"label\": \"Encumbrance\", \"value\": 0.005 },\r\n            \"coinValue\": { \"label\": \"Value (in d)\", \"type\": \"Number\", \"value\": 240 },\r\n            \"source\": { \"type\": \"String\", \"label\": \"Source\" }\r\n          }\r\n        }\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"item\",\r\n      name: \"Silver Shilling\",\r\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n      abbreviation: \"{#}SS\",\r\n      data: {\r\n        item: {\r\n          \"name\": \"Silver Shilling\",\r\n          \"type\": \"money\",\r\n          \"img\": \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n          \"system\": {\r\n            \"quantity\": { \"type\": \"Number\", \"label\": \"Quantity\", \"value\": 1 },\r\n            \"encumbrance\": { \"type\": \"Number\", \"label\": \"Encumbrance\", \"value\": 0.01 },\r\n            \"coinValue\": { \"label\": \"Value (in d)\", \"type\": \"Number\", \"value\": 12 },\r\n            \"source\": { \"type\": \"String\", \"label\": \"Source\" }\r\n          }\r\n        }\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.05\r\n    },\r\n    {\r\n      type: \"item\",\r\n      name: \"Brass Penny\",\r\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n      abbreviation: \"{#}BP\",\r\n      data: {\r\n        item: {\r\n          \"name\": \"Brass Penny\",\r\n          \"type\": \"money\",\r\n          \"img\": \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n          \"system\": {\r\n            \"quantity\": { \"type\": \"Number\", \"label\": \"Quantity\", \"value\": 1 },\r\n            \"encumbrance\": { \"type\": \"Number\", \"label\": \"Encumbrance\", \"value\": 0.01 },\r\n            \"coinValue\": { \"label\": \"Value (in d)\", \"type\": \"Number\", \"value\": 1 },\r\n            \"source\": { \"type\": \"String\", \"label\": \"Source\" }\r\n          }\r\n        }\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.004166667\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.4\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"spell,strength,weakness,mastery,species,culture,ancestry,education,resource,npcfeature,moonsign,language,culturelore,statuseffect,spelleffect,npcattack\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.sufferedDamage\", \"system.quality\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Solare\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-copper.webp\",\r\n      abbreviation: \"{#}S\",\r\n      data: {\r\n        path: \"system.currency.S\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Lunare\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-silver.webp\",\r\n      abbreviation: \"{#}L\",\r\n      data: {\r\n        path: \"system.currency.L\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Telare\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-platinum.webp\",\r\n      abbreviation: \"{#}T\",\r\n      data: {\r\n        path: \"system.currency.T\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.0001\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n  \r\n  \"VERSION\": \"1.0.1\",\r\n  \r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n  \r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n  \r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n  \r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"criticalInjury,monsterAttack,monsterTalent\"\r\n    }\r\n  ],\r\n  \r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n  \r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Gold\",\r\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n      abbreviation: \"{#}GP\",\r\n      data: {\r\n        path: \"system.currency.gold\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Silver\",\r\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n      abbreviation: \"{#}SP\",\r\n      data: {\r\n        path: \"system.currency.silver\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Copper\",\r\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n      abbreviation: \"{#}CP\",\r\n      data: {\r\n        path: \"system.currency.copper\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}","export default {\r\n\r\n  \"VERSION\": \"1.0.3\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"ability\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Coin\",\r\n      img: \"icons/svg/coins.svg\",\r\n      abbreviation: \"{#}C\",\r\n      data: {\r\n        path: \"system.coin.value\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.2\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"affiliation,background,class,beast quality,destiny,feat,forcePower,forceRegimen,forceSecret,forceTechnique,species,talent,template,trait,vehicleSystem\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"type\", \"name\", \"strippable\", \"hasPrerequisites\", \"modifiable\", \"hasLevels\"],\r\n\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Credits\",\r\n      img: \"icons/svg/coins.svg\",\r\n      abbreviation: \"{#}C\",\r\n      data: {\r\n        path: \"system.common.credits\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\n  VERSION: \"1.0.1\",\n\n  ACTOR_CLASS_TYPE: \"character\",\n\n  ITEM_QUANTITY_ATTRIBUTE: \"system.quantity\",\n\n  ITEM_PRICE_ATTRIBUTE: \"system.price\",\n\n  ITEM_FILTERS: [\n    {\n      path: \"type\",\n      filters: \"power,feat,class,archetype,background\",\n    },\n    {\n      path: \"system.weaponType\",\n      filters: \"natural\",\n    },\n  ],\n\n  ITEM_TRANSFORMER: async (itemData, actor = false) => {\n    [\"equipped\", \"proficient\", \"prepared\"].forEach((key) => {\n      if (itemData?.system?.[key] !== void 0) {\n        delete itemData.system[key];\n      }\n    });\n    setProperty(\n      itemData,\n      \"system.attunement\",\n      Math.min(\n        CONFIG.SW5E.attunementTypes.REQUIRED,\n        itemData?.system?.attunement ?? 0\n      )\n    );\n    return itemData;\n  },\n\n  ITEM_SIMILARITIES: [\"name\", \"type\"],\n\n  CURRENCIES: [\n    {\n      type: \"attribute\",\n      name: \"SW5E.CurrencyGC\",\n      img: \"systems/sw5e/packs/Icons/Data Recording and Storage/CreditChip.webp\",\n      abbreviation: \"{#}GC\",\n      data: {\n        path: \"system.currency.gc\",\n      },\n      primary: true,\n      exchangeRate: 1,\n    },\n  ],\n};\n","export default {\r\n\r\n  \"VERSION\": \"1.0.3\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"skill,perk,special_ability\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"FALLOUT.UI.CAPS\",\r\n      img: \"icons/commodities/currency/coins-engraved-copper.webp\",\r\n      abbreviation: \"{#}C\",\r\n      data: {\r\n        path: \"system.currency.caps\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.1\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price.market\",\r\n\r\n  // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"role, skill, criticalInjury\"\r\n    },\r\n    {\r\n      \"path\": \"system.isInstalled\",\r\n      \"filters\": [true]\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"CPR.characterSheet.rightPane.eurobucks.eurobucks\",\r\n      img: \"icons/svg/coins.svg\",\r\n      abbreviation: \"{#}€$\",\r\n      data: {\r\n        path: \"system.wealth.value\"\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.coppers\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"spell\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": []\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.qty\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"specialty,injury\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": []\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"injury, shipProblem, shipCriticalDamage, shipLogbook\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"YZECORIOLIS.Birr\",\r\n      img: \"icons/commodities/currency/coin-inset-insect-gold.webp\",\r\n      abbreviation: \"{#}B\",\r\n      data: {\r\n        path: \"system.birr\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\n\n  \"VERSION\": \"1.0.0\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"character\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"talent,attackOption,race,style,facade,bond\"\n    }\n  ],\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"KG.Money\",\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n      abbreviation: \"{#}G\",\n      data: {\n        path: \"system.attributes.money\",\n      },\n      primary: true,\n      exchangeRate: 1\n    }\n  ],\n\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\n}\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"monster\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.number\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"ability,boon,burden,mysticalPower,ritual,trait\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Thaler\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-copper.webp\",\r\n      abbreviation: \"{#}T\",\r\n      data: {\r\n        path: \"system.money.thaler\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Shilling\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-silver.webp\",\r\n      abbreviation: \"{#}S\",\r\n      data: {\r\n        path: \"system.money.shilling\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Orteg\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-platinum.webp\",\r\n      abbreviation: \"{#}O\",\r\n      data: {\r\n        path: \"system.money.orteg\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"ability, art, asset, focus, skill, spell\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"WWN.items.PP.long\",\r\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n      abbreviation: \"{#}PP\",\r\n      data: {\r\n        path: \"system.currency.pp\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 50\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"WWN.items.GP.long\",\r\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n      abbreviation: \"{#}GP\",\r\n      data: {\r\n        path: \"system.currency.gp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 10\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"WWN.items.EP.long\",\r\n      img: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\r\n      abbreviation: \"{#}EP\",\r\n      data: {\r\n        path: \"system.currency.ep\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 5\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"WWN.items.SP.long\",\r\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n      abbreviation: \"{#}SP\",\r\n      data: {\r\n        path: \"system.currency.sp\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"WWN.items.CP.long\",\r\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n      abbreviation: \"{#}CP\",\r\n      data: {\r\n        path: \"system.currency.cp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.1\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"pc\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.basic.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"flags.item-piles.system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"ability, lasting-damage, power-shift, recursion, skill, tag\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Adamantine pieces\",\r\n      img: \"icons/commodities/currency/coin-embossed-ruby-gold.webp\",\r\n      abbreviation: \"{#} ap\",\r\n      data: {\r\n        path: \"system.settings.equipment.currency.quantity6\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 1000\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Mithral pieces\",\r\n      img: \"icons/commodities/currency/coin-embossed-unicorn-silver.webp\",\r\n      abbreviation: \"{#} mp\",\r\n      data: {\r\n        path: \"system.settings.equipment.currency.quantity5\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 100\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Platinum pieces\",\r\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n      abbreviation: \"{#} pp\",\r\n      data: {\r\n        path: \"system.settings.equipment.currency.quantity4\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 10\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Gold pieces\",\r\n      img: \"icons/commodities/currency/coins-plain-gold.webp\",\r\n      abbreviation: \"{#} gp\",\r\n      data: {\r\n        path: \"system.settings.equipment.currency.quantity3\"\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Silver pieces\",\r\n      img: \"icons/commodities/currency/coins-engraved-face-silver.webp\",\r\n      abbreviation: \"{#} sp\",\r\n      data: {\r\n        path: \"system.settings.equipment.currency.quantity2\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Copper pieces\",\r\n      img: \"icons/commodities/currency/coins-engraved-copper.webp\",\r\n      abbreviation: \"{#} cp\",\r\n      data: {\r\n        path: \"system.settings.equipment.currency.quantity1\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"feat,edge,ability,move,capability,pokeedge,dexentry\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"PTU.Money\",\r\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n      abbreviation: \"{#}₱\",\r\n      data: {\r\n        path: \"system.money\"\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    }\r\n  ]\r\n}\r\n","export default {\n\n  \"VERSION\": \"1.0.0\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"Player\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.value\",\n\n  // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"spell,skill\"\n    },\n  ],\n\n  // This function is an optional system handler that specifically transforms an item when it is added to actors\n  \"ITEM_TRANSFORMER\": async (itemData) => {\n    // Transferred items should become unequipped\n    if (itemData?.system?.equipped) {\n      itemData.system.equipped = false;\n    }\n    // Transferring spells doesn't make a lot of sense, but if it happens the lost flag and mercurial effect should be cleared\n    [\"lost\", \"mercurialEffect\"].forEach(key => {\n      if (itemData?.system?.[key] !== undefined) {\n        delete itemData.system[key];\n      }\n    });\n    return itemData;\n  },\n\n  // This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n  \"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n    let overallCost = 0;\n    currencies.forEach((currency, index) => {\n      let denominationCost = Number(getProperty(item, currency.data.path.replace(\"system.currency.\", \"system.value.\")));\n      if (!isNaN(denominationCost)) {\n        overallCost += denominationCost * currency.exchangeRate;\n      }\n    })\n    return overallCost ?? 0;\n  },\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n  // In the case of attributes, the path is relative to the \"actor.system\"\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"DCC.CurrencyPP\",\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n      abbreviation: \"{#}Pp\",\n      data: {\n        path: \"system.currency.pp\",\n      },\n      primary: false,\n      exchangeRate: 100\n    },\n    {\n      type: \"attribute\",\n      name: \"DCC.CurrencyEP\",\n      img: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n      abbreviation: \"{#} Ep\",\n      data: {\n        path: \"system.currency.ep\",\n      },\n      primary: false,\n      exchangeRate: 10\n    },\n    {\n      type: \"attribute\",\n      name: \"DCC.CurrencyGP\",\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n      abbreviation: \"{#} Gp\",\n      data: {\n        path: \"system.currency.gp\",\n      },\n      primary: true,\n      exchangeRate: 1\n    },\n    {\n      type: \"attribute\",\n      name: \"DCC.CurrencySP\",\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n      abbreviation: \"{#} Sp\",\n      data: {\n        path: \"system.currency.sp\",\n      },\n      primary: false,\n      exchangeRate: 0.1\n    },\n    {\n      type: \"attribute\",\n      name: \"DCC.CurrencyCP\",\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n      abbreviation: \"{#} Cp\",\n      data: {\n        path: \"system.currency.cp\",\n      },\n      primary: false,\n      exchangeRate: 0.01\n    }\n  ],\n}\n","export default {\n\n  \"VERSION\": \"1.0.0\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"character\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n  // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"feature, maneuver, spell, background, culture, heritage, destiny\"\n    }\n  ],\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n  // In the case of attributes, the path is relative to the \"actor.system\"\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n  \"CURRENCIES\": [\n    {\n      type: \"attribute\",\n      name: \"Platinum Pieces\",\n      img: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n      abbreviation: \"{#}PP\",\n      data: {\n        path: \"system.currency.pp\"\n      },\n      primary: false,\n      exchangeRate: 10\n    },\n    {\n      type: \"attribute\",\n      name: \"Gold Pieces\",\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n      abbreviation: \"{#}GP\",\n      data: {\n        path: \"system.currency.gp\",\n      },\n      primary: true,\n      exchangeRate: 1\n    },\n    {\n      type: \"attribute\",\n      name: \"Electrum Pieces\",\n      img: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n      abbreviation: \"{#}EP\",\n      data: {\n        path: \"system.currency.ep\",\n      },\n      primary: false,\n      exchangeRate: 0.5\n    },\n    {\n      type: \"attribute\",\n      name: \"Silver Pieces\",\n      img: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n      abbreviation: \"{#}SP\",\n      data: {\n        path: \"system.currency.sp\",\n      },\n      primary: false,\n      exchangeRate: 0.1\n    },\n    {\n      type: \"attribute\",\n      name: \"Copper Pieces\",\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n      abbreviation: \"{#}CP\",\n      data: {\n        path: \"system.currency.cp\",\n      },\n      primary: false,\n      exchangeRate: 0.01\n    }\n  ]\n};\n","export default {\n\n  \"VERSION\": \"1.0.0\",\n\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n  \"ACTOR_CLASS_TYPE\": \"acolyte\",\n\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\n  \"ITEM_PRICE_ATTRIBUTE\": \"\",\n\n  // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n  \"ITEM_FILTERS\": [\n    {\n      \"path\": \"type\",\n      \"filters\": \"specialAbility, aptitude, talent, psychicPower, trait\"\n    },\n    {\n      \"path\": \"system.installed\",\n      \"filters\": \"installed\"\n    }\n  ],\n\n  // Item similarities determines how item piles detect similarities and differences in the system\n  \"ITEM_SIMILARITIES\": [],\n\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n  // In the case of attributes, the path is relative to the \"actor.system\"\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n  \"CURRENCIES\": [],\n\n  \"CURRENCY_DECIMAL_DIGITS\": 0.00001\n}\n  ","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.prix\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"ape,attaque,competence,coup,etat,metier,origine,region,sort,trait\"\r\n    }\r\n  ],\r\n\r\n  // This function is an optional system handler that specifically transforms an item when it is added to actors\r\n  \"ITEM_TRANSFORMER\": async (itemData) => {\r\n    [\"equipe\"].forEach(key => {\r\n      if (itemData?.system?.[key] !== undefined) {\r\n        delete itemData.system[key];\r\n      }\r\n    });\r\n    return itemData;\r\n  },\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"item\",\r\n      name: \"Pièce d'argent\",\r\n      img: \"systems/naheulbeuk/assets/from-rexard-icons/Tresors/tresor%20(101).webp\",\r\n      abbreviation: \"{#}PA\",\r\n      data: {\r\n        uuid: \"Compendium.naheulbeuk.trucs.BTUFKc6sEbJLmlas\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 10\r\n    },\r\n    {\r\n      type: \"item\",\r\n      name: \"Pièce d'or\",\r\n      img: \"systems/naheulbeuk/assets/from-rexard-icons/Tresors/tresor%20(52).webp\",\r\n      abbreviation: \"{#}PO\",\r\n      data: {\r\n        uuid: \"Compendium.naheulbeuk.trucs.AKuErwzQ6wDxtzyp\"\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"item\",\r\n      name: \"Lingot de Thrytil\",\r\n      img: \"systems/naheulbeuk/assets/from-rexard-icons/Objets/Materiaux/objet%20(291).webp\",\r\n      abbreviation: \"{#}LT\",\r\n      data: {\r\n        uuid: \"Compendium.naheulbeuk.trucs.tOTNc2WYpkyf2Yyl\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    },\r\n    {\r\n      type: \"item\",\r\n      name: \"Lingot de Berylium\",\r\n      img: \"systems/naheulbeuk/assets/from-rexard-icons/Objets/Materiaux/objet%20(252).webp\",\r\n      abbreviation: \"{#}LB\",\r\n      data: {\r\n        uuid: \"Compendium.naheulbeuk.trucs.r4qLXqXaIIdyKzOf\"\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.002\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.0\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"flags.item-piles.system.price\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"ability,power,augment,spell,part,property\"\r\n    }\r\n  ],\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n  \r\n}\r\n","// ↓ IMPORT SYSTEMS HERE ↓\nimport dnd4e from \"./systems/dnd4e.js\";\nimport dnd5e from \"./systems/dnd5e.js\";\nimport dnd5e203 from \"./systems/dnd5e-2.0.3.js\";\nimport pf1 from \"./systems/pf1.js\";\nimport pf2e from \"./systems/pf2e.js\";\nimport ds4 from \"./systems/ds4.js\";\nimport d35e from \"./systems/d35e.js\";\nimport sfrpg from \"./systems/sfrpg.js\";\nimport swade from \"./systems/swade.js\";\nimport tormenta20 from \"./systems/tormenta20.js\";\nimport wfrp4e from \"./systems/wfrp4e.js\";\nimport splittermond from \"./systems/splittermond.js\";\nimport forbiddenLands from \"./systems/forbidden-lands.js\";\nimport icrpg from \"./systems/icrpg.js\";\nimport swse from \"./systems/swse.js\";\nimport sw5e from \"./systems/sw5e.js\";\nimport fallout from \"./systems/fallout.js\";\nimport cyberpunkRedCore from \"./systems/cyberpunk-red-core.js\";\nimport knave from \"./systems/knave.js\";\nimport t2k4e from \"./systems/t2k4e.js\";\nimport yzecoriolis from \"./systems/yzecoriolis.js\";\nimport kamigakari from \"./systems/kamigakari.js\";\nimport symbaroum from \"./systems/symbaroum.js\";\nimport wwn from \"./systems/wwn.js\";\nimport cyphersystem from \"./systems/cyphersystem.js\";\nimport ptu from \"./systems/ptu.js\";\nimport dcc from \"./systems/dcc.js\";\nimport a5e from \"./systems/a5e.js\";\nimport darkHeresy2e from \"./systems/dark-heresy.js\";\nimport naheulbeuk from \"./systems/naheulbeuk.js\";\nimport icrpgme from \"./systems/icrpgme.js\";\n// ↑ IMPORT SYSTEMS HERE ↑\n\n/**\n * NOTE: YOUR PULL REQUEST WILL NOT BE ACCEPTED IF YOU DO NOT\n * FOLLOW THE CONVENTION IN THE D&D 5E SYSTEM FILE\n */\nexport const SYSTEMS = {\n\n  SUPPORTED_SYSTEMS: {\n    // ↓ ADD SYSTEMS HERE ↓\n    \"dnd4e\": {\n      \"latest\": dnd4e\n    },\n    \"dnd5e\": {\n      \"latest\": dnd5e,\n      \"2.0.3\": dnd5e203,\n    },\n    \"pf1\": {\n      \"latest\": pf1\n    },\n    \"pf2e\": {\n      \"latest\": pf2e\n    },\n    \"ds4\": {\n      \"latest\": ds4\n    },\n    \"d35e\": {\n      \"latest\": d35e\n    },\n    \"sfrpg\": {\n      \"latest\": sfrpg\n    },\n    \"swade\": {\n      \"latest\": swade\n    },\n    \"tormenta20\": {\n      \"latest\": tormenta20\n    },\n    \"wfrp4e\": {\n      \"latest\": wfrp4e\n    },\n    \"splittermond\": {\n      \"latest\": splittermond\n    },\n    \"forbidden-lands\": {\n      \"latest\": forbiddenLands\n    },\n    \"icrpg\": {\n      \"latest\": icrpg\n    },\n    \"icrpgme\": {\n      \"latest\": icrpgme\n    },\n    \"swse\": {\n      \"latest\": swse\n    },\n    \"sw5e\": {\n      \"latest\": sw5e\n    },\n    \"fallout\": {\n      \"latest\": fallout\n    },\n    \"cyberpunk-red-core\": {\n      \"latest\": cyberpunkRedCore\n    },\n    \"knave\": {\n      \"latest\": knave\n    },\n    \"t2k4e\": {\n      \"latest\": t2k4e\n    },\n    \"yzecoriolis\": {\n      \"latest\": yzecoriolis\n    },\n    \"kamigakari\": {\n      \"latest\": kamigakari\n    },\n    \"wwn\": {\n      \"latest\": wwn\n    },\n    \"symbaroum\": {\n      \"latest\": symbaroum\n    },\n    \"cyphersystem\": {\n      \"latest\": cyphersystem\n    },\n    \"ptu\": {\n      \"latest\": ptu\n    },\n    \"dcc\": {\n      \"latest\": dcc\n    },\n    \"a5e\": {\n      \"latest\": a5e\n    },\n    \"dark-heresy\": {\n      \"latest\": darkHeresy2e\n    },\n    \"naheulbeuk\": {\n      \"latest\": naheulbeuk\n    }\n    // ↑ ADD SYSTEMS HERE ↑\n  },\n\n  DEFAULT_SETTINGS: {\n    ACTOR_CLASS_TYPE: \"\",\n    ITEM_QUANTITY_ATTRIBUTE: \"\",\n    ITEM_PRICE_ATTRIBUTE: \"\",\n    QUANTITY_FOR_PRICE_ATTRIBUTE: \"flags.item-piles.system.quantityForPrice\",\n    ITEM_FILTERS: [],\n    ITEM_SIMILARITIES: [],\n    VAULT_STYLES: [],\n    CSS_VARIABLES: [],\n    UNSTACKABLE_ITEM_TYPES: [],\n    CURRENCIES: [],\n    SECONDARY_CURRENCIES: [],\n    PILE_DEFAULTS: {},\n    TOKEN_FLAG_DEFAULTS: {},\n    CURRENCY_DECIMAL_DIGITS: 0.00001\n  },\n\n  get HAS_SYSTEM_SUPPORT() {\n    return !!this.SUPPORTED_SYSTEMS?.[game.system.id.toLowerCase()];\n  },\n\n  _currentSystem: false,\n\n  get DATA() {\n\n    if (this._currentSystem) return this._currentSystem;\n\n    const system = this.SUPPORTED_SYSTEMS?.[game.system.id.toLowerCase()];\n    if (!system) return this.DEFAULT_SETTINGS;\n\n    if (system[game.system.version]) {\n      this._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[game.system.version]);\n      return this._currentSystem;\n    }\n\n    const versions = Object.keys(system);\n    if (versions.length === 1) {\n      this._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[versions[0]]);\n      return this._currentSystem;\n    }\n\n    versions.sort((a, b) => {\n      return a === \"latest\" || b === \"latest\" ? -Infinity : (isNewerVersion(b, a) ? -1 : 1);\n    });\n    const version = versions.find(version => {\n      return version === \"latest\" || !isNewerVersion(game.system.version, version);\n    });\n\n    this._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[version]);\n\n    return this._currentSystem;\n  },\n\n  addSystem(data) {\n    this.SUPPORTED_SYSTEMS[game.system.id.toLowerCase()] = { latest: data };\n  }\n};\n","function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\nfunction is_promise(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function') && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\nfunction split_css_unit(value) {\n    const split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n    return split ? [parseFloat(split[1]), split[2] || 'px'] : [value, 'px'];\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element.sheet;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n    return style.sheet;\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentNode !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    if (node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_immediate_propagation(fn) {\n    return function (event) {\n        event.stopImmediatePropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data_map(node, data_map) {\n    Object.keys(data_map).forEach((key) => {\n        set_custom_element_data(node, key, data_map[key]);\n    });\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction set_dynamic_element_data(tag) {\n    return (/-/.test(tag)) ? set_custom_element_data_map : set_attributes;\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction init_binding_group(group) {\n    let _inputs;\n    return {\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            _inputs.forEach(input => group.push(input));\n        },\n        /* remove */ r() {\n            _inputs.forEach(input => group.splice(group.indexOf(input), 1));\n        }\n    };\n}\nfunction init_binding_group_dynamic(group, indexes) {\n    let _group = get_binding_group(group);\n    let _inputs;\n    function get_binding_group(group) {\n        for (let i = 0; i < indexes.length; i++) {\n            group = group[indexes[i]] = group[indexes[i]] || [];\n        }\n        return group;\n    }\n    function push() {\n        _inputs.forEach(input => _group.push(input));\n    }\n    function remove() {\n        _inputs.forEach(input => _group.splice(_group.indexOf(input), 1));\n    }\n    return {\n        /* update */ u(new_indexes) {\n            indexes = new_indexes;\n            const new_group = get_binding_group(group);\n            if (new_group !== _group) {\n                remove();\n                _group = new_group;\n                push();\n            }\n        },\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            push();\n        },\n        /* remove */ r: remove\n    };\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes, is_svg) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration(undefined, is_svg);\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes, is_svg);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    if (value === null) {\n        node.style.removeProperty(key);\n    }\n    else {\n        node.style.setProperty(key, value, important ? 'important' : '');\n    }\n}\nfunction select_option(select, value, mounting) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    if (!mounting || value !== undefined) {\n        select.selectedIndex = -1; // no option should be selected\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked');\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n            // make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n            // see https://github.com/sveltejs/svelte/issues/4233\n            fn();\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, cancelable, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nfunction head_selector(nodeId, head) {\n    const result = [];\n    let started = 0;\n    for (const node of head.childNodes) {\n        if (node.nodeType === 8 /* comment node */) {\n            const comment = node.textContent.trim();\n            if (comment === `HEAD_${nodeId}_END`) {\n                started -= 1;\n                result.push(node);\n            }\n            else if (comment === `HEAD_${nodeId}_START`) {\n                started += 1;\n                result.push(node);\n            }\n        }\n        else if (started > 0) {\n            result.push(node);\n        }\n    }\n    return result;\n}\nclass HtmlTag {\n    constructor(is_svg = false) {\n        this.is_svg = false;\n        this.is_svg = is_svg;\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            if (this.is_svg)\n                this.e = svg_element(target.nodeName);\n            /** #7364  target for <template> may be provided as #document-fragment(11) */\n            else\n                this.e = element((target.nodeType === 11 ? 'TEMPLATE' : target.nodeName));\n            this.t = target.tagName !== 'TEMPLATE' ? target : target.content;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes, is_svg = false) {\n        super(is_svg);\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\nfunction construct_svelte_component(component, props) {\n    return new component(props);\n}\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\nconst managed_styles = new Map();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_style_information(doc, node) {\n    const info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n    managed_styles.set(doc, info);\n    return info;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    const { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n    if (!rules[name]) {\n        rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        managed_styles.forEach(info => {\n            const { ownerNode } = info.stylesheet;\n            // there is no ownerNode if it runs on jsdom.\n            if (ownerNode)\n                detach(ownerNode);\n        });\n        managed_styles.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs#run-time-svelte-beforeupdate\n */\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * `onMount` does not run inside a [server-side component](/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs#run-time-svelte-onmount\n */\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n */\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs#run-time-svelte-ondestroy\n */\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * https://svelte.dev/docs#run-time-svelte-createeventdispatcher\n */\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail, { cancelable = false } = {}) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail, { cancelable });\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n            return !event.defaultPrevented;\n        }\n        return true;\n    };\n}\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-setcontext\n */\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n    return context;\n}\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-getcontext\n */\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs#run-time-svelte-getallcontexts\n */\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-hascontext\n */\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nlet render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\nlet flushidx = 0; // Do *not* move this inside the flush() function\nfunction flush() {\n    // Do not reenter flush while dirty components are updated, as this can\n    // result in an infinite loop. Instead, let the inner flush handle it.\n    // Reentrancy is ok afterwards for bindings etc.\n    if (flushidx !== 0) {\n        return;\n    }\n    const saved_component = current_component;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        try {\n            while (flushidx < dirty_components.length) {\n                const component = dirty_components[flushidx];\n                flushidx++;\n                set_current_component(component);\n                update(component.$$);\n            }\n        }\n        catch (e) {\n            // reset dirty state to not end up in a deadlocked state and then rethrow\n            dirty_components.length = 0;\n            flushidx = 0;\n            throw e;\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        flushidx = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    seen_callbacks.clear();\n    set_current_component(saved_component);\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n */\nfunction flush_render_callbacks(fns) {\n    const filtered = [];\n    const targets = [];\n    render_callbacks.forEach((c) => fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c));\n    targets.forEach((c) => c());\n    render_callbacks = filtered;\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n    else if (callback) {\n        callback();\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    const options = { direction: 'in' };\n    let config = fn(node, params, options);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config(options);\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    const options = { direction: 'out' };\n    let config = fn(node, params, options);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config(options);\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    const options = { direction: 'both' };\n    let config = fn(node, params, options);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config(options);\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    const updates = [];\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            // defer updates until all the DOM shuffling is done\n            updates.push(() => block.p(child_ctx, dirty));\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    run_all(updates);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\nconst _boolean_attributes = [\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'inert',\n    'ismap',\n    'itemscope',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n];\n/**\n * List of HTML boolean attributes (e.g. `<input disabled>`).\n * Source: https://html.spec.whatwg.org/multipage/indices.html\n */\nconst boolean_attributes = new Set([..._boolean_attributes]);\n\n/** regex of all html void element names */\nconst void_element_names = /^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;\nfunction is_void(name) {\n    return void_element_names.test(name) || name.toLowerCase() === '!doctype';\n}\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, attrs_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (attrs_to_add) {\n        const classes_to_add = attrs_to_add.classes;\n        const styles_to_add = attrs_to_add.styles;\n        if (classes_to_add) {\n            if (attributes.class == null) {\n                attributes.class = classes_to_add;\n            }\n            else {\n                attributes.class += ' ' + classes_to_add;\n            }\n        }\n        if (styles_to_add) {\n            if (attributes.style == null) {\n                attributes.style = style_object_to_string(styles_to_add);\n            }\n            else {\n                attributes.style = style_object_to_string(merge_ssr_styles(attributes.style, styles_to_add));\n            }\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nfunction merge_ssr_styles(style_attribute, style_directive) {\n    const style_object = {};\n    for (const individual_style of style_attribute.split(';')) {\n        const colon_index = individual_style.indexOf(':');\n        const name = individual_style.slice(0, colon_index).trim();\n        const value = individual_style.slice(colon_index + 1).trim();\n        if (!name)\n            continue;\n        style_object[name] = value;\n    }\n    for (const name in style_directive) {\n        const value = style_directive[name];\n        if (value) {\n            style_object[name] = value;\n        }\n        else {\n            delete style_object[name];\n        }\n    }\n    return style_object;\n}\nconst ATTR_REGEX = /[&\"]/g;\nconst CONTENT_REGEX = /[&<]/g;\n/**\n * Note: this method is performance sensitive and has been optimized\n * https://github.com/sveltejs/svelte/pull/5701\n */\nfunction escape(value, is_attr = false) {\n    const str = String(value);\n    const pattern = is_attr ? ATTR_REGEX : CONTENT_REGEX;\n    pattern.lastIndex = 0;\n    let escaped = '';\n    let last = 0;\n    while (pattern.test(str)) {\n        const i = pattern.lastIndex - 1;\n        const ch = str[i];\n        escaped += str.substring(last, i) + (ch === '&' ? '&amp;' : (ch === '\"' ? '&quot;' : '&lt;'));\n        last = i + 1;\n    }\n    return escaped + str.substring(last);\n}\nfunction escape_attribute_value(value) {\n    // keep booleans, null, and undefined for the sake of `spread`\n    const should_escape = typeof value === 'string' || (value && typeof value === 'object');\n    return should_escape ? escape(value, true) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules. Otherwise you may need to fix a <${name}>.`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    const assignment = (boolean && value === true) ? '' : `=\"${escape(value, true)}\"`;\n    return ` ${name}${assignment}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\nfunction style_object_to_string(style_object) {\n    return Object.keys(style_object)\n        .filter(key => style_object[key])\n        .map(key => `${key}: ${escape_attribute_value(style_object[key])};`)\n        .join(' ');\n}\nfunction add_styles(style_object) {\n    const styles = style_object_to_string(style_object);\n    return styles ? ` style=\"${styles}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n            // if the component was destroyed immediately\n            // it will update the `$$.on_destroy` reference to `null`.\n            // the destructured on_destroy may still reference to the old array\n            if (component.$$.on_destroy) {\n                component.$$.on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        flush_render_callbacks($$.after_update);\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: [],\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            if (!is_function(callback)) {\n                return noop;\n            }\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        if (!is_function(callback)) {\n            return noop;\n        }\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.57.0' }, detail), { bubbles: true }));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation, has_stop_immediate_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    if (has_stop_immediate_propagation)\n        modifiers.push('stopImmediatePropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nfunction validate_dynamic_element(tag) {\n    const is_string = typeof tag === 'string';\n    if (tag && !is_string) {\n        throw new Error('<svelte:element> expects \"this\" attribute to be a string.');\n    }\n}\nfunction validate_void_dynamic_element(tag) {\n    if (tag && is_void(tag)) {\n        console.warn(`<svelte:element this=\"${tag}\"> is self-closing and cannot have content.`);\n    }\n}\nfunction construct_svelte_component_dev(component, props) {\n    const error_message = 'this={...} of <svelte:component> should specify a Svelte component.';\n    try {\n        const instance = new component(props);\n        if (!instance.$$ || !instance.$set || !instance.$on || !instance.$destroy) {\n            throw new Error(error_message);\n        }\n        return instance;\n    }\n    catch (err) {\n        const { message } = err;\n        if (typeof message === 'string' && message.indexOf('is not a constructor') !== -1) {\n            throw new Error(error_message);\n        }\n        else {\n            throw err;\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_styles, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, construct_svelte_component, construct_svelte_component_dev, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, flush_render_callbacks, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, head_selector, identity, init, init_binding_group, init_binding_group_dynamic, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, is_void, listen, listen_dev, loop, loop_guard, merge_ssr_styles, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_custom_element_data_map, set_data, set_data_dev, set_dynamic_element_data, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, split_css_unit, spread, src_url_equal, start_hydrating, stop_immediate_propagation, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_dynamic_element, validate_each_argument, validate_each_keys, validate_slots, validate_store, validate_void_dynamic_element, xlink_attr };\n","import { group_outros, transition_out, check_outros } from 'svelte/internal';\n\n/**\n * Provides common object manipulation utilities including depth traversal, obtaining accessors, safely setting values /\n * equality tests, and validation.\n */\n\nconst s_TAG_OBJECT = '[object Object]';\n\n/**\n * Recursively deep merges all source objects into the target object in place. Like `Object.assign` if you provide `{}`\n * as the target a copy is produced. If the target and source property are object literals they are merged.\n * Deleting keys is supported by specifying a property starting with `-=`.\n *\n * @param {object}      target - Target object.\n *\n * @param {...object}   sourceObj - One or more source objects.\n *\n * @returns {object}    Target object.\n */\nfunction deepMerge(target = {}, ...sourceObj)\n{\n   if (Object.prototype.toString.call(target) !== s_TAG_OBJECT)\n   {\n      throw new TypeError(`deepMerge error: 'target' is not an 'object'.`);\n   }\n\n   for (let cntr = 0; cntr < sourceObj.length; cntr++)\n   {\n      if (Object.prototype.toString.call(sourceObj[cntr]) !== s_TAG_OBJECT)\n      {\n         throw new TypeError(`deepMerge error: 'sourceObj[${cntr}]' is not an 'object'.`);\n      }\n   }\n\n   return _deepMerge(target, ...sourceObj);\n}\n\n/**\n * Tests for whether an object is iterable.\n *\n * @param {*} value - Any value.\n *\n * @returns {boolean} Whether object is iterable.\n */\nfunction isIterable(value)\n{\n   if (value === null || value === void 0 || typeof value !== 'object') { return false; }\n\n   return typeof value[Symbol.iterator] === 'function';\n}\n\n/**\n * Tests for whether an object is async iterable.\n *\n * @param {*} value - Any value.\n *\n * @returns {boolean} Whether value is async iterable.\n */\nfunction isIterableAsync(value)\n{\n   if (value === null || value === void 0 || typeof value !== 'object') { return false; }\n\n   return typeof value[Symbol.asyncIterator] === 'function';\n}\n\n/**\n * Tests for whether object is not null and a typeof object.\n *\n * @param {*} value - Any value.\n *\n * @returns {boolean} Is it an object.\n */\nfunction isObject(value)\n{\n   return value !== null && typeof value === 'object';\n}\n\n/**\n * Tests for whether the given value is a plain object.\n *\n * An object is plain if it is created by either: {}, new Object() or Object.create(null).\n *\n * @param {*} value - Any value\n *\n * @returns {boolean} Is it a plain object.\n */\nfunction isPlainObject(value)\n{\n   if (Object.prototype.toString.call(value) !== s_TAG_OBJECT) { return false; }\n\n   const prototype = Object.getPrototypeOf(value);\n   return prototype === null || prototype === Object.prototype;\n}\n\n/**\n * Provides a way to safely access an objects data / entries given an accessor string which describes the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string}   accessor - A string describing the entries to access.\n *\n * @param {*}        defaultValue - (Optional) A default value to return if an entry for accessor is not found.\n *\n * @returns {object} The data object.\n */\nfunction safeAccess(data, accessor, defaultValue = void 0)\n{\n   if (typeof data !== 'object') { return defaultValue; }\n   if (typeof accessor !== 'string') { return defaultValue; }\n\n   const access = accessor.split('.');\n\n   // Walk through the given object by the accessor indexes.\n   for (let cntr = 0; cntr < access.length; cntr++)\n   {\n      // If the next level of object access is undefined or null then return the empty string.\n      if (typeof data[access[cntr]] === 'undefined' || data[access[cntr]] === null) { return defaultValue; }\n\n      data = data[access[cntr]];\n   }\n\n   return data;\n}\n\n/**\n * Provides a way to safely set an objects data / entries given an accessor string which describes the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string}   accessor - A string describing the entries to access.\n *\n * @param {*}        value - A new value to set if an entry for accessor is found.\n *\n * @param {string}   [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set',\n *                                       'set-undefined', 'sub'.\n *\n * @param {boolean}  [createMissing=true] - If true missing accessor entries will be created as objects\n *                                          automatically.\n *\n * @returns {boolean} True if successful.\n */\nfunction safeSet(data, accessor, value, operation = 'set', createMissing = true)\n{\n   if (typeof data !== 'object') { throw new TypeError(`safeSet Error: 'data' is not an 'object'.`); }\n   if (typeof accessor !== 'string') { throw new TypeError(`safeSet Error: 'accessor' is not a 'string'.`); }\n\n   const access = accessor.split('.');\n\n   // Walk through the given object by the accessor indexes.\n   for (let cntr = 0; cntr < access.length; cntr++)\n   {\n      // If data is an array perform validation that the accessor is a positive integer otherwise quit.\n      if (Array.isArray(data))\n      {\n         const number = (+access[cntr]);\n\n         if (!Number.isInteger(number) || number < 0) { return false; }\n      }\n\n      if (cntr === access.length - 1)\n      {\n         switch (operation)\n         {\n            case 'add':\n               data[access[cntr]] += value;\n               break;\n\n            case 'div':\n               data[access[cntr]] /= value;\n               break;\n\n            case 'mult':\n               data[access[cntr]] *= value;\n               break;\n\n            case 'set':\n               data[access[cntr]] = value;\n               break;\n\n            case 'set-undefined':\n               if (typeof data[access[cntr]] === 'undefined') { data[access[cntr]] = value; }\n               break;\n\n            case 'sub':\n               data[access[cntr]] -= value;\n               break;\n         }\n      }\n      else\n      {\n         // If createMissing is true and the next level of object access is undefined then create a new object entry.\n         if (createMissing && typeof data[access[cntr]] === 'undefined') { data[access[cntr]] = {}; }\n\n         // Abort if the next level is null or not an object and containing a value.\n         if (data[access[cntr]] === null || typeof data[access[cntr]] !== 'object') { return false; }\n\n         data = data[access[cntr]];\n      }\n   }\n\n   return true;\n}\n\n/**\n * Internal implementation for `deepMerge`.\n *\n * @param {object}      target - Target object.\n *\n * @param {...object}   sourceObj - One or more source objects.\n *\n * @returns {object}    Target object.\n */\nfunction _deepMerge(target = {}, ...sourceObj)\n{\n   // Iterate and merge all source objects into target.\n   for (let cntr = 0; cntr < sourceObj.length; cntr++)\n   {\n      const obj = sourceObj[cntr];\n\n      for (const prop in obj)\n      {\n         if (Object.prototype.hasOwnProperty.call(obj, prop))\n         {\n            // Handle the special property starting with '-=' to delete keys.\n            if (prop.startsWith('-='))\n            {\n               delete target[prop.slice(2)];\n               continue;\n            }\n\n            // If target already has prop and both target[prop] and obj[prop] are object literals then merge them\n            // otherwise assign obj[prop] to target[prop].\n            target[prop] = Object.prototype.hasOwnProperty.call(target, prop) && target[prop]?.constructor === Object &&\n            obj[prop]?.constructor === Object ? _deepMerge({}, target[prop], obj[prop]) : obj[prop];\n         }\n      }\n   }\n\n   return target;\n}\n\n/**\n * Provides several helpful utility methods for accessibility and keyboard navigation.\n */\nclass A11yHelper\n{\n   /**\n    * Apply focus to the HTMLElement targets in a given A11yFocusSource data object. An iterable list `options.focusEl`\n    * can contain HTMLElements or selector strings. If multiple focus targets are provided in a list then the first\n    * valid target found will be focused. If focus target is a string then a lookup via `document.querySelector` is\n    * performed. In this case you should provide a unique selector for the desired focus target.\n    *\n    * Note: The body of this method is postponed to the next clock tick to allow any changes in the DOM to occur that\n    * might alter focus targets before applying.\n    *\n    * @param {A11yFocusSource|{ focusSource: A11yFocusSource }}   options - The focus options instance to apply.\n    */\n   static applyFocusSource(options)\n   {\n      if (!isObject(options)) { return; }\n\n      // Handle the case of receiving an object with embedded `focusSource`.\n      const focusOpts = isObject(options?.focusSource) ? options.focusSource : options;\n\n      setTimeout(() =>\n      {\n         const debug = typeof focusOpts.debug === 'boolean' ? focusOpts.debug : false;\n\n         if (isIterable(focusOpts.focusEl))\n         {\n            if (debug)\n            {\n               console.debug(`A11yHelper.applyFocusSource debug - Attempting to apply focus target: `, focusOpts.focusEl);\n            }\n\n            for (const target of focusOpts.focusEl)\n            {\n               if (target instanceof HTMLElement && target.isConnected)\n               {\n                  target.focus();\n                  if (debug)\n                  {\n                     console.debug(`A11yHelper.applyFocusSource debug - Applied focus to target: `, target);\n                  }\n                  break;\n               }\n               else if (typeof target === 'string')\n               {\n                  const element = document.querySelector(target);\n                  if (element instanceof HTMLElement && element.isConnected)\n                  {\n                     element.focus();\n                     if (debug)\n                     {\n                        console.debug(`A11yHelper.applyFocusSource debug - Applied focus to target: `, element);\n                     }\n                     break;\n                  }\n                  else if (debug)\n                  {\n                     console.debug(`A11yHelper.applyFocusSource debug - Could not query selector: `, target);\n                  }\n               }\n            }\n         }\n         else if (debug)\n         {\n            console.debug(`A11yHelper.applyFocusSource debug - No focus targets defined.`);\n         }\n      }, 0);\n   }\n\n   /**\n    * Returns first focusable element within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] - Optional element to start query.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>} [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @returns {HTMLElement} First focusable child element\n    */\n   static getFirstFocusableElement(element = document, options)\n   {\n      const focusableElements = this.getFocusableElements(element, options);\n\n      return focusableElements.length > 0 ? focusableElements[0] : void 0;\n   }\n\n   /**\n    * Returns all focusable elements within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] Optional element to start query.\n    *\n    * @param {object}            [options] - Optional parameters.\n    *\n    * @param {boolean}           [options.anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @param {Iterable<string>}  [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>}  [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @param {string}            [options.selectors] - Custom list of focusable selectors for `querySelectorAll`.\n    *\n    * @returns {Array<HTMLElement>} Child keyboard focusable\n    */\n   static getFocusableElements(element = document, { anchorHref = true, ignoreClasses, ignoreElements, selectors } = {})\n   {\n      if (!(element instanceof HTMLElement) && !(element instanceof Document))\n      {\n         throw new TypeError(`'element' is not a HTMLElement or Document instance.`);\n      }\n\n      if (typeof anchorHref !== 'boolean')\n      {\n         throw new TypeError(`'anchorHref' is not a boolean.`);\n      }\n\n      if (ignoreClasses !== void 0 && !isIterable(ignoreClasses))\n      {\n         throw new TypeError(`'ignoreClasses' is not an iterable list.`);\n      }\n\n      if (ignoreElements !== void 0 && !(ignoreElements instanceof Set))\n      {\n         throw new TypeError(`'ignoreElements' is not a Set.`);\n      }\n\n      if (selectors !== void 0 && typeof selectors !== 'string')\n      {\n         throw new TypeError(`'selectors' is not a string.`);\n      }\n\n      const selectorQuery = selectors ?? this.#getFocusableSelectors(anchorHref);\n\n      const allElements = [...element.querySelectorAll(selectorQuery)];\n\n      if (ignoreElements && ignoreClasses)\n      {\n         return allElements.filter((el) =>\n         {\n            let hasIgnoreClass = false;\n            for (const ignoreClass of ignoreClasses)\n            {\n               if (el.classList.contains(ignoreClass))\n               {\n                  hasIgnoreClass = true;\n                  break;\n               }\n            }\n\n            return !hasIgnoreClass && !ignoreElements.has(el) && el.style.display !== 'none' &&\n             el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') && !el.hasAttribute('inert') &&\n              el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else if (ignoreClasses)\n      {\n         return allElements.filter((el) =>\n         {\n            let hasIgnoreClass = false;\n            for (const ignoreClass of ignoreClasses)\n            {\n               if (el.classList.contains(ignoreClass))\n               {\n                  hasIgnoreClass = true;\n                  break;\n               }\n            }\n\n            return !hasIgnoreClass && el.style.display !== 'none' && el.style.visibility !== 'hidden' &&\n             !el.hasAttribute('disabled') && !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else if (ignoreElements)\n      {\n         return allElements.filter((el) =>\n         {\n            return !ignoreElements.has(el) && el.style.display !== 'none' && el.style.visibility !== 'hidden' &&\n             !el.hasAttribute('disabled') && !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else\n      {\n         return allElements.filter((el) =>\n         {\n            return el.style.display !== 'none' && el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') &&\n             !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n   }\n\n   /**\n    * Returns the default focusable selectors query.\n    *\n    * @param {boolean}  [anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @returns {string} Focusable selectors for `querySelectorAll`.\n    */\n   static #getFocusableSelectors(anchorHref = true)\n   {\n      return `button, [contenteditable=\"\"], [contenteditable=\"true\"], details summary:not([tabindex=\"-1\"]), embed, a${\n       anchorHref ? '[href]' : ''}, iframe, object, input:not([type=hidden]), select, textarea, ` +\n        `[tabindex]:not([tabindex=\"-1\"])`;\n   }\n\n   /**\n    * Gets a A11yFocusSource object from the given DOM event allowing for optional X / Y screen space overrides.\n    * Browsers (Firefox / Chrome) forwards a mouse event for the context menu keyboard button. Provides detection of\n    * when the context menu event is from the keyboard. Firefox as of (1/23) does not provide the correct screen space\n    * coordinates, so for keyboard context menu presses coordinates are generated from the centroid point of the\n    * element.\n    *\n    * A default fallback element or selector string may be provided to provide the focus target. If the event comes from\n    * the keyboard however the source focused element is inserted as the target with the fallback value appended to the\n    * list of focus targets. When A11yFocusSource is applied by {@link A11yHelper.applyFocusSource} the target focus\n    * list is iterated through until a connected target is found and focus applied.\n    *\n    * @param {object} options - Options\n    *\n    * @param {KeyboardEvent|MouseEvent}   [options.event] - The source DOM event.\n    *\n    * @param {boolean} [options.debug] - When true {@link A11yHelper.applyFocusSource} logs focus target data.\n    *\n    * @param {HTMLElement|string} [options.focusEl] - A specific HTMLElement or selector string as the focus target.\n    *\n    * @param {number}   [options.x] - Used when an event isn't provided; integer of event source in screen space.\n    *\n    * @param {number}   [options.y] - Used when an event isn't provided; integer of event source in screen space.\n    *\n    * @returns {A11yFocusSource} A A11yFocusSource object.\n    *\n    * @see https://bugzilla.mozilla.org/show_bug.cgi?id=1426671\n    * @see https://bugzilla.mozilla.org/show_bug.cgi?id=314314\n    *\n    * TODO: Evaluate / test against touch input devices.\n    */\n   static getFocusSource({ event, x, y, focusEl, debug = false })\n   {\n      if (focusEl !== void 0 && !(focusEl instanceof HTMLElement) && typeof focusEl !== 'string')\n      {\n         throw new TypeError(\n          `A11yHelper.getFocusSource error: 'focusEl' is not a HTMLElement or string.`);\n      }\n\n      if (debug !== void 0 && typeof debug !== 'boolean')\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'debug' is not a boolean.`);\n      }\n\n      // Handle the case when no event is provided and x, y, or focusEl is explicitly defined.\n      if (event === void 0)\n      {\n         if (typeof x !== 'number')\n         {\n            throw new TypeError(`A11yHelper.getFocusSource error: 'event' not defined and 'x' is not a number.`);\n         }\n\n         if (typeof y !== 'number')\n         {\n            throw new TypeError(`A11yHelper.getFocusSource error: 'event' not defined and 'y' is not a number.`);\n         }\n\n         return {\n            debug,\n            focusEl: focusEl !== void 0 ? [focusEl] : void 0,\n            x,\n            y,\n         };\n      }\n\n      if (!(event instanceof KeyboardEvent) && !(event instanceof MouseEvent))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'event' is not a KeyboardEvent or MouseEvent.`);\n      }\n\n      if (x !== void 0 && !Number.isInteger(x))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'x' is not a number.`);\n      }\n\n      if (y !== void 0 && !Number.isInteger(y))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'y' is not a number.`);\n      }\n\n      /** @type {HTMLElement} */\n      const targetEl = event.target;\n\n      if (!(targetEl instanceof HTMLElement))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'event.target' is not an HTMLElement.`);\n      }\n\n      const result = { debug };\n\n      if (event instanceof MouseEvent)\n      {\n         // Firefox currently (1/23) does not correctly determine the location of a keyboard originated\n         // context menu location, so calculate position from middle of the event target.\n         // Firefox fires a mouse event for the context menu key.\n         if (event?.button !== 2 && event.type === 'contextmenu')\n         {\n            const rect = targetEl.getBoundingClientRect();\n            result.x = x ?? rect.left + (rect.width / 2);\n            result.y = y ?? rect.top + (rect.height / 2);\n            result.focusEl = focusEl !== void 0 ? [targetEl, focusEl] : [targetEl];\n            result.source = 'keyboard';\n         }\n         else\n         {\n            result.x = x ?? event.pageX;\n            result.y = y ?? event.pageY;\n            result.focusEl = focusEl !== void 0 ? [focusEl] : void 0;\n         }\n      }\n      else\n      {\n         const rect = targetEl.getBoundingClientRect();\n         result.x = x ?? rect.left + (rect.width / 2);\n         result.y = y ?? rect.top + (rect.height / 2);\n         result.focusEl = focusEl !== void 0 ? [targetEl, focusEl] : [targetEl];\n         result.source = 'keyboard';\n      }\n\n      return result;\n   }\n\n   /**\n    * Returns first focusable element within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] - Optional element to start query.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>} [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @returns {HTMLElement} First focusable child element\n    */\n   static getLastFocusableElement(element = document, options)\n   {\n      const focusableElements = this.getFocusableElements(element, options);\n\n      return focusableElements.length > 0 ? focusableElements[focusableElements.length - 1] : void 0;\n   }\n\n   /**\n    * Tests if the given element is focusable.\n    *\n    * @param {HTMLElement} [el] - Element to test.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {boolean} [options.anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @returns {boolean} Element is focusable.\n    */\n   static isFocusable(el, { anchorHref = true, ignoreClasses } = {})\n   {\n      if (el === void 0 || el === null || !(el instanceof HTMLElement) || el?.hidden || !el?.isConnected)\n      {\n         return false;\n      }\n\n      if (typeof anchorHref !== 'boolean')\n      {\n         throw new TypeError(`'anchorHref' is not a boolean.`);\n      }\n\n      if (ignoreClasses !== void 0 && !isIterable(ignoreClasses))\n      {\n         throw new TypeError(`'ignoreClasses' is not an iterable list.`);\n      }\n\n      const contenteditableAttr = el.getAttribute('contenteditable');\n      const contenteditableFocusable = typeof contenteditableAttr === 'string' &&\n       (contenteditableAttr === '' || contenteditableAttr === 'true');\n\n      const tabindexAttr = el.getAttribute('tabindex');\n      const tabindexFocusable = typeof tabindexAttr === 'string' && tabindexAttr !== '-1';\n\n      const isAnchor = el instanceof HTMLAnchorElement;\n\n      if (contenteditableFocusable || tabindexFocusable || isAnchor || el instanceof HTMLButtonElement ||\n       el instanceof HTMLDetailsElement || el instanceof HTMLEmbedElement || el instanceof HTMLIFrameElement ||\n        el instanceof HTMLInputElement || el instanceof HTMLObjectElement || el instanceof HTMLSelectElement ||\n         el instanceof HTMLTextAreaElement)\n      {\n         if (isAnchor && anchorHref && typeof el.getAttribute('href') !== 'string')\n         {\n            return false;\n         }\n\n         return el.style.display !== 'none' && el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') &&\n          !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n      }\n\n      return false;\n   }\n\n   /**\n    * Convenience method to check if the given data is a valid focus source.\n    *\n    * @param {HTMLElement|string}   data - Either an HTMLElement or selector string.\n    *\n    * @returns {boolean} Is valid focus source.\n    */\n   static isFocusSource(data)\n   {\n      return data instanceof HTMLElement || typeof data === 'string';\n   }\n}\n\n/**\n * @typedef {object} A11yFocusSource - Provides essential data to return focus to an HTMLElement after a series of UI\n * actions like working with context menus and modal dialogs.\n *\n * @property {boolean} [debug] - When true logs to console the actions taken in {@link A11yHelper.applyFocusSource}.\n *\n * @property {Iterable<HTMLElement|string>} [focusEl] - List of targets to attempt to focus.\n *\n * @property {string} [source] - The source of the event: 'keyboard' for instance.\n *\n * @property {number} [x] - Potential X coordinate of initial event.\n *\n * @property {number} [y] - Potential Y coordinate of initial event.\n */\n\n/**\n * Provides management of a single Promise that can be shared and accessed across JS & Svelte components. This allows a\n * Promise to be created and managed as part of the TRL application lifecycle and accessed safely in various control\n * flow scenarios. When resolution of the current managed Promise starts further interaction is prevented.\n *\n * Note: to enable debugging / log statements set the static `logging` variable to true.\n */\nclass ManagedPromise\n{\n   /** @type {boolean} */\n   static #logging = false;\n\n   /** @type {{ isProcessing?: boolean, promise?: Promise, reject: Function, resolve: Function }} */\n   #current;\n\n   /**\n    * @returns {boolean} Whether global logging is enabled.\n    */\n   static get logging()\n   {\n      return this.#logging;\n   }\n\n   /**\n    * @returns {boolean} Whether there is an active managed Promise.\n    */\n   get isActive()\n   {\n      return this.#current !== void 0;\n   }\n\n   /**\n    * @returns {boolean} Whether there is an active managed Promise and resolution is currently being processed.\n    */\n   get isProcessing()\n   {\n      return this.#current !== void 0 ? this.#current.isProcessing : false;\n   }\n\n   /**\n    * Sets global logging enabled state.\n    *\n    * @param {boolean}  logging - New logging enabled state.\n    */\n   static set logging(logging)\n   {\n      if (typeof logging !== 'boolean')\n      {\n         throw new TypeError(`[TRL] ManagedPromise.logging error: 'logging' is not a boolean.`);\n      }\n\n      this.#logging = logging;\n   }\n\n   // ----------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Resolves any current Promise with undefined and creates a new current Promise.\n    *\n    * @template T\n    *\n    * @param {object} opts - Options.\n    *\n    * @param {boolean}  [opts.reuse=false] - When true if there is an existing live Promise it is returned immediately.\n    *\n    * @returns {Promise<T>} The new current managed Promise.\n    */\n   create({ reuse = false } = {})\n   {\n      if (typeof reuse !== 'boolean')\n      {\n         throw new TypeError(`[TRL] ManagedPromise.create error: 'reuse' is not a boolean.`);\n      }\n\n      if (reuse && this.#current !== void 0 && this.#current.promise instanceof Promise)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.create info: Reusing / returning existing managed Promise.`);\n         }\n\n         return this.#current.promise;\n      }\n\n      if (this.#current !== void 0)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(\n             `[TRL] ManagedPromise.create info: Creating a new Promise and resolving existing immediately.`);\n         }\n\n         this.#current.resolve(void 0);\n         this.#current = void 0;\n      }\n\n      const promise = new Promise((resolve, reject) =>\n      {\n         this.#current = {\n            isProcessing: false,\n            reject,\n            resolve\n         };\n      });\n\n      this.#current.promise = promise;\n\n      return promise;\n   }\n\n   /**\n    * Gets the current Promise if any.\n    *\n    * @returns {Promise<any>} Current Promise.\n    */\n   get()\n   {\n      return this.#current ? this.#current.promise : void 0;\n   }\n\n   /**\n    * Rejects the current Promise if applicable.\n    *\n    * @param {*}  [result] - Result to reject.\n    *\n    * @returns {boolean} Was the promise rejected.\n    */\n   reject(result = void 0)\n   {\n      // Early out as Promise resolution is currently processing.\n      if (this.#current !== void 0 && this.#current.isProcessing)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.reject info: Currently processing promise.`);\n         }\n\n         return true;\n      }\n\n      if (this.#current !== void 0)\n      {\n         this.#current.isProcessing = true;\n\n         if (result instanceof Promise)\n         {\n            result.then((value) =>\n            {\n               this.#current.reject(value);\n               this.#current = void 0;\n            }).catch((err) =>\n            {\n               this.#current.reject(err);\n               this.#current = void 0;\n            });\n         }\n         else\n         {\n            this.#current.reject(result);\n            this.#current = void 0;\n         }\n\n         return true;\n      }\n      else\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.reject warning: No current managed Promise to reject.`);\n         }\n\n         return false;\n      }\n   }\n\n   /**\n    * Resolves the current Promise if applicable.\n    *\n    * @param {*}  [result] - Result to resolve.\n    *\n    * @returns {boolean} Was the promise resolved.\n    */\n   resolve(result = void 0)\n   {\n      // Early out as Promise resolution is currently processing.\n      if (this.#current !== void 0 && this.#current.isProcessing)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.resolve info: Currently processing promise.`);\n         }\n\n         return true;\n      }\n\n      if (this.#current !== void 0)\n      {\n         if (result instanceof Promise)\n         {\n            this.#current.isProcessing = true;\n\n            result.then((value) =>\n            {\n               this.#current.resolve(value);\n               this.#current = void 0;\n            }).catch((err) =>\n            {\n               this.#current.reject(err);\n               this.#current = void 0;\n            });\n         }\n         else\n         {\n            this.#current.resolve(result);\n            this.#current = void 0;\n         }\n\n         return true;\n      }\n      else\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.resolve warning: No current managed Promise to resolve.`);\n         }\n\n         return false;\n      }\n   }\n}\n\n/**\n * Provides access to the Clipboard API for reading / writing text strings. This requires a secure context.\n *\n * Note: `writeText` will attempt to use the older `execCommand` if available when `navigator.clipboard` is not\n * available.\n */\nclass ClipboardAccess\n{\n   /**\n    * Uses `navigator.clipboard` if available to read text from the clipboard.\n    *\n    * Note: Always returns `undefined` when `navigator.clipboard` is not available or the clipboard contains the\n    * empty string.\n    *\n    * @returns {Promise<string|undefined>} The current clipboard text or undefined.\n    */\n   static async readText()\n   {\n      let result;\n\n      if (globalThis?.navigator?.clipboard)\n      {\n         try\n         {\n            result = await globalThis.navigator.clipboard.readText();\n         }\n         catch (err) { /**/ }\n      }\n\n      return result === '' ? void 0 : result;\n   }\n\n   /**\n    * Uses `navigator.clipboard` if available then falls back to `document.execCommand('copy')` if available to copy\n    * the given text to the clipboard.\n    *\n    * @param {string}   text - Text to copy to the browser clipboard.\n    *\n    * @returns {Promise<boolean>} Copy successful.\n    */\n   static async writeText(text)\n   {\n      if (typeof text !== 'string')\n      {\n         throw new TypeError(`ClipboardAccess.writeText error: 'text' is not a string.`);\n      }\n\n      let success = false;\n\n      if (globalThis?.navigator?.clipboard)\n      {\n         try\n         {\n            await globalThis.navigator.clipboard.writeText(text);\n            success = true;\n         }\n         catch (err) { /**/ }\n      }\n      else if (globalThis?.document?.execCommand instanceof Function)\n      {\n         const textArea = globalThis.document.createElement('textarea');\n\n         // Place in the top-left corner of screen regardless of scroll position.\n         textArea.style.position = 'fixed';\n         textArea.style.top = '0';\n         textArea.style.left = '0';\n\n         // Ensure it has a small width and height. Setting to 1px / 1em\n         // doesn't work as this gives a negative w/h on some browsers.\n         textArea.style.width = '2em';\n         textArea.style.height = '2em';\n\n         // We don't need padding, reducing the size if it does flash render.\n         textArea.style.padding = '0';\n\n         // Clean up any borders.\n         textArea.style.border = 'none';\n         textArea.style.outline = 'none';\n         textArea.style.boxShadow = 'none';\n\n         // Avoid flash of the white box if rendered for any reason.\n         textArea.style.background = 'transparent';\n\n         textArea.value = text;\n\n         globalThis.document.body.appendChild(textArea);\n         textArea.focus();\n         textArea.select();\n\n         try\n         {\n            success = document.execCommand('copy');\n         }\n         catch (err) { /**/ }\n\n         document.body.removeChild(textArea);\n      }\n\n      return success;\n   }\n}\n\n/**\n * Provides a solid string hashing algorithm.\n *\n * Sourced from: https://stackoverflow.com/a/52171480\n *\n * @param {string}   str - String to hash.\n *\n * @param {number}   seed - A seed value altering the hash.\n *\n * @returns {number} Hash code.\n */\nfunction hashCode(str, seed = 0)\n{\n   if (typeof str !== 'string') { return 0; }\n\n   let h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n\n   for (let ch, i = 0; i < str.length; i++)\n   {\n      ch = str.charCodeAt(i);\n      h1 = Math.imul(h1 ^ ch, 2654435761);\n      h2 = Math.imul(h2 ^ ch, 1597334677);\n   }\n\n   h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\n   h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\n\n   return 4294967296 * (2097151 & h2) + (h1 >>> 0);\n}\n\nconst s_UUIDV4_REGEX = /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i;\n\n/**\n * Generates a UUID v4 compliant ID. Please use a complete UUID generation package for guaranteed compliance.\n *\n * This code is an evolution of the following Gist.\n * https://gist.github.com/jed/982883\n *\n * There is a public domain / free copy license attached to it that is not a standard OSS license...\n * https://gist.github.com/jed/982883#file-license-txt\n *\n * @returns {string} UUIDv4\n */\nfunction uuidv4()\n{\n   return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>\n    (c ^ (globalThis.crypto || globalThis.msCrypto).getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));\n}\n\n/**\n * Validates that the given string is formatted as a UUIDv4 string.\n *\n * @param {string}   uuid - UUID string to test.\n *\n * @returns {boolean} Is UUIDv4 string.\n */\nuuidv4.isValid = (uuid) => s_UUIDV4_REGEX.test(uuid);\n\n/**\n * Normalizes a string.\n *\n * @param {string}   query - A string to normalize for comparisons.\n *\n * @returns {string} Cleaned string.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize\n */\nfunction normalizeString(query)\n{\n   return query.trim().normalize('NFD').replace(/[\\x00-\\x1F]/gm, ''); // eslint-disable-line no-control-regex\n}\n\n/**\n * Recursive function that finds the closest parent stacking context.\n * See also https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context\n *\n * Original author: Kerry Liu / https://github.com/gwwar\n *\n * @see https://github.com/gwwar/z-context/blob/master/content-script.js\n * @see https://github.com/gwwar/z-context/blob/master/LICENSE\n *\n * @param {Element} node -\n *\n * @returns {StackingContext} The closest parent stacking context\n */\nfunction getStackingContext(node)\n{\n   // the root element (HTML).\n   if (!node || node.nodeName === 'HTML')\n   {\n      return { node: document.documentElement, reason: 'root' };\n   }\n\n   // handle shadow root elements.\n   if (node.nodeName === '#document-fragment')\n   {\n      return getStackingContext(node.host);\n   }\n\n   const computedStyle = globalThis.getComputedStyle(node);\n\n   // position: fixed or sticky.\n   if (computedStyle.position === 'fixed' || computedStyle.position === 'sticky')\n   {\n      return { node, reason: `position: ${computedStyle.position}` };\n   }\n\n   // positioned (absolutely or relatively) with a z-index value other than \"auto\".\n   if (computedStyle.zIndex !== 'auto' && computedStyle.position !== 'static')\n   {\n      return { node, reason: `position: ${computedStyle.position}; z-index: ${computedStyle.zIndex}` };\n   }\n\n   // elements with an opacity value less than 1.\n   if (computedStyle.opacity !== '1')\n   {\n      return { node, reason: `opacity: ${computedStyle.opacity}` };\n   }\n\n   // elements with a transform value other than \"none\".\n   if (computedStyle.transform !== 'none')\n   {\n      return { node, reason: `transform: ${computedStyle.transform}` };\n   }\n\n   // elements with a mix-blend-mode value other than \"normal\".\n   if (computedStyle.mixBlendMode !== 'normal')\n   {\n      return { node, reason: `mixBlendMode: ${computedStyle.mixBlendMode}` };\n   }\n\n   // elements with a filter value other than \"none\".\n   if (computedStyle.filter !== 'none')\n   {\n      return { node, reason: `filter: ${computedStyle.filter}` };\n   }\n\n   // elements with a perspective value other than \"none\".\n   if (computedStyle.perspective !== 'none')\n   {\n      return { node, reason: `perspective: ${computedStyle.perspective}` };\n   }\n\n   // elements with a clip-path value other than \"none\".\n   if (computedStyle.clipPath !== 'none')\n   {\n      return { node, reason: `clip-path: ${computedStyle.clipPath} ` };\n   }\n\n   // elements with a mask value other than \"none\".\n   const mask = computedStyle.mask || computedStyle.webkitMask;\n   if (mask !== 'none' && mask !== undefined)\n   {\n      return { node, reason: `mask:  ${mask}` };\n   }\n\n   // elements with a mask-image value other than \"none\".\n   const maskImage = computedStyle.maskImage || computedStyle.webkitMaskImage;\n   if (maskImage !== 'none' && maskImage !== undefined)\n   {\n      return { node, reason: `mask-image: ${maskImage}` };\n   }\n\n   // elements with a mask-border value other than \"none\".\n   const maskBorder = computedStyle.maskBorder || computedStyle.webkitMaskBorder;\n   if (maskBorder !== 'none' && maskBorder !== undefined)\n   {\n      return { node, reason: `mask-border: ${maskBorder}` };\n   }\n\n   // elements with isolation set to \"isolate\".\n   if (computedStyle.isolation === 'isolate')\n   {\n      return { node, reason: `isolation: ${computedStyle.isolation}` };\n   }\n\n   // transform or opacity in will-change even if you don't specify values for these attributes directly.\n   if (computedStyle.willChange === 'transform' || computedStyle.willChange === 'opacity')\n   {\n      return { node, reason: `willChange: ${computedStyle.willChange}` };\n   }\n\n   // elements with -webkit-overflow-scrolling set to \"touch\".\n   if (computedStyle.webkitOverflowScrolling === 'touch')\n   {\n      return { node, reason: '-webkit-overflow-scrolling: touch' };\n   }\n\n   // an item with a z-index value other than \"auto\".\n   if (computedStyle.zIndex !== 'auto')\n   {\n      const parentStyle = globalThis.getComputedStyle(node.parentNode);\n      // with a flex|inline-flex parent.\n      if (parentStyle.display === 'flex' || parentStyle.display === 'inline-flex')\n      {\n         return { node, reason: `flex-item; z-index: ${computedStyle.zIndex}` };\n         // with a grid parent.\n      }\n      else if (parentStyle.grid !== 'none / none / none / row / auto / auto')\n      {\n         return { node, reason: `child of grid container; z-index: ${computedStyle.zIndex}` };\n      }\n   }\n\n   // contain with a value of layout, or paint, or a composite value that includes either of them\n   const contain = computedStyle.contain;\n   if (['layout', 'paint', 'strict', 'content'].indexOf(contain) > -1 ||\n    contain.indexOf('paint') > -1 ||\n    contain.indexOf('layout') > -1\n   )\n   {\n      return { node, reason: `contain: ${contain}` };\n   }\n\n   return getStackingContext(node.parentNode);\n}\n\n/**\n * @typedef {object} StackingContext\n *\n * @property {Element} node - A DOM Element.\n *\n * @property {string}  reason - Reason for why a stacking context was created.\n */\n\n/**\n * Provides a managed dynamic style sheet / element useful in configuring global CSS variables. When creating an\n * instance of StyleManager you must provide a \"document key\" / string for the style element added. The style element\n * can be accessed via `document[docKey]`.\n *\n * Instances of StyleManager can also be versioned by supplying a positive integer greater than or equal to `1` via the\n * 'version' option. This version number is assigned to the associated style element. When a StyleManager instance is\n * created and there is an existing instance with a version that is lower than the current instance all CSS rules are\n * removed letting the higher version to take precedence. This isn't a perfect system and requires thoughtful\n * construction of CSS variables exposed, but allows multiple independently compiled TRL packages to load the latest\n * CSS variables. It is recommended to always set `overwrite` option of {@link StyleManager.setProperty} and\n * {@link StyleManager.setProperties} to `false` when loading initial values.\n */\nclass StyleManager\n{\n   /** @type {CSSStyleRule} */\n   #cssRule;\n\n   /** @type {string} */\n   #docKey;\n\n   /** @type {string} */\n   #selector;\n\n   /** @type {HTMLStyleElement} */\n   #styleElement;\n\n   /** @type {number} */\n   #version;\n\n   /**\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.docKey - Required key providing a link to a specific style sheet element.\n    *\n    * @param {string}   [opts.selector=:root] - Selector element.\n    *\n    * @param {Document} [opts.document] - Target document to load styles into.\n    *\n    * @param {number}   [opts.version] - An integer representing the version / level of styles being managed.\n    *\n    */\n   constructor({ docKey, selector = ':root', document = globalThis.document, version } = {})\n   {\n      if (typeof docKey !== 'string') { throw new TypeError(`StyleManager error: 'docKey' is not a string.`); }\n\n      // TODO: Verify 'document' type from Popout FVTT module. For some reason the popout document trips this\n      //  unintentionally.\n      // if (!(document instanceof Document))\n      // {\n      //    throw new TypeError(`StyleManager error: 'document' is not an instance of Document.`);\n      // }\n\n      if (typeof selector !== 'string') { throw new TypeError(`StyleManager error: 'selector' is not a string.`); }\n\n      if (version !== void 0 && !Number.isSafeInteger(version) && version < 1)\n      {\n         throw new TypeError(`StyleManager error: 'version' is defined and is not a positive integer >= 1.`);\n      }\n\n      this.#selector = selector;\n      this.#docKey = docKey;\n      this.#version = version;\n\n      if (document[this.#docKey] === void 0)\n      {\n         this.#styleElement = document.createElement('style');\n\n         document.head.append(this.#styleElement);\n\n         // Set initial style manager version if any supplied.\n         this.#styleElement._STYLE_MANAGER_VERSION = version;\n\n         this.#styleElement.sheet.insertRule(`${selector} {}`, 0);\n\n         this.#cssRule = this.#styleElement.sheet.cssRules[0];\n\n         document[docKey] = this.#styleElement;\n      }\n      else\n      {\n         this.#styleElement = document[docKey];\n         this.#cssRule = this.#styleElement.sheet.cssRules[0];\n\n         if (version)\n         {\n            const existingVersion = this.#styleElement._STYLE_MANAGER_VERSION ?? 0;\n\n            // Remove all existing CSS rules / text if version is greater than existing version.\n            if (version > existingVersion)\n            {\n               this.#cssRule.style.cssText = '';\n            }\n         }\n      }\n   }\n\n   /**\n    * @returns {string} Provides an accessor to get the `cssText` for the style sheet.\n    */\n   get cssText()\n   {\n      return this.#cssRule.style.cssText;\n   }\n\n   /**\n    * @returns {number} Returns the version of this instance.\n    */\n   get version()\n   {\n      return this.#version;\n   }\n\n   /**\n    * Provides a copy constructor to duplicate an existing StyleManager instance into a new document.\n    *\n    * Note: This is used to support the `PopOut` module.\n    *\n    * @param {Document} [document] Target browser document to clone into.\n    *\n    * @returns {StyleManager} New style manager instance.\n    */\n   clone(document = globalThis.document)\n   {\n      const newStyleManager = new StyleManager({\n         selector: this.#selector,\n         docKey: this.#docKey,\n         document,\n         version: this.#version\n      });\n\n      newStyleManager.#cssRule.style.cssText = this.#cssRule.style.cssText;\n\n      return newStyleManager;\n   }\n\n   get()\n   {\n      const cssText = this.#cssRule.style.cssText;\n\n      const result = {};\n\n      if (cssText !== '')\n      {\n         for (const entry of cssText.split(';'))\n         {\n            if (entry !== '')\n            {\n               const values = entry.split(':');\n               result[values[0].trim()] = values[1];\n            }\n         }\n      }\n\n      return result;\n   }\n\n   /**\n    * Gets a particular CSS variable.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @returns {string} Returns CSS variable value.\n    */\n   getProperty(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      return this.#cssRule.style.getPropertyValue(key);\n   }\n\n   /**\n    * Set rules by property / value; useful for CSS variables.\n    *\n    * @param {Object<string, string>}  rules - An object with property / value string pairs to load.\n    *\n    * @param {boolean}                 [overwrite=true] - When true overwrites any existing values.\n    */\n   setProperties(rules, overwrite = true)\n   {\n      if (!isObject(rules)) { throw new TypeError(`StyleManager error: 'rules' is not an object.`); }\n\n      if (typeof overwrite !== 'boolean') { throw new TypeError(`StyleManager error: 'overwrite' is not a boolean.`); }\n\n      if (overwrite)\n      {\n         for (const [key, value] of Object.entries(rules))\n         {\n            this.#cssRule.style.setProperty(key, value);\n         }\n      }\n      else\n      {\n         // Only set property keys for entries that don't have an existing rule set.\n         for (const [key, value] of Object.entries(rules))\n         {\n            if (this.#cssRule.style.getPropertyValue(key) === '')\n            {\n               this.#cssRule.style.setProperty(key, value);\n            }\n         }\n      }\n   }\n\n   /**\n    * Sets a particular property.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @param {string}   value - CSS variable value.\n    *\n    * @param {boolean}  [overwrite=true] - Overwrite any existing value.\n    */\n   setProperty(key, value, overwrite = true)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      if (typeof value !== 'string') { throw new TypeError(`StyleManager error: 'value' is not a string.`); }\n\n      if (typeof overwrite !== 'boolean') { throw new TypeError(`StyleManager error: 'overwrite' is not a boolean.`); }\n\n      if (overwrite)\n      {\n         this.#cssRule.style.setProperty(key, value);\n      }\n      else\n      {\n         if (this.#cssRule.style.getPropertyValue(key) === '')\n         {\n            this.#cssRule.style.setProperty(key, value);\n         }\n      }\n   }\n\n   /**\n    * Removes the property keys specified. If `keys` is an iterable list then all property keys in the list are removed.\n    *\n    * @param {Iterable<string>} keys - The property keys to remove.\n    */\n   removeProperties(keys)\n   {\n      if (!isIterable(keys)) { throw new TypeError(`StyleManager error: 'keys' is not an iterable list.`); }\n\n      for (const key of keys)\n      {\n         if (typeof key === 'string') { this.#cssRule.style.removeProperty(key); }\n      }\n   }\n\n   /**\n    * Removes a particular CSS variable.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @returns {string} CSS variable value when removed.\n    */\n   removeProperty(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      return this.#cssRule.style.removeProperty(key);\n   }\n}\n\nconst s_REGEX = /(\\d+)\\s*px/;\n\n/**\n * Parses a pixel string / computed styles. Ex. `100px` returns `100`.\n *\n * @param {string}   value - Value to parse.\n *\n * @returns {number|undefined} The integer component of a pixel string.\n */\nfunction styleParsePixels(value)\n{\n   if (typeof value !== 'string') { return void 0; }\n\n   const isPixels = s_REGEX.test(value);\n   const number = parseInt(value);\n\n   return isPixels && Number.isFinite(number) ? number : void 0;\n}\n\n/**\n * Defines the application shell contract. If Svelte components export getter / setters for the following properties\n * then that component is considered an application shell.\n *\n * @type {string[]}\n */\nconst applicationShellContract = ['elementRoot'];\n\nObject.freeze(applicationShellContract);\n\n/**\n * Provides a method to determine if the passed in object / Svelte component follows the application shell contract.\n * This involves ensuring that the accessors defined in `applicationShellContract`.\n *\n * Note: A caveat is that when using Vite in a developer build components are wrapped in a proxy / ProxyComponent that\n * defines instance accessors versus on the prototype, so the check below ensures that all accessors in the contract are\n * either available on the prototype or directly on the instance.\n *\n * @param {*}  component - Object / component to test.\n *\n * @returns {boolean} Whether the component is a ApplicationShell or TJSApplicationShell.\n */\nfunction isApplicationShell(component)\n{\n   if (component === null || component === void 0) { return false; }\n\n   let compHasContract = true;\n   let protoHasContract = true;\n\n   // Check for accessors on the instance.\n   for (const accessor of applicationShellContract)\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(component, accessor);\n      if (descriptor === void 0 || descriptor.get === void 0 || descriptor.set === void 0) { compHasContract = false; }\n   }\n\n   // Get the prototype which is the parent SvelteComponent that has any getter / setters.\n   const prototype = Object.getPrototypeOf(component);\n\n   // Verify the application shell contract. If the accessors (getters / setters) are defined for\n   // `applicationShellContract`.\n   for (const accessor of applicationShellContract)\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(prototype, accessor);\n      if (descriptor === void 0 || descriptor.get === void 0 || descriptor.set === void 0) { protoHasContract = false; }\n   }\n\n   return compHasContract || protoHasContract;\n}\n\n/**\n * Provides basic duck typing to determine if the provided object is a HMR ProxyComponent instance or class.\n *\n * @param {*}  comp - Data to check as a HMR proxy component.\n *\n * @returns {boolean} Whether basic duck typing succeeds.\n */\nfunction isHMRProxy(comp)\n{\n   const instanceName = comp?.constructor?.name;\n   if (typeof instanceName === 'string' && (instanceName.startsWith('Proxy<') || instanceName === 'ProxyComponent'))\n   {\n      return true;\n   }\n\n   const prototypeName = comp?.prototype?.constructor?.name;\n   return typeof prototypeName === 'string' && (prototypeName.startsWith('Proxy<') ||\n    prototypeName === 'ProxyComponent');\n}\n\n/**\n * Provides basic duck typing to determine if the provided function is a constructor function for a Svelte component.\n *\n * @param {*}  comp - Data to check as a Svelte component.\n *\n * @returns {boolean} Whether basic duck typing succeeds.\n */\nfunction isSvelteComponent(comp)\n{\n   if (comp === null || comp === void 0 || typeof comp !== 'function') { return false; }\n\n   // When using Vite in a developer build the SvelteComponent is wrapped in a ProxyComponent class.\n   // This class doesn't define methods on the prototype, so we must check if the constructor name\n   // starts with `Proxy<` as it provides the wrapped component as `Proxy<_wrapped component name_>`.\n   const prototypeName = comp?.prototype?.constructor?.name;\n   if (typeof prototypeName === 'string' && (prototypeName.startsWith('Proxy<') || prototypeName === 'ProxyComponent'))\n   {\n      return true;\n   }\n\n   return typeof window !== void 0 ?\n    typeof comp.prototype.$destroy === 'function' && typeof comp.prototype.$on === 'function' : // client-side\n     typeof comp.render === 'function'; // server-side\n}\n\n/**\n * Runs outro transition then destroys Svelte component.\n *\n * Workaround for https://github.com/sveltejs/svelte/issues/4056\n *\n * @param {*}  instance - A Svelte component.\n */\nasync function outroAndDestroy(instance)\n{\n   return new Promise((resolve) =>\n   {\n      if (instance.$$.fragment && instance.$$.fragment.o)\n      {\n         group_outros();\n         transition_out(instance.$$.fragment, 0, 0, () =>\n         {\n            instance.$destroy();\n            resolve();\n         });\n         check_outros();\n      }\n      else\n      {\n         instance.$destroy();\n         resolve();\n      }\n   });\n}\n\n/**\n * Parses a TyphonJS Svelte config object ensuring that classes specified are Svelte components and props are set\n * correctly.\n *\n * @param {object}   config - Svelte config object.\n *\n * @param {*}        [thisArg] - `This` reference to set for invoking any props function.\n *\n * @returns {object} The processed Svelte config object.\n */\nfunction parseSvelteConfig(config, thisArg = void 0)\n{\n   if (typeof config !== 'object')\n   {\n      throw new TypeError(`parseSvelteConfig - 'config' is not an object:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (!isSvelteComponent(config.class))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'class' is not a Svelte component constructor for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.hydrate !== void 0 && typeof config.hydrate !== 'boolean')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'hydrate' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.intro !== void 0 && typeof config.intro !== 'boolean')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'intro' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.target !== void 0 && typeof config.target !== 'string' && !(config.target instanceof HTMLElement) &&\n    !(config.target instanceof ShadowRoot) && !(config.target instanceof DocumentFragment))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'target' is not a string, HTMLElement, ShadowRoot, or DocumentFragment for config:\\n${\n        JSON.stringify(config)}.`);\n   }\n\n   if (config.anchor !== void 0 && typeof config.anchor !== 'string' && !(config.anchor instanceof HTMLElement) &&\n    !(config.anchor instanceof ShadowRoot) && !(config.anchor instanceof DocumentFragment))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'anchor' is not a string, HTMLElement, ShadowRoot, or DocumentFragment for config:\\n${\n        JSON.stringify(config)}.`);\n   }\n\n   if (config.context !== void 0 && typeof config.context !== 'function' && !(config.context instanceof Map) &&\n    typeof config.context !== 'object')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'context' is not a Map, function or object for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // Validate extra TyphonJS options --------------------------------------------------------------------------------\n\n   // `selectorTarget` optionally stores a target element found in main element.\n   if (config.selectorTarget !== void 0 && typeof config.selectorTarget !== 'string')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'selectorTarget' is not a string for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // `options` stores `injectApp`, `injectEventbus`, and `selectorElement`.\n   if (config.options !== void 0 && typeof config.options !== 'object')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'options' is not an object for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // Validate TyphonJS standard options.\n   if (config.options !== void 0)\n   {\n      if (config.options.injectApp !== void 0 && typeof config.options.injectApp !== 'boolean')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'options.injectApp' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n      }\n\n      if (config.options.injectEventbus !== void 0 && typeof config.options.injectEventbus !== 'boolean')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'options.injectEventbus' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n      }\n\n      // `selectorElement` optionally stores a main element selector to be found in a HTMLElement target.\n      if (config.options.selectorElement !== void 0 && typeof config.options.selectorElement !== 'string')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'selectorElement' is not a string for config:\\n${JSON.stringify(config)}.`);\n      }\n   }\n\n   const svelteConfig = { ...config };\n\n   // Delete extra Svelte options.\n   delete svelteConfig.options;\n\n   let externalContext = {};\n\n   // If a context callback function is provided then invoke it with `this` being the Foundry app.\n   // If an object is returned it adds the entries to external context.\n   if (typeof svelteConfig.context === 'function')\n   {\n      const contextFunc = svelteConfig.context;\n      delete svelteConfig.context;\n\n      const result = contextFunc.call(thisArg);\n      if (isObject(result))\n      {\n         externalContext = { ...result };\n      }\n      else\n      {\n         throw new Error(`parseSvelteConfig - 'context' is a function that did not return an object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n   }\n   else if (svelteConfig.context instanceof Map)\n   {\n      externalContext = Object.fromEntries(svelteConfig.context);\n      delete svelteConfig.context;\n   }\n   else if (isObject(svelteConfig.context))\n   {\n      externalContext = svelteConfig.context;\n      delete svelteConfig.context;\n   }\n\n   // If a props is a function then invoke it with `this` being the Foundry app.\n   // If an object is returned set it as the props.\n   svelteConfig.props = s_PROCESS_PROPS(svelteConfig.props, thisArg, config);\n\n   // Process children components attaching to external context.\n   if (Array.isArray(svelteConfig.children))\n   {\n      const children = [];\n\n      for (let cntr = 0; cntr < svelteConfig.children.length; cntr++)\n      {\n         const child = svelteConfig.children[cntr];\n\n         if (!isSvelteComponent(child.class))\n         {\n            throw new Error(`parseSvelteConfig - 'class' is not a Svelte component for child[${cntr}] for config:\\n${\n             JSON.stringify(config)}`);\n         }\n\n         child.props = s_PROCESS_PROPS(child.props, thisArg, config);\n\n         children.push(child);\n      }\n\n      if (children.length > 0)\n      {\n         externalContext.children = children;\n      }\n\n      delete svelteConfig.children;\n   }\n   else if (isObject(svelteConfig.children))\n   {\n      if (!isSvelteComponent(svelteConfig.children.class))\n      {\n         throw new Error(`parseSvelteConfig - 'class' is not a Svelte component for children object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n\n      svelteConfig.children.props = s_PROCESS_PROPS(svelteConfig.children.props, thisArg, config);\n\n      externalContext.children = [svelteConfig.children];\n      delete svelteConfig.children;\n   }\n\n   if (!(svelteConfig.context instanceof Map))\n   {\n      svelteConfig.context = new Map();\n   }\n\n   svelteConfig.context.set('#external', externalContext);\n\n   return svelteConfig;\n}\n\n/**\n * Processes Svelte props. Potentially props can be a function to invoke with `thisArg`.\n *\n * @param {object|Function}   props - Svelte props.\n *\n * @param {*}                 thisArg - `This` reference to set for invoking any props function.\n *\n * @param {object}            config - Svelte config\n *\n * @returns {object|void}     Svelte props.\n */\nfunction s_PROCESS_PROPS(props, thisArg, config)\n{\n   // If a props is a function then invoke it with `this` being the Foundry app.\n   // If an object is returned set it as the props.\n   if (typeof props === 'function')\n   {\n      const result = props.call(thisArg);\n      if (isObject(result))\n      {\n         return result;\n      }\n      else\n      {\n         throw new Error(`parseSvelteConfig - 'props' is a function that did not return an object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n   }\n   else if (isObject(props))\n   {\n      return props;\n   }\n   else if (props !== void 0)\n   {\n      throw new Error(\n       `parseSvelteConfig - 'props' is not a function or an object for config:\\n${JSON.stringify(config)}`);\n   }\n\n   return {};\n}\n\n/**\n * Wraps a callback in a debounced timeout.\n *\n * Delay execution of the callback function until the function has not been called for the given delay in milliseconds.\n *\n * @param {Function} callback - A function to execute once the debounced threshold has been passed.\n *\n * @param {number}   delay - An amount of time in milliseconds to delay.\n *\n * @returns {Function} A wrapped function that can be called to debounce execution.\n */\nfunction debounce(callback, delay)\n{\n   let timeoutId;\n\n   return function(...args)\n   {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(() => { callback.apply(this, args); }, delay);\n   };\n}\n\n/**\n * Provides a method to determine if the passed in Svelte component has a getter accessor.\n *\n * @param {*}        object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the getter for accessor.\n */\nfunction hasGetter(object, accessor)\n{\n   if (object === null || object === void 0) { return false; }\n\n   // Check for instance accessor.\n   const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n   if (iDescriptor !== void 0 && iDescriptor.get !== void 0) { return true; }\n\n   // Walk parent prototype chain. Check for descriptor at each prototype level.\n   for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o))\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n      if (descriptor !== void 0 && descriptor.get !== void 0) { return true; }\n   }\n\n   return false;\n}\n\n/**\n * Provides a method to determine if the passed in Svelte component has a getter & setter accessor.\n *\n * @param {*}        object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the getter and setter for accessor.\n */\nfunction hasAccessor(object, accessor)\n{\n   if (object === null || object === void 0) { return false; }\n\n   // Check for instance accessor.\n   const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n   if (iDescriptor !== void 0 && iDescriptor.get !== void 0 && iDescriptor.set !== void 0) { return true; }\n\n   // Walk parent prototype chain. Check for descriptor at each prototype level.\n   for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o))\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n      if (descriptor !== void 0 && descriptor.get !== void 0 && descriptor.set !== void 0) { return true; }\n   }\n\n   return false;\n}\n\n/**\n * Provides a method to determine if the passed in Svelte component has a setter accessor.\n *\n * @param {*}        object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the setter for accessor.\n */\nfunction hasSetter(object, accessor)\n{\n   if (object === null || object === void 0) { return false; }\n\n   // Check for instance accessor.\n   const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n   if (iDescriptor !== void 0 && iDescriptor.set !== void 0) { return true; }\n\n   // Walk parent prototype chain. Check for descriptor at each prototype level.\n   for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o))\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n      if (descriptor !== void 0 && descriptor.set !== void 0) { return true; }\n   }\n\n   return false;\n}\n\n/**\n * Returns whether the target is or has the given prototype walking up the prototype chain.\n *\n * @param {*}  target - Any target to test.\n *\n * @param {Function} Prototype - Prototype function / class constructor to find.\n *\n * @returns {boolean} Target matches prototype.\n */\nfunction hasPrototype(target, Prototype)\n{\n   /* c8 ignore next */\n   if (typeof target !== 'function') { return false; }\n\n   if (target === Prototype) { return true; }\n\n   // Walk parent prototype chain. Check for descriptor at each prototype level.\n   for (let proto = Object.getPrototypeOf(target); proto; proto = Object.getPrototypeOf(proto))\n   {\n      if (proto === Prototype) { return true; }\n   }\n\n   return false;\n}\n\nfunction set(obj, key, val) {\n\tif (typeof val.value === 'object') val.value = klona(val.value);\n\tif (!val.enumerable || val.get || val.set || !val.configurable || !val.writable || key === '__proto__') {\n\t\tObject.defineProperty(obj, key, val);\n\t} else obj[key] = val.value;\n}\n\nfunction klona(x) {\n\tif (typeof x !== 'object') return x;\n\n\tvar i=0, k, list, tmp, str=Object.prototype.toString.call(x);\n\n\tif (str === '[object Object]') {\n\t\ttmp = Object.create(x.__proto__ || null);\n\t} else if (str === '[object Array]') {\n\t\ttmp = Array(x.length);\n\t} else if (str === '[object Set]') {\n\t\ttmp = new Set;\n\t\tx.forEach(function (val) {\n\t\t\ttmp.add(klona(val));\n\t\t});\n\t} else if (str === '[object Map]') {\n\t\ttmp = new Map;\n\t\tx.forEach(function (val, key) {\n\t\t\ttmp.set(klona(key), klona(val));\n\t\t});\n\t} else if (str === '[object Date]') {\n\t\ttmp = new Date(+x);\n\t} else if (str === '[object RegExp]') {\n\t\ttmp = new RegExp(x.source, x.flags);\n\t} else if (str === '[object DataView]') {\n\t\ttmp = new x.constructor( klona(x.buffer) );\n\t} else if (str === '[object ArrayBuffer]') {\n\t\ttmp = x.slice(0);\n\t} else if (str.slice(-6) === 'Array]') {\n\t\t// ArrayBuffer.isView(x)\n\t\t// ~> `new` bcuz `Buffer.slice` => ref\n\t\ttmp = new x.constructor(x);\n\t}\n\n\tif (tmp) {\n\t\tfor (list=Object.getOwnPropertySymbols(x); i < list.length; i++) {\n\t\t\tset(tmp, list[i], Object.getOwnPropertyDescriptor(x, list[i]));\n\t\t}\n\n\t\tfor (i=0, list=Object.getOwnPropertyNames(x); i < list.length; i++) {\n\t\t\tif (Object.hasOwnProperty.call(tmp, k=list[i]) && tmp[k] === x[k]) continue;\n\t\t\tset(tmp, k, Object.getOwnPropertyDescriptor(x, k));\n\t\t}\n\t}\n\n\treturn tmp || x;\n}\n\nfunction isSpace(character) {\n    return character == \" \" || character == \"\\n\" || character == \"\\r\" || character == \"\\t\";\n}\nfunction isQuote(character) {\n    return character == '\"' || character == \"'\";\n}\nconst TAG_START = \"<\";\nconst TAG_END = \">\";\nconst ENCODED_TAG_START = \"&lt;\";\nconst ENCODED_TAG_END = \"&gt;\";\nclass InPlaintextState {\n    constructor(options) {\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == TAG_START) {\n            transition(new InTagNameState(this.options));\n            return \"\";\n        }\n        else if (character == TAG_END && this.options.encodePlaintextTagDelimiters) {\n            return ENCODED_TAG_END;\n        }\n        return character;\n    }\n}\nclass InTagNameState {\n    constructor(options) {\n        this.options = options;\n        this.nameBuffer = \"\";\n        this.isClosingTag = false;\n    }\n    consume(character, transition) {\n        if (this.nameBuffer.length == 0) {\n            if (isSpace(character)) {\n                transition(new InPlaintextState(this.options));\n                return ((this.options.encodePlaintextTagDelimiters ? ENCODED_TAG_START : \"<\") +\n                    character);\n            }\n            if (character == \"/\") {\n                this.isClosingTag = true;\n                return \"\";\n            }\n        }\n        if (isSpace(character)) {\n            if (this.isNameBufferAnAllowedTag()) {\n                transition(new InTagState(0 /* TagMode.Allowed */, this.options));\n                return TAG_START + (this.isClosingTag ? \"/\" : \"\") + this.nameBuffer + character;\n            }\n            else {\n                transition(new InTagState(1 /* TagMode.Disallowed */, this.options));\n                return this.options.tagReplacementText;\n            }\n        }\n        if (character == TAG_START) {\n            this.nameBuffer += ENCODED_TAG_START;\n            return \"\";\n        }\n        if (character == TAG_END) {\n            transition(new InPlaintextState(this.options));\n            if (this.isNameBufferAnAllowedTag()) {\n                return TAG_START + (this.isClosingTag ? \"/\" : \"\") + this.nameBuffer + character;\n            }\n            else {\n                return this.options.tagReplacementText;\n            }\n        }\n        if (character == \"-\" && this.nameBuffer == \"!-\") {\n            transition(new InCommentState(this.options));\n            return \"\";\n        }\n        this.nameBuffer += character;\n        return \"\";\n    }\n    isNameBufferAnAllowedTag() {\n        const tagName = this.nameBuffer.toLowerCase();\n        if (this.options.allowedTags) {\n            return this.options.allowedTags.has(tagName);\n        }\n        else if (this.options.disallowedTags) {\n            return !this.options.disallowedTags.has(tagName);\n        }\n        else {\n            return false;\n        }\n    }\n}\nclass InTagState {\n    constructor(mode, options) {\n        this.mode = mode;\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == TAG_END) {\n            transition(new InPlaintextState(this.options));\n        }\n        else if (isQuote(character)) {\n            transition(new InQuotedStringInTagState(this.mode, character, this.options));\n        }\n        if (this.mode == 1 /* TagMode.Disallowed */) {\n            return \"\";\n        }\n        if (character == TAG_START) {\n            return ENCODED_TAG_START;\n        }\n        else {\n            return character;\n        }\n    }\n}\nclass InQuotedStringInTagState {\n    constructor(mode, quoteCharacter, options) {\n        this.mode = mode;\n        this.quoteCharacter = quoteCharacter;\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == this.quoteCharacter) {\n            transition(new InTagState(this.mode, this.options));\n        }\n        if (this.mode == 1 /* TagMode.Disallowed */) {\n            return \"\";\n        }\n        if (character == TAG_START) {\n            return ENCODED_TAG_START;\n        }\n        else if (character == TAG_END) {\n            return ENCODED_TAG_END;\n        }\n        else {\n            return character;\n        }\n    }\n}\nclass InCommentState {\n    constructor(options) {\n        this.options = options;\n        this.consecutiveHyphens = 0;\n    }\n    consume(character, transition) {\n        if (character == \">\" && this.consecutiveHyphens >= 2) {\n            transition(new InPlaintextState(this.options));\n        }\n        else if (character == \"-\") {\n            this.consecutiveHyphens++;\n        }\n        else {\n            this.consecutiveHyphens = 0;\n        }\n        return \"\";\n    }\n}\n\nconst DefaultStateMachineOptions = {\n    tagReplacementText: \"\",\n    encodePlaintextTagDelimiters: true,\n};\nclass StateMachine {\n    constructor(partialOptions = {}) {\n        this.state = new InPlaintextState(Object.assign(Object.assign({}, DefaultStateMachineOptions), partialOptions));\n        this.transitionFunction = ((next) => {\n            this.state = next;\n        }).bind(this);\n    }\n    consume(text) {\n        let outputBuffer = \"\";\n        for (const character of text) {\n            outputBuffer += this.state.consume(character, this.transitionFunction);\n        }\n        return outputBuffer;\n    }\n}\nfunction striptags(text, options = {}) {\n    return new StateMachine(options).consume(text);\n}\n\n/**\n * Attempts to create a Foundry UUID from standard drop data. This may not work for all systems.\n *\n * @param {object}   data - Drop transfer data.\n *\n * @param {ParseDataTransferOptions}   opts - Optional parameters.\n *\n * @returns {string|undefined} Foundry UUID for drop data.\n */\nfunction getUUIDFromDataTransfer(data, { actor = true, compendium = true, world = true, types = void 0 } = {})\n{\n   if (typeof data !== 'object') { return void 0; }\n   if (Array.isArray(types) && !types.includes(data.type)) { return void 0; }\n\n   let uuid = void 0;\n\n   if (typeof data.uuid === 'string') // v10 and above provides a full UUID.\n   {\n      const isCompendium = data.uuid.startsWith('Compendium');\n\n      if (isCompendium && compendium)\n      {\n         uuid = data.uuid;\n      }\n      else if (world)\n      {\n         uuid = data.uuid;\n      }\n   }\n   else // v9 and below parsing.\n   {\n      if (actor && world && data.actorId && data.type)\n      {\n         uuid = `Actor.${data.actorId}.${data.type}.${data.data._id}`;\n      }\n      else if (typeof data.id === 'string') // v9 and below uses `id`\n      {\n         if (compendium && typeof data.pack === 'string')\n         {\n            uuid = `Compendium.${data.pack}.${data.id}`;\n         }\n         else if (world)\n         {\n            uuid = `${data.type}.${data.id}`;\n         }\n      }\n   }\n\n   return uuid;\n}\n\nexport { A11yHelper, ClipboardAccess, ManagedPromise, StyleManager, debounce, deepMerge, getStackingContext, getUUIDFromDataTransfer, hasAccessor, hasGetter, hasPrototype, hasSetter, hashCode, isApplicationShell, isHMRProxy, isIterable, isIterableAsync, isObject, isPlainObject, isSvelteComponent, klona, normalizeString, outroAndDestroy, parseSvelteConfig, safeAccess, safeSet, striptags, styleParsePixels, uuidv4 };\n//# sourceMappingURL=index.js.map\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0 && stop) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let started = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (started) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        started = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n            // We need to set this to false because callbacks can still happen despite having unsubscribed:\n            // Callbacks might already be placed in the queue which doesn't know it should no longer\n            // invoke this derived store.\n            started = false;\n        };\n    });\n}\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * @param store - store to make readonly\n */\nfunction readonly(store) {\n    return {\n        subscribe: store.subscribe.bind(store)\n    };\n}\n\nexport { derived, readable, readonly, writable };\n","import { isIterable, uuidv4, isPlainObject, getUUIDFromDataTransfer, isObject, hasPrototype } from '@typhonjs-fvtt/runtime/svelte/util';\nimport { writable as writable$2, derived, get } from 'svelte/store';\nimport { noop, run_all, is_function } from 'svelte/internal';\n\nclass DynReducerUtils {\n    /**\n     * Checks for array equality between two arrays of numbers.\n     *\n     * @param a - Array A\n     *\n     * @param b - Array B\n     *\n     * @returns Arrays are equal.\n     */\n    static arrayEquals(a, b) {\n        if (a === b) {\n            return true;\n        }\n        if (a === null || b === null) {\n            return false;\n        }\n        /* c8 ignore next */\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (let cntr = a.length; --cntr >= 0;) {\n            /* c8 ignore next */\n            if (a[cntr] !== b[cntr]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Provides a solid string hashing algorithm.\n     *\n     * Sourced from: https://stackoverflow.com/a/52171480\n     *\n     * @param str - String to hash.\n     *\n     * @param seed - A seed value altering the hash.\n     *\n     * @returns Hash code.\n     */\n    static hashString(str, seed = 0) {\n        let h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n        for (let ch, i = 0; i < str.length; i++) {\n            ch = str.charCodeAt(i);\n            h1 = Math.imul(h1 ^ ch, 2654435761);\n            h2 = Math.imul(h2 ^ ch, 1597334677);\n        }\n        h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\n        h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\n        return 4294967296 * (2097151 & h2) + (h1 >>> 0);\n    }\n    /**\n     * Converts an unknown value for hashing purposes in {@link AdapterIndexer.calcHashUpdate}.\n     *\n     * Currently objects / Map w/ object keys is not supported. Potentially can include `object-hash` to handle this\n     * case, but it is not common to use objects as keys in Maps.\n     *\n     * @param value - An unknown value to convert to a number.\n     */\n    static hashUnknown(value) {\n        if (value === null || value === void 0) {\n            return 0;\n        }\n        let result = 0;\n        switch (typeof value) {\n            case 'boolean':\n                result = value ? 1 : 0;\n                break;\n            case 'bigint':\n                result = Number(BigInt.asIntN(64, value));\n                break;\n            case 'function':\n                result = this.hashString(value.name);\n                break;\n            case 'number':\n                result = Number.isFinite(value) ? value : 0;\n                break;\n            case 'object':\n                // TODO: consider hashing an object IE `object-hash` and convert to number.\n                break;\n            case 'string':\n                result = this.hashString(value);\n                break;\n            case 'symbol':\n                result = this.hashString(Symbol.keyFor(value));\n                break;\n        }\n        return result;\n    }\n    /**\n     * @param target -\n     *\n     * @param Prototype -\n     *\n     * @returns target constructor function has Prototype.\n     */\n    static hasPrototype(target, Prototype) {\n        /* c8 ignore next */\n        if (typeof target !== 'function') {\n            return false;\n        }\n        if (target === Prototype) {\n            return true;\n        }\n        // Walk parent prototype chain. Check for descriptor at each prototype level.\n        for (let proto = Object.getPrototypeOf(target); proto; proto = Object.getPrototypeOf(proto)) {\n            if (proto === Prototype) {\n                return true;\n            }\n        }\n        return false;\n    }\n    /**\n     * Provides a utility method to determine if the given data is iterable / implements iterator protocol.\n     *\n     * @param data - Data to verify as iterable.\n     *\n     * @returns Is data iterable.\n     */\n    static isIterable(data) {\n        return data !== null && data !== void 0 && typeof data === 'object' &&\n            typeof data[Symbol.iterator] === 'function';\n    }\n}\n\n/**\n * Provides the `derived` API for all dynamic reducers.\n */\nclass AdapterDerived {\n    #hostData;\n    #DerivedReducerCtor;\n    #parentIndex;\n    #derived = new Map();\n    #destroyed = false;\n    /**\n     * @param hostData - Hosted data structure.\n     *\n     * @param parentIndex - Any associated parent index API.\n     *\n     * @param DerivedReducerCtor - The default derived reducer constructor function.\n     */\n    constructor(hostData, parentIndex, DerivedReducerCtor) {\n        this.#hostData = hostData;\n        this.#parentIndex = parentIndex;\n        this.#DerivedReducerCtor = DerivedReducerCtor;\n        Object.freeze(this);\n    }\n    /**\n     * Creates a new derived reducer.\n     *\n     * @param options - Options defining the new derived reducer.\n     *\n     * @returns Newly created derived reducer.\n     */\n    create(options) {\n        if (this.#destroyed) {\n            throw Error(`AdapterDerived.create error: this instance has been destroyed.`);\n        }\n        let name;\n        let rest = {};\n        let ctor;\n        const DerivedReducerCtor = this.#DerivedReducerCtor;\n        if (typeof options === 'string') {\n            name = options;\n            ctor = DerivedReducerCtor;\n        }\n        else if (typeof options === 'function' && DynReducerUtils.hasPrototype(options, DerivedReducerCtor)) {\n            ctor = options;\n        }\n        else if (typeof options === 'object' && options !== null) {\n            ({ name, ctor = DerivedReducerCtor, ...rest } = options);\n        }\n        else {\n            throw new TypeError(`AdapterDerived.create error: 'options' does not conform to allowed parameters.`);\n        }\n        if (!DynReducerUtils.hasPrototype(ctor, DerivedReducerCtor)) {\n            throw new TypeError(`AdapterDerived.create error: 'ctor' is not a '${DerivedReducerCtor?.name}'.`);\n        }\n        name = name ?? ctor?.name;\n        if (typeof name !== 'string') {\n            throw new TypeError(`AdapterDerived.create error: 'name' is not a string.`);\n        }\n        const derivedReducer = new ctor(this.#hostData, this.#parentIndex, rest);\n        this.#derived.set(name, derivedReducer);\n        return derivedReducer;\n    }\n    /**\n     * Removes all derived reducers and associated subscriptions.\n     */\n    clear() {\n        if (this.#destroyed) {\n            return;\n        }\n        for (const reducer of this.#derived.values()) {\n            reducer.destroy();\n        }\n        this.#derived.clear();\n    }\n    /**\n     * Deletes and destroys a derived reducer by name.\n     *\n     * @param name - Name of the derived reducer.\n     */\n    delete(name) {\n        if (this.#destroyed) {\n            throw Error(`AdapterDerived.delete error: this instance has been destroyed.`);\n        }\n        const reducer = this.#derived.get(name);\n        if (reducer) {\n            reducer.destroy();\n        }\n        return this.#derived.delete(name);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) {\n            return;\n        }\n        this.clear();\n        this.#hostData = [null];\n        this.#parentIndex = null;\n        this.#destroyed = true;\n    }\n    /**\n     * Returns an existing derived reducer.\n     *\n     * @param name - Name of derived reducer.\n     */\n    get(name) {\n        if (this.#destroyed) {\n            throw Error(`AdapterDerived.get error: this instance has been destroyed.`);\n        }\n        return this.#derived.get(name);\n    }\n    /**\n     * Updates all managed derived reducer indexes.\n     *\n     * @param [force] - Force an update to subscribers.\n     */\n    update(force = false) {\n        if (this.#destroyed) {\n            return;\n        }\n        for (const reducer of this.#derived.values()) {\n            reducer.index.update(force);\n        }\n    }\n}\n\n/**\n * Provides the storage and sequencing of managed filters. Each filter added may be a bespoke function or a\n * {@link DataFilter} object containing an `id`, `filter`, and `weight` attributes; `filter` is the only required\n * attribute.\n *\n * The `id` attribute can be anything that creates a unique ID for the filter; recommended strings or numbers. This\n * allows filters to be removed by ID easily.\n *\n * The `weight` attribute is a number between 0 and 1 inclusive that allows filters to be added in a\n * predictable order which is especially handy if they are manipulated at runtime. A lower weighted filter always runs\n * before a higher weighted filter. For speed and efficiency always set the heavier / more inclusive filter with a\n * lower weight; an example of this is a keyword / name that will filter out many entries making any further filtering\n * faster. If no weight is specified the default of '1' is assigned and it is appended to the end of the filters list.\n *\n * This class forms the public API which is accessible from the `.filters` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.filters.add(...);\n * dynArray.filters.clear();\n * dynArray.filters.length;\n * dynArray.filters.remove(...);\n * dynArray.filters.removeBy(...);\n * dynArray.filters.removeById(...);\n * ```\n */\nclass AdapterFilters {\n    #filtersData;\n    #indexUpdate;\n    #mapUnsubscribe = new Map();\n    /**\n     * @param indexUpdate - update function for the indexer.\n     *\n     * @param filtersAdapter - Stores the filter function data.\n     */\n    constructor(indexUpdate, filtersAdapter) {\n        this.#indexUpdate = indexUpdate;\n        this.#filtersData = filtersAdapter;\n        Object.freeze(this);\n    }\n    /**\n     * @returns Returns the length of the filter data.\n     */\n    get length() { return this.#filtersData.filters.length; }\n    /**\n     * Provides an iterator for filters.\n     *\n     * @returns Generator / iterator of filters.\n     * @yields {DataFilter<T>}\n     */\n    *[Symbol.iterator]() {\n        if (this.#filtersData.filters.length === 0) {\n            return;\n        }\n        for (const entry of this.#filtersData.filters) {\n            yield { ...entry };\n        }\n    }\n    /**\n     * @param filters -\n     */\n    add(...filters) {\n        /**\n         * Tracks the number of filters added that have subscriber functionality.\n         */\n        let subscribeCount = 0;\n        for (const filter of filters) {\n            const filterType = typeof filter;\n            if (filterType !== 'function' && (filterType !== 'object' || filter === null)) {\n                throw new TypeError(`AdapterFilters error: 'filter' is not a function or object.`);\n            }\n            let data = void 0;\n            let subscribeFn = void 0;\n            if (filterType === 'function') {\n                data = {\n                    id: void 0,\n                    filter,\n                    weight: 1\n                };\n                subscribeFn = filter.subscribe;\n            }\n            else if (filterType === 'object') {\n                if ('filter' in filter) {\n                    if (typeof filter.filter !== 'function') {\n                        throw new TypeError(`AdapterFilters error: 'filter' attribute is not a function.`);\n                    }\n                    if (filter.weight !== void 0 && typeof filter.weight !== 'number' ||\n                        (filter.weight < 0 || filter.weight > 1)) {\n                        throw new TypeError(`AdapterFilters error: 'weight' attribute is not a number between '0 - 1' inclusive.`);\n                    }\n                    data = {\n                        id: filter.id !== void 0 ? filter.id : void 0,\n                        filter: filter.filter,\n                        weight: filter.weight || 1\n                    };\n                    subscribeFn = filter.filter.subscribe ?? filter.subscribe;\n                }\n                else {\n                    throw new TypeError(`AdapterFilters error: 'filter' attribute is not a function.`);\n                }\n            }\n            // Find the index to insert where data.weight is less than existing values weight.\n            const index = this.#filtersData.filters.findIndex((value) => {\n                return data.weight < value.weight;\n            });\n            // If an index was found insert at that location.\n            if (index >= 0) {\n                this.#filtersData.filters.splice(index, 0, data);\n            }\n            else // push to end of filters.\n             {\n                this.#filtersData.filters.push(data);\n            }\n            if (typeof subscribeFn === 'function') {\n                const unsubscribe = subscribeFn(this.#indexUpdate);\n                // Ensure that unsubscribe is a function.\n                if (typeof unsubscribe !== 'function') {\n                    throw new TypeError('AdapterFilters error: Filter has subscribe function, but no unsubscribe function is returned.');\n                }\n                // Ensure that the same filter is not subscribed to multiple times.\n                if (this.#mapUnsubscribe.has(data.filter)) {\n                    throw new Error('AdapterFilters error: Filter added already has an unsubscribe function registered.');\n                }\n                this.#mapUnsubscribe.set(data.filter, unsubscribe);\n                subscribeCount++;\n            }\n        }\n        // Filters with subscriber functionality are assumed to immediately invoke the `subscribe` callback. If the\n        // subscriber count is less than the amount of filters added then automatically trigger an index update manually.\n        if (subscribeCount < filters.length) {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * Clears and removes all filters.\n     */\n    clear() {\n        this.#filtersData.filters.length = 0;\n        // Unsubscribe from all filters with subscription support.\n        for (const unsubscribe of this.#mapUnsubscribe.values()) {\n            unsubscribe();\n        }\n        this.#mapUnsubscribe.clear();\n        this.#indexUpdate();\n    }\n    /**\n     * @param filters -\n     */\n    remove(...filters) {\n        const length = this.#filtersData.filters.length;\n        if (length === 0) {\n            return;\n        }\n        for (const data of filters) {\n            // Handle the case that the filter may either be a function or a filter entry / object.\n            const actualFilter = typeof data === 'function' ? data : data !== null && typeof data === 'object' ?\n                data.filter : void 0;\n            if (!actualFilter) {\n                continue;\n            }\n            for (let cntr = this.#filtersData.filters.length; --cntr >= 0;) {\n                if (this.#filtersData.filters[cntr].filter === actualFilter) {\n                    this.#filtersData.filters.splice(cntr, 1);\n                    // Invoke any unsubscribe function for given filter then remove from tracking.\n                    let unsubscribe = void 0;\n                    if (typeof (unsubscribe = this.#mapUnsubscribe.get(actualFilter)) === 'function') {\n                        unsubscribe();\n                        this.#mapUnsubscribe.delete(actualFilter);\n                    }\n                }\n            }\n        }\n        // Update the index a filter was removed.\n        if (length !== this.#filtersData.filters.length) {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * Remove filters by the provided callback. The callback takes 3 parameters: `id`, `filter`, and `weight`.\n     * Any truthy value returned will remove that filter.\n     *\n     * @param callback - Callback function to evaluate each filter entry.\n     */\n    removeBy(callback) {\n        const length = this.#filtersData.filters.length;\n        if (length === 0) {\n            return;\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError(`AdapterFilters error: 'callback' is not a function.`);\n        }\n        this.#filtersData.filters = this.#filtersData.filters.filter((data) => {\n            const remove = callback.call(callback, { ...data });\n            if (remove) {\n                let unsubscribe;\n                if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.filter)) === 'function') {\n                    unsubscribe();\n                    this.#mapUnsubscribe.delete(data.filter);\n                }\n            }\n            // Reverse remove boolean to properly filter / remove this filter.\n            return !remove;\n        });\n        if (length !== this.#filtersData.filters.length) {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * @param ids - Removes filters by ID.\n     */\n    removeById(...ids) {\n        const length = this.#filtersData.filters.length;\n        if (length === 0) {\n            return;\n        }\n        this.#filtersData.filters = this.#filtersData.filters.filter((data) => {\n            let remove = 0;\n            for (const id of ids) {\n                remove |= (data.id === id ? 1 : 0);\n            }\n            // If not keeping invoke any unsubscribe function for given filter then remove from tracking.\n            if (!!remove) {\n                let unsubscribe;\n                if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.filter)) === 'function') {\n                    unsubscribe();\n                    this.#mapUnsubscribe.delete(data.filter);\n                }\n            }\n            return !remove; // Swap here to actually remove the item via array filter method.\n        });\n        if (length !== this.#filtersData.filters.length) {\n            this.#indexUpdate();\n        }\n    }\n}\n\n/**\n * Provides construction and management of indexed data when there are parent indexes or filter / sort functions\n * applied.\n */\nclass AdapterIndexer {\n    derivedAdapter;\n    filtersData;\n    hostData;\n    hostUpdate;\n    indexData;\n    sortData;\n    sortFn;\n    destroyed = false;\n    /**\n     * @param hostData - Hosted data structure.\n     *\n     * @param hostUpdate - Host update function invoked on index updates.\n     *\n     * @param [parentIndexer] - Any associated parent index API.\n     *\n     * @returns Indexer adapter instance.\n     */\n    constructor(hostData, hostUpdate, parentIndexer) {\n        this.hostData = hostData;\n        this.hostUpdate = hostUpdate;\n        this.indexData = { index: null, hash: null, reversed: false, parent: parentIndexer };\n    }\n    /**\n     * @returns Returns whether the index is active.\n     */\n    get active() {\n        return this.filtersData.filters.length > 0 || this.sortData.compareFn !== null ||\n            this.indexData.parent?.active === true;\n    }\n    /**\n     * @returns Returns length of reduced index.\n     */\n    get length() {\n        return this.indexData.index ? this.indexData.index.length : 0;\n    }\n    /* c8 ignore start */\n    /**\n     * @returns Returns reversed state.\n     */\n    get reversed() { return this.indexData.reversed; }\n    /* c8 ignore end */\n    /**\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) { this.indexData.reversed = reversed; }\n    // -------------------------------------------------------------------------------------------------------------------\n    /**\n     * Calculates a new hash value for the new index array if any. If the new index array is null then the hash value\n     * is set to null. Set calculated new hash value to the index adapter hash value.\n     *\n     * After hash generation compare old and new hash values and perform an update if they are different. If they are\n     * equal check for array equality between the old and new index array and perform an update if they are not equal.\n     *\n     * @param oldIndex - Old index array.\n     *\n     * @param oldHash - Old index hash value.\n     *\n     * @param [force=false] - When true forces an update to subscribers.\n     */\n    calcHashUpdate(oldIndex, oldHash, force = false) {\n        // Use force if a boolean otherwise default to false.\n        const actualForce = typeof force === 'boolean' ? force : /* c8 ignore next */ false;\n        let newHash = null;\n        const newIndex = this.indexData.index;\n        if (newIndex) {\n            for (let cntr = newIndex.length; --cntr >= 0;) {\n                newHash ^= DynReducerUtils.hashUnknown(newIndex[cntr]) + 0x9e3779b9 + (newHash << 6) + (newHash >> 2);\n            }\n        }\n        this.indexData.hash = newHash;\n        if (actualForce || (oldHash === newHash ? !DynReducerUtils.arrayEquals(oldIndex, newIndex) : true)) {\n            this.hostUpdate();\n        }\n    }\n    /**\n     * Destroys all resources.\n     */\n    destroy() {\n        if (this.destroyed) {\n            return;\n        }\n        this.indexData.index = null;\n        this.indexData.hash = null;\n        this.indexData.reversed = null;\n        this.indexData.parent = null;\n        this.destroyed = true;\n    }\n    /**\n     * Store associated filter and sort data that are constructed after the indexer.\n     *\n     * @param filtersData - Associated AdapterFilters instance.\n     *\n     * @param sortData - Associated AdapterSort instance.\n     *\n     * @param derivedAdapter - Associated AdapterDerived instance.\n     */\n    initAdapters(filtersData, sortData, derivedAdapter) {\n        this.filtersData = filtersData;\n        this.sortData = sortData;\n        this.derivedAdapter = derivedAdapter;\n        this.sortFn = this.createSortFn();\n    }\n}\n\n/**\n * Provides the storage and sequencing of a managed sort function. The sort function set may be a bespoke function or a\n * {@link DataSort} object containing an `compare`, and `subscribe` attributes; `compare` is the only required\n * attribute.\n *\n * Note: You can set a compare function that also has a subscribe function attached as the `subscribe` attribute.\n * If a subscribe function is provided the sort function can notify any updates that may change sort order and this\n * triggers an index update.\n *\n * This class forms the public API which is accessible from the `.sort` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.sort.clear();\n * dynArray.sort.set(...);\n * ```\n */\nclass AdapterSort {\n    #sortData;\n    #indexUpdate;\n    #unsubscribe;\n    /**\n     * @param indexUpdate - Function to update indexer.\n     *\n     * @param sortData - Storage for compare function.\n     */\n    constructor(indexUpdate, sortData) {\n        this.#indexUpdate = indexUpdate;\n        this.#sortData = sortData;\n        Object.freeze(this);\n    }\n    /**\n     * Clears & removes any assigned sort function and triggers an index update.\n     */\n    clear() {\n        const oldCompareFn = this.#sortData.compareFn;\n        this.#sortData.compareFn = null;\n        if (typeof this.#unsubscribe === 'function') {\n            this.#unsubscribe();\n            this.#unsubscribe = void 0;\n        }\n        // Only update index if an old compare function is set.\n        if (typeof oldCompareFn === 'function') {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * @param data - A callback function that compares two values. Return > 0 to sort b before a;\n     * < 0 to sort a before b; or 0 to keep original order of a & b.\n     *\n     * Note: You can set a compare function that also has a subscribe function attached as the `subscribe` attribute.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#parameters\n     */\n    set(data) {\n        if (typeof this.#unsubscribe === 'function') {\n            this.#unsubscribe();\n            this.#unsubscribe = void 0;\n        }\n        let compareFn = void 0;\n        let subscribeFn = void 0;\n        switch (typeof data) {\n            case 'function':\n                compareFn = data;\n                subscribeFn = data.subscribe;\n                break;\n            case 'object':\n                // Early out if data is null / noop.\n                if (data === null) {\n                    break;\n                }\n                if (typeof data.compare !== 'function') {\n                    throw new TypeError(`AdapterSort error: 'compare' attribute is not a function.`);\n                }\n                compareFn = data.compare;\n                subscribeFn = data.compare.subscribe ?? data.subscribe;\n                break;\n        }\n        if (typeof compareFn === 'function') {\n            this.#sortData.compareFn = compareFn;\n        }\n        else {\n            const oldCompareFn = this.#sortData.compareFn;\n            this.#sortData.compareFn = null;\n            // Update index if the old compare function exists.\n            if (typeof oldCompareFn === 'function') {\n                this.#indexUpdate();\n            }\n            return;\n        }\n        if (typeof subscribeFn === 'function') {\n            this.#unsubscribe = subscribeFn(this.#indexUpdate);\n            // Ensure that unsubscribe is a function.\n            if (typeof this.#unsubscribe !== 'function') {\n                throw new Error(`AdapterSort error: sort has 'subscribe' function, but no 'unsubscribe' function is returned.`);\n            }\n        }\n        else {\n            // A sort function with subscriber functionality are assumed to immediately invoke the `subscribe` callback.\n            // Only manually update the index if there is no subscriber functionality.\n            this.#indexUpdate();\n        }\n    }\n}\n\n/**\n * Provides the public API for accessing the index API.\n *\n * This class forms the public API which is accessible from the `.index` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.index.active;\n * dynArray.index.hash;\n * dynArray.index.length;\n * dynArray.index.update(...);\n * ```\n */\nclass IndexerAPI {\n    #indexData;\n    /**\n     * Provides a getter to determine if the index is active.\n     */\n    active;\n    /**\n     * Provides length of reduced / indexed elements.\n     */\n    length;\n    /**\n     * Manually invoke an update of the index.\n     *\n     * @param force - Force update to any subscribers.\n     */\n    update;\n    constructor(adapterIndexer) {\n        this.#indexData = adapterIndexer.indexData;\n        this.update = adapterIndexer.update.bind(adapterIndexer);\n        // Defines getters on the public API to get the index hash, active state, and index length.\n        Object.defineProperties(this, {\n            active: { get: () => adapterIndexer.active },\n            length: { get: () => adapterIndexer.length }\n        });\n        Object.freeze(this);\n    }\n    /**\n     * - Current hash value of the index.\n     */\n    get hash() {\n        return this.#indexData.hash;\n    }\n    /**\n     * Provides an iterator over the index array.\n     *\n     * @returns Iterator / generator\n     * @yields {K}\n     */\n    *[Symbol.iterator]() {\n        const indexData = this.#indexData;\n        if (!indexData.index) {\n            return;\n        }\n        const reversed = indexData.reversed;\n        const length = indexData.index.length;\n        if (reversed) {\n            for (let cntr = length; --cntr >= 0;) {\n                yield indexData.index[cntr];\n            }\n        }\n        else {\n            for (let cntr = 0; cntr < length; cntr++) {\n                yield indexData.index[cntr];\n            }\n        }\n    }\n}\n\n/**\n * Provides the public API for derived reducers. There are several ways to create a derived reducer from utilizing the\n * default implementation or passing in a constructor function / class for a custom derived reducer.\n *\n * This class forms the public API which is accessible from the `.derived` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.derived.clear();\n * dynArray.derived.create(...);\n * dynArray.derived.delete(...);\n * dynArray.derived.destroy();\n * dynArray.derived.get(...);\n * ```\n */\nclass DerivedAPI {\n    /**\n     * Removes all derived reducers and associated subscriptions.\n     */\n    clear;\n    /**\n     * @param options - Options for creating a reducer.\n     *\n     * @returns Newly created derived reducer.\n     */\n    create;\n    /**\n     * Deletes and destroys a derived reducer.\n     *\n     * @param name - Name of the derived reducer\n     */\n    delete;\n    /**\n     * Removes all derived reducers, associated subscriptions, and cleans up all resources.\n     */\n    destroy;\n    /**\n     * Returns an existing derived reducer.\n     *\n     * @param name - Name of derived reducer.\n     */\n    get;\n    constructor(adapterDerived) {\n        this.clear = adapterDerived.clear.bind(adapterDerived);\n        this.create = adapterDerived.create.bind(adapterDerived);\n        this.delete = adapterDerived.delete.bind(adapterDerived);\n        this.destroy = adapterDerived.destroy.bind(adapterDerived);\n        this.get = adapterDerived.get.bind(adapterDerived);\n        Object.freeze(this);\n    }\n}\n\n/**\n */\nclass Indexer$1 extends AdapterIndexer {\n    /**\n     * @inheritDoc\n     */\n    createSortFn() {\n        return (a, b) => this.sortData.compareFn(this.hostData[0][a], this.hostData[0][b]);\n    }\n    /**\n     * Provides the custom filter / reduce step that is ~25-40% faster than implementing with `Array.reduce`.\n     *\n     * Note: Other loop unrolling techniques like Duff's Device gave a slight faster lower bound on large data sets,\n     * but the maintenance factor is not worth the extra complication.\n     *\n     * @returns New filtered index array.\n     */\n    reduceImpl() {\n        const data = [];\n        const array = this.hostData[0];\n        if (!array) {\n            return data;\n        }\n        const filters = this.filtersData.filters;\n        let include = true;\n        const parentIndex = this.indexData.parent;\n        // Source index data is coming from an active parent index.\n        if (DynReducerUtils.isIterable(parentIndex) && parentIndex.active) {\n            for (const adjustedIndex of parentIndex) {\n                const value = array[adjustedIndex];\n                include = true;\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(value)) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(adjustedIndex);\n                }\n            }\n        }\n        else {\n            for (let cntr = 0, length = array.length; cntr < length; cntr++) {\n                include = true;\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(array[cntr])) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(cntr);\n                }\n            }\n        }\n        return data;\n    }\n    /**\n     * Update the reducer indexes. If there are changes subscribers are notified. If data order is changed externally\n     * pass in true to force an update to subscribers.\n     *\n     * @param [force=false] - When true forces an update to subscribers.\n     */\n    update(force = false) {\n        if (this.destroyed) {\n            return;\n        }\n        const oldIndex = this.indexData.index;\n        const oldHash = this.indexData.hash;\n        const array = this.hostData[0];\n        const parentIndex = this.indexData.parent;\n        // Clear index if there are no filters and no sort function or the index length doesn't match the item length.\n        if ((this.filtersData.filters.length === 0 && !this.sortData.compareFn) ||\n            (this.indexData.index && array?.length !== this.indexData.index.length)) {\n            this.indexData.index = null;\n        }\n        // If there are filters build new index.\n        if (this.filtersData.filters.length > 0) {\n            this.indexData.index = this.reduceImpl();\n        }\n        // If the index isn't built yet and there is an active parent index then create it from the parent.\n        if (!this.indexData.index && parentIndex?.active) {\n            this.indexData.index = [...parentIndex];\n        }\n        if (this.sortData.compareFn && Array.isArray(array)) {\n            // If there is no index then create one with keys matching host item length.\n            if (!this.indexData.index) {\n                this.indexData.index = [...Array(array.length).keys()];\n            }\n            this.indexData.index.sort(this.sortFn);\n        }\n        this.calcHashUpdate(oldIndex, oldHash, force);\n        // Update all derived reducers.\n        this.derivedAdapter?.update(force);\n    }\n}\n\n/**\n * Provides the base implementation derived reducer for arrays / DynArrayReducer.\n */\nclass DerivedArrayReducer {\n    #array;\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * @param array - Data host array.\n     *\n     * @param parentIndex - Parent indexer.\n     *\n     * @param options - Any filters and sort functions to apply.\n     */\n    constructor(array, parentIndex, options) {\n        this.#array = array;\n        this.#index = new Indexer$1(this.#array, this.#updateSubscribers.bind(this), parentIndex);\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#array, this.#indexPublicAPI, DerivedArrayReducer);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        let filters = void 0;\n        let sort = void 0;\n        if (options !== void 0 && ('filters' in options || 'sort' in options)) {\n            if (options.filters !== void 0) {\n                if (DynReducerUtils.isIterable(options.filters)) {\n                    filters = options.filters;\n                }\n                else {\n                    throw new TypeError(`DerivedArrayReducer error (DataDerivedOptions): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (options.sort !== void 0) {\n                if (typeof options.sort === 'function') {\n                    sort = options.sort;\n                }\n                else if (typeof options.sort === 'object' && options.sort !== null) {\n                    sort = options.sort;\n                }\n                else {\n                    throw new TypeError(`DerivedArrayReducer error (DataDerivedOptions): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // Add any filters and sort function defined by DataDynArray.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: if an array is set as initial data then that array is used as the internal data. If any changes are\n     * performed to the data externally do invoke {@link IndexerAPI.update} with `true` to recalculate the index and\n     * notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#array[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * Returns the Indexer public API.\n     *\n     * @returns Indexer API - is also iterable.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this derived reducer is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * @returns Main data / items length or indexed length.\n     */\n    get length() {\n        const array = this.#array[0];\n        return this.#index.active ? this.index.length :\n            array ? array.length : 0;\n    }\n    /**\n     * @returns Gets current reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DerivedArrayReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        this.#destroyed = true;\n        // Remove any external data reference and perform a final update.\n        this.#array = [null];\n        this.#index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#derived.destroy();\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom derived reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Provides an iterator for data stored in DerivedArrayReducer.\n     *\n     * @returns Generator / iterator of all data.\n     */\n    *[Symbol.iterator]() {\n        const array = this.#array[0];\n        if (this.#destroyed || array === null || array?.length === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const entry of this.index) {\n                yield array[entry];\n            }\n        }\n        else {\n            if (this.reversed) {\n                for (let cntr = array.length; --cntr >= 0;) {\n                    yield array[cntr];\n                }\n            }\n            else {\n                for (let cntr = 0; cntr < array.length; cntr++) {\n                    yield array[cntr];\n                }\n            }\n        }\n    }\n    // -------------------------------------------------------------------------------------------------------------------\n    /**\n     * Subscribe to this DerivedArrayReducer.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n}\n\n/**\n * Provides a managed array with non-destructive reducing / filtering / sorting capabilities with subscription /\n * Svelte store support.\n */\nclass DynArrayReducer {\n    #array = [null];\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * Initializes DynArrayReducer. Any iterable is supported for initial data. Take note that if `data` is an array it\n     * will be used as the host array and not copied. All non-array iterables otherwise create a new array / copy.\n     *\n     * @param [data] - Data iterable to store if array or copy otherwise.\n     */\n    constructor(data) {\n        let dataIterable = void 0;\n        let filters = void 0;\n        let sort = void 0;\n        if (data === null) {\n            throw new TypeError(`DynArrayReducer error: 'data' is not iterable.`);\n        }\n        if (data !== void 0 && typeof data !== 'object' && !DynReducerUtils.isIterable(data)) {\n            throw new TypeError(`DynArrayReducer error: 'data' is not iterable.`);\n        }\n        if (data !== void 0 && Symbol.iterator in data) {\n            dataIterable = data;\n        }\n        else if (data !== void 0 && ('data' in data || 'filters' in data || 'sort' in data)) {\n            if (data.data !== void 0 && !DynReducerUtils.isIterable(data.data)) {\n                throw new TypeError(`DynArrayReducer error (DataDynArray): 'data' attribute is not iterable.`);\n            }\n            dataIterable = data.data;\n            if (data.filters !== void 0) {\n                if (DynReducerUtils.isIterable(data.filters)) {\n                    filters = data.filters;\n                }\n                else {\n                    throw new TypeError(`DynArrayReducer error (DataDynArray): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (data.sort !== void 0) {\n                if (typeof data.sort === 'function') {\n                    sort = data.sort;\n                }\n                else if (typeof data.sort === 'object' && data.sort !== null) {\n                    sort = data.sort;\n                }\n                else {\n                    throw new TypeError(`DynArrayReducer error (DataDynArray): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // In the case of the main data being an array directly use the array otherwise create a copy.\n        if (dataIterable) {\n            this.#array[0] = Array.isArray(dataIterable) ? dataIterable : [...dataIterable];\n        }\n        this.#index = new Indexer$1(this.#array, this.#updateSubscribers.bind(this));\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#array, this.#indexPublicAPI, DerivedArrayReducer);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        // Add any filters and sort function defined by DataDynArray.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: if an array is set as initial data then that array is used as the internal data. If any changes are\n     * performed to the data externally do invoke {@link AdapterIndexer.index.update} with `true` to recalculate the\n     * index and notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#array[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * @returns Returns the Indexer public API.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this instance is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * Gets the main data / items length.\n     *\n     * @returns {number} Main data / items length.\n     */\n    get length() {\n        const array = this.#array[0];\n        return this.#index.active ? this.#indexPublicAPI.length :\n            array ? array.length : 0;\n    }\n    /**\n     * Gets current reversed state.\n     *\n     * @returns {boolean} Reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DynArrayReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) {\n            return;\n        }\n        this.#destroyed = true;\n        this.#derived.destroy();\n        // Set the backing data to null and provide a final update.\n        this.#array = [null];\n        this.index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Removes internal data and pushes new data. This does not destroy any initial array set to internal data unless\n     * `replace` is set to true.\n     *\n     * @param data - New data to set to internal data.\n     *\n     * @param replace=false - New data to set to internal data.\n     */\n    setData(data, replace = false) {\n        if (data !== null && !DynReducerUtils.isIterable(data)) {\n            throw new TypeError(`DynArrayReducer.setData error: 'data' is not iterable.`);\n        }\n        if (typeof replace !== 'boolean') {\n            throw new TypeError(`DynArrayReducer.setData error: 'replace' is not a boolean.`);\n        }\n        const array = this.#array[0];\n        // If the array isn't defined or 'replace' is true then replace internal data with new array or create an array\n        // from an iterable.\n        if (!Array.isArray(array) || replace) {\n            if (data) {\n                this.#array[0] = Array.isArray(data) ? data : [...data];\n            }\n        }\n        else {\n            if (data) {\n                // Remove all entries in internal data. This will not replace any initially set array.\n                array.length = 0;\n                // Add all new data.\n                array.push(...data);\n            }\n            else {\n                this.#array[0] = null;\n            }\n        }\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Add a subscriber to this DynArrayReducer instance.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n    /**\n     * Provides an iterator for data stored in DynArrayReducer.\n     *\n     * @returns Generator / iterator of all data.\n     * @yields {T}\n     */\n    *[Symbol.iterator]() {\n        const array = this.#array[0];\n        if (this.#destroyed || array === null || array?.length === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const entry of this.index) {\n                yield array[entry];\n            }\n        }\n        else {\n            if (this.reversed) {\n                for (let cntr = array.length; --cntr >= 0;) {\n                    yield array[cntr];\n                }\n            }\n            else {\n                for (let cntr = 0; cntr < array.length; cntr++) {\n                    yield array[cntr];\n                }\n            }\n        }\n    }\n}\n\n/**\n */\nclass Indexer extends AdapterIndexer {\n    /**\n     * @inheritDoc\n     */\n    createSortFn() {\n        return (a, b) => this.sortData.compareFn(this.hostData[0].get(a), this.hostData[0].get(b));\n    }\n    /**\n     * Provides the custom filter / reduce step that is ~25-40% faster than implementing with `Array.reduce`.\n     *\n     * Note: Other loop unrolling techniques like Duff's Device gave a slight faster lower bound on large data sets,\n     * but the maintenance factor is not worth the extra complication.\n     *\n     * @returns New filtered index array.\n     */\n    reduceImpl() {\n        const data = [];\n        const map = this.hostData[0];\n        if (!map) {\n            return data;\n        }\n        const filters = this.filtersData.filters;\n        let include = true;\n        const parentIndex = this.indexData.parent;\n        // Source index data is coming from an active parent index.\n        if (DynReducerUtils.isIterable(parentIndex) && parentIndex.active) {\n            for (const key of parentIndex) {\n                const value = map.get(key);\n                include = true;\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(value)) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(key);\n                }\n            }\n        }\n        else {\n            for (const key of map.keys()) {\n                include = true;\n                const value = map.get(key);\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(value)) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(key);\n                }\n            }\n        }\n        return data;\n    }\n    /**\n     * Update the reducer indexes. If there are changes subscribers are notified. If data order is changed externally\n     * pass in true to force an update to subscribers.\n     *\n     * @param [force=false] - When true forces an update to subscribers.\n     */\n    update(force = false) {\n        if (this.destroyed) {\n            return;\n        }\n        const oldIndex = this.indexData.index;\n        const oldHash = this.indexData.hash;\n        const map = this.hostData[0];\n        const parentIndex = this.indexData.parent;\n        // Clear index if there are no filters and no sort function or the index length doesn't match the item length.\n        if ((this.filtersData.filters.length === 0 && !this.sortData.compareFn) ||\n            (this.indexData.index && map?.size !== this.indexData.index.length)) {\n            this.indexData.index = null;\n        }\n        // If there are filters build new index.\n        if (this.filtersData.filters.length > 0) {\n            this.indexData.index = this.reduceImpl();\n        }\n        // If the index isn't built yet and there is an active parent index then create it from the parent.\n        if (!this.indexData.index && parentIndex?.active) {\n            this.indexData.index = [...parentIndex];\n        }\n        if (this.sortData.compareFn && map instanceof Map) {\n            // If there is no index then create one with keys matching host item length.\n            if (!this.indexData.index) {\n                this.indexData.index = this.indexData.index = [...map.keys()];\n            }\n            this.indexData.index.sort(this.sortFn);\n        }\n        this.calcHashUpdate(oldIndex, oldHash, force);\n        // Update all derived reducers.\n        this.derivedAdapter?.update(force);\n    }\n}\n\n/**\n * Provides the base implementation derived reducer for arrays / DynArrayReducer.\n */\nclass DerivedMapReducer {\n    #map;\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * @param map - Data host Map.\n     *\n     * @param parentIndex - Parent indexer.\n     *\n     * @param options - Any filters and sort functions to apply.\n     */\n    constructor(map, parentIndex, options) {\n        this.#map = map;\n        this.#index = new Indexer(this.#map, this.#updateSubscribers.bind(this), parentIndex);\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#map, this.#indexPublicAPI, DerivedMapReducer);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        let filters = void 0;\n        let sort = void 0;\n        if (options !== void 0 && ('filters' in options || 'sort' in options)) {\n            if (options.filters !== void 0) {\n                if (DynReducerUtils.isIterable(options.filters)) {\n                    filters = options.filters;\n                }\n                else {\n                    throw new TypeError(`DerivedMapReducer error (DataDerivedOptions): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (options.sort !== void 0) {\n                if (typeof options.sort === 'function') {\n                    sort = options.sort;\n                }\n                else if (typeof options.sort === 'object' && options.sort !== null) {\n                    sort = options.sort;\n                }\n                else {\n                    throw new TypeError(`DerivedMapReducer error (DataDerivedOptions): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // Add any filters and sort function defined by DataDynArray.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: The returned map is the same map set by the main reducer. If any changes are performed to the data\n     * externally do invoke {@link IndexerAPI.update} with `true` to recalculate the index and notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#map[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * Returns the Indexer public API.\n     *\n     * @returns Indexer API - is also iterable.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this derived reducer is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * @returns Main data / items length or indexed length.\n     */\n    get length() {\n        const map = this.#map[0];\n        return this.#index.active ? this.index.length :\n            map ? map.size : 0;\n    }\n    /**\n     * @returns Gets current reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DerivedMapReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        this.#destroyed = true;\n        // Remove any external data reference and perform a final update.\n        this.#map = [null];\n        this.#index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#derived.destroy();\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom derived reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Provides an iterator for data stored in DerivedMapReducer.\n     *\n     * @returns Generator / iterator of all data.\n     */\n    *[Symbol.iterator]() {\n        const map = this.#map[0];\n        if (this.#destroyed || map === null || map?.size === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const key of this.index) {\n                yield map.get(key);\n            }\n        }\n        else {\n            if (this.reversed) {\n                // TODO: Not efficient due to creating temporary values array.\n                const values = [...map.values()];\n                for (let cntr = values.length; --cntr >= 0;) {\n                    yield values[cntr];\n                }\n            }\n            else {\n                for (const value of map.values()) {\n                    yield value;\n                }\n            }\n        }\n    }\n    // -------------------------------------------------------------------------------------------------------------------\n    /**\n     * Subscribe to this DerivedMapReducer.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n}\n\n/**\n * Provides a managed Map with non-destructive reducing / filtering / sorting capabilities with subscription /\n * Svelte store support.\n */\nclass DynMapReducer {\n    #map = [null];\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * Initializes DynMapReducer. Any iterable is supported for initial data. Take note that if `data` is an array it\n     * will be used as the host array and not copied. All non-array iterables otherwise create a new array / copy.\n     *\n     * @param [data] - Data iterable to store if array or copy otherwise.\n     */\n    constructor(data) {\n        let dataMap = void 0;\n        let filters = void 0;\n        let sort = void 0;\n        if (data === null) {\n            throw new TypeError(`DynMapReducer error: 'data' is not an object or Map.`);\n        }\n        if (data !== void 0 && typeof data !== 'object' && !(data instanceof Map)) {\n            throw new TypeError(`DynMapReducer error: 'data' is not an object or Map.`);\n        }\n        if (data !== void 0 && data instanceof Map) {\n            dataMap = data;\n        }\n        else if (data !== void 0 && ('data' in data || 'filters' in data || 'sort' in data)) {\n            if (data.data !== void 0 && !(data.data instanceof Map)) {\n                throw new TypeError(`DynMapReducer error (DataDynMap): 'data' attribute is not a Map.`);\n            }\n            dataMap = data.data;\n            if (data.filters !== void 0) {\n                if (DynReducerUtils.isIterable(data.filters)) {\n                    filters = data.filters;\n                }\n                else {\n                    throw new TypeError(`DynMapReducer error (DataDynMap): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (data.sort !== void 0) {\n                if (typeof data.sort === 'function') {\n                    sort = data.sort;\n                }\n                else if (typeof data.sort === 'object' && data.sort !== null) {\n                    sort = data.sort;\n                }\n                else {\n                    throw new TypeError(`DynMapReducer error (DataDynMap): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // In the case of the main data being an array directly use the array otherwise create a copy.\n        if (dataMap) {\n            this.#map[0] = dataMap;\n        }\n        this.#index = new Indexer(this.#map, this.#updateSubscribers.bind(this));\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#map, this.#indexPublicAPI, DerivedMapReducer);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        // Add any filters and sort function defined by DataDynMap.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: When a map is set as data then that map is used as the internal data. If any changes are\n     * performed to the data externally do invoke {@link AdapterIndexer.index.update} with `true` to recalculate the\n     * index and notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#map[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * @returns Returns the Indexer public API.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this instance is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * Gets the main data / items length.\n     *\n     * @returns {number} Main data / items length.\n     */\n    get length() {\n        const map = this.#map[0];\n        return this.#index.active ? this.#indexPublicAPI.length :\n            map ? map.size : 0;\n    }\n    /**\n     * Gets current reversed state.\n     *\n     * @returns {boolean} Reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DynMapReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) {\n            return;\n        }\n        this.#destroyed = true;\n        this.#derived.destroy();\n        // Set the backing data to null and provide a final update.\n        this.#map = [null];\n        this.index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Removes internal data and pushes new data. This does not destroy any initial array set to internal data unless\n     * `replace` is set to true.\n     *\n     * @param data - New data to set to internal data.\n     *\n     * @param replace=false - New data to set to internal data.\n     */\n    setData(data, replace = false) {\n        if (data !== null && !(data instanceof Map)) {\n            throw new TypeError(`DynMapReducer.setData error: 'data' is not iterable.`);\n        }\n        if (typeof replace !== 'boolean') {\n            throw new TypeError(`DynMapReducer.setData error: 'replace' is not a boolean.`);\n        }\n        const map = this.#map[0];\n        // If the array isn't defined or 'replace' is true then replace internal data with new array or create an array\n        // from an iterable.\n        if (!(map instanceof Map) || replace) {\n            this.#map[0] = data instanceof Map ? data : null;\n        }\n        else if (data instanceof Map && map instanceof Map) {\n            // Create a set of all current entry IDs.\n            const removeKeySet = new Set(map.keys());\n            for (const key of data.keys()) {\n                map.set(key, data.get(key));\n                if (removeKeySet.has(key)) {\n                    removeKeySet.delete(key);\n                }\n            }\n            // Remove entries that are no longer in data.\n            for (const key of removeKeySet) {\n                map.delete(key);\n            }\n        }\n        else if (data === null) {\n            this.#map[0] = null;\n        }\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Add a subscriber to this DynMapReducer instance.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n    /**\n     * Provides an iterator for data stored in DynMapReducer.\n     *\n     * @returns Generator / iterator of all data.\n     * @yields {T}\n     */\n    *[Symbol.iterator]() {\n        const map = this.#map[0];\n        if (this.#destroyed || map === null || map?.size === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const key of this.index) {\n                yield map.get(key);\n            }\n        }\n        else {\n            if (this.reversed) {\n                // TODO: Not efficient due to creating temporary values array.\n                const values = [...map.values()];\n                for (let cntr = values.length; --cntr >= 0;) {\n                    yield values[cntr];\n                }\n            }\n            else {\n                for (const value of map.values()) {\n                    yield value;\n                }\n            }\n        }\n    }\n}\n\n/**\n * Provides a readable store to track keys actively pressed. KeyStore is designed to be used with the {@link keyforward}\n * action.\n */\nclass KeyStore\n{\n   #keySet;\n\n   /**\n    * @type {Map<string, number>}\n    */\n   #keyMap = new Map();\n\n   /**\n    * @type {KeyStoreOptions}\n    */\n   #options = { preventDefault: true, useCode: true, stopPropagation: true };\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {(function(KeyStore): void)[]}\n    */\n   #subscriptions = [];\n\n   /**\n    * @param {Iterable<string>}  [keyNames] -\n    *\n    * @param {KeyStoreOptions}   [options] - Optional parameters\n    */\n   constructor(keyNames, options)\n   {\n      if (!isIterable(keyNames))\n      {\n         throw new TypeError(`'keyNames' is not an iterable list.`);\n      }\n\n      this.setOptions(options);\n\n      this.#keySet = new Set(keyNames);\n   }\n\n   /**\n    * Add given key to the tracking key set.\n    *\n    * @param {string}   key - Key to add.\n    */\n   addKey(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`'key' is not a string.`); }\n\n      this.#keySet.add(key);\n   }\n\n   /**\n    * @returns {boolean} True if any keys in the key set are pressed.\n    */\n\n   /**\n    * Returns true if any of given keys are pressed. If `keys` is undefined then the result is true if any keys being\n    * tracked are pressed.\n    *\n    * @param {string|Iterable<string>|undefined} keys - Zero or more key strings or list to verify if any pressed.\n    *\n    * @returns {boolean} True if any keys set are pressed.\n    */\n   anyPressed(keys)\n   {\n      // When no keys given then check if any key is pressed.\n      if (keys === void 0) { return this.#keyMap.size > 0; }\n\n      const isList = isIterable(keys);\n\n      if (typeof keys !== 'string' && !isList)\n      {\n         throw new TypeError(`'keys' is not a string or iterable list of strings.`);\n      }\n\n      let result = false;\n\n      if (isList)\n      {\n         for (const key of keys)\n         {\n            if (this.#keyMap.has(key))\n            {\n               result = true;\n               break;\n            }\n         }\n      }\n      else\n      {\n         if (this.#keyMap.has(keys)) { result = true; }\n      }\n\n      return result;\n   }\n\n   /**\n    * Is the given key in the tracking key set.\n    *\n    * @param {string}   key - Key to check.\n    */\n   hasKey(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`'key' is not a string.`); }\n\n      this.#keySet.has(key);\n   }\n\n   /**\n    * Returns true if all given keys are pressed.\n    *\n    * @param {string|Iterable<string>} keys - One or more key strings to verify if pressed.\n    *\n    * @returns {boolean} Are all keys pressed.\n    */\n   isPressed(keys)\n   {\n      const isList = isIterable(keys);\n\n      if (typeof keys !== 'string' && !isList)\n      {\n         throw new TypeError(`'keys' is not a string or iterable list of strings.`);\n      }\n\n      let result = true;\n\n      if (isList)\n      {\n         for (const key of keys)\n         {\n            if (!this.#keyMap.has(key))\n            {\n               result = false;\n               break;\n            }\n         }\n      }\n      else\n      {\n         if (!this.#keyMap.has(keys)) { result = false; }\n      }\n\n      return result;\n   }\n\n   /**\n    * Handle keydown event adding any key from the tracked key set.\n    *\n    * @param {KeyboardEvent}  event - KeyboardEvent.\n    */\n   keydown(event)\n   {\n      const key = this.#options.useCode ? event.code : event.key;\n\n      if (this.#keySet.has(key))\n      {\n         if (!this.#keyMap.has(key))\n         {\n            this.#keyMap.set(key, 1);\n            this._updateSubscribers();\n         }\n\n         if (this.#options.preventDefault) { event.preventDefault(); }\n         if (this.#options.stopPropagation) { event.stopPropagation(); }\n      }\n   }\n\n   /**\n    * @returns {IterableIterator<string>} Returns current pressed keys iterator.\n    */\n   keysPressed()\n   {\n      return this.#keyMap.keys();\n   }\n\n   /**\n    * @returns {IterableIterator<string>} Returns currently tracked keys iterator.\n    */\n   keysTracked()\n   {\n      return this.#keySet.keys();\n   }\n\n   /**\n    * Handle keyup event removing any key from the tracked key set.\n    *\n    * @param {KeyboardEvent}  event - KeyboardEvent.\n    */\n   keyup(event)\n   {\n      const key = this.#options.useCode ? event.code : event.key;\n\n      if (this.#keySet.has(key))\n      {\n         if (this.#keyMap.has(key))\n         {\n            this.#keyMap.delete(key);\n            this._updateSubscribers();\n         }\n\n         if (this.#options.preventDefault) { event.preventDefault(); }\n         if (this.#options.stopPropagation) { event.stopPropagation(); }\n      }\n   }\n\n   /**\n    * Remove the given key from the tracking key set.\n    *\n    * @param {string}   key - Key to remove.\n    */\n   removeKey(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`'key' is not a string.`); }\n\n      if (this.#keySet.has(key))\n      {\n         this.#keySet.delete(key);\n\n         if (this.#keyMap.has(key))\n         {\n            this.#keyMap.delete(key);\n            this._updateSubscribers();\n         }\n      }\n   }\n\n   /**\n    * Update options.\n    *\n    * @param {KeyStoreOptions}   options - Options to set.\n    */\n   setOptions(options)\n   {\n      if (typeof options?.preventDefault === 'boolean') { this.#options.preventDefault = options.preventDefault; }\n      if (typeof options?.useCode === 'boolean') { this.#options.useCode = options.useCode; }\n      if (typeof options?.stopPropagation === 'boolean') { this.#options.stopPropagation = options.stopPropagation; }\n   }\n\n   /**\n    * @param {string}   key - key or key code to lookup.\n    *\n    * @returns {number} 1 if currently pressed and 0 if not pressed.\n    */\n   value(key)\n   {\n      return this.#keyMap.has(key) ? 1 : 0;\n   }\n\n   // Store subscriber implementation --------------------------------------------------------------------------------\n\n   /**\n    * @param {function(KeyStore): void} handler - Callback function that is invoked on update / changes.\n    *\n    * @returns {(function(): void)} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(this);                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   /**\n    * Updates subscribers.\n    *\n    * @protected\n    */\n   _updateSubscribers()\n   {\n      for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) { this.#subscriptions[cntr](this); }\n   }\n}\n\n/**\n * @typedef {object} KeyStoreOptions\n *\n * @property {boolean}  [preventDefault=true] - Invoke `preventDefault` on key events.\n *\n * @property {boolean}  [useCode=true] - When true use `event.code` otherwise use `event.key` to get active key.\n *\n * @property {boolean}  [stopPropagation=true] - Invoke `stopPropagation` on key events.\n */\n\n// src/generator.ts\nfunction isSimpleDeriver(deriver) {\n  return deriver.length < 2;\n}\nfunction generator(storage) {\n  function readable(key, value, start) {\n    return {\n      subscribe: writable(key, value, start).subscribe\n    };\n  }\n  function writable(key, value, start = noop) {\n    function wrap_start(ogSet) {\n      return start(function wrap_set(new_value) {\n        if (storage) {\n          storage.setItem(key, JSON.stringify(new_value));\n        }\n        return ogSet(new_value);\n      });\n    }\n    if (storage) {\n      const storageValue = storage.getItem(key);\n      try {\n        if (storageValue) {\n          value = JSON.parse(storageValue);\n        }\n      } catch (err) {\n      }\n      storage.setItem(key, JSON.stringify(value));\n    }\n    const ogStore = writable$2(value, start ? wrap_start : void 0);\n    function set(new_value) {\n      if (storage) {\n        storage.setItem(key, JSON.stringify(new_value));\n      }\n      ogStore.set(new_value);\n    }\n    function update(fn) {\n      set(fn(get(ogStore)));\n    }\n    function subscribe(run, invalidate = noop) {\n      return ogStore.subscribe(run, invalidate);\n    }\n    return {set, update, subscribe};\n  }\n  function derived(key, stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single ? [stores] : stores;\n    if (storage && storage.getItem(key)) {\n      try {\n        initial_value = JSON.parse(storage.getItem(key));\n      } catch (err) {\n      }\n    }\n    return readable(key, initial_value, (set) => {\n      let inited = false;\n      const values = [];\n      let pending = 0;\n      let cleanup = noop;\n      const sync = () => {\n        if (pending) {\n          return;\n        }\n        cleanup();\n        const input = single ? values[0] : values;\n        if (isSimpleDeriver(fn)) {\n          set(fn(input));\n        } else {\n          const result = fn(input, set);\n          cleanup = is_function(result) ? result : noop;\n        }\n      };\n      const unsubscribers = stores_array.map((store, i) => store.subscribe((value) => {\n        values[i] = value;\n        pending &= ~(1 << i);\n        if (inited) {\n          sync();\n        }\n      }, () => {\n        pending |= 1 << i;\n      }));\n      inited = true;\n      sync();\n      return function stop() {\n        run_all(unsubscribers);\n        cleanup();\n      };\n    });\n  }\n  return {\n    readable,\n    writable,\n    derived,\n    get: get\n  };\n}\n\n// src/local.ts\nvar storage$1 = typeof window !== \"undefined\" ? window.localStorage : void 0;\nvar g$1 = generator(storage$1);\nvar writable$1 = g$1.writable;\n\nclass TJSLocalStorage\n{\n   /**\n    * @type {Map<string, import('svelte/store').Writable>}\n    */\n   #stores = new Map();\n\n   /**\n    * Creates a new writable store for the given key.\n    *\n    * @param {string}   key - Key to lookup in stores map.\n    *\n    * @param {boolean}  [defaultValue] - A default value to set for the store.\n    *\n    * @returns {import('svelte/store').Writable} The new store.\n    */\n   static #createStore(key, defaultValue = void 0)\n   {\n      try\n      {\n         const value = localStorage.getItem(key);\n         if (value !== null) { defaultValue = value === 'undefined' ? void 0 : JSON.parse(value); }\n      }\n      catch (err) { /**/ }\n\n      return writable$1(key, defaultValue);\n   }\n\n   /**\n    * Gets a store from the stores Map or creates a new store for the key and a given default value.\n    *\n    * @param {string}               key - Key to lookup in stores map.\n    *\n    * @param {boolean}              [defaultValue] - A default value to set for the store.\n    *\n    * @returns {import('svelte/store').Writable} The store for the given key.\n    */\n   #getStore(key, defaultValue = void 0)\n   {\n      let store = this.#stores.get(key);\n      if (store === void 0)\n      {\n         store = TJSLocalStorage.#createStore(key, defaultValue);\n         this.#stores.set(key, store);\n      }\n\n      return store;\n   }\n\n   /**\n    * Get value from the localStorage.\n    *\n    * @param {string}   key - Key to lookup in localStorage.\n    *\n    * @param {*}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {*} Value from session storage or if not defined any default value provided.\n    */\n   getItem(key, defaultValue)\n   {\n      let value = defaultValue;\n\n      const storageValue = localStorage.getItem(key);\n\n      if (storageValue !== null)\n      {\n         try\n         {\n            value = storageValue === 'undefined' ? void 0 : JSON.parse(storageValue);\n         }\n         catch (err)\n         {\n            value = defaultValue;\n         }\n      }\n      else if (defaultValue !== void 0)\n      {\n         try\n         {\n            const newValue = JSON.stringify(defaultValue);\n\n            // If there is no existing storage value and defaultValue is defined the storage value needs to be set.\n            localStorage.setItem(key, newValue === 'undefined' ? void 0 : newValue);\n         }\n         catch (err) { /* */ }\n      }\n\n      return value;\n   }\n\n   /**\n    * Returns the backing Svelte store for the given key; potentially sets a default value if the key\n    * is not already set.\n    *\n    * @param {string}   key - Key to lookup in localStorage.\n    *\n    * @param {*}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {import('svelte/store').Writable} The Svelte store for this key.\n    */\n   getStore(key, defaultValue)\n   {\n      return this.#getStore(key, defaultValue);\n   }\n\n   /**\n    * Sets the value for the given key in localStorage.\n    *\n    * @param {string}   key - Key to lookup in localStorage.\n    *\n    * @param {*}        value - A value to set for this key.\n    */\n   setItem(key, value)\n   {\n      const store = this.#getStore(key);\n      store.set(value);\n   }\n\n   /**\n    * Convenience method to swap a boolean value stored in session storage.\n    *\n    * @param {string}   key - Key to lookup in localStorage.\n    *\n    * @param {boolean}  [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {boolean} The boolean swap for the given key.\n    */\n   swapItemBoolean(key, defaultValue)\n   {\n      const store = this.#getStore(key, defaultValue);\n\n      let currentValue = false;\n\n      try\n      {\n         currentValue = !!JSON.parse(localStorage.getItem(key));\n      }\n      catch (err) { /**/ }\n\n      const newValue = typeof currentValue === 'boolean' ? !currentValue : false;\n\n      store.set(newValue);\n      return newValue;\n   }\n}\n\n// src/session.ts\nvar storage = typeof window !== \"undefined\" ? window.sessionStorage : void 0;\nvar g = generator(storage);\nvar writable = g.writable;\n\nclass TJSSessionStorage\n{\n   /**\n    * @type {Map<string, import('svelte/store').Writable>}\n    */\n   #stores = new Map();\n\n   /**\n    * Creates a new store for the given key.\n    *\n    * @param {string}   key - Key to lookup in stores map.\n    *\n    * @param {boolean}  [defaultValue] - A default value to set for the store.\n    *\n    * @returns {import('svelte/store').Writable} The new store.\n    */\n   static #createStore(key, defaultValue = void 0)\n   {\n      try\n      {\n         const value = sessionStorage.getItem(key);\n         if (value !== null) { defaultValue = value === 'undefined' ? void 0 : JSON.parse(value); }\n      }\n      catch (err) { /**/ }\n\n      return writable(key, defaultValue);\n   }\n\n   /**\n    * Gets a store from the `stores` Map or creates a new store for the key and a given default value.\n    *\n    * @param {string}               key - Key to lookup in stores map.\n    *\n    * @param {boolean}              [defaultValue] - A default value to set for the store.\n    *\n    * @returns {import('svelte/store').Writable} The store for the given key.\n    */\n   #getStore(key, defaultValue = void 0)\n   {\n      let store = this.#stores.get(key);\n      if (store === void 0)\n      {\n         store = TJSSessionStorage.#createStore(key, defaultValue);\n         this.#stores.set(key, store);\n      }\n\n      return store;\n   }\n\n   /**\n    * Get value from the sessionStorage.\n    *\n    * @param {string}   key - Key to lookup in sessionStorage.\n    *\n    * @param {*}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {*} Value from session storage or if not defined any default value provided.\n    */\n   getItem(key, defaultValue)\n   {\n      let value = defaultValue;\n\n      const storageValue = sessionStorage.getItem(key);\n\n      if (storageValue !== null)\n      {\n         try\n         {\n            value = storageValue === 'undefined' ? void 0 : JSON.parse(storageValue);\n         }\n         catch (err)\n         {\n            value = defaultValue;\n         }\n      }\n      else if (defaultValue !== void 0)\n      {\n         try\n         {\n            const newValue = JSON.stringify(defaultValue);\n\n            // If there is no existing storage value and defaultValue is defined the storage value needs to be set.\n            sessionStorage.setItem(key, newValue === 'undefined' ? void 0 : newValue);\n         }\n         catch (err) { /* */ }\n      }\n\n      return value;\n   }\n\n   /**\n    * Returns the backing Svelte store for the given key; potentially sets a default value if the key\n    * is not already set.\n    *\n    * @param {string}   key - Key to lookup in sessionStorage.\n    *\n    * @param {*}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {import('svelte/store').Writable} The Svelte store for this key.\n    */\n   getStore(key, defaultValue)\n   {\n      return this.#getStore(key, defaultValue);\n   }\n\n   /**\n    * Sets the value for the given key in sessionStorage.\n    *\n    * @param {string}   key - Key to lookup in sessionStorage.\n    *\n    * @param {*}        value - A value to set for this key.\n    */\n   setItem(key, value)\n   {\n      const store = this.#getStore(key);\n      store.set(value);\n   }\n\n   /**\n    * Convenience method to swap a boolean value stored in session storage.\n    *\n    * @param {string}   key - Key to lookup in sessionStorage.\n    *\n    * @param {boolean}  [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {boolean} The boolean swap for the given key.\n    */\n   swapItemBoolean(key, defaultValue)\n   {\n      const store = this.#getStore(key, defaultValue);\n\n      let currentValue = false;\n\n      try\n      {\n         currentValue = !!JSON.parse(sessionStorage.getItem(key));\n      }\n      catch (err) { /**/ }\n\n      const newValue = typeof currentValue === 'boolean' ? !currentValue : false;\n\n      store.set(newValue);\n      return newValue;\n   }\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a readable store by having a `subscribe`\n * function.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isReadableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\n * function and an `update` function.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isUpdatableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function' && typeof store.update === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\n * `set`, and `update` functions.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ `subscribe` & `set` functions.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isWritableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function' && typeof store.set === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Subscribes to the given store with the update function provided and ignores the first automatic\n * update. All future updates are dispatched to the update function.\n *\n * @param {import('svelte/store').Readable | import('svelte/store').Writable} store -\n *  Store to subscribe to...\n *\n * @param {import('svelte/store').Updater} update - function to receive future updates.\n *\n * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n */\nfunction subscribeIgnoreFirst(store, update)\n{\n   let firedFirst = false;\n\n   return store.subscribe((value) =>\n   {\n      if (!firedFirst)\n      {\n         firedFirst = true;\n      }\n      else\n      {\n         update(value);\n      }\n   });\n}\n\n/**\n * Subscribes to the given store with two update functions provided. The first function is invoked on the initial\n * subscription. All future updates are dispatched to the update function.\n *\n * @param {import('svelte/store').Readable | import('svelte/store').Writable} store -\n *  Store to subscribe to...\n *\n * @param {import('svelte/store').Updater} first - Function to receive first update.\n *\n * @param {import('svelte/store').Updater} update - Function to receive future updates.\n *\n * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n */\nfunction subscribeFirstRest(store, first, update)\n{\n   let firedFirst = false;\n\n   return store.subscribe((value) =>\n   {\n      if (!firedFirst)\n      {\n         firedFirst = true;\n         first(value);\n      }\n      else\n      {\n         update(value);\n      }\n   });\n}\n\n/**\n * @external Store\n * @see [Svelte stores](https://svelte.dev/docs#component-format-script-4-prefix-stores-with-$-to-access-their-values-store-contract)\n */\n\n/**\n * Create a store similar to [Svelte's `derived`](https://svelte.dev/docs#run-time-svelte-store-writable),\n * but which has its own `set` and `update` methods and can send values back to the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#default-export-writablederived)\n * \n * @param {Store|Store[]} origins One or more stores to derive from. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 1st parameter.\n * @param {!Function} derive The callback to determine the derived value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 2nd parameter.\n * @param {!Function} reflect Called when the derived store gets a new value via its `set` or\n * `update` methods, and determines new values for the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#new-parameter-reflect)\n * @param [initial] The new store's initial value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 3rd parameter.\n * \n * @returns {Store} A writable store.\n */\nfunction writableDerived(origins, derive, reflect, initial) {\n\tvar childDerivedSetter, originValues, blockNextDerive = false;\n\tvar reflectOldValues = reflect.length >= 2;\n\tvar wrappedDerive = (got, set) => {\n\t\tchildDerivedSetter = set;\n\t\tif (reflectOldValues) {\n\t\t\toriginValues = got;\n\t\t}\n\t\tif (!blockNextDerive) {\n\t\t\tlet returned = derive(got, set);\n\t\t\tif (derive.length < 2) {\n\t\t\t\tset(returned);\n\t\t\t} else {\n\t\t\t\treturn returned;\n\t\t\t}\n\t\t}\n\t\tblockNextDerive = false;\n\t};\n\tvar childDerived = derived(origins, wrappedDerive, initial);\n\t\n\tvar singleOrigin = !Array.isArray(origins);\n\tfunction doReflect(reflecting) {\n\t\tvar setWith = reflect(reflecting, originValues);\n\t\tif (singleOrigin) {\n\t\t\tblockNextDerive = true;\n\t\t\torigins.set(setWith);\n\t\t} else {\n\t\t\tsetWith.forEach( (value, i) => {\n\t\t\t\tblockNextDerive = true;\n\t\t\t\torigins[i].set(value);\n\t\t\t} );\n\t\t}\n\t\tblockNextDerive = false;\n\t}\n\t\n\tvar tryingSet = false;\n\tfunction update(fn) {\n\t\tvar isUpdated, mutatedBySubscriptions, oldValue, newValue;\n\t\tif (tryingSet) {\n\t\t\tnewValue = fn( get(childDerived) );\n\t\t\tchildDerivedSetter(newValue);\n\t\t\treturn;\n\t\t}\n\t\tvar unsubscribe = childDerived.subscribe( (value) => {\n\t\t\tif (!tryingSet) {\n\t\t\t\toldValue = value;\n\t\t\t} else if (!isUpdated) {\n\t\t\t\tisUpdated = true;\n\t\t\t} else {\n\t\t\t\tmutatedBySubscriptions = true;\n\t\t\t}\n\t\t} );\n\t\tnewValue = fn(oldValue);\n\t\ttryingSet = true;\n\t\tchildDerivedSetter(newValue);\n\t\tunsubscribe();\n\t\ttryingSet = false;\n\t\tif (mutatedBySubscriptions) {\n\t\t\tnewValue = get(childDerived);\n\t\t}\n\t\tif (isUpdated) {\n\t\t\tdoReflect(newValue);\n\t\t}\n\t}\n\treturn {\n\t\tsubscribe: childDerived.subscribe,\n\t\tset(value) { update( () => value ); },\n\t\tupdate,\n\t};\n}\n\n/**\n * Create a store for a property value in an object contained in another store.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#named-export-propertystore)\n * \n * @param {Store} origin The store containing the object to get/set from.\n * @param {string|number|symbol|Array<string|number|symbol>} propName The property to get/set, or a path of\n * properties in nested objects.\n *\n * @returns {Store} A writable store.\n */\nfunction propertyStore(origin, propName) {\n\tif (!Array.isArray(propName)) {\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(object) => object[propName],\n\t\t\t(reflecting, object) => {\n\t\t\t\tobject[propName] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t} else {\n\t\tlet props = propName.concat();\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(value) => {\n\t\t\t\tfor (let i = 0; i < props.length; ++i) {\n\t\t\t\t\tvalue = value[ props[i] ];\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\t(reflecting, object) => {\n\t\t\t\tlet target = object;\n\t\t\t\tfor (let i = 0; i < props.length - 1; ++i) {\n\t\t\t\t\ttarget = target[ props[i] ];\n\t\t\t\t}\n\t\t\t\ttarget[ props[props.length - 1] ] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t}\n}\n\n/**\n * Provides management of reactive embedded collections.\n *\n * TODO: Consider subscribing to TJSDocument rather than exposing {@link EmbeddedStoreManager.handleDocChange} and\n * {@link EmbeddedStoreManager.handleUpdate}\n */\nclass EmbeddedStoreManager\n{\n   /**\n    * RegExp for detecting CRUD updates for renderContext.\n    *\n    * @type {RegExp}\n    */\n   static #renderContextRegex = /(create|delete|update)(\\w+)/;\n\n   /**\n    * @type {Map<string, EmbeddedCollectionData>}\n    */\n   #name = new Map();\n\n   /**\n    * @type {foundry.abstract.Document[]}\n    */\n   #document;\n\n   /**\n    * @type {Set<string>}\n    */\n   #embeddedNames = new Set();\n\n   /**\n    * @param {foundry.abstract.Document[]} document - The associated document holder.\n    */\n   constructor(document)\n   {\n      this.#document = document;\n\n      this.handleDocChange();\n\n      Object.seal(this);\n   }\n\n   /**\n    * @template T\n    *\n    * @param {string} embeddedName -\n    *\n    * @param {import('@typhonjs-fvtt/svelte/store').OptionsDynMapCreate<string, T>} options -\n    *\n    * @returns {import('@typhonjs-fvtt/svelte/store').DynMapReducer<string, T>} DynMapReducer instance\n    */\n   create(embeddedName, options)\n   {\n      /** @type {foundry.abstract.Document} */\n      const doc = this.#document[0];\n\n      let collection = null;\n\n      if (doc)\n      {\n         try\n         {\n            collection = doc.getEmbeddedCollection(embeddedName);\n         }\n         catch (err)\n         {\n            console.warn(`EmbeddedStoreManager.create error: No valid embedded collection for: ${embeddedName}`);\n         }\n      }\n\n      let embeddedData;\n\n      if (!this.#name.has(embeddedName))\n      {\n         embeddedData = {\n            collection,\n            stores: new Map()\n         };\n\n         this.#name.set(embeddedName, embeddedData);\n      }\n      else\n      {\n         embeddedData = this.#name.get(embeddedName);\n      }\n\n      /** @type {string} */\n      let name;\n\n      /** @type {import('@typhonjs-fvtt/svelte/store').DataOptions<T>} */\n      let rest = {};\n\n      /** @type {import('@typhonjs-fvtt/svelte/store').IDynMapReducerCtor<string, T>} */\n      let ctor;\n\n      if (typeof options === 'string')\n      {\n         name = options;\n         ctor = DynMapReducer;\n      }\n      else if (typeof options === 'function' && hasPrototype(options, DynMapReducer))\n      {\n         ctor = options;\n      }\n      else if (isObject(options))\n      {\n         ({ name, ctor = DynMapReducer, ...rest } = options);\n      }\n      else\n      {\n         throw new TypeError(`EmbeddedStoreManager.create error: 'options' does not conform to allowed parameters.`);\n      }\n\n      if (!hasPrototype(ctor, DynMapReducer))\n      {\n         throw new TypeError(`EmbeddedStoreManager.create error: 'ctor' is not a 'DynMapReducer'.`);\n      }\n\n      name = name ?? ctor?.name;\n\n      if (typeof name !== 'string') { throw new TypeError(`EmbeddedStoreManager.create error: 'name' is not a string.`); }\n\n      if (embeddedData.stores.has(name))\n      {\n         return embeddedData.stores.get(name);\n      }\n      else\n      {\n         const storeOptions = collection ? { data: collection, ...rest } : { ...rest };\n         const store = new ctor(storeOptions);\n         embeddedData.stores.set(name, store);\n         return store;\n      }\n   }\n\n   /**\n    * Destroys and removes embedded collection stores. Invoking this method with no parameters destroys all stores.\n    * Invoking with an embedded name destroys all stores for that particular collection. If you provide an embedded and\n    * store name just that particular store is destroyed and removed.\n    *\n    * @param {string}   [embeddedName] - Specific embedded collection name.\n    *\n    * @param {string}   [storeName] - Specific store name.\n    *\n    * @returns {boolean} One or more stores destroyed?\n    */\n   destroy(embeddedName, storeName)\n   {\n      let count = 0;\n\n      // Destroy all embedded stores\n      if (embeddedName === void 0)\n      {\n         for (const embeddedData of this.#name.values())\n         {\n            embeddedData.collection = null;\n            for (const store of embeddedData.stores.values())\n            {\n               store.destroy();\n               count++;\n            }\n         }\n\n         this.#name.clear();\n      }\n      else if (typeof embeddedName === 'string' && storeName === void 0)\n      {\n         const embeddedData = this.#name.get(embeddedName);\n         if (embeddedData)\n         {\n            embeddedData.collection = null;\n            for (const store of embeddedData.stores.values())\n            {\n               store.destroy();\n               count++;\n            }\n         }\n\n         this.#name.delete(embeddedName);\n      }\n      else if (typeof embeddedName === 'string' && storeName === 'string')\n      {\n         const embeddedData = this.#name.get(embeddedName);\n         if (embeddedData)\n         {\n            const store = embeddedData.stores.get(storeName);\n            if (store)\n            {\n               store.destroy();\n               count++;\n            }\n         }\n      }\n\n      return count > 0;\n   }\n\n   /**\n    * @template T\n    *\n    * @param {string} embeddedName -\n    *\n    * @param {string} storeName -\n    *\n    * @returns {import('@typhonjs-fvtt/svelte/store').DynMapReducer<string, T>} DynMapReducer instance.\n    */\n   get(embeddedName, storeName)\n   {\n      if (!this.#name.has(embeddedName)) { return void 0; }\n\n      return this.#name.get(embeddedName).stores.get(storeName);\n   }\n\n   /**\n    * Updates all existing embedded collection stores with the associated embedded collection\n    */\n   handleDocChange()\n   {\n      const doc = this.#document[0];\n\n      if (doc instanceof globalThis.foundry.abstract.Document)\n      {\n         const existingEmbeddedNames = new Set(this.#name.keys());\n\n         /** @type {string[]} */\n         const embeddedNames = Object.keys(doc.constructor?.metadata?.embedded ?? []);\n\n         // Remove all previously stored embedded name CRUD keys.\n         this.#embeddedNames.clear();\n\n         for (const embeddedName of embeddedNames)\n         {\n            // Remove processed embedded name from existingEmbeddedNames set.\n            existingEmbeddedNames.delete(embeddedName);\n\n            // Update CRUD keys.\n            this.#embeddedNames.add(`create${embeddedName}`);\n            this.#embeddedNames.add(`delete${embeddedName}`);\n            this.#embeddedNames.add(`update${embeddedName}`);\n\n            let collection = null;\n\n            try\n            {\n               // Update any existing stores with the actual collection.\n               collection = doc.getEmbeddedCollection(embeddedName);\n            }\n            catch (err)\n            {\n               console.warn(`EmbeddedStoreManager.handleDocUpdate error: No valid embedded collection for: ${\n                embeddedName}`);\n            }\n\n            // Update EmbeddedData for new collection.\n            const embeddedData = this.#name.get(embeddedName);\n            if (embeddedData)\n            {\n               embeddedData.collection = collection;\n\n               // Update all existing stores.\n               for (const store of embeddedData.stores.values()) { store.setData(collection, true); }\n            }\n         }\n\n         // Update all existing embedded collections with null data that aren't processed above.\n         for (const embeddedName of existingEmbeddedNames)\n         {\n            const embeddedData = this.#name.get(embeddedName);\n            if (embeddedData)\n            {\n               embeddedData.collection = null;\n\n               for (const store of embeddedData.stores.values()) { store.setData(null, true); }\n            }\n         }\n      }\n      else // Reset all embedded reducer stores to null data.\n      {\n         this.#embeddedNames.clear();\n\n         for (const embeddedData of this.#name.values())\n         {\n            embeddedData.collection = null;\n\n            for (const store of embeddedData.stores.values()) { store.setData(null, true); }\n         }\n      }\n   }\n\n   /**\n    * Handles updates to embedded stores parsing the render context for valid embedded store types.\n    *\n    * On create, delete, update parse the type being modified then force index updates for the embedded type.\n    *\n    * @param {string}   renderContext - render context update from document.\n    */\n   handleUpdate(renderContext)\n   {\n      if (!this.#embeddedNames.has(renderContext)) { return; }\n\n      const match = EmbeddedStoreManager.#renderContextRegex.exec(renderContext);\n\n      if (match)\n      {\n         const embeddedName = match[2];\n         if (!this.#name.has(embeddedName)) { return; }\n\n         for (const store of this.#name.get(embeddedName).stores.values())\n         {\n            store.index.update(true);\n         }\n      }\n   }\n}\n\n/**\n * @typedef {object} EmbeddedCollectionData\n *\n * @property {foundry.abstract.Collection} collection -\n *\n * @property {Map<string, import('@typhonjs-fvtt/svelte/store').DynMapReducer<string, T>>} stores -\n */\n\n/**\n * Provides a wrapper implementing the Svelte store / subscriber protocol around any Document / ClientMixinDocument.\n * This makes documents reactive in a Svelte component, but otherwise provides subscriber functionality external to\n * Svelte.\n */\nclass TJSDocument\n{\n   /**\n    * @type {foundry.abstract.Document[]}\n    */\n   #document = [void 0];\n\n   /**\n    * @type {EmbeddedStoreManager}\n    */\n   #embeddedStoreManager;\n   #embeddedAPI;\n\n   /**\n    * @type {string}\n    */\n   #uuidv4;\n\n   /**\n    * @type {TJSDocumentOptions}\n    */\n   #options = { delete: void 0, preDelete: void 0 };\n\n   #subscriptions = [];\n   #updateOptions;\n\n   /**\n    * @param {foundry.abstract.Document | TJSDocumentOptions}  [document] - Document to wrap or TJSDocumentOptions.\n    *\n    * @param {TJSDocumentOptions}      [options] - TJSDocument options.\n    */\n   constructor(document, options = {})\n   {\n      this.#uuidv4 = `tjs-document-${uuidv4()}`;\n\n      if (isPlainObject(document)) // Handle case when only options are passed into ctor.\n      {\n         this.setOptions(document);\n      }\n      else\n      {\n         this.setOptions(options);\n         this.set(document);\n      }\n   }\n\n   /**\n    * @returns {EmbeddedAPI} Embedded store manager.\n    */\n   get embedded()\n   {\n      if (!this.#embeddedAPI)\n      {\n         this.#embeddedStoreManager = new EmbeddedStoreManager(this.#document);\n         this.#embeddedAPI = {\n            create: (embeddedName, options) => this.#embeddedStoreManager.create(embeddedName, options),\n            destroy: (embeddedName, storeName) => this.#embeddedStoreManager.destroy(embeddedName, storeName),\n            get: (embeddedName, storeName) => this.#embeddedStoreManager.get(embeddedName, storeName)\n         };\n      }\n\n      return this.#embeddedAPI;\n   }\n\n   /**\n    * Returns the options passed on last update.\n    *\n    * @returns {object} Last update options.\n    */\n   get updateOptions() { return this.#updateOptions ?? {}; }\n\n   /**\n    * Returns the UUID assigned to this store.\n    *\n    * @returns {string} UUID\n    */\n   get uuidv4() { return this.#uuidv4; }\n\n   /**\n    * Handles cleanup when the document is deleted. Invoking any optional delete function set in the constructor.\n    *\n    * @returns {Promise<void>}\n    */\n   async #deleted()\n   {\n      const doc = this.#document[0];\n\n      // Check to see if the document is still in the associated collection to determine if actually deleted.\n      if (doc instanceof globalThis.foundry.abstract.Document && !doc?.collection?.has(doc.id))\n      {\n         delete doc?.apps[this.#uuidv4];\n         this.#setDocument(void 0);\n\n         if (typeof this.#options.preDelete === 'function')\n         {\n            await this.#options.preDelete(doc);\n         }\n\n         this.#updateSubscribers(false, { action: 'delete', data: void 0 });\n\n         if (typeof this.#options.delete === 'function')\n         {\n            await this.#options.delete(doc);\n         }\n\n         this.#updateOptions = void 0;\n      }\n   }\n\n   /**\n    * Completely removes all internal subscribers, any optional delete callback, and unregisters from the\n    * ClientDocumentMixin `apps` tracking object.\n    */\n   destroy()\n   {\n      const doc = this.#document[0];\n\n      if (this.#embeddedStoreManager)\n      {\n         this.#embeddedStoreManager.destroy();\n         this.#embeddedStoreManager = void 0;\n         this.#embeddedAPI = void 0;\n      }\n\n      if (doc instanceof globalThis.foundry.abstract.Document)\n      {\n         delete doc?.apps[this.#uuidv4];\n         this.#setDocument(void 0);\n      }\n\n      this.#options.delete = void 0;\n      this.#subscriptions.length = 0;\n   }\n\n   /**\n    * @param {boolean}  [force] - unused - signature from Foundry render function.\n    *\n    * @param {object}   [options] - Options from render call; will have document update context.\n    */\n   #updateSubscribers(force = false, options = {}) // eslint-disable-line no-unused-vars\n   {\n      this.#updateOptions = options;\n\n      const doc = this.#document[0];\n\n      for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) { this.#subscriptions[cntr](doc, options); }\n\n      if (this.#embeddedStoreManager)\n      {\n         this.#embeddedStoreManager.handleUpdate(options.renderContext);\n      }\n   }\n\n   /**\n    * @returns {foundry.abstract.Document | undefined} Current document\n    */\n   get() { return this.#document[0]; }\n\n   /**\n    * @param {foundry.abstract.Document | undefined}  document - New document to set.\n    *\n    * @param {object}         [options] - New document update options to set.\n    */\n   set(document, options = {})\n   {\n      if (this.#document[0])\n      {\n         delete this.#document[0].apps[this.#uuidv4];\n      }\n\n      if (document !== void 0 && !(document instanceof globalThis.foundry.abstract.Document))\n      {\n         throw new TypeError(`TJSDocument set error: 'document' is not a valid Document or undefined.`);\n      }\n\n      if (options === null || typeof options !== 'object')\n      {\n         throw new TypeError(`TJSDocument set error: 'options' is not an object.`);\n      }\n\n      if (document instanceof globalThis.foundry.abstract.Document)\n      {\n         document.apps[this.#uuidv4] = {\n            close: this.#deleted.bind(this),\n            render: this.#updateSubscribers.bind(this)\n         };\n      }\n\n      this.#setDocument(document);\n      this.#updateOptions = options;\n      this.#updateSubscribers();\n   }\n\n   /**\n    *\n    * @param {foundry.abstract.Document | undefined} doc -\n    */\n   #setDocument(doc)\n   {\n      this.#document[0] = doc;\n\n      if (this.#embeddedStoreManager) { this.#embeddedStoreManager.handleDocChange(); }\n   }\n\n   /**\n    * Potentially sets new document from data transfer object.\n    *\n    * @param {object}   data - Document transfer data.\n    *\n    * @param {ParseDataTransferOptions & TJSDocumentOptions}   [options] - Optional parameters.\n    *\n    * @returns {Promise<boolean>} Returns true if new document set from data transfer blob.\n    */\n   async setFromDataTransfer(data, options)\n   {\n      return this.setFromUUID(getUUIDFromDataTransfer(data, options), options);\n   }\n\n   /**\n    * Sets the document by Foundry UUID performing a lookup and setting the document if found.\n    *\n    * @param {string}   uuid - A Foundry UUID to lookup.\n    *\n    * @param {TJSDocumentOptions}   [options] - New document update options to set.\n    *\n    * @returns {Promise<boolean>} True if successfully set document from UUID.\n    */\n   async setFromUUID(uuid, options = {})\n   {\n      if (typeof uuid !== 'string' || uuid.length === 0) { return false; }\n\n      try\n      {\n         const doc = await globalThis.fromUuid(uuid);\n\n         if (doc)\n         {\n            this.set(doc, options);\n            return true;\n         }\n      }\n      catch (err) { /**/ }\n\n      return false;\n   }\n\n   /**\n    * Sets options for this document wrapper / store.\n    *\n    * @param {TJSDocumentOptions}   options - Options for TJSDocument.\n    */\n   setOptions(options)\n   {\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocument error: 'options' is not a plain object.`);\n      }\n\n      // Verify valid values -------------\n\n      if (options.delete !== void 0 && typeof options.delete !== 'function')\n      {\n         throw new TypeError(`TJSDocument error: 'delete' attribute in options is not a function.`);\n      }\n\n      if (options.preDelete !== void 0 && typeof options.preDelete !== 'function')\n      {\n         throw new TypeError(`TJSDocument error: 'preDelete' attribute in options is not a function.`);\n      }\n\n      // Set any valid values -------------\n\n      if (options.delete === void 0 || typeof options.delete === 'function')\n      {\n         this.#options.delete = options.delete;\n      }\n\n      if (options.preDelete === void 0 || typeof options.preDelete === 'function')\n      {\n         this.#options.preDelete = options.preDelete;\n      }\n   }\n\n   /**\n    * @param {function(foundry.abstract.Document, object): void} handler - Callback function that is invoked on update / changes.\n    *\n    * @returns {(function(): void)} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler);           // Add handler to the array of subscribers.\n\n      const updateOptions = { action: 'subscribe', data: void 0 };\n\n      handler(this.#document[0], updateOptions);      // Call handler with current value and update options.\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n}\n\n/**\n * @typedef {object} TJSDocumentOptions\n *\n * @property {(doc: foundry.abstract.Document) => void} [delete] - Optional post delete function to invoke when\n *           document is deleted _after_ subscribers have been notified.\n *\n * @property {(doc: foundry.abstract.Document) => void} [preDelete] - Optional pre delete function to invoke when\n *           document is deleted _before_ subscribers are notified.\n */\n\n/**\n * @typedef {object} EmbeddedAPI\n *\n * @property {(embeddedName: string, options: import('@typhonjs-fvtt/runtime/svelte/store').OptionsDynMapCreate<string, any>) => import('@typhonjs-fvtt/runtime/svelte/store').DynMapReducer<string, T>} create - Creates an embedded collection store.\n *\n * @property {(embeddedName?: string, storeName?: string) => boolean} destroy - Destroys one or more embedded collection stores.\n *\n * @property {(embeddedName: string, storeName: string) => import('@typhonjs-fvtt/runtime/svelte/store').DynMapReducer<string, T>} get - Returns a specific existing embedded collection store.\n */\n\n/**\n * Provides a wrapper implementing the Svelte store / subscriber protocol around any DocumentCollection. This makes\n * document collections reactive in a Svelte component, but otherwise provides subscriber functionality external to\n * Svelte.\n *\n * @template {DocumentCollection} T\n */\nclass TJSDocumentCollection\n{\n   #collection;\n   #collectionCallback;\n   #uuid;\n\n   /**\n    * @type {TJSDocumentCollectionOptions}\n    */\n   #options = { delete: void 0, preDelete: void 0 };\n\n   #subscriptions = [];\n   #updateOptions;\n\n   /**\n    * @param {T|TJSDocumentCollectionOptions}   [collection] - Collection to wrap or TJSDocumentCollectionOptions.\n    *\n    * @param {TJSDocumentCollectionOptions}     [options] - TJSDocumentCollection options.\n    */\n   constructor(collection, options = {})\n   {\n      this.#uuid = `tjs-collection-${uuidv4()}`;\n\n      if (isPlainObject(collection)) // Handle case when only options are passed into ctor.\n      {\n         this.setOptions(collection);\n      }\n      else\n      {\n         this.setOptions(options);\n         this.set(collection);\n      }\n   }\n\n   /**\n    * Returns the options passed on last update.\n    *\n    * @returns {object} Last update options.\n    */\n   get updateOptions() { return this.#updateOptions ?? {}; }\n\n   /**\n    * Returns the UUID assigned to this store.\n    *\n    * @returns {*} UUID\n    */\n   get uuid() { return this.#uuid; }\n\n   /**\n    * Handles cleanup when the collection is deleted. Invoking any optional delete function set in the constructor.\n    *\n    * @returns {Promise<void>}\n    */\n   async #deleted()\n   {\n      const collection = this.#collection;\n\n      if (collection instanceof DocumentCollection)\n      {\n         const index = collection?.apps?.findIndex((sub) => sub === this.#collectionCallback);\n         if (index >= 0) { collection?.apps?.splice(index, 1); }\n\n         this.#collection = void 0;\n      }\n\n      if (typeof this.#options.preDelete === 'function')\n      {\n         await this.#options.preDelete(collection);\n      }\n\n      this.#notify(false, { action: 'delete', documentType: collection.documentName, documents: [], data: [] });\n\n      if (typeof this.#options.delete === 'function')\n      {\n         await this.#options.delete(collection);\n      }\n\n      this.#updateOptions = void 0;\n   }\n\n   /**\n    * Completely removes all internal subscribers, any optional delete callback, and unregisters from the\n    * DocumentCollection `apps` tracking array.\n    */\n   destroy()\n   {\n      const collection = this.#collection;\n\n      if (collection instanceof DocumentCollection)\n      {\n         const index = collection?.apps?.findIndex((sub) => sub === this.#collectionCallback);\n         if (index >= 0) { collection?.apps?.splice(index, 1); }\n\n         this.#collection = void 0;\n      }\n\n      this.#options.delete = void 0;\n      this.#subscriptions.length = 0;\n   }\n\n   /**\n    * @param {boolean}  [force] - unused - signature from Foundry render function.\n    *\n    * @param {object}   [options] - Options from render call; will have collection update context.\n    */\n   #notify(force = false, options = {}) // eslint-disable-line no-unused-vars\n   {\n      this.#updateOptions = options;\n\n      // Subscriptions are stored locally as on the browser Babel is still used for private class fields / Babel\n      // support until 2023. IE not doing this will require several extra method calls otherwise.\n      const subscriptions = this.#subscriptions;\n      const collection = this.#collection;\n\n      for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](collection, options); }\n   }\n\n   /**\n    * @returns {T | undefined} Current collection\n    */\n   get() { return this.#collection; }\n\n   /**\n    * @param {T | undefined}  collection - New collection to set.\n    *\n    * @param {object}         [options] - New collection update options to set.\n    */\n   set(collection, options = {})\n   {\n      if (this.#collection)\n      {\n         const index = this.#collection.apps.findIndex((sub) => sub === this.#collectionCallback);\n         if (index >= 0) { this.#collection.apps.splice(index, 1); }\n\n         this.#collectionCallback = void 0;\n      }\n\n      if (collection !== void 0 && !(collection instanceof DocumentCollection))\n      {\n         throw new TypeError(\n          `TJSDocumentCollection set error: 'collection' is not a valid DocumentCollection or undefined.`);\n      }\n\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocument set error: 'options' is not an object.`);\n      }\n\n      if (collection instanceof DocumentCollection)\n      {\n         this.#collectionCallback = {\n            close: this.#deleted.bind(this),\n            render: this.#notify.bind(this)\n         };\n\n         collection?.apps?.push(this.#collectionCallback);\n      }\n\n      this.#collection = collection;\n      this.#updateOptions = options;\n      this.#notify();\n   }\n\n   /**\n    * Sets options for this collection wrapper / store.\n    *\n    * @param {TJSDocumentCollectionOptions}   options - Options for TJSDocumentCollection.\n    */\n   setOptions(options)\n   {\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocumentCollection error: 'options' is not an object.`);\n      }\n\n      // Verify valid values -------------\n\n      if (options.delete !== void 0 && typeof options.delete !== 'function')\n      {\n         throw new TypeError(`TJSDocumentCollection error: 'delete' attribute in options is not a function.`);\n      }\n\n      if (options.preDelete !== void 0 && typeof options.preDelete !== 'function')\n      {\n         throw new TypeError(`TJSDocumentCollection error: 'preDelete' attribute in options is not a function.`);\n      }\n\n      // Set any valid values -------------\n\n      if (options.delete === void 0 || typeof options.delete === 'function')\n      {\n         this.#options.delete = options.delete;\n      }\n\n      if (options.preDelete === void 0 || typeof options.preDelete === 'function')\n      {\n         this.#options.preDelete = options.preDelete;\n      }\n   }\n\n   /**\n    * @param {function(T, object): void} handler - Callback function that is invoked on update / changes.\n    *\n    * @returns {(function(): void)} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler);              // Add handler to the array of subscribers.\n\n      const collection = this.#collection;\n\n      const documentType = collection?.documentName ?? void 0;\n\n      const updateOptions = { action: 'subscribe', documentType, documents: [], data: [] };\n\n      handler(collection, updateOptions);  // Call handler with current value and update options.\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n}\n\n/**\n * @typedef TJSDocumentCollectionOptions\n *\n * @property {(collection: foundry.abstract.DocumentCollection) => void} [delete] - Optional post delete function\n *           to invoke when document is deleted _after_ subscribers have been notified.\n *\n * @property {(collection: foundry.abstract.DocumentCollection) => void} [preDelete] - Optional pre delete function to\n *           invoke when document is deleted _before_ subscribers are notified.\n */\n\nconst storeState = writable$2(void 0);\n\n/**\n * @type {GameState} Provides a Svelte store wrapping the Foundry runtime / global game state.\n */\nconst gameState = {\n   subscribe: storeState.subscribe,\n   get: () => game\n};\n\nObject.freeze(gameState);\n\nHooks.once('ready', () => storeState.set(game));\n\nexport { DerivedArrayReducer, DerivedMapReducer, DynArrayReducer, DynMapReducer, KeyStore, TJSDocument, TJSDocumentCollection, TJSLocalStorage, TJSSessionStorage, gameState, isReadableStore, isUpdatableStore, isWritableStore, propertyStore, subscribeFirstRest, subscribeIgnoreFirst, writableDerived };\n//# sourceMappingURL=index.js.map\n","export { identity as linear } from '../internal/index.mjs';\n\n/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\nfunction backInOut(t) {\n    const s = 1.70158 * 1.525;\n    if ((t *= 2) < 1)\n        return 0.5 * (t * t * ((s + 1) * t - s));\n    return 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\nfunction backIn(t) {\n    const s = 1.70158;\n    return t * t * ((s + 1) * t - s);\n}\nfunction backOut(t) {\n    const s = 1.70158;\n    return --t * t * ((s + 1) * t + s) + 1;\n}\nfunction bounceOut(t) {\n    const a = 4.0 / 11.0;\n    const b = 8.0 / 11.0;\n    const c = 9.0 / 10.0;\n    const ca = 4356.0 / 361.0;\n    const cb = 35442.0 / 1805.0;\n    const cc = 16061.0 / 1805.0;\n    const t2 = t * t;\n    return t < a\n        ? 7.5625 * t2\n        : t < b\n            ? 9.075 * t2 - 9.9 * t + 3.4\n            : t < c\n                ? ca * t2 - cb * t + cc\n                : 10.8 * t * t - 20.52 * t + 10.72;\n}\nfunction bounceInOut(t) {\n    return t < 0.5\n        ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0))\n        : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\nfunction bounceIn(t) {\n    return 1.0 - bounceOut(1.0 - t);\n}\nfunction circInOut(t) {\n    if ((t *= 2) < 1)\n        return -0.5 * (Math.sqrt(1 - t * t) - 1);\n    return 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\nfunction circIn(t) {\n    return 1.0 - Math.sqrt(1.0 - t * t);\n}\nfunction circOut(t) {\n    return Math.sqrt(1 - --t * t);\n}\nfunction cubicInOut(t) {\n    return t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\nfunction cubicIn(t) {\n    return t * t * t;\n}\nfunction cubicOut(t) {\n    const f = t - 1.0;\n    return f * f * f + 1.0;\n}\nfunction elasticInOut(t) {\n    return t < 0.5\n        ? 0.5 *\n            Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) *\n            Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n        : 0.5 *\n            Math.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n            Math.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n            1.0;\n}\nfunction elasticIn(t) {\n    return Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction elasticOut(t) {\n    return (Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0);\n}\nfunction expoInOut(t) {\n    return t === 0.0 || t === 1.0\n        ? t\n        : t < 0.5\n            ? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n            : -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\nfunction expoIn(t) {\n    return t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction expoOut(t) {\n    return t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\nfunction quadInOut(t) {\n    t /= 0.5;\n    if (t < 1)\n        return 0.5 * t * t;\n    t--;\n    return -0.5 * (t * (t - 2) - 1);\n}\nfunction quadIn(t) {\n    return t * t;\n}\nfunction quadOut(t) {\n    return -t * (t - 2.0);\n}\nfunction quartInOut(t) {\n    return t < 0.5\n        ? +8.0 * Math.pow(t, 4.0)\n        : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\nfunction quartIn(t) {\n    return Math.pow(t, 4.0);\n}\nfunction quartOut(t) {\n    return Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\nfunction quintInOut(t) {\n    if ((t *= 2) < 1)\n        return 0.5 * t * t * t * t * t;\n    return 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\nfunction quintIn(t) {\n    return t * t * t * t * t;\n}\nfunction quintOut(t) {\n    return --t * t * t * t * t + 1;\n}\nfunction sineInOut(t) {\n    return -0.5 * (Math.cos(Math.PI * t) - 1);\n}\nfunction sineIn(t) {\n    const v = Math.cos(t * Math.PI * 0.5);\n    if (Math.abs(v) < 1e-14)\n        return 1;\n    else\n        return 1 - v;\n}\nfunction sineOut(t) {\n    return Math.sin((t * Math.PI) / 2);\n}\n\nexport { backIn, backInOut, backOut, bounceIn, bounceInOut, bounceOut, circIn, circInOut, circOut, cubicIn, cubicInOut, cubicOut, elasticIn, elasticInOut, elasticOut, expoIn, expoInOut, expoOut, quadIn, quadInOut, quadOut, quartIn, quartInOut, quartOut, quintIn, quintInOut, quintOut, sineIn, sineInOut, sineOut };\n","/**\n * Performs linear interpolation between a start & end value by given amount between 0 - 1 inclusive.\n *\n * @param {number}   start - Start value.\n *\n * @param {number}   end - End value.\n *\n * @param {number}   amount - Current amount between 0 - 1 inclusive.\n *\n * @returns {number} Linear interpolated value between start & end.\n */\nfunction lerp$5(start, end, amount)\n{\n   return (1 - amount) * start + amount * end;\n}\n\n/**\n * Converts the given number from degrees to radians.\n *\n * @param {number}   deg - Degree number to convert\n *\n * @returns {number} Degree as radians.\n */\nfunction degToRad(deg)\n{\n   return deg * (Math.PI / 180.0);\n}\n\n/**\n * Converts the given number from radians to degrees.\n *\n * @param {number}   rad - Radian number to convert.\n *\n * @returns {number} Degree as radians.\n */\nfunction radToDeg(rad)\n{\n   return rad * (180.0 / Math.PI);\n}\n\n/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nvar EPSILON = 0.000001;\nvar ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nvar RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nfunction setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nfunction toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nfunction equals$9(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};\n\nconst common = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   get ARRAY_TYPE () { return ARRAY_TYPE; },\n   EPSILON: EPSILON,\n   RANDOM: RANDOM,\n   equals: equals$9,\n   setMatrixArrayType: setMatrixArrayType,\n   toRadian: toRadian\n});\n\n/**\n * 2x2 Matrix\n * @module mat2\n */\n\n/**\n * Creates a new identity mat2\n *\n * @returns {mat2} a new 2x2 matrix\n */\n\nfunction create$8() {\n  var out = new ARRAY_TYPE(4);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\n * Creates a new mat2 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat2} a matrix to clone\n * @returns {mat2} a new 2x2 matrix\n */\n\nfunction clone$8(a) {\n  var out = new ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Copy the values from one mat2 to another\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\n\nfunction copy$8(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set a mat2 to the identity matrix\n *\n * @param {mat2} out the receiving matrix\n * @returns {mat2} out\n */\n\nfunction identity$5(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\n * Create a new mat2 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out A new 2x2 matrix\n */\n\nfunction fromValues$8(m00, m01, m10, m11) {\n  var out = new ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\n * Set the components of a mat2 to the given values\n *\n * @param {mat2} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out\n */\n\nfunction set$8(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\n * Transpose the values of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\n\nfunction transpose$2(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\n\nfunction invert$5(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3]; // Calculate the determinant\n\n  var det = a0 * a3 - a2 * a1;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\n\nfunction adjoint$2(out, a) {\n  // Caching this value is nessecary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n/**\n * Calculates the determinant of a mat2\n *\n * @param {ReadonlyMat2} a the source matrix\n * @returns {Number} determinant of a\n */\n\nfunction determinant$3(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n/**\n * Multiplies two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\n\nfunction multiply$8(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n/**\n * Rotates a mat2 by the given angle\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\n\nfunction rotate$4(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n/**\n * Scales the mat2 by the dimensions in the given vec2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to rotate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat2} out\n **/\n\nfunction scale$8(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.rotate(dest, dest, rad);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\n\nfunction fromRotation$4(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.scale(dest, dest, vec);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat2} out\n */\n\nfunction fromScaling$3(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n/**\n * Returns a string representation of a mat2\n *\n * @param {ReadonlyMat2} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nfunction str$8(a) {\n  return \"mat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat2\n *\n * @param {ReadonlyMat2} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nfunction frob$3(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3]);\n}\n/**\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\n * @param {ReadonlyMat2} L the lower triangular matrix\n * @param {ReadonlyMat2} D the diagonal matrix\n * @param {ReadonlyMat2} U the upper triangular matrix\n * @param {ReadonlyMat2} a the input matrix to factorize\n */\n\nfunction LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n/**\n * Adds two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\n\nfunction add$8(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\n\nfunction subtract$6(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat2} a The first matrix.\n * @param {ReadonlyMat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction exactEquals$8(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat2} a The first matrix.\n * @param {ReadonlyMat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction equals$8(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2} out\n */\n\nfunction multiplyScalar$3(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2} out the receiving vector\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2} out\n */\n\nfunction multiplyScalarAndAdd$3(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\n * Alias for {@link mat2.multiply}\n * @function\n */\n\nvar mul$8 = multiply$8;\n/**\n * Alias for {@link mat2.subtract}\n * @function\n */\n\nvar sub$6 = subtract$6;\n\nconst mat2 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   LDU: LDU,\n   add: add$8,\n   adjoint: adjoint$2,\n   clone: clone$8,\n   copy: copy$8,\n   create: create$8,\n   determinant: determinant$3,\n   equals: equals$8,\n   exactEquals: exactEquals$8,\n   frob: frob$3,\n   fromRotation: fromRotation$4,\n   fromScaling: fromScaling$3,\n   fromValues: fromValues$8,\n   identity: identity$5,\n   invert: invert$5,\n   mul: mul$8,\n   multiply: multiply$8,\n   multiplyScalar: multiplyScalar$3,\n   multiplyScalarAndAdd: multiplyScalarAndAdd$3,\n   rotate: rotate$4,\n   scale: scale$8,\n   set: set$8,\n   str: str$8,\n   sub: sub$6,\n   subtract: subtract$6,\n   transpose: transpose$2\n});\n\n/**\n * 2x3 Matrix\n * @module mat2d\n * @description\n * A mat2d contains six elements defined as:\n * <pre>\n * [a, b,\n *  c, d,\n *  tx, ty]\n * </pre>\n * This is a short form for the 3x3 matrix:\n * <pre>\n * [a, b, 0,\n *  c, d, 0,\n *  tx, ty, 1]\n * </pre>\n * The last column is ignored so the array is shorter and operations are faster.\n */\n\n/**\n * Creates a new identity mat2d\n *\n * @returns {mat2d} a new 2x3 matrix\n */\n\nfunction create$7() {\n  var out = new ARRAY_TYPE(6);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\n * Creates a new mat2d initialized with values from an existing matrix\n *\n * @param {ReadonlyMat2d} a matrix to clone\n * @returns {mat2d} a new 2x3 matrix\n */\n\nfunction clone$7(a) {\n  var out = new ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\n * Copy the values from one mat2d to another\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {mat2d} out\n */\n\nfunction copy$7(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\n * Set a mat2d to the identity matrix\n *\n * @param {mat2d} out the receiving matrix\n * @returns {mat2d} out\n */\n\nfunction identity$4(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\n * Create a new mat2d with the given values\n *\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} A new mat2d\n */\n\nfunction fromValues$7(a, b, c, d, tx, ty) {\n  var out = new ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\n * Set the components of a mat2d to the given values\n *\n * @param {mat2d} out the receiving matrix\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} out\n */\n\nfunction set$7(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\n * Inverts a mat2d\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {mat2d} out\n */\n\nfunction invert$4(out, a) {\n  var aa = a[0],\n      ab = a[1],\n      ac = a[2],\n      ad = a[3];\n  var atx = a[4],\n      aty = a[5];\n  var det = aa * ad - ab * ac;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n/**\n * Calculates the determinant of a mat2d\n *\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {Number} determinant of a\n */\n\nfunction determinant$2(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n/**\n * Multiplies two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\n\nfunction multiply$7(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n/**\n * Rotates a mat2d by the given angle\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\n\nfunction rotate$3(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\n * Scales the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to translate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat2d} out\n **/\n\nfunction scale$7(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\n * Translates the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to translate\n * @param {ReadonlyVec2} v the vec2 to translate the matrix by\n * @returns {mat2d} out\n **/\n\nfunction translate$3(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.rotate(dest, dest, rad);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\n\nfunction fromRotation$3(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.scale(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat2d} out\n */\n\nfunction fromScaling$2(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.translate(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat2d} out\n */\n\nfunction fromTranslation$3(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n/**\n * Returns a string representation of a mat2d\n *\n * @param {ReadonlyMat2d} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nfunction str$7(a) {\n  return \"mat2d(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat2d\n *\n * @param {ReadonlyMat2d} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nfunction frob$2(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], 1);\n}\n/**\n * Adds two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\n\nfunction add$7(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\n\nfunction subtract$5(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2d} out\n */\n\nfunction multiplyScalar$2(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n/**\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2d} out the receiving vector\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2d} out\n */\n\nfunction multiplyScalarAndAdd$2(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat2d} a The first matrix.\n * @param {ReadonlyMat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction exactEquals$7(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat2d} a The first matrix.\n * @param {ReadonlyMat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction equals$7(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n/**\n * Alias for {@link mat2d.multiply}\n * @function\n */\n\nvar mul$7 = multiply$7;\n/**\n * Alias for {@link mat2d.subtract}\n * @function\n */\n\nvar sub$5 = subtract$5;\n\nconst mat2d = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$7,\n   clone: clone$7,\n   copy: copy$7,\n   create: create$7,\n   determinant: determinant$2,\n   equals: equals$7,\n   exactEquals: exactEquals$7,\n   frob: frob$2,\n   fromRotation: fromRotation$3,\n   fromScaling: fromScaling$2,\n   fromTranslation: fromTranslation$3,\n   fromValues: fromValues$7,\n   identity: identity$4,\n   invert: invert$4,\n   mul: mul$7,\n   multiply: multiply$7,\n   multiplyScalar: multiplyScalar$2,\n   multiplyScalarAndAdd: multiplyScalarAndAdd$2,\n   rotate: rotate$3,\n   scale: scale$7,\n   set: set$7,\n   str: str$7,\n   sub: sub$5,\n   subtract: subtract$5,\n   translate: translate$3\n});\n\n/**\n * 3x3 Matrix\n * @module mat3\n */\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\n\nfunction create$6() {\n  var out = new ARRAY_TYPE(9);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {ReadonlyMat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\n\nfunction fromMat4$1(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\n\nfunction clone$6(a) {\n  var out = new ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nfunction copy$6(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\n\nfunction fromValues$6(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\n\nfunction set$6(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\n\nfunction identity$3(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nfunction transpose$1(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nfunction invert$3(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nfunction adjoint$1(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\n * Calculates the determinant of a mat3\n *\n * @param {ReadonlyMat3} a the source matrix\n * @returns {Number} determinant of a\n */\n\nfunction determinant$1(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nfunction multiply$6(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to translate\n * @param {ReadonlyVec2} v vector to translate by\n * @returns {mat3} out\n */\n\nfunction translate$2(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\n\nfunction rotate$2(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\n\nfunction scale$6(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat3} out\n */\n\nfunction fromTranslation$2(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\n\nfunction fromRotation$2(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat3} out\n */\n\nfunction fromScaling$1(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to copy\n * @returns {mat3} out\n **/\n\nfunction fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\n * Calculates a 3x3 matrix from the given quaternion\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat3} out\n */\n\nfunction fromQuat$1(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n *\n * @returns {mat3} out\n */\n\nfunction normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\n * Generates a 2D projection matrix with the given bounds\n *\n * @param {mat3} out mat3 frustum matrix will be written into\n * @param {number} width Width of your gl context\n * @param {number} height Height of gl context\n * @returns {mat3} out\n */\n\nfunction projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat3\n *\n * @param {ReadonlyMat3} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nfunction str$6(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nfunction frob$1(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nfunction add$6(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nfunction subtract$4(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\n\nfunction multiplyScalar$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\n\nfunction multiplyScalarAndAdd$1(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction exactEquals$6(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction equals$6(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\n\nvar mul$6 = multiply$6;\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\n\nvar sub$4 = subtract$4;\n\nconst mat3 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$6,\n   adjoint: adjoint$1,\n   clone: clone$6,\n   copy: copy$6,\n   create: create$6,\n   determinant: determinant$1,\n   equals: equals$6,\n   exactEquals: exactEquals$6,\n   frob: frob$1,\n   fromMat2d: fromMat2d,\n   fromMat4: fromMat4$1,\n   fromQuat: fromQuat$1,\n   fromRotation: fromRotation$2,\n   fromScaling: fromScaling$1,\n   fromTranslation: fromTranslation$2,\n   fromValues: fromValues$6,\n   identity: identity$3,\n   invert: invert$3,\n   mul: mul$6,\n   multiply: multiply$6,\n   multiplyScalar: multiplyScalar$1,\n   multiplyScalarAndAdd: multiplyScalarAndAdd$1,\n   normalFromMat4: normalFromMat4,\n   projection: projection,\n   rotate: rotate$2,\n   scale: scale$6,\n   set: set$6,\n   str: str$6,\n   sub: sub$4,\n   subtract: subtract$4,\n   translate: translate$2,\n   transpose: transpose$1\n});\n\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nfunction create$5() {\n  var out = new ARRAY_TYPE(16);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nfunction clone$5(a) {\n  var out = new ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nfunction copy$5(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nfunction fromValues$5(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nfunction set$5(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nfunction identity$2(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nfunction transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nfunction invert$2(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nfunction adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nfunction determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nfunction multiply$5(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nfunction translate$1(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nfunction scale$5(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nfunction rotate$1(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nfunction rotateX$3(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nfunction rotateY$3(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nfunction rotateZ$3(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nfunction fromTranslation$1(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nfunction fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nfunction fromRotation$1(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nfunction fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nfunction fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nfunction fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nfunction fromRotationTranslation$1(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nfunction fromQuat2(out, a) {\n  var translation = new ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation$1(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nfunction getTranslation$1(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nfunction getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nfunction getRotation(out, mat) {\n  var scaling = new ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nfunction fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nfunction fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nfunction fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nfunction frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nfunction perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nvar perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nfunction perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nfunction perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nfunction orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nvar ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nfunction orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nfunction lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < EPSILON && Math.abs(eyey - centery) < EPSILON && Math.abs(eyez - centerz) < EPSILON) {\n    return identity$2(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nfunction targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nfunction str$5(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nfunction frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nfunction add$5(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nfunction subtract$3(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nfunction multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nfunction multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction exactEquals$5(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nfunction equals$5(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nvar mul$5 = multiply$5;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nvar sub$3 = subtract$3;\n\nconst mat4 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$5,\n   adjoint: adjoint,\n   clone: clone$5,\n   copy: copy$5,\n   create: create$5,\n   determinant: determinant,\n   equals: equals$5,\n   exactEquals: exactEquals$5,\n   frob: frob,\n   fromQuat: fromQuat,\n   fromQuat2: fromQuat2,\n   fromRotation: fromRotation$1,\n   fromRotationTranslation: fromRotationTranslation$1,\n   fromRotationTranslationScale: fromRotationTranslationScale,\n   fromRotationTranslationScaleOrigin: fromRotationTranslationScaleOrigin,\n   fromScaling: fromScaling,\n   fromTranslation: fromTranslation$1,\n   fromValues: fromValues$5,\n   fromXRotation: fromXRotation,\n   fromYRotation: fromYRotation,\n   fromZRotation: fromZRotation,\n   frustum: frustum,\n   getRotation: getRotation,\n   getScaling: getScaling,\n   getTranslation: getTranslation$1,\n   identity: identity$2,\n   invert: invert$2,\n   lookAt: lookAt,\n   mul: mul$5,\n   multiply: multiply$5,\n   multiplyScalar: multiplyScalar,\n   multiplyScalarAndAdd: multiplyScalarAndAdd,\n   ortho: ortho,\n   orthoNO: orthoNO,\n   orthoZO: orthoZO,\n   perspective: perspective,\n   perspectiveFromFieldOfView: perspectiveFromFieldOfView,\n   perspectiveNO: perspectiveNO,\n   perspectiveZO: perspectiveZO,\n   rotate: rotate$1,\n   rotateX: rotateX$3,\n   rotateY: rotateY$3,\n   rotateZ: rotateZ$3,\n   scale: scale$5,\n   set: set$5,\n   str: str$5,\n   sub: sub$3,\n   subtract: subtract$3,\n   targetTo: targetTo,\n   translate: translate$1,\n   transpose: transpose\n});\n\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nfunction create$4() {\n  var out = new ARRAY_TYPE(3);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nfunction clone$4(a) {\n  var out = new ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nfunction length$4(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nfunction fromValues$4(x, y, z) {\n  var out = new ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nfunction copy$4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nfunction set$4(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction add$4(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction subtract$2(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction multiply$4(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction divide$2(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nfunction ceil$2(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nfunction floor$2(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction min$2(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction max$2(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nfunction round$2(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nfunction scale$4(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nfunction scaleAndAdd$2(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nfunction distance$2(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nfunction squaredDistance$2(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nfunction squaredLength$4(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nfunction negate$2(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nfunction inverse$2(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nfunction normalize$4(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nfunction dot$4(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction cross$2(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nfunction lerp$4(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nfunction hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nfunction bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nfunction random$3(out, scale) {\n  scale = scale || 1.0;\n  var r = RANDOM() * 2.0 * Math.PI;\n  var z = RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nfunction transformMat4$2(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nfunction transformMat3$1(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nfunction transformQuat$1(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nfunction rotateX$2(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nfunction rotateY$2(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nfunction rotateZ$2(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nfunction angle$1(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot$4(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nfunction zero$2(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nfunction str$4(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nfunction exactEquals$4(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nfunction equals$4(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nvar sub$2 = subtract$2;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nvar mul$4 = multiply$4;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nvar div$2 = divide$2;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nvar dist$2 = distance$2;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nvar sqrDist$2 = squaredDistance$2;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nvar len$4 = length$4;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nvar sqrLen$4 = squaredLength$4;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nvar forEach$2 = function () {\n  var vec = create$4();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();\n\nconst vec3 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$4,\n   angle: angle$1,\n   bezier: bezier,\n   ceil: ceil$2,\n   clone: clone$4,\n   copy: copy$4,\n   create: create$4,\n   cross: cross$2,\n   dist: dist$2,\n   distance: distance$2,\n   div: div$2,\n   divide: divide$2,\n   dot: dot$4,\n   equals: equals$4,\n   exactEquals: exactEquals$4,\n   floor: floor$2,\n   forEach: forEach$2,\n   fromValues: fromValues$4,\n   hermite: hermite,\n   inverse: inverse$2,\n   len: len$4,\n   length: length$4,\n   lerp: lerp$4,\n   max: max$2,\n   min: min$2,\n   mul: mul$4,\n   multiply: multiply$4,\n   negate: negate$2,\n   normalize: normalize$4,\n   random: random$3,\n   rotateX: rotateX$2,\n   rotateY: rotateY$2,\n   rotateZ: rotateZ$2,\n   round: round$2,\n   scale: scale$4,\n   scaleAndAdd: scaleAndAdd$2,\n   set: set$4,\n   sqrDist: sqrDist$2,\n   sqrLen: sqrLen$4,\n   squaredDistance: squaredDistance$2,\n   squaredLength: squaredLength$4,\n   str: str$4,\n   sub: sub$2,\n   subtract: subtract$2,\n   transformMat3: transformMat3$1,\n   transformMat4: transformMat4$2,\n   transformQuat: transformQuat$1,\n   zero: zero$2\n});\n\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\n\nfunction create$3() {\n  var out = new ARRAY_TYPE(4);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\n\nfunction clone$3(a) {\n  var out = new ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\n\nfunction fromValues$3(x, y, z, w) {\n  var out = new ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\n\nfunction copy$3(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\n\nfunction set$3(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nfunction add$3(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nfunction subtract$1(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nfunction multiply$3(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nfunction divide$1(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\n\nfunction ceil$1(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\n\nfunction floor$1(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nfunction min$1(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nfunction max$1(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\n * Math.round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\n\nfunction round$1(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\n\nfunction scale$3(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\n\nfunction scaleAndAdd$1(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\n\nfunction distance$1(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nfunction squaredDistance$1(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nfunction length$3(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nfunction squaredLength$3(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\n\nfunction negate$1(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\n\nfunction inverse$1(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\n\nfunction normalize$3(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nfunction dot$3(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} result the receiving vector\n * @param {ReadonlyVec4} U the first vector\n * @param {ReadonlyVec4} V the second vector\n * @param {ReadonlyVec4} W the third vector\n * @returns {vec4} result\n */\n\nfunction cross$1(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\n\nfunction lerp$3(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec4} out\n */\n\nfunction random$2(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = RANDOM() * 2 - 1;\n    v2 = RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = RANDOM() * 2 - 1;\n    v4 = RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\n\nfunction transformMat4$1(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec4} out\n */\n\nfunction transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\n\nfunction zero$1(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nfunction str$3(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nfunction exactEquals$3(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nfunction equals$3(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\n\nvar sub$1 = subtract$1;\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\n\nvar mul$3 = multiply$3;\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\n\nvar div$1 = divide$1;\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\n\nvar dist$1 = distance$1;\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\n\nvar sqrDist$1 = squaredDistance$1;\n/**\n * Alias for {@link vec4.length}\n * @function\n */\n\nvar len$3 = length$3;\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\n\nvar sqrLen$3 = squaredLength$3;\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nvar forEach$1 = function () {\n  var vec = create$3();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();\n\nconst vec4 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$3,\n   ceil: ceil$1,\n   clone: clone$3,\n   copy: copy$3,\n   create: create$3,\n   cross: cross$1,\n   dist: dist$1,\n   distance: distance$1,\n   div: div$1,\n   divide: divide$1,\n   dot: dot$3,\n   equals: equals$3,\n   exactEquals: exactEquals$3,\n   floor: floor$1,\n   forEach: forEach$1,\n   fromValues: fromValues$3,\n   inverse: inverse$1,\n   len: len$3,\n   length: length$3,\n   lerp: lerp$3,\n   max: max$1,\n   min: min$1,\n   mul: mul$3,\n   multiply: multiply$3,\n   negate: negate$1,\n   normalize: normalize$3,\n   random: random$2,\n   round: round$1,\n   scale: scale$3,\n   scaleAndAdd: scaleAndAdd$1,\n   set: set$3,\n   sqrDist: sqrDist$1,\n   sqrLen: sqrLen$3,\n   squaredDistance: squaredDistance$1,\n   squaredLength: squaredLength$3,\n   str: str$3,\n   sub: sub$1,\n   subtract: subtract$1,\n   transformMat4: transformMat4$1,\n   transformQuat: transformQuat,\n   zero: zero$1\n});\n\n/**\n * Quaternion\n * @module quat\n */\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\n\nfunction create$2() {\n  var out = new ARRAY_TYPE(4);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\n * Set a quat to the identity quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\n\nfunction identity$1(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\n * Sets a quat from the given angle and rotation axis,\n * then returns it.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyVec3} axis the axis around which to rotate\n * @param {Number} rad the angle in radians\n * @returns {quat} out\n **/\n\nfunction setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\n * Gets the rotation axis and angle for a given\n *  quaternion. If a quaternion is created with\n *  setAxisAngle, this method will return the same\n *  values as providied in the original parameter list\n *  OR functionally equivalent values.\n * Example: The quaternion formed by axis [0, 0, 1] and\n *  angle -90 is the same as the quaternion formed by\n *  [0, 0, 1] and 270. This method favors the latter.\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\n * @return {Number}     Angle, in radians, of the rotation\n */\n\nfunction getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\n * Gets the angular distance between two unit quaternions\n *\n * @param  {ReadonlyQuat} a     Origin unit quaternion\n * @param  {ReadonlyQuat} b     Destination unit quaternion\n * @return {Number}     Angle, in radians, between the two quaternions\n */\n\nfunction getAngle(a, b) {\n  var dotproduct = dot$2(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\n * Multiplies two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n */\n\nfunction multiply$2(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nfunction rotateX$1(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nfunction rotateY$1(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the Z axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nfunction rotateZ$1(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\n * Calculates the W component of a quat from the X, Y, and Z components.\n * Assumes that quaternion is 1 unit in length.\n * Any existing W component will be ignored.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate W component of\n * @returns {quat} out\n */\n\nfunction calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\n * Calculate the exponential of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\n\nfunction exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\n * Calculate the natural logarithm of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\n\nfunction ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\n * Calculate the scalar power of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @param {Number} b amount to scale the quaternion by\n * @returns {quat} out\n */\n\nfunction pow(out, a, b) {\n  ln(out, a);\n  scale$2(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\n * Performs a spherical linear interpolation between two quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\n\nfunction slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\n * Generates a random unit quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\n\nfunction random$1(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = RANDOM();\n  var u2 = RANDOM();\n  var u3 = RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\n * Calculates the inverse of a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate inverse of\n * @returns {quat} out\n */\n\nfunction invert$1(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate conjugate of\n * @returns {quat} out\n */\n\nfunction conjugate$1(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a quaternion from the given 3x3 rotation matrix.\n *\n * NOTE: The resultant quaternion is not normalized, so you should be sure\n * to renormalize the quaternion yourself where necessary.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyMat3} m rotation matrix\n * @returns {quat} out\n * @function\n */\n\nfunction fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\n * Creates a quaternion from the given euler angle x, y, z.\n *\n * @param {quat} out the receiving quaternion\n * @param {x} Angle to rotate around X axis in degrees.\n * @param {y} Angle to rotate around Y axis in degrees.\n * @param {z} Angle to rotate around Z axis in degrees.\n * @returns {quat} out\n * @function\n */\n\nfunction fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\n * Returns a string representation of a quatenion\n *\n * @param {ReadonlyQuat} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nfunction str$2(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\n\nvar clone$2 = clone$3;\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\n\nvar fromValues$2 = fromValues$3;\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the source quaternion\n * @returns {quat} out\n * @function\n */\n\nvar copy$2 = copy$3;\n/**\n * Set the components of a quat to the given values\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} out\n * @function\n */\n\nvar set$2 = set$3;\n/**\n * Adds two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n * @function\n */\n\nvar add$2 = add$3;\n/**\n * Alias for {@link quat.multiply}\n * @function\n */\n\nvar mul$2 = multiply$2;\n/**\n * Scales a quat by a scalar number\n *\n * @param {quat} out the receiving vector\n * @param {ReadonlyQuat} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {quat} out\n * @function\n */\n\nvar scale$2 = scale$3;\n/**\n * Calculates the dot product of two quat's\n *\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\n\nvar dot$2 = dot$3;\n/**\n * Performs a linear interpolation between two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n * @function\n */\n\nvar lerp$2 = lerp$3;\n/**\n * Calculates the length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nvar length$2 = length$3;\n/**\n * Alias for {@link quat.length}\n * @function\n */\n\nvar len$2 = length$2;\n/**\n * Calculates the squared length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\n\nvar squaredLength$2 = squaredLength$3;\n/**\n * Alias for {@link quat.squaredLength}\n * @function\n */\n\nvar sqrLen$2 = squaredLength$2;\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\n\nvar normalize$2 = normalize$3;\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat} a The first quaternion.\n * @param {ReadonlyQuat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nvar exactEquals$2 = exactEquals$3;\n/**\n * Returns whether or not the quaternions have approximately the same elements in the same position.\n *\n * @param {ReadonlyQuat} a The first vector.\n * @param {ReadonlyQuat} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nvar equals$2 = equals$3;\n/**\n * Sets a quaternion to represent the shortest rotation from one\n * vector to another.\n *\n * Both vectors are assumed to be unit length.\n *\n * @param {quat} out the receiving quaternion.\n * @param {ReadonlyVec3} a the initial vector\n * @param {ReadonlyVec3} b the destination vector\n * @returns {quat} out\n */\n\nvar rotationTo = function () {\n  var tmpvec3 = create$4();\n  var xUnitVec3 = fromValues$4(1, 0, 0);\n  var yUnitVec3 = fromValues$4(0, 1, 0);\n  return function (out, a, b) {\n    var dot = dot$4(a, b);\n\n    if (dot < -0.999999) {\n      cross$2(tmpvec3, xUnitVec3, a);\n      if (len$4(tmpvec3) < 0.000001) cross$2(tmpvec3, yUnitVec3, a);\n      normalize$4(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      cross$2(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize$2(out, out);\n    }\n  };\n}();\n/**\n * Performs a spherical linear interpolation with two control points\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {ReadonlyQuat} c the third operand\n * @param {ReadonlyQuat} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\n\nvar sqlerp = function () {\n  var temp1 = create$2();\n  var temp2 = create$2();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\n * Sets the specified quaternion with values corresponding to the given\n * axes. Each axis is a vec3 and is expected to be unit length and\n * perpendicular to all other specified axes.\n *\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\n * @returns {quat} out\n */\n\nvar setAxes = function () {\n  var matr = create$6();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize$2(out, fromMat3(out, matr));\n  };\n}();\n\nconst quat = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$2,\n   calculateW: calculateW,\n   clone: clone$2,\n   conjugate: conjugate$1,\n   copy: copy$2,\n   create: create$2,\n   dot: dot$2,\n   equals: equals$2,\n   exactEquals: exactEquals$2,\n   exp: exp,\n   fromEuler: fromEuler,\n   fromMat3: fromMat3,\n   fromValues: fromValues$2,\n   getAngle: getAngle,\n   getAxisAngle: getAxisAngle,\n   identity: identity$1,\n   invert: invert$1,\n   len: len$2,\n   length: length$2,\n   lerp: lerp$2,\n   ln: ln,\n   mul: mul$2,\n   multiply: multiply$2,\n   normalize: normalize$2,\n   pow: pow,\n   random: random$1,\n   rotateX: rotateX$1,\n   rotateY: rotateY$1,\n   rotateZ: rotateZ$1,\n   rotationTo: rotationTo,\n   scale: scale$2,\n   set: set$2,\n   setAxes: setAxes,\n   setAxisAngle: setAxisAngle,\n   slerp: slerp,\n   sqlerp: sqlerp,\n   sqrLen: sqrLen$2,\n   squaredLength: squaredLength$2,\n   str: str$2\n});\n\n/**\n * Dual Quaternion<br>\n * Format: [real, dual]<br>\n * Quaternion format: XYZW<br>\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\n * @module quat2\n */\n\n/**\n * Creates a new identity dual quat\n *\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\n */\n\nfunction create$1() {\n  var dq = new ARRAY_TYPE(8);\n\n  if (ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n\n  dq[3] = 1;\n  return dq;\n}\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat2} a dual quaternion to clone\n * @returns {quat2} new dual quaternion\n * @function\n */\n\nfunction clone$1(a) {\n  var dq = new ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n/**\n * Creates a new dual quat initialized with the given values\n *\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component\n * @param {Number} y2 Y component\n * @param {Number} z2 Z component\n * @param {Number} w2 W component\n * @returns {quat2} new dual quaternion\n * @function\n */\n\nfunction fromValues$1(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n/**\n * Creates a new dual quat from the given values (quat and translation)\n *\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component (translation)\n * @param {Number} y2 Y component (translation)\n * @param {Number} z2 Z component (translation)\n * @returns {quat2} new dual quaternion\n * @function\n */\n\nfunction fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n      ay = y2 * 0.5,\n      az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n/**\n * Creates a dual quat from a quaternion and a translation\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyQuat} q a normalized quaternion\n * @param {ReadonlyVec3} t tranlation vector\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\n\nfunction fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n      ay = t[1] * 0.5,\n      az = t[2] * 0.5,\n      bx = q[0],\n      by = q[1],\n      bz = q[2],\n      bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\n * Creates a dual quat from a translation\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyVec3} t translation vector\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\n\nfunction fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n/**\n * Creates a dual quat from a quaternion\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyQuat} q the quaternion\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\n\nfunction fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\n * Creates a new dual quat from a matrix (4x4)\n *\n * @param {quat2} out the dual quaternion\n * @param {ReadonlyMat4} a the matrix\n * @returns {quat2} dual quat receiving operation result\n * @function\n */\n\nfunction fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = create$2();\n  getRotation(outer, a);\n  var t = new ARRAY_TYPE(3);\n  getTranslation$1(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n/**\n * Copy the values from one dual quat to another\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the source dual quaternion\n * @returns {quat2} out\n * @function\n */\n\nfunction copy$1(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\n * Set a dual quat to the identity dual quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @returns {quat2} out\n */\n\nfunction identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\n * Set the components of a dual quat to the given values\n *\n * @param {quat2} out the receiving quaternion\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component\n * @param {Number} y2 Y component\n * @param {Number} z2 Z component\n * @param {Number} w2 W component\n * @returns {quat2} out\n * @function\n */\n\nfunction set$1(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n/**\n * Gets the real part of a dual quat\n * @param  {quat} out real part\n * @param  {ReadonlyQuat2} a Dual Quaternion\n * @return {quat} real part\n */\n\nvar getReal = copy$2;\n/**\n * Gets the dual part of a dual quat\n * @param  {quat} out dual part\n * @param  {ReadonlyQuat2} a Dual Quaternion\n * @return {quat} dual part\n */\n\nfunction getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n/**\n * Set the real component of a dual quat to the given quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat} q a quaternion representing the real part\n * @returns {quat2} out\n * @function\n */\n\nvar setReal = copy$2;\n/**\n * Set the dual component of a dual quat to the given quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat} q a quaternion representing the dual part\n * @returns {quat2} out\n * @function\n */\n\nfunction setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n/**\n * Gets the translation of a normalized dual quat\n * @param  {vec3} out translation\n * @param  {ReadonlyQuat2} a Dual Quaternion to be decomposed\n * @return {vec3} translation\n */\n\nfunction getTranslation(out, a) {\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n/**\n * Translates a dual quat by the given vector\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {quat2} out\n */\n\nfunction translate(out, a, v) {\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3],\n      bx1 = v[0] * 0.5,\n      by1 = v[1] * 0.5,\n      bz1 = v[2] * 0.5,\n      ax2 = a[4],\n      ay2 = a[5],\n      az2 = a[6],\n      aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n/**\n * Rotates a dual quat around the X axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\n\nfunction rotateX(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  rotateX$1(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\n * Rotates a dual quat around the Y axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\n\nfunction rotateY(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  rotateY$1(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\n * Rotates a dual quat around the Z axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\n\nfunction rotateZ(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  rotateZ$1(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\n * Rotates a dual quat by a given quaternion (a * q)\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {ReadonlyQuat} q quaternion to rotate by\n * @returns {quat2} out\n */\n\nfunction rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n/**\n * Rotates a dual quat by a given quaternion (q * a)\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat} q quaternion to rotate by\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @returns {quat2} out\n */\n\nfunction rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      bx = a[0],\n      by = a[1],\n      bz = a[2],\n      bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n/**\n * Rotates a dual quat around a given axis. Does the normalisation automatically\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @param {Number} rad how far the rotation should be\n * @returns {quat2} out\n */\n\nfunction rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < EPSILON) {\n    return copy$1(out, a);\n  }\n\n  var axisLength = Math.hypot(axis[0], axis[1], axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\n * Adds two dual quat's\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {quat2} out\n * @function\n */\n\nfunction add$1(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n/**\n * Multiplies two dual quat's\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {quat2} out\n */\n\nfunction multiply$1(out, a, b) {\n  var ax0 = a[0],\n      ay0 = a[1],\n      az0 = a[2],\n      aw0 = a[3],\n      bx1 = b[4],\n      by1 = b[5],\n      bz1 = b[6],\n      bw1 = b[7],\n      ax1 = a[4],\n      ay1 = a[5],\n      az1 = a[6],\n      aw1 = a[7],\n      bx0 = b[0],\n      by0 = b[1],\n      bz0 = b[2],\n      bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n/**\n * Alias for {@link quat2.multiply}\n * @function\n */\n\nvar mul$1 = multiply$1;\n/**\n * Scales a dual quat by a scalar number\n *\n * @param {quat2} out the receiving dual quat\n * @param {ReadonlyQuat2} a the dual quat to scale\n * @param {Number} b amount to scale the dual quat by\n * @returns {quat2} out\n * @function\n */\n\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n/**\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\n *\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\n\nvar dot$1 = dot$2;\n/**\n * Performs a linear interpolation between two dual quats's\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\n *\n * @param {quat2} out the receiving dual quat\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat2} out\n */\n\nfunction lerp$1(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot$1(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n/**\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a dual quat to calculate inverse of\n * @returns {quat2} out\n */\n\nfunction invert(out, a) {\n  var sqlen = squaredLength$1(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n/**\n * Calculates the conjugate of a dual quat\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat2} a quat to calculate conjugate of\n * @returns {quat2} out\n */\n\nfunction conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\n * Calculates the length of a dual quat\n *\n * @param {ReadonlyQuat2} a dual quat to calculate length of\n * @returns {Number} length of a\n * @function\n */\n\nvar length$1 = length$2;\n/**\n * Alias for {@link quat2.length}\n * @function\n */\n\nvar len$1 = length$1;\n/**\n * Calculates the squared length of a dual quat\n *\n * @param {ReadonlyQuat2} a dual quat to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\n\nvar squaredLength$1 = squaredLength$2;\n/**\n * Alias for {@link quat2.squaredLength}\n * @function\n */\n\nvar sqrLen$1 = squaredLength$1;\n/**\n * Normalize a dual quat\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a dual quaternion to normalize\n * @returns {quat2} out\n * @function\n */\n\nfunction normalize$1(out, a) {\n  var magnitude = squaredLength$1(a);\n\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n\n  return out;\n}\n/**\n * Returns a string representation of a dual quatenion\n *\n * @param {ReadonlyQuat2} a dual quaternion to represent as a string\n * @returns {String} string representation of the dual quat\n */\n\nfunction str$1(a) {\n  return \"quat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \")\";\n}\n/**\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat2} a the first dual quaternion.\n * @param {ReadonlyQuat2} b the second dual quaternion.\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\n */\n\nfunction exactEquals$1(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n/**\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\n *\n * @param {ReadonlyQuat2} a the first dual quat.\n * @param {ReadonlyQuat2} b the second dual quat.\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\n */\n\nfunction equals$1(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}\n\nconst quat2 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add$1,\n   clone: clone$1,\n   conjugate: conjugate,\n   copy: copy$1,\n   create: create$1,\n   dot: dot$1,\n   equals: equals$1,\n   exactEquals: exactEquals$1,\n   fromMat4: fromMat4,\n   fromRotation: fromRotation,\n   fromRotationTranslation: fromRotationTranslation,\n   fromRotationTranslationValues: fromRotationTranslationValues,\n   fromTranslation: fromTranslation,\n   fromValues: fromValues$1,\n   getDual: getDual,\n   getReal: getReal,\n   getTranslation: getTranslation,\n   identity: identity,\n   invert: invert,\n   len: len$1,\n   length: length$1,\n   lerp: lerp$1,\n   mul: mul$1,\n   multiply: multiply$1,\n   normalize: normalize$1,\n   rotateAroundAxis: rotateAroundAxis,\n   rotateByQuatAppend: rotateByQuatAppend,\n   rotateByQuatPrepend: rotateByQuatPrepend,\n   rotateX: rotateX,\n   rotateY: rotateY,\n   rotateZ: rotateZ,\n   scale: scale$1,\n   set: set$1,\n   setDual: setDual,\n   setReal: setReal,\n   sqrLen: sqrLen$1,\n   squaredLength: squaredLength$1,\n   str: str$1,\n   translate: translate\n});\n\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\n\nfunction create() {\n  var out = new ARRAY_TYPE(2);\n\n  if (ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\n\nfunction clone(a) {\n  var out = new ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\n\nfunction fromValues(x, y) {\n  var out = new ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\n\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\n\nfunction set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nfunction multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nfunction divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\n\nfunction ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\n\nfunction floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nfunction min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nfunction max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\n * Math.round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\n\nfunction round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\n\nfunction scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\n\nfunction scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\n\nfunction distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nfunction squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nfunction length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nfunction squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\n\nfunction negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\n\nfunction inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\n\nfunction normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\n\nfunction cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\n\nfunction lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec2} out\n */\n\nfunction random(out, scale) {\n  scale = scale || 1.0;\n  var r = RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\n\nfunction transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\n\nfunction transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\n\nfunction transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\n\nfunction transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\n\nfunction rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\n * Get the angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\n\nfunction angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\n\nfunction zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nfunction str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nfunction exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nfunction equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\n * Alias for {@link vec2.length}\n * @function\n */\n\nvar len = length;\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\n\nvar sub = subtract;\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\n\nvar mul = multiply;\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\n\nvar div = divide;\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\n\nvar dist = distance;\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\n\nvar sqrDist = squaredDistance;\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\n\nvar sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nvar forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();\n\nconst vec2 = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   add: add,\n   angle: angle,\n   ceil: ceil,\n   clone: clone,\n   copy: copy,\n   create: create,\n   cross: cross,\n   dist: dist,\n   distance: distance,\n   div: div,\n   divide: divide,\n   dot: dot,\n   equals: equals,\n   exactEquals: exactEquals,\n   floor: floor,\n   forEach: forEach,\n   fromValues: fromValues,\n   inverse: inverse,\n   len: len,\n   length: length,\n   lerp: lerp,\n   max: max,\n   min: min,\n   mul: mul,\n   multiply: multiply,\n   negate: negate,\n   normalize: normalize,\n   random: random,\n   rotate: rotate,\n   round: round,\n   scale: scale,\n   scaleAndAdd: scaleAndAdd,\n   set: set,\n   sqrDist: sqrDist,\n   sqrLen: sqrLen,\n   squaredDistance: squaredDistance,\n   squaredLength: squaredLength,\n   str: str,\n   sub: sub,\n   subtract: subtract,\n   transformMat2: transformMat2,\n   transformMat2d: transformMat2d,\n   transformMat3: transformMat3,\n   transformMat4: transformMat4,\n   zero: zero\n});\n\n/**\n * Provides a way to calculate velocity via effectively creating a \"complementary filter\".\n *\n * `velQuick` and `velSmooth` separately accumulate over time. `velInstant` and `velUsed` do not accumulate and are\n * discarded each update. `velQuick` is responsive, but noisy. `velSmooth` is laggy but eventually more accurate. By\n * tracking them separately the used result can be responsive in the short term and accurate in the long term.\n *\n * TODO: This class will be moved to a final location in the @typhonjs-svelte/lib/math package.\n */\nclass TJSVelocityTrack\n{\n   /** @type {number} */\n   #lastSampleTime;\n\n   /**\n    * Tracks the last sample point.\n    *\n    * @type {{x: number, y: number, z: number}}\n    */\n   #lastSamplePoint = { x: 0, y: 0, z: 0 };\n\n   /**\n    * Defines the settle time in milliseconds that resets any tracked velocity state.\n    *\n    * @type {number}\n    */\n   #resetDeltaTime;\n\n   /**\n    * Stores the scaling conversion for used velocity calculation. By default, this is 1000 which converts the velocity\n    * calculation to velocity per second. Set to `1` for instance for velocity per millisecond.\n    *\n    * @type {number}\n    */\n   #scaleTime;\n\n   /**\n    * Stores the instant velocity between current and last sample point.\n    *\n    * @type {{x: number, y: number, z: number}}\n    */\n   #velInstant = { x: 0, y: 0, z: 0 };\n\n   /**\n    * Stores the `quick` running calculated velocity.\n    *\n    * @type {{x: number, y: number, z: number}}\n    */\n   #velQuick = { x: 0, y: 0, z: 0 };\n\n   /**\n    * Stores the `smooth` running calculated velocity.\n    *\n    * @type {{x: number, y: number, z: number}}\n    */\n   #velSmooth = { x: 0, y: 0, z: 0 };\n\n   /**\n    * Stores the mix between `quick` and `smooth` running velocity.\n    *\n    * @type {{x: number, y: number, z: number}}\n    */\n   #velUsed = { x: 0, y: 0, z: 0 };\n\n   /**\n    * Creates a velocity tracker instance.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {number}   [opts.resetDeltaTime=50] - Delta time in milliseconds that resets velocity tracking.\n    *\n    * @param {number}   [opts.scaleTime=1000] - Scales velocity calculation to new time frame. 1000 is velocity per\n    *                                           second.\n    */\n   constructor({ resetDeltaTime = 50, scaleTime = 1000 } = {})\n   {\n      this.resetDeltaTime = resetDeltaTime;\n      this.scaleTime = scaleTime;\n\n      Object.seal(this.#velUsed);\n   }\n\n   /**\n    * @returns {number} Gets `resetDeltaTime`.\n    */\n   get resetDeltaTime() { return this.#resetDeltaTime; }\n\n   /**\n    * @returns {number} Gets `scaleTime`.\n    */\n   get scaleTime() { return this.#scaleTime; }\n\n   /**\n    * Sets `resetDeltaTime`.\n    *\n    * @param {number}   resetDeltaTime - Delta time in milliseconds that resets velocity tracking.\n    */\n   set resetDeltaTime(resetDeltaTime)\n   {\n      if (!Number.isFinite(resetDeltaTime) || resetDeltaTime < 0)\n      {\n         throw new TypeError(`'resetDeltaTime' is not a positive finite number.`);\n      }\n\n      this.#resetDeltaTime = resetDeltaTime;\n   }\n\n   /**\n    * Sets `scaleTime`.\n    *\n    * @param {number}   scaleTime - Scales velocity calculation to new time frame. 1000 is velocity per second.\n    */\n   set scaleTime(scaleTime)\n   {\n      if (!Number.isFinite(scaleTime) || scaleTime < 0)\n      {\n         throw new TypeError(`'scaleTime' is not a positive finite number.`);\n      }\n\n      this.#scaleTime = scaleTime;\n   }\n\n   /**\n    * Resets velocity tracking data.\n    *\n    * @param {number}   [x=0] - 'X' value to set to last sample point.\n    *\n    * @param {number}   [y=0] - 'Y' value to set to last sample point.\n    *\n    * @param {number}   [z=0] - 'Z' value to set to last sample point.\n    *\n    * @param {number}   [sampleTime=performance.now()] - A sample time in milliseconds resolution.\n    */\n   reset(x = 0, y = 0, z = 0, sampleTime = performance.now())\n   {\n      if (!Number.isFinite(x)) { throw new TypeError(`'x' is not a finite number.`); }\n      if (!Number.isFinite(y)) { throw new TypeError(`'y' is not a finite number.`); }\n      if (!Number.isFinite(z)) { throw new TypeError(`'z' is not a finite number.`); }\n      if (!Number.isFinite(sampleTime)) { throw new TypeError(`'sampleTime' is not a finite number.`); }\n\n      // Reset velocity tracking variables.\n      this.#lastSampleTime = sampleTime;\n\n      this.#lastSamplePoint.x = x;\n      this.#lastSamplePoint.y = y;\n      this.#lastSamplePoint.z = z;\n\n      this.#velInstant.x = this.#velQuick.x = this.#velSmooth.x = this.#velUsed.x = 0;\n      this.#velInstant.y = this.#velQuick.y = this.#velSmooth.y = this.#velUsed.y = 0;\n      this.#velInstant.z = this.#velQuick.z = this.#velSmooth.z = this.#velUsed.z = 0;\n   }\n\n   /**\n    * Runs ongoing velocity calculation of x / y / z given a sample time.\n    *\n    * @param {number|undefined}  x - New sample X\n    *\n    * @param {number|undefined}  y - New sample Y\n    *\n    * @param {number|undefined}  z - New sample Z\n    *\n    * @param {number}            [sampleTime=performance.now()] - An optional specific time w/ millisecond resolution.\n    *\n    * @returns {{x: number, y: number, z: number}} current velocity.\n    */\n   update(x = void 0, y = void 0, z = void 0, sampleTime = performance.now())\n   {\n      if (!Number.isFinite(sampleTime)) { throw new TypeError(`'sampleTime' is not a finite number.`); }\n\n      const deltaTime = sampleTime - this.#lastSampleTime + Number.EPSILON;\n      this.#lastSampleTime = sampleTime;\n\n      // Reset velocity tracking if the delta time is greater than `resetDeltaTime`.\n      if (deltaTime > this.#resetDeltaTime)\n      {\n         this.reset(x, y, z, sampleTime);\n         return this.#velUsed;\n      }\n\n      if (Number.isFinite(x))\n      {\n         this.#velInstant.x = (x - this.#lastSamplePoint.x) / deltaTime;\n\n         this.#lastSamplePoint.x = x;\n\n         this.#velQuick.x = lerp$5(this.#velQuick.x, this.#velInstant.x, 0.1);\n         this.#velSmooth.x = lerp$5(this.#velSmooth.x, this.#velInstant.x, 0.01);\n         this.#velUsed.x = lerp$5(this.#velSmooth.x, this.#velQuick.x, 0.5) * this.#scaleTime;\n      }\n\n      if (Number.isFinite(y))\n      {\n         this.#velInstant.y = (y - this.#lastSamplePoint.y) / deltaTime;\n\n         this.#lastSamplePoint.y = y;\n\n         this.#velQuick.y = lerp$5(this.#velQuick.y, this.#velInstant.y, 0.1);\n         this.#velSmooth.y = lerp$5(this.#velSmooth.y, this.#velInstant.y, 0.01);\n\n         this.#velUsed.y = lerp$5(this.#velSmooth.y, this.#velQuick.y, 0.5) * this.#scaleTime;\n      }\n\n      if (Number.isFinite(z))\n      {\n         this.#velInstant.z = (z - this.#lastSamplePoint.z) / deltaTime;\n\n         this.#lastSamplePoint.z = z;\n\n         this.#velQuick.z = lerp$5(this.#velQuick.z, this.#velInstant.z, 0.1);\n         this.#velSmooth.z = lerp$5(this.#velSmooth.z, this.#velInstant.z, 0.01);\n         this.#velUsed.z = lerp$5(this.#velSmooth.z, this.#velQuick.z, 0.5) * this.#scaleTime;\n      }\n\n      return this.#velUsed;\n   }\n\n   /**\n    * Gets the current velocity tracking data.\n    *\n    * @returns {{x: number, y: number, z: number}} Velocity tracking data.\n    */\n   get()\n   {\n      this.#velUsed.x = lerp$5(this.#velSmooth.x, this.#velQuick.x, 0.5) * this.#scaleTime;\n      this.#velUsed.y = lerp$5(this.#velSmooth.y, this.#velQuick.y, 0.5) * this.#scaleTime;\n      this.#velUsed.z = lerp$5(this.#velSmooth.z, this.#velQuick.z, 0.5) * this.#scaleTime;\n\n      return this.#velUsed;\n   }\n}\n\nexport { TJSVelocityTrack, degToRad, common as glMatrix, lerp$5 as lerp, mat2, mat2d, mat3, mat4, quat, quat2, radToDeg, vec2, vec3, vec4 };\n//# sourceMappingURL=index.js.map\n","import { isObject } from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Provides a basic {@link TJSBasicAnimation} implementation for Position animation.\n */\nexport class AnimationControl\n{\n   /** @type {object} */\n   #animationData;\n\n   /** @type {Promise<void>} */\n   #finishedPromise;\n\n   #willFinish;\n\n   /**\n    * Defines a static empty / void animation control.\n    *\n    * @type {AnimationControl}\n    */\n   static #voidControl = new AnimationControl(null);\n\n   /**\n    * Provides a static void / undefined AnimationControl that is automatically resolved.\n    *\n    * @returns {AnimationControl} Void AnimationControl\n    */\n   static get voidControl() { return this.#voidControl; }\n\n   /**\n    * @param {object|null} [animationData] - Animation data from {@link AnimationAPI}.\n    *\n    * @param {boolean}     [willFinish] - Promise that tracks animation finished state.\n    */\n   constructor(animationData, willFinish = false)\n   {\n      this.#animationData = animationData;\n      this.#willFinish = willFinish;\n\n      // Set this control to animation data.\n      if (isObject(animationData)) { animationData.control = this; }\n   }\n\n   /**\n    * Get a promise that resolves when animation is finished.\n    *\n    * @returns {Promise<void>}\n    */\n   get finished()\n   {\n      if (!(this.#finishedPromise instanceof Promise))\n      {\n         this.#finishedPromise = this.#willFinish ? new Promise((resolve) => this.#animationData.resolve = resolve) :\n          Promise.resolve();\n      }\n\n      return this.#finishedPromise;\n   }\n\n   /**\n    * Returns whether this animation is currently active / animating.\n    *\n    * Note: a delayed animation may not be started / active yet. Use {@link AnimationControl.isFinished} to determine\n    * if an animation is actually finished.\n    *\n    * @returns {boolean} Animation active state.\n    */\n   get isActive() { return this.#animationData.active; }\n\n   /**\n    * Returns whether this animation is completely finished.\n    *\n    * @returns {boolean} Animation finished state.\n    */\n   get isFinished() { return this.#animationData.finished; }\n\n   /**\n    * Cancels the animation.\n    */\n   cancel()\n   {\n      const animationData = this.#animationData;\n\n      if (animationData === null || animationData === void 0) { return; }\n\n      // Set cancelled state to true and this animation data instance will be removed from AnimationManager on next\n      // update.\n      animationData.cancelled = true;\n   }\n}\n","/**\n * Provides animation management and scheduling allowing all Position instances to utilize one micro-task.\n */\nexport class AnimationManager\n{\n   /**\n    * @type {object[]}\n    */\n   static activeList = [];\n\n   /**\n    * @type {object[]}\n    */\n   static newList = [];\n\n   /**\n    * @type {number}\n    */\n   static current;\n\n   /**\n    * Add animation data.\n    *\n    * @param {object}   data -\n    */\n   static add(data)\n   {\n      const now = performance.now();\n\n      // Offset start time by delta between last rAF time. This allows continuous tween cycles to appear naturally as\n      // starting from the instant they are added to the AnimationManager. This is what makes `draggable` smooth when\n      // easing is enabled.\n      data.start = now + (AnimationManager.current - now);\n\n      AnimationManager.newList.push(data);\n   }\n\n   /**\n    * Manage all animation\n    */\n   static animate()\n   {\n      const current = AnimationManager.current = performance.now();\n\n      // Early out of the rAF callback when there are no current animations.\n      if (AnimationManager.activeList.length === 0 && AnimationManager.newList.length === 0)\n      {\n         globalThis.requestAnimationFrame(AnimationManager.animate);\n         return;\n      }\n\n      if (AnimationManager.newList.length)\n      {\n         // Process new data\n         for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n         {\n            const data = AnimationManager.newList[cntr];\n\n            // If animation instance has been cancelled before start then remove it from new list and cleanup.\n            if (data.cancelled)\n            {\n               AnimationManager.newList.splice(cntr, 1);\n               data.cleanup(data);\n            }\n\n            // If data is active then process it now. Delayed animations start with `active` false.\n            if (data.active)\n            {\n               // Remove from new list and add to active list.\n               AnimationManager.newList.splice(cntr, 1);\n               AnimationManager.activeList.push(data);\n            }\n         }\n      }\n\n      // Process active animations.\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n\n         // Remove any animations that have been canceled.\n         // Ensure that the element is still connected otherwise remove it from active list and continue.\n         if (data.cancelled || (data.el !== void 0 && !data.el.isConnected))\n         {\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cleanup(data);\n            continue;\n         }\n\n         data.current = current - data.start;\n\n         // Remove this animation instance if current animating time exceeds duration.\n         if (data.current >= data.duration)\n         {\n            // Prepare final update with end position data.\n            for (let dataCntr = data.keys.length; --dataCntr >= 0;)\n            {\n               const key = data.keys[dataCntr];\n               data.newData[key] = data.destination[key];\n            }\n\n            data.position.set(data.newData);\n\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cleanup(data);\n\n            continue;\n         }\n\n         // Apply easing to create an eased time.\n         const easedTime = data.ease(data.current / data.duration);\n\n         for (let dataCntr = data.keys.length; --dataCntr >= 0;)\n         {\n            const key = data.keys[dataCntr];\n            data.newData[key] = data.interpolate(data.initial[key], data.destination[key], easedTime);\n         }\n\n         data.position.set(data.newData);\n      }\n\n      globalThis.requestAnimationFrame(AnimationManager.animate);\n   }\n\n   /**\n    * Cancels all animations for given Position instance.\n    *\n    * @param {Position} position - Position instance.\n    */\n   static cancel(position)\n   {\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         if (data.position === position)\n         {\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cancelled = true;\n            data.cleanup(data);\n         }\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         if (data.position === position)\n         {\n            AnimationManager.newList.splice(cntr, 1);\n            data.cancelled = true;\n            data.cleanup(data);\n         }\n      }\n   }\n\n   /**\n    * Cancels all active and delayed animations.\n    */\n   static cancelAll()\n   {\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         data.cancelled = true;\n         data.cleanup(data);\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         data.cancelled = true;\n         data.cleanup(data);\n      }\n\n      AnimationManager.activeList.length = 0;\n      AnimationManager.newList.length = 0;\n   }\n\n   /**\n    * Gets all {@link AnimationControl} instances for a given Position instance.\n    *\n    * @param {Position} position - Position instance.\n    *\n    * @returns {AnimationControl[]} All scheduled AnimationControl instances for the given Position instance.\n    */\n   static getScheduled(position)\n   {\n      const results = [];\n\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         if (data.position === position)\n         {\n            results.push(data.control);\n         }\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         if (data.position === position)\n         {\n            results.push(data.control);\n         }\n      }\n\n      return results;\n   }\n}\n\n// Start animation manager immediately. It constantly is running in background.\nAnimationManager.animate();\n","/**\n * Stores the PositionData properties that can be animated.\n *\n * @type {Set<string>}\n */\nconst animateKeys = new Set([\n   // Main keys\n   'left', 'top', 'maxWidth', 'maxHeight', 'minWidth', 'minHeight', 'width', 'height',\n   'rotateX', 'rotateY', 'rotateZ', 'scale', 'translateX', 'translateY', 'translateZ', 'zIndex',\n\n   // Aliases\n   'rotation'\n]);\n\n/**\n * Defines the keys of PositionData that are transform keys.\n *\n * @type {string[]}\n */\nconst transformKeys = ['rotateX', 'rotateY', 'rotateZ', 'scale', 'translateX', 'translateY', 'translateZ'];\n\nObject.freeze(transformKeys);\n\n/**\n * Parses a relative value string in the form of '+=', '-=', or '*=' and float / numeric value. IE '+=0.2'.\n *\n * @type {RegExp}\n */\nconst relativeRegex = /^([-+*])=(-?[\\d]*\\.?[\\d]+)$/;\n\n/**\n * Provides numeric defaults for all parameters. This is used by {@link Position.get} to optionally provide\n * numeric defaults.\n *\n * @type {{rotation: number, scale: number, minWidth: null, minHeight: null, translateZ: number, top: number, left: number, maxHeight: null, translateY: number, translateX: number, width: number, transformOrigin: null, rotateX: number, rotateY: number, height: number, maxWidth: null, zIndex: null, rotateZ: number}}\n */\nconst numericDefaults = {\n   // Other keys\n   height: 0,\n   left: 0,\n   maxHeight: null,\n   maxWidth: null,\n   minHeight: null,\n   minWidth: null,\n   top: 0,\n   transformOrigin: null,\n   width: 0,\n   zIndex: null,\n\n   rotateX: 0,\n   rotateY: 0,\n   rotateZ: 0,\n   scale: 1,\n   translateX: 0,\n   translateY: 0,\n   translateZ: 0,\n\n   rotation: 0\n};\n\nObject.freeze(numericDefaults);\n\n/**\n * Sets numeric defaults for a {@link PositionData} like object.\n *\n * @param {object}   data - A PositionData like object.\n */\nfunction setNumericDefaults(data)\n{\n   // Transform keys\n   if (data.rotateX === null) { data.rotateX = 0; }\n   if (data.rotateY === null) { data.rotateY = 0; }\n   if (data.rotateZ === null) { data.rotateZ = 0; }\n   if (data.translateX === null) { data.translateX = 0; }\n   if (data.translateY === null) { data.translateY = 0; }\n   if (data.translateZ === null) { data.translateZ = 0; }\n   if (data.scale === null) { data.scale = 1; }\n\n   // Aliases\n   if (data.rotation === null) { data.rotation = 0; }\n}\n\n/**\n * Defines bitwise keys for transforms used in {@link Transforms.getMat4}.\n *\n * @type {object}\n */\nconst transformKeysBitwise = {\n   rotateX: 1,\n   rotateY: 2,\n   rotateZ: 4,\n   scale: 8,\n   translateX: 16,\n   translateY: 32,\n   translateZ: 64\n};\n\nObject.freeze(transformKeysBitwise);\n\n/**\n * Defines the default transform origin.\n *\n * @type {string}\n */\nconst transformOriginDefault = 'top left';\n\n/**\n * Defines the valid transform origins.\n *\n * @type {string[]}\n */\nconst transformOrigins = ['top left', 'top center', 'top right', 'center left', 'center', 'center right', 'bottom left',\n 'bottom center', 'bottom right'];\n\nObject.freeze(transformOrigins);\n\nexport {\n   animateKeys,\n   numericDefaults,\n   relativeRegex,\n   setNumericDefaults,\n   transformKeys,\n   transformKeysBitwise,\n   transformOriginDefault,\n   transformOrigins\n};\n","import * as constants from './constants.js';\n\n/**\n * Converts any relative string values for animatable keys to actual updates performed against current data.\n *\n * @param {PositionDataExtended}    positionData - position data.\n *\n * @param {Position|PositionData}   position - The source position instance.\n */\nexport function convertRelative(positionData, position)\n{\n   for (const key in positionData)\n   {\n      // Key is animatable / numeric.\n      if (constants.animateKeys.has(key))\n      {\n         const value = positionData[key];\n\n         if (typeof value !== 'string') { continue; }\n\n         // Ignore 'auto' and 'inherit' string values.\n         if (value === 'auto' || value === 'inherit') { continue; }\n\n         const regexResults = constants.relativeRegex.exec(value);\n\n         if (!regexResults)\n         {\n            throw new Error(\n             `convertRelative error: malformed relative key (${key}) with value (${value})`);\n         }\n\n         const current = position[key];\n\n         switch (regexResults[1])\n         {\n            case '-':\n               positionData[key] = current - parseFloat(regexResults[2]);\n               break;\n\n            case '+':\n               positionData[key] = current + parseFloat(regexResults[2]);\n               break;\n\n            case '*':\n               positionData[key] = current * parseFloat(regexResults[2]);\n               break;\n         }\n      }\n   }\n}\n","import { cubicOut }           from 'svelte/easing';\n\nimport { lerp }               from '@typhonjs-fvtt/runtime/svelte/math';\nimport {\n   isIterable,\n   isObject }                 from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { AnimationControl }   from './AnimationControl.js';\nimport { AnimationManager }   from './AnimationManager.js';\n\nimport { convertRelative }    from '../convertRelative.js';\n\nimport {\n   animateKeys,\n   setNumericDefaults }       from '../constants.js';\n\nexport class AnimationAPI\n{\n   /** @type {PositionData} */\n   #data;\n\n   /** @type {Position} */\n   #position;\n\n   /**\n    * Tracks the number of animation control instances that are active.\n    *\n    * @type {number}\n    */\n   #instanceCount = 0;\n\n   /**\n    * Provides a bound function to pass as data to AnimationManager to invoke\n    *\n    * @type {Function}\n    * @see {AnimationAPI.#cleanupInstance}\n    */\n   #cleanup;\n\n   constructor(position, data)\n   {\n      this.#position = position;\n      this.#data = data;\n\n      this.#cleanup = this.#cleanupInstance.bind(this);\n   }\n\n   /**\n    * Returns whether there are scheduled animations whether active or delayed for this Position.\n    *\n    * @returns {boolean} Are there active animation instances.\n    */\n   get isScheduled()\n   {\n      return this.#instanceCount > 0;\n   }\n\n   /**\n    * Adds / schedules an animation w/ the AnimationManager. This contains the final steps common to all tweens.\n    *\n    * @param {object}      initial -\n    *\n    * @param {object}      destination -\n    *\n    * @param {number}      duration -\n    *\n    * @param {HTMLElement} el -\n    *\n    * @param {number}      delay -\n    *\n    * @param {Function}    ease -\n    *\n    * @param {Function}    interpolate -\n    *\n    * @returns {AnimationControl} The associated animation control.\n    */\n   #addAnimation(initial, destination, duration, el, delay, ease, interpolate)\n   {\n      // Set initial data for transform values that are often null by default.\n      setNumericDefaults(initial);\n      setNumericDefaults(destination);\n\n      // Reject all initial data that is not a number.\n      for (const key in initial)\n      {\n         if (!Number.isFinite(initial[key])) { delete initial[key]; }\n      }\n\n      const keys = Object.keys(initial);\n      const newData = Object.assign({ immediateElementUpdate: true }, initial);\n\n      // Nothing to animate, so return now.\n      if (keys.length === 0) { return AnimationControl.voidControl; }\n\n      const animationData = {\n         active: true,\n         cleanup: this.#cleanup,\n         cancelled: false,\n         control: void 0,\n         current: 0,\n         destination,\n         duration: duration * 1000, // Internally the AnimationManager works in ms.\n         ease,\n         el,\n         finished: false,\n         initial,\n         interpolate,\n         keys,\n         newData,\n         position: this.#position,\n         resolve: void 0,\n         start: void 0\n      };\n\n      if (delay > 0)\n      {\n         animationData.active = false;\n\n         // Delay w/ setTimeout and schedule w/ AnimationManager if not already canceled\n         setTimeout(() =>\n         {\n            if (!animationData.cancelled)\n            {\n               animationData.active = true;\n\n               const now = performance.now();\n\n               // Offset start time by delta between last rAF time. This allows a delayed tween to start from the\n               // precise delayed time.\n               animationData.start = now + (AnimationManager.current - now);\n            }\n         }, delay * 1000);\n      }\n\n      // Schedule immediately w/ AnimationManager\n      this.#instanceCount++;\n      AnimationManager.add(animationData);\n\n      // Create animation control\n      return new AnimationControl(animationData, true);\n   }\n\n   /**\n    * Cancels all animation instances for this Position instance.\n    */\n   cancel()\n   {\n      AnimationManager.cancel(this.#position);\n   }\n\n   /**\n    * Cleans up an animation instance.\n    *\n    * @param {object}   data - Animation data for an animation instance.\n    */\n   #cleanupInstance(data)\n   {\n      this.#instanceCount--;\n\n      data.active = false;\n      data.finished = true;\n\n      if (typeof data.resolve === 'function') { data.resolve(data.cancelled); }\n   }\n\n   /**\n    * Returns all currently scheduled AnimationControl instances for this Position instance.\n    *\n    * @returns {AnimationControl[]} All currently scheduled animation controls for this Position instance.\n    */\n   getScheduled()\n   {\n      return AnimationManager.getScheduled(this.#position);\n   }\n\n   /**\n    * Provides a tween from given position data to the current position.\n    *\n    * @param {PositionDataExtended} fromData - The starting position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {AnimationControl}  A control object that can cancel animation and provides a `finished` Promise.\n    */\n   from(fromData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(fromData))\n      {\n         throw new TypeError(`AnimationAPI.from error: 'fromData' is not an object.`);\n      }\n\n      const position = this.#position;\n      const parent = position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.from error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.from error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.from error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.from error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in fromData)\n      {\n         if (data[key] !== void 0 && fromData[key] !== data[key])\n         {\n            initial[key] = fromData[key];\n            destination[key] = data[key];\n         }\n      }\n\n      convertRelative(initial, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Provides a tween from given position data to the current position.\n    *\n    * @param {PositionDataExtended} fromData - The starting position.\n    *\n    * @param {PositionDataExtended} toData - The ending position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {AnimationControl}  A control object that can cancel animation and provides a `finished` Promise.\n    */\n   fromTo(fromData, toData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(fromData))\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'fromData' is not an object.`);\n      }\n\n      if (!isObject(toData))\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'toData' is not an object.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in fromData)\n      {\n         if (toData[key] === void 0)\n         {\n            console.warn(\n             `AnimationAPI.fromTo warning: key ('${key}') from 'fromData' missing in 'toData'; skipping this key.`);\n            continue;\n         }\n\n         if (data[key] !== void 0)\n         {\n            initial[key] = fromData[key];\n            destination[key] = toData[key];\n         }\n      }\n\n      convertRelative(initial, data);\n      convertRelative(destination, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Provides a tween to given position data from the current position.\n    *\n    * @param {PositionDataExtended} toData - The destination position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {AnimationControl}  A control object that can cancel animation and provides a `finished` Promise.\n    */\n   to(toData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(toData))\n      {\n         throw new TypeError(`AnimationAPI.to error: 'toData' is not an object.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.to error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.to error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.to error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.to error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in toData)\n      {\n         if (data[key] !== void 0 && toData[key] !== data[key])\n         {\n            destination[key] = toData[key];\n            initial[key] = data[key];\n         }\n      }\n\n      convertRelative(destination, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Returns a function that provides an optimized way to constantly update a to-tween.\n    *\n    * @param {Iterable<string>}  keys - The keys for quickTo.\n    *\n    * @param {object}            [opts] - Optional parameters.\n    *\n    * @param {number}            [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}          [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}          [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {quickToCallback} quick-to tween function.\n    */\n   quickTo(keys, { duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isIterable(keys))\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'keys' is not an iterable list.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         throw new Error(`AnimationAPI.quickTo error: 'parent' is not positionable.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key of keys)\n      {\n         if (typeof key !== 'string')\n         {\n            throw new TypeError(`AnimationAPI.quickTo error: key is not a string.`);\n         }\n\n         if (!animateKeys.has(key))\n         {\n            throw new Error(`AnimationAPI.quickTo error: key ('${key}') is not animatable.`);\n         }\n\n         if (data[key] !== void 0)\n         {\n            destination[key] = data[key];\n            initial[key] = data[key];\n         }\n      }\n\n      const keysArray = [...keys];\n\n      Object.freeze(keysArray);\n\n      const newData = Object.assign({ immediateElementUpdate: true }, initial);\n\n      const animationData = {\n         active: true,\n         cleanup: this.#cleanup,\n         cancelled: false,\n         control: void 0,\n         current: 0,\n         destination,\n         duration: duration * 1000, // Internally the AnimationManager works in ms.\n         ease,\n         el: void 0,\n         finished: true, // Note: start in finished state to add to AnimationManager on first callback.\n         initial,\n         interpolate,\n         keys,\n         newData,\n         position: this.#position,\n         resolve: void 0,\n         start: void 0\n      };\n\n      const quickToCB = (...args) =>\n      {\n         const argsLength = args.length;\n\n         if (argsLength === 0) { return; }\n\n         for (let cntr = keysArray.length; --cntr >= 0;)\n         {\n            const key = keysArray[cntr];\n            if (data[key] !== void 0) { initial[key] = data[key]; }\n         }\n\n         // Handle case where the first arg is an object. Update all quickTo keys from data contained in the object.\n         if (isObject(args[0]))\n         {\n            const objData = args[0];\n\n            for (const key in objData)\n            {\n               if (destination[key] !== void 0) { destination[key] = objData[key]; }\n            }\n         }\n         else // Assign each variable argument to the key specified in the initial `keys` array above.\n         {\n            for (let cntr = 0; cntr < argsLength && cntr < keysArray.length; cntr++)\n            {\n               const key = keysArray[cntr];\n               if (destination[key] !== void 0) { destination[key] = args[cntr]; }\n            }\n         }\n\n         convertRelative(destination, data);\n\n         // Set initial data for transform values that are often null by default.\n         setNumericDefaults(initial);\n         setNumericDefaults(destination);\n\n         // Set target element to animation data to track if it is removed from the DOM hence ending the animation.\n         const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n         animationData.el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n         // Reschedule the quickTo animation with AnimationManager as it is finished.\n         if (animationData.finished)\n         {\n            animationData.finished = false;\n            animationData.active = true;\n            animationData.current = 0;\n\n            this.#instanceCount++;\n            AnimationManager.add(animationData);\n         }\n         else // QuickTo animation is currently scheduled w/ AnimationManager so reset start and current time.\n         {\n            const now = performance.now();\n\n            // Offset start time by delta between last rAF time. This allows a delayed tween to start from the\n            // precise delayed time.\n            animationData.start = now + (AnimationManager.current - now);\n            animationData.current = 0;\n         }\n      };\n\n      quickToCB.keys = keysArray;\n\n      /**\n       * Sets options of quickTo tween.\n       *\n       * @param {object}            [opts] - Optional parameters.\n       *\n       * @param {number}            [opts.duration] - Duration in seconds.\n       *\n       * @param {Function}          [opts.ease] - Easing function.\n       *\n       * @param {Function}          [opts.interpolate] - Interpolation function.\n       *\n       * @returns {quickToCallback} The quickTo callback.\n       */\n      quickToCB.options = ({ duration, ease, interpolate } = {}) => // eslint-disable-line no-shadow\n      {\n         if (duration !== void 0 && (!Number.isFinite(duration) || duration < 0))\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'duration' is not a positive number.`);\n         }\n\n         if (ease !== void 0 && typeof ease !== 'function')\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'ease' is not a function.`);\n         }\n\n         if (interpolate !== void 0 && typeof interpolate !== 'function')\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'interpolate' is not a function.`);\n         }\n\n         if (duration >= 0) { animationData.duration = duration * 1000; }\n         if (ease) { animationData.ease = ease; }\n         if (interpolate) { animationData.interpolate = interpolate; }\n\n         return quickToCB;\n      };\n\n      return quickToCB;\n   }\n}\n\n/**\n * @callback quickToCallback\n *\n * @param {...number|object} args - Either individual numbers corresponding to the order in which keys are specified or\n *                                  a single object with keys specified and numerical values.\n *\n * @property {({duration?: number, ease?: Function, interpolate?: Function}) => quickToCallback} options - A function\n *                                  to update options for quickTo function.\n */\n","/**\n * Provides a basic {@link TJSBasicAnimation} implementation for a Position animation for a group of Position instances.\n */\nexport class AnimationGroupControl\n{\n   /** @type {AnimationControl[]} */\n   #animationControls;\n\n   /** @type {Promise<Awaited<unknown>[]>} */\n   #finishedPromise;\n\n   /**\n    * Defines a static empty / void animation control.\n    *\n    * @type {AnimationGroupControl}\n    */\n   static #voidControl = new AnimationGroupControl(null);\n\n   /**\n    * Provides a static void / undefined AnimationGroupControl that is automatically resolved.\n    *\n    * @returns {AnimationGroupControl} Void AnimationGroupControl\n    */\n   static get voidControl() { return this.#voidControl; }\n\n   /**\n    * @param {AnimationControl[]} animationControls - An array of AnimationControl instances.\n    */\n   constructor(animationControls)\n   {\n      this.#animationControls = animationControls;\n   }\n\n   /**\n    * Get a promise that resolves when all animations are finished.\n    *\n    * @returns {Promise<Awaited<unknown>[]>|Promise<void>} Finished Promise for all animations.\n    */\n   get finished()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return Promise.resolve(); }\n\n      if (!(this.#finishedPromise instanceof Promise))\n      {\n         const promises = [];\n         for (let cntr = animationControls.length; --cntr >= 0;)\n         {\n            promises.push(animationControls[cntr].finished);\n         }\n\n         this.#finishedPromise = Promise.all(promises);\n      }\n\n      return this.#finishedPromise;\n   }\n\n   /**\n    * Returns whether there are active animation instances for this group.\n    *\n    * Note: a delayed animation may not be started / active yet. Use {@link AnimationGroupControl.isFinished} to\n    * determine if all animations in the group are finished.\n    *\n    * @returns {boolean} Are there active animation instances.\n    */\n   get isActive()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return false; }\n\n      for (let cntr = animationControls.length; --cntr >= 0;)\n      {\n         if (animationControls[cntr].isActive) { return true; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Returns whether all animations in the group are finished.\n    *\n    * @returns {boolean} Are all animation instances finished.\n    */\n   get isFinished()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return true; }\n\n      for (let cntr = animationControls.length; --cntr >= 0;)\n      {\n         if (!animationControls[cntr].isFinished) { return false; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Cancels the all animations.\n    */\n   cancel()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return; }\n\n      for (let cntr = this.#animationControls.length; --cntr >= 0;)\n      {\n         this.#animationControls[cntr].cancel();\n      }\n   }\n}\n","import {\n   isIterable,\n   isObject }                    from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { AnimationManager }      from './AnimationManager.js';\nimport { AnimationAPI }          from './AnimationAPI.js';\nimport { AnimationGroupControl } from './AnimationGroupControl.js';\n\n/**\n * Provides a public API for grouping multiple {@link Position} animations together with the AnimationManager.\n *\n * Note: To remove cyclic dependencies as this class provides the Position static / group Animation API `instanceof`\n * checks are not done against Position. Instead, a check for the animate property being an instanceof\n * {@link AnimationAPI} is performed in {@link AnimationGroupAPI.#isPosition}.\n *\n * @see AnimationAPI\n */\nexport class AnimationGroupAPI\n{\n   /**\n    * Checks of the given object is a Position instance by checking for AnimationAPI.\n    *\n    * @param {*}  object - Any data.\n    *\n    * @returns {boolean} Is Position.\n    */\n   static #isPosition(object)\n   {\n      return isObject(object) && object.animate instanceof AnimationAPI;\n   }\n\n   /**\n    * Cancels any animation for given Position data.\n    *\n    * @param {Position|{position: Position}|Iterable<Position>|Iterable<{position: Position}>} position -\n    */\n   static cancel(position)\n   {\n      if (isIterable(position))\n      {\n         let index = -1;\n\n         for (const entry of position)\n         {\n            index++;\n\n            const actualPosition = this.#isPosition(entry) ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.cancel warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            AnimationManager.cancel(actualPosition);\n         }\n      }\n      else\n      {\n         const actualPosition = this.#isPosition(position) ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.cancel warning: No Position instance found.`);\n            return;\n         }\n\n         AnimationManager.cancel(actualPosition);\n      }\n   }\n\n   /**\n    * Cancels all Position animation.\n    */\n   static cancelAll() { AnimationManager.cancelAll(); }\n\n   /**\n    * Gets all animation controls for the given position data.\n    *\n    * @param {Position|{position: Position}|Iterable<Position>|Iterable<{position: Position}>} position -\n    *\n    * @returns {{position: Position, data: object|void, controls: AnimationControl[]}[]} Results array.\n    */\n   static getScheduled(position)\n   {\n      const results = [];\n\n      if (isIterable(position))\n      {\n         let index = -1;\n\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.getScheduled warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            const controls = AnimationManager.getScheduled(actualPosition);\n\n            results.push({ position: actualPosition, data: isPosition ? void 0 : entry, controls });\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.getScheduled warning: No Position instance found.`);\n            return results;\n         }\n\n         const controls = AnimationManager.getScheduled(actualPosition);\n\n         results.push({ position: actualPosition, data: isPosition ? void 0 : position, controls });\n      }\n\n      return results;\n   }\n\n   /**\n    * Provides the `from` animation tween for one or more Position instances as a group.\n    *\n    * @param {Position|{position: Position}|Iterable<Position>|Iterable<{position: Position}>} position -\n    *\n    * @param {object|Function}   fromData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {TJSBasicAnimation} Basic animation control.\n    */\n   static from(position, fromData, options)\n   {\n      if (!isObject(fromData) && typeof fromData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.from error: 'fromData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.from error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasDataCallback = typeof fromData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasDataCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualFromData = fromData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.from warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasDataCallback)\n            {\n               actualFromData = fromData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualFromData === null || actualFromData === void 0) { continue; }\n\n               if (typeof actualFromData !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.from error: fromData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (typeof actualOptions !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.from error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.from(actualFromData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.from warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasDataCallback)\n         {\n            actualFromData = fromData(callbackOptions);\n\n            if (typeof actualFromData !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.from error: fromData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (typeof actualOptions !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.from error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.from(actualFromData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `fromTo` animation tween for one or more Position instances as a group.\n    *\n    * @param {Position|{position: Position}|Iterable<Position>|Iterable<{position: Position}>} position -\n    *\n    * @param {object|Function}   fromData -\n    *\n    * @param {object|Function}   toData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {TJSBasicAnimation} Basic animation control.\n    */\n   static fromTo(position, fromData, toData, options)\n   {\n      if (!isObject(fromData) && typeof fromData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'fromData' is not an object or function.`);\n      }\n\n      if (!isObject(toData) && typeof toData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'toData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasFromCallback = typeof fromData === 'function';\n      const hasToCallback = typeof toData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasFromCallback || hasToCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualFromData = fromData;\n      let actualToData = toData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.fromTo warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasFromCallback)\n            {\n               actualFromData = fromData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualFromData === null || actualFromData === void 0) { continue; }\n\n               if (typeof actualFromData !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: fromData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasToCallback)\n            {\n               actualToData = toData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualToData === null || actualToData === void 0) { continue; }\n\n               if (typeof actualToData !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: toData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (typeof actualOptions !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.fromTo(actualFromData, actualToData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.fromTo warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasFromCallback)\n         {\n            actualFromData = fromData(callbackOptions);\n\n            if (typeof actualFromData !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: fromData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasToCallback)\n         {\n            actualToData = toData(callbackOptions);\n\n            if (typeof actualToData !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: toData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (typeof actualOptions !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.fromTo(actualFromData, actualToData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `to` animation tween for one or more Position instances as a group.\n    *\n    * @param {Position|{position: Position}|Iterable<Position>|Iterable<{position: Position}>} position -\n    *\n    * @param {object|Function}   toData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {TJSBasicAnimation} Basic animation control.\n    */\n   static to(position, toData, options)\n   {\n      if (!isObject(toData) && typeof toData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.to error: 'toData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.to error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasDataCallback = typeof toData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasDataCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualToData = toData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.to warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasDataCallback)\n            {\n               actualToData = toData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualToData === null || actualToData === void 0) { continue; }\n\n               if (typeof actualToData !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.to error: toData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (typeof actualOptions !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.to error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.to(actualToData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.to warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasDataCallback)\n         {\n            actualToData = toData(callbackOptions);\n\n            if (typeof actualToData !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.to error: toData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (typeof actualOptions !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.to error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.to(actualToData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `to` animation tween for one or more Position instances as a group.\n    *\n    * @param {Position|{position: Position}|Iterable<Position>|Iterable<{position: Position}>} position -\n    *\n    * @param {Iterable<string>}  keys -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {quickToCallback} Basic animation control.\n    */\n   static quickTo(position, keys, options)\n   {\n      if (!isIterable(keys))\n      {\n         throw new TypeError(`AnimationGroupAPI.quickTo error: 'keys' is not an iterable list.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.quickTo error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {quickToCallback[]}\n       */\n      const quickToCallbacks = [];\n\n      let index = -1;\n\n      const hasOptionCallback = typeof options === 'function';\n\n      const callbackOptions = { index, position: void 0, data: void 0 };\n\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.quickTo warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            callbackOptions.index = index;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : entry;\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (typeof actualOptions !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.quickTo error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            quickToCallbacks.push(actualPosition.animate.quickTo(keys, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.quickTo warning: No Position instance found.`);\n            return () => null;\n         }\n\n         callbackOptions.index = 0;\n         callbackOptions.position = position;\n         callbackOptions.data = isPosition ? void 0 : position;\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (typeof actualOptions !== 'object')\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.quickTo error: options callback function failed to return an object.`);\n            }\n         }\n\n         quickToCallbacks.push(actualPosition.animate.quickTo(keys, actualOptions));\n      }\n\n      const keysArray = [...keys];\n\n      Object.freeze(keysArray);\n\n      const quickToCB = (...args) =>\n      {\n         const argsLength = args.length;\n\n         if (argsLength === 0) { return; }\n\n         if (typeof args[0] === 'function')\n         {\n            const dataCallback = args[0];\n\n            index = -1;\n            let cntr = 0;\n\n            if (isIterable(position))\n            {\n               for (const entry of position)\n               {\n                  index++;\n\n                  const isPosition = this.#isPosition(entry);\n                  const actualPosition = isPosition ? entry : entry.position;\n\n                  if (!this.#isPosition(actualPosition)) { continue; }\n\n                  callbackOptions.index = index;\n                  callbackOptions.position = position;\n                  callbackOptions.data = isPosition ? void 0 : entry;\n\n                  const toData = dataCallback(callbackOptions);\n\n                  // Returned data from callback is null / undefined, so skip this position instance.\n                  if (toData === null || toData === void 0) { continue; }\n\n                  /**\n                   * @type {boolean}\n                   */\n                  const toDataIterable = isIterable(toData);\n\n                  if (!Number.isFinite(toData) && !toDataIterable && typeof toData !== 'object')\n                  {\n                     throw new TypeError(`AnimationGroupAPI.quickTo error: toData callback function iteration(${\n                      index}) failed to return a finite number, iterable list, or object.`);\n                  }\n\n                  if (toDataIterable)\n                  {\n                     quickToCallbacks[cntr++](...toData);\n                  }\n                  else\n                  {\n                     quickToCallbacks[cntr++](toData);\n                  }\n               }\n            }\n            else\n            {\n               const isPosition = this.#isPosition(position);\n               const actualPosition = isPosition ? position : position.position;\n\n               if (!this.#isPosition(actualPosition)) { return; }\n\n               callbackOptions.index = 0;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : position;\n\n               const toData = dataCallback(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (toData === null || toData === void 0) { return; }\n\n               const toDataIterable = isIterable(toData);\n\n               if (!Number.isFinite(toData) && !toDataIterable && typeof toData !== 'object')\n               {\n                  throw new TypeError(`AnimationGroupAPI.quickTo error: toData callback function iteration(${\n                   index}) failed to return a finite number, iterable list, or object.`);\n               }\n\n               if (toDataIterable)\n               {\n                  quickToCallbacks[cntr++](...toData);\n               }\n               else\n               {\n                  quickToCallbacks[cntr++](toData);\n               }\n            }\n         }\n         else\n         {\n            for (let cntr = quickToCallbacks.length; --cntr >= 0;)\n            {\n               quickToCallbacks[cntr](...args);\n            }\n         }\n      };\n\n      quickToCB.keys = keysArray;\n\n      /**\n       * Sets options of quickTo tween.\n       *\n       * @param {object|Function}   [options] - Optional parameters.\n       *\n       * @param {number}            [options.duration] - Duration in seconds.\n       *\n       * @param {Function}          [options.ease] - Easing function.\n       *\n       * @param {Function}          [options.interpolate] - Interpolation function.\n       *\n       * @returns {quickToCallback} The quickTo callback.\n       */\n      quickToCB.options = (options) => // eslint-disable-line no-shadow\n      {\n         if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n         {\n            throw new TypeError(`AnimationGroupAPI.quickTo error: 'options' is not an object or function.`);\n         }\n\n         // Set options object for each quickTo callback.\n         if (isObject(options))\n         {\n            for (let cntr = quickToCallbacks.length; --cntr >= 0;) { quickToCallbacks[cntr].options(options); }\n         }\n         else if (typeof options === 'function')\n         {\n            if (isIterable(position))\n            {\n               index = -1;\n               let cntr = 0;\n\n               for (const entry of position)\n               {\n                  index++;\n\n                  const isPosition = this.#isPosition(entry);\n                  const actualPosition = isPosition ? entry : entry.position;\n\n                  if (!this.#isPosition(actualPosition))\n                  {\n                     console.warn(\n                      `AnimationGroupAPI.quickTo.options warning: No Position instance found at index: ${index}.`);\n                     continue;\n                  }\n\n                  callbackOptions.index = index;\n                  callbackOptions.position = position;\n                  callbackOptions.data = isPosition ? void 0 : entry;\n\n                  actualOptions = options(callbackOptions);\n\n                  // Returned data from callback is null / undefined, so skip this position instance.\n                  if (actualOptions === null || actualOptions === void 0) { continue; }\n\n                  if (typeof actualOptions !== 'object')\n                  {\n                     throw new TypeError(\n                      `AnimationGroupAPI.quickTo.options error: options callback function iteration(${\n                       index}) failed to return an object.`);\n                  }\n\n                  quickToCallbacks[cntr++].options(actualOptions);\n               }\n            }\n            else\n            {\n               const isPosition = this.#isPosition(position);\n               const actualPosition = isPosition ? position : position.position;\n\n               if (!this.#isPosition(actualPosition))\n               {\n                  console.warn(`AnimationGroupAPI.quickTo.options warning: No Position instance found.`);\n                  return quickToCB;\n               }\n\n               callbackOptions.index = 0;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : position;\n\n               actualOptions = options(callbackOptions);\n\n               if (typeof actualOptions !== 'object')\n               {\n                  throw new TypeError(\n                   `AnimationGroupAPI.quickTo error: options callback function failed to return an object.`);\n               }\n\n               quickToCallbacks[0].options(actualOptions);\n            }\n         }\n\n         return quickToCB;\n      };\n\n      return quickToCB;\n   }\n}\n","export class Centered\n{\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ element, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get element() { return this.#element; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0  || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   getLeft(width)\n   {\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n\n      return (boundsWidth - width) / 2;\n   }\n\n   getTop(height)\n   {\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      return (boundsHeight - height) / 2;\n   }\n}\n","import { Centered } from './Centered.js';\n\nconst browserCentered = new Centered();\n\nexport { browserCentered, Centered };\n\n","export class PositionChangeSet\n{\n   constructor()\n   {\n      this.left = false;\n      this.top = false;\n      this.width = false;\n      this.height = false;\n      this.maxHeight = false;\n      this.maxWidth = false;\n      this.minHeight = false;\n      this.minWidth = false;\n      this.zIndex = false;\n      this.transform = false;\n      this.transformOrigin = false;\n   }\n\n   hasChange()\n   {\n      return this.left || this.top || this.width || this.height || this.maxHeight || this.maxWidth || this.minHeight ||\n       this.minWidth || this.zIndex || this.transform || this.transformOrigin;\n   }\n\n   set(value)\n   {\n      this.left = value;\n      this.top = value;\n      this.width = value;\n      this.height = value;\n      this.maxHeight = value;\n      this.maxWidth = value;\n      this.minHeight = value;\n      this.minWidth = value;\n      this.zIndex = value;\n      this.transform = value;\n      this.transformOrigin = value;\n   }\n}\n","/**\n * Defines stored positional data.\n */\nexport class PositionData\n{\n   constructor({ height = null, left = null, maxHeight = null, maxWidth = null, minHeight = null, minWidth = null,\n    rotateX = null, rotateY = null, rotateZ = null, scale = null, translateX = null, translateY = null,\n     translateZ = null, top = null, transformOrigin = null, width = null, zIndex = null } = {})\n   {\n      /**\n       * @type {number|'auto'|'inherit'|null}\n       */\n      this.height = height;\n\n      /**\n       * @type {number|null}\n       */\n      this.left = left;\n\n      /**\n       * @type {number|null}\n       */\n      this.maxHeight = maxHeight;\n\n      /**\n       * @type {number|null}\n       */\n      this.maxWidth = maxWidth;\n\n      /**\n       * @type {number|null}\n       */\n      this.minHeight = minHeight;\n\n      /**\n       * @type {number|null}\n       */\n      this.minWidth = minWidth;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateX = rotateX;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateY = rotateY;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateZ = rotateZ;\n\n      /**\n       * @type {number|null}\n       */\n      this.scale = scale;\n\n      /**\n       * @type {number|null}\n       */\n      this.top = top;\n\n      /**\n       * @type {string|null}\n       */\n      this.transformOrigin = transformOrigin;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateX = translateX;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateY = translateY;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateZ = translateZ;\n\n      /**\n       * @type {number|'auto'|'inherit'|null}\n       */\n      this.width = width;\n\n      /**\n       * @type {number|null}\n       */\n      this.zIndex = zIndex;\n\n      Object.seal(this);\n   }\n\n   /**\n    * Copies given data to this instance.\n    *\n    * @param {PositionData}   data - Copy from this instance.\n    *\n    * @returns {PositionData} This instance.\n    */\n   copy(data)\n   {\n      this.height = data.height;\n      this.left = data.left;\n      this.maxHeight = data.maxHeight;\n      this.maxWidth = data.maxWidth;\n      this.minHeight = data.minHeight;\n      this.minWidth = data.minWidth;\n      this.rotateX = data.rotateX;\n      this.rotateY = data.rotateY;\n      this.rotateZ = data.rotateZ;\n      this.scale = data.scale;\n      this.top = data.top;\n      this.transformOrigin = data.transformOrigin;\n      this.translateX = data.translateX;\n      this.translateY = data.translateY;\n      this.translateZ = data.translateZ;\n      this.width = data.width;\n      this.zIndex = data.zIndex;\n\n      return this;\n   }\n}\n","import { linear }       from 'svelte/easing';\n\nimport { lerp }         from '@typhonjs-fvtt/runtime/svelte/math';\nimport { isIterable }   from '@typhonjs-fvtt/runtime/svelte/util';\n\nexport class PositionStateAPI\n{\n   /** @type {PositionData} */\n   #data;\n\n   /**\n    * @type {Map<string, PositionDataExtended>}\n    */\n   #dataSaved = new Map();\n\n   /** @type {Position} */\n   #position;\n\n   /** @type {Transforms} */\n   #transforms;\n\n   constructor(position, data, transforms)\n   {\n      this.#position = position;\n      this.#data = data;\n      this.#transforms = transforms;\n   }\n\n   /**\n    * Returns any stored save state by name.\n    *\n    * @param {string}   name - Saved data set name.\n    *\n    * @returns {PositionDataExtended} The saved data set.\n    */\n   get({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - getSave error: 'name' is not a string.`); }\n\n      return this.#dataSaved.get(name);\n   }\n\n   /**\n    * Returns any associated default data.\n    *\n    * @returns {PositionDataExtended} Associated default data.\n    */\n   getDefault()\n   {\n      return this.#dataSaved.get('#defaultData');\n   }\n\n   /**\n    * Removes and returns any position state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Name to remove and retrieve.\n    *\n    * @returns {PositionDataExtended} Saved position data.\n    */\n   remove({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - remove: 'name' is not a string.`); }\n\n      const data = this.#dataSaved.get(name);\n      this.#dataSaved.delete(name);\n\n      return data;\n   }\n\n   /**\n    * Resets data to default values and invokes set.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.keepZIndex=false] - When true keeps current z-index.\n    *\n    * @param {boolean}  [opts.invokeSet=true] - When true invokes set method.\n    *\n    * @returns {boolean} Operation successful.\n    */\n   reset({ keepZIndex = false, invokeSet = true } = {})\n   {\n      const defaultData = this.#dataSaved.get('#defaultData');\n\n      // Quit early if there is no saved default data.\n      if (typeof defaultData !== 'object') { return false; }\n\n      // Cancel all animations for Position if there are currently any scheduled.\n      if (this.#position.animate.isScheduled)\n      {\n         this.#position.animate.cancel();\n      }\n\n      const zIndex = this.#position.zIndex;\n\n      const data = Object.assign({}, defaultData);\n\n      if (keepZIndex) { data.zIndex = zIndex; }\n\n      // Reset the transform data.\n      this.#transforms.reset(data);\n\n      // If current minimized invoke `maximize`.\n      if (this.#position.parent?.reactive?.minimized)\n      {\n         this.#position.parent?.maximize?.({ animate: false, duration: 0 });\n      }\n\n      // Note next clock tick scheduling.\n      if (invokeSet) { setTimeout(() => this.#position.set(data), 0); }\n\n      return true;\n   }\n\n   /**\n    * Restores a saved positional state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * @param {object}            params - Parameters\n    *\n    * @param {string}            params.name - Saved data set name.\n    *\n    * @param {boolean}           [params.remove=false] - Remove data set.\n    *\n    * @param {Iterable<string>}  [params.properties] - Specific properties to set / animate.\n    *\n    * @param {boolean}           [params.silent] - Set position data directly; no store or style updates.\n    *\n    * @param {boolean}           [params.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [params.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [params.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [params.ease=linear] - Easing function.\n    *\n    * @param {Function}          [params.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {PositionDataExtended|Promise<PositionDataExtended>} Saved position data.\n    */\n   restore({ name, remove = false, properties, silent = false, async = false, animateTo = false, duration = 0.1,\n    ease = linear, interpolate = lerp })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - restore error: 'name' is not a string.`); }\n\n      const dataSaved = this.#dataSaved.get(name);\n\n      if (dataSaved)\n      {\n         if (remove) { this.#dataSaved.delete(name); }\n\n         let data = dataSaved;\n\n         if (isIterable(properties))\n         {\n            data = {};\n            for (const property of properties) { data[property] = dataSaved[property]; }\n         }\n\n         // Update data directly with no store or inline style updates.\n         if (silent)\n         {\n            for (const property in data) { this.#data[property] = data[property]; }\n            return dataSaved;\n         }\n         else if (animateTo)  // Animate to saved data.\n         {\n            // Provide special handling to potentially change transform origin as this parameter is not animated.\n            if (data.transformOrigin !== this.#position.transformOrigin)\n            {\n               this.#position.transformOrigin = data.transformOrigin;\n            }\n\n            // Return a Promise with saved data that resolves after animation ends.\n            if (async)\n            {\n               return this.#position.animate.to(data, { duration, ease, interpolate }).finished.then(() => dataSaved);\n            }\n            else  // Animate synchronously.\n            {\n               this.#position.animate.to(data, { duration, ease, interpolate });\n            }\n         }\n         else\n         {\n            // Default options is to set data for an immediate update.\n            this.#position.set(data);\n         }\n      }\n\n      return dataSaved;\n   }\n\n   /**\n    * Saves current position state with the opportunity to add extra data to the saved state.\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.name - name to index this saved data.\n    *\n    * @param {...*}     [opts.extra] - Extra data to add to saved data.\n    *\n    * @returns {PositionData} Current position data\n    */\n   save({ name, ...extra })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - save error: 'name' is not a string.`); }\n\n      const data = this.#position.get(extra);\n\n      this.#dataSaved.set(name, data);\n\n      return data;\n   }\n\n   /**\n    * Directly sets a position state.\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.name - name to index this saved data.\n    *\n    * @param {...*}     [opts.data] - Position data to set.\n    */\n   set({ name, ...data })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - set error: 'name' is not a string.`); }\n\n      this.#dataSaved.set(name, data);\n   }\n}\n","import { writable }           from 'svelte/store';\n\nimport { propertyStore }      from '@typhonjs-fvtt/runtime/svelte/store';\nimport { styleParsePixels }   from '@typhonjs-fvtt/runtime/svelte/util';\n\nexport class StyleCache\n{\n   constructor()\n   {\n      /** @type {HTMLElement|undefined} */\n      this.el = void 0;\n\n      /** @type {CSSStyleDeclaration} */\n      this.computed = void 0;\n\n      /** @type {number|undefined} */\n      this.marginLeft = void 0;\n\n      /** @type {number|undefined} */\n      this.marginTop = void 0;\n\n      /** @type {number|undefined} */\n      this.maxHeight = void 0;\n\n      /** @type {number|undefined} */\n      this.maxWidth = void 0;\n\n      /** @type {number|undefined} */\n      this.minHeight = void 0;\n\n      /** @type {number|undefined} */\n      this.minWidth = void 0;\n\n      /** @type {boolean} */\n      this.hasWillChange = false;\n\n      /**\n       * @type {ResizeObserverData}\n       */\n      this.resizeObserved = {\n         contentHeight: void 0,\n         contentWidth: void 0,\n         offsetHeight: void 0,\n         offsetWidth: void 0\n      };\n\n      /**\n       * Provides a writable store to track offset & content width / height from an associated `resizeObserver` action.\n       *\n       * @type {Writable<ResizeObserverData>}\n       */\n      const storeResizeObserved = writable(this.resizeObserved);\n\n      this.stores = {\n         element: writable(this.el),\n         resizeContentHeight: propertyStore(storeResizeObserved, 'contentHeight'),\n         resizeContentWidth: propertyStore(storeResizeObserved, 'contentWidth'),\n         resizeObserved: storeResizeObserved,\n         resizeOffsetHeight: propertyStore(storeResizeObserved, 'offsetHeight'),\n         resizeOffsetWidth: propertyStore(storeResizeObserved, 'offsetWidth')\n      };\n   }\n\n   /**\n    * Returns the cached offsetHeight from any attached `resizeObserver` action otherwise gets the offsetHeight from\n    * the element directly. The more optimized path is using `resizeObserver` as getting it from the element\n    * directly is more expensive and alters the execution order of an animation frame.\n    *\n    * @returns {number} The element offsetHeight.\n    */\n   get offsetHeight()\n   {\n      if (this.el instanceof HTMLElement)\n      {\n         return this.resizeObserved.offsetHeight !== void 0 ? this.resizeObserved.offsetHeight : this.el.offsetHeight;\n      }\n\n      throw new Error(`StyleCache - get offsetHeight error: no element assigned.`);\n   }\n\n   /**\n    * Returns the cached offsetWidth from any attached `resizeObserver` action otherwise gets the offsetWidth from\n    * the element directly. The more optimized path is using `resizeObserver` as getting it from the element\n    * directly is more expensive and alters the execution order of an animation frame.\n    *\n    * @returns {number} The element offsetHeight.\n    */\n   get offsetWidth()\n   {\n      if (this.el instanceof HTMLElement)\n      {\n         return this.resizeObserved.offsetWidth !== void 0 ? this.resizeObserved.offsetWidth : this.el.offsetWidth;\n      }\n\n      throw new Error(`StyleCache - get offsetWidth error: no element assigned.`);\n   }\n\n   /**\n    * @param {HTMLElement} el -\n    *\n    * @returns {boolean} Does element match cached element.\n    */\n   hasData(el) { return this.el === el; }\n\n   /**\n    * Resets the style cache.\n    */\n   reset()\n   {\n      // Remove will-change inline style from previous element if it is still connected.\n      if (this.el instanceof HTMLElement && this.el.isConnected && !this.hasWillChange)\n      {\n         this.el.style.willChange = null;\n      }\n\n      this.el = void 0;\n      this.computed = void 0;\n      this.marginLeft = void 0;\n      this.marginTop = void 0;\n      this.maxHeight = void 0;\n      this.maxWidth = void 0;\n      this.minHeight = void 0;\n      this.minWidth = void 0;\n\n      this.hasWillChange = false;\n\n      // Silently reset `resizedObserved`; With proper usage the `resizeObserver` action issues an update on removal.\n      this.resizeObserved.contentHeight = void 0;\n      this.resizeObserved.contentWidth = void 0;\n      this.resizeObserved.offsetHeight = void 0;\n      this.resizeObserved.offsetWidth = void 0;\n\n      // Reset the tracked element this Position instance is modifying.\n      this.stores.element.set(void 0);\n   }\n\n   /**\n    * Updates the style cache with new data from the given element.\n    *\n    * @param {HTMLElement} el - An HTML element.\n    */\n   update(el)\n   {\n      this.el = el;\n\n      this.computed = globalThis.getComputedStyle(el);\n\n      this.marginLeft = styleParsePixels(el.style.marginLeft) ?? styleParsePixels(this.computed.marginLeft);\n      this.marginTop = styleParsePixels(el.style.marginTop) ?? styleParsePixels(this.computed.marginTop);\n      this.maxHeight = styleParsePixels(el.style.maxHeight) ?? styleParsePixels(this.computed.maxHeight);\n      this.maxWidth = styleParsePixels(el.style.maxWidth) ?? styleParsePixels(this.computed.maxWidth);\n\n      // Note that the computed styles for below will always be 0px / 0 when no style is active.\n      this.minHeight = styleParsePixels(el.style.minHeight) ?? styleParsePixels(this.computed.minHeight);\n      this.minWidth = styleParsePixels(el.style.minWidth) ?? styleParsePixels(this.computed.minWidth);\n\n      // Tracks if there already is a will-change property on the inline or computed styles.\n      const willChange = el.style.willChange !== '' ? el.style.willChange : void 0 ?? this.computed.willChange;\n\n      this.hasWillChange = willChange !== '' && willChange !== 'auto';\n\n      // Update the tracked element this Position instance is modifying.\n      this.stores.element.set(el);\n   }\n}\n","import { mat4, vec3 }   from '@typhonjs-fvtt/runtime/svelte/math';\n\n/**\n * Provides the output data for {@link Transforms.getData}.\n */\nexport class TransformData\n{\n   constructor()\n   {\n      Object.seal(this);\n   }\n\n   /**\n    * Stores the calculated bounding rectangle.\n    *\n    * @type {DOMRect}\n    */\n   #boundingRect = new DOMRect();\n\n   /**\n    * Stores the individual transformed corner points of the window in screenspace clockwise from:\n    * top left -> top right -> bottom right -> bottom left.\n    *\n    * @type {Vector3[]}\n    */\n   #corners = [vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n\n   /**\n    * Stores the current gl-matrix mat4 data.\n    *\n    * @type {Matrix4}\n    */\n   #mat4 = mat4.create();\n\n   /**\n    * Stores the pre & post origin translations to apply to matrix transforms.\n    *\n    * @type {Matrix4[]}\n    */\n   #originTranslations = [mat4.create(), mat4.create()];\n\n   /**\n    * @returns {DOMRect} The bounding rectangle.\n    */\n   get boundingRect() { return this.#boundingRect; }\n\n   /**\n    * @returns {Vector3[]} The transformed corner points as vec3 in screen space.\n    */\n   get corners() { return this.#corners; }\n\n   /**\n    * @returns {string} Returns the CSS style string for the transform matrix.\n    */\n   get css() { return `matrix3d(${this.mat4.join(',')})`; }\n\n   /**\n    * @returns {Matrix4} The transform matrix.\n    */\n   get mat4() { return this.#mat4; }\n\n   /**\n    * @returns {Matrix4[]} The pre / post translation matrices for origin translation.\n    */\n   get originTranslations() { return this.#originTranslations; }\n}\n\n/**\n * @typedef {Float32Array} Vector3 - 3 Dimensional Vector.\n *\n * @see https://glmatrix.net/docs/module-vec3.html\n */\n\n/**\n * @typedef {Float32Array} Matrix4 - 4x4 Matrix; Format: column-major, when typed out it looks like row-major.\n *\n * @see https://glmatrix.net/docs/module-mat4.html\n */\n","import { isObject } from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Provides the storage and sequencing of managed position validators. Each validator added may be a bespoke function or\n * a {@link ValidatorData} object containing an `id`, `validator`, and `weight` attributes; `validator` is the only\n * required attribute.\n *\n * The `id` attribute can be anything that creates a unique ID for the validator; recommended strings or numbers. This\n * allows validators to be removed by ID easily.\n *\n * The `weight` attribute is a number between 0 and 1 inclusive that allows validators to be added in a\n * predictable order which is especially handy if they are manipulated at runtime. A lower weighted validator always\n * runs before a higher weighted validator. If no weight is specified the default of '1' is assigned and it is appended\n * to the end of the validators list.\n *\n * This class forms the public API which is accessible from the `.validators` getter in the main Position instance.\n * ```\n * const position = new Position(<PositionData>);\n * position.validators.add(...);\n * position.validators.clear();\n * position.validators.length;\n * position.validators.remove(...);\n * position.validators.removeBy(...);\n * position.validators.removeById(...);\n * ```\n */\nexport class AdapterValidators\n{\n   /** @type {boolean} */\n   #enabled = true;\n\n   /**\n    * @type {ValidatorData[]}\n    */\n   #validatorData;\n\n   #mapUnsubscribe = new Map();\n\n   /**\n    * @returns {[AdapterValidators, ValidatorData[]]} Returns this and internal storage for validator adapter.\n    */\n   constructor()\n   {\n      this.#validatorData = [];\n\n      Object.seal(this);\n\n      return [this, this.#validatorData];\n   }\n\n   /**\n    * @returns {boolean} Returns the enabled state.s\n    */\n   get enabled() { return this.#enabled; }\n\n   /**\n    * @returns {number} Returns the length of the validators array.\n    */\n   get length() { return this.#validatorData.length; }\n\n   /**\n    * @param {boolean}  enabled - Sets enabled state.\n    */\n   set enabled(enabled)\n   {\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   /**\n    * Provides an iterator for validators.\n    *\n    * @returns {Generator<ValidatorData|undefined>} Generator / iterator of validators.\n    * @yields {ValidatorData}\n    */\n   *[Symbol.iterator]()\n   {\n      if (this.#validatorData.length === 0) { return; }\n\n      for (const entry of this.#validatorData)\n      {\n         yield { ...entry };\n      }\n   }\n\n   /**\n    * @param {...(ValidatorFn|ValidatorData)}   validators -\n    */\n   add(...validators)\n   {\n      /**\n       * Tracks the number of validators added that have subscriber functionality.\n       *\n       * @type {number}\n       */\n      // let subscribeCount = 0;  // TODO: Currently unused\n\n      for (const validator of validators)\n      {\n         const validatorType = typeof validator;\n\n         if (validatorType !== 'function' && validatorType !== 'object' || validator === null)\n         {\n            throw new TypeError(`AdapterValidator error: 'validator' is not a function or object.`);\n         }\n\n         let data = void 0;\n         let subscribeFn = void 0;\n\n         switch (validatorType)\n         {\n            case 'function':\n               data = {\n                  id: void 0,\n                  validator,\n                  weight: 1\n               };\n\n               subscribeFn = validator.subscribe;\n               break;\n\n            case 'object':\n               if (typeof validator.validator !== 'function')\n               {\n                  throw new TypeError(`AdapterValidator error: 'validator' attribute is not a function.`);\n               }\n\n               if (validator.weight !== void 0 && typeof validator.weight !== 'number' ||\n                (validator.weight < 0 || validator.weight > 1))\n               {\n                  throw new TypeError(\n                   `AdapterValidator error: 'weight' attribute is not a number between '0 - 1' inclusive.`);\n               }\n\n               data = {\n                  id: validator.id !== void 0 ? validator.id : void 0,\n                  validator: validator.validator.bind(validator),\n                  weight: validator.weight || 1,\n                  instance: validator\n               };\n\n               subscribeFn = validator.validator.subscribe ?? validator.subscribe;\n               break;\n         }\n\n         // Find the index to insert where data.weight is less than existing values weight.\n         const index = this.#validatorData.findIndex((value) =>\n         {\n            return data.weight < value.weight;\n         });\n\n         // If an index was found insert at that location.\n         if (index >= 0)\n         {\n            this.#validatorData.splice(index, 0, data);\n         }\n         else // push to end of validators.\n         {\n            this.#validatorData.push(data);\n         }\n\n         if (typeof subscribeFn === 'function')\n         {\n            // TODO: consider how to handle validator updates.\n            const unsubscribe = subscribeFn();\n\n            // Ensure that unsubscribe is a function.\n            if (typeof unsubscribe !== 'function')\n            {\n               throw new TypeError(\n                'AdapterValidator error: Filter has subscribe function, but no unsubscribe function is returned.');\n            }\n\n            // Ensure that the same validator is not subscribed to multiple times.\n            if (this.#mapUnsubscribe.has(data.validator))\n            {\n               throw new Error(\n                'AdapterValidator error: Filter added already has an unsubscribe function registered.');\n            }\n\n            this.#mapUnsubscribe.set(data.validator, unsubscribe);\n            // subscribeCount++;  // TODO: Currently unused\n         }\n      }\n\n      // Filters with subscriber functionality are assumed to immediately invoke the `subscribe` callback. If the\n      // subscriber count is less than the amount of validators added then automatically trigger an index update\n      // manually.\n      // TODO: handle validator updates.\n      // if (subscribeCount < validators.length) { this.#indexUpdate(); }\n   }\n\n   clear()\n   {\n      this.#validatorData.length = 0;\n\n      // Unsubscribe from all validators with subscription support.\n      for (const unsubscribe of this.#mapUnsubscribe.values())\n      {\n         unsubscribe();\n      }\n\n      this.#mapUnsubscribe.clear();\n\n      // TODO: handle validator updates.\n      // this.#indexUpdate();\n   }\n\n   /**\n    * @param {...(ValidatorFn|ValidatorData)}   validators -\n    */\n   remove(...validators)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      for (const data of validators)\n      {\n         // Handle the case that the validator may either be a function or a validator entry / object.\n         const actualValidator = typeof data === 'function' ? data : isObject(data) ? data.validator : void 0;\n\n         if (!actualValidator) { continue; }\n\n         for (let cntr = this.#validatorData.length; --cntr >= 0;)\n         {\n            if (this.#validatorData[cntr].validator === actualValidator)\n            {\n               this.#validatorData.splice(cntr, 1);\n\n               // Invoke any unsubscribe function for given validator then remove from tracking.\n               let unsubscribe = void 0;\n               if (typeof (unsubscribe = this.#mapUnsubscribe.get(actualValidator)) === 'function')\n               {\n                  unsubscribe();\n                  this.#mapUnsubscribe.delete(actualValidator);\n               }\n            }\n         }\n      }\n\n      // Update the index a validator was removed.\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n\n   /**\n    * Remove validators by the provided callback. The callback takes 3 parameters: `id`, `validator`, and `weight`.\n    * Any truthy value returned will remove that validator.\n    *\n    * @param {function(*, ValidatorFn, number): boolean} callback - Callback function to evaluate each validator\n    *                                                                  entry.\n    */\n   removeBy(callback)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      if (typeof callback !== 'function')\n      {\n         throw new TypeError(`AdapterValidator error: 'callback' is not a function.`);\n      }\n\n      this.#validatorData = this.#validatorData.filter((data) =>\n      {\n         const remove = callback.call(callback, { ...data });\n\n         if (remove)\n         {\n            let unsubscribe;\n            if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.validator)) === 'function')\n            {\n               unsubscribe();\n               this.#mapUnsubscribe.delete(data.validator);\n            }\n         }\n\n         // Reverse remove boolean to properly validator / remove this validator.\n         return !remove;\n      });\n\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n\n   removeById(...ids)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      this.#validatorData = this.#validatorData.filter((data) =>\n      {\n         let remove = false;\n\n         for (const id of ids) { remove |= data.id === id; }\n\n         // If not keeping invoke any unsubscribe function for given validator then remove from tracking.\n         if (remove)\n         {\n            let unsubscribe;\n            if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.validator)) === 'function')\n            {\n               unsubscribe();\n               this.#mapUnsubscribe.delete(data.validator);\n            }\n         }\n\n         return !remove; // Swap here to actually remove the item via array validator method.\n      });\n\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n}\n\n/**\n * @callback ValidatorFn - Position validator function that takes a {@link PositionData} instance potentially\n *                             modifying it or returning null if invalid.\n *\n * @param {ValidationData} valData - Validation data.\n *\n * @returns {PositionData|null} The validated position data or null to cancel position update.\n *\n */\n\n/**\n * @typedef {object} ValidatorData\n *\n * @property {*}           [id=undefined] - An ID associated with this validator. Can be used to remove the validator.\n *\n * @property {ValidatorFn} validator - Position validator function that takes a {@link PositionData} instance\n *                                     potentially modifying it or returning null if invalid.\n *\n * @property {number}      [weight=1] - A number between 0 and 1 inclusive to position this validator against others.\n *\n * @property {Function}    [subscribe] - Optional subscribe function following the Svelte store / subscribe pattern.\n */\n\n/**\n * @typedef {ValidatorFn|ValidatorData|Iterable<ValidatorFn|ValidatorData>} PositionValidatorOptions Defines the\n *          position validator options.\n */\n","export class BasicBounds\n{\n   /**\n    * When true constrains the min / max width or height to element.\n    *\n    * @type {boolean}\n    */\n   #constrain;\n\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * When true the validator is active.\n    *\n    * @type {boolean}\n    */\n   #enabled;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ constrain = true, element, enabled = true, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.constrain = constrain;\n      this.enabled = enabled;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get constrain() { return this.#constrain; }\n\n   get element() { return this.#element; }\n\n   get enabled() { return this.#enabled; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set constrain(constrain)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof constrain !== 'boolean') { throw new TypeError(`'constrain' is not a boolean.`); }\n\n      this.#constrain = constrain;\n   }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0  || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set enabled(enabled)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Provides a validator that respects transforms in positional data constraining the position to within the target\n    * elements bounds.\n    *\n    * @param {ValidationData}   valData - The associated validation data for position updates.\n    *\n    * @returns {PositionData} Potentially adjusted position data.\n    */\n   validator(valData)\n   {\n      // Early out if element is undefined or local enabled state is false.\n      if (!this.#enabled) { return valData.position; }\n\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      if (typeof valData.position.width === 'number')\n      {\n         const maxW = valData.maxWidth ?? (this.#constrain ? boundsWidth : Number.MAX_SAFE_INTEGER);\n         valData.position.width = valData.width = Math.clamped(valData.position.width, valData.minWidth, maxW);\n\n         if ((valData.width + valData.position.left + valData.marginLeft) > boundsWidth)\n         {\n            valData.position.left = boundsWidth - valData.width - valData.marginLeft;\n         }\n      }\n\n      if (typeof valData.position.height === 'number')\n      {\n         const maxH = valData.maxHeight ?? (this.#constrain ? boundsHeight : Number.MAX_SAFE_INTEGER);\n         valData.position.height = valData.height = Math.clamped(valData.position.height, valData.minHeight, maxH);\n\n         if ((valData.height + valData.position.top + valData.marginTop) > boundsHeight)\n         {\n            valData.position.top = boundsHeight - valData.height - valData.marginTop;\n         }\n      }\n\n      const maxL = Math.max(boundsWidth - valData.width - valData.marginLeft, 0);\n      valData.position.left = Math.round(Math.clamped(valData.position.left, 0, maxL));\n\n      const maxT = Math.max(boundsHeight - valData.height - valData.marginTop, 0);\n      valData.position.top = Math.round(Math.clamped(valData.position.top, 0, maxT));\n\n      return valData.position;\n   }\n}\n","import { TransformData } from '../transform/TransformData.js';\n\nconst s_TRANSFORM_DATA = new TransformData();\n\nexport class TransformBounds\n{\n   /**\n    * When true constrains the min / max width or height to element.\n    *\n    * @type {boolean}\n    */\n   #constrain;\n\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * When true the validator is active.\n    *\n    * @type {boolean}\n    */\n   #enabled;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ constrain = true, element, enabled = true, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.constrain = constrain;\n      this.enabled = enabled;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get constrain() { return this.#constrain; }\n\n   get element() { return this.#element; }\n\n   get enabled() { return this.#enabled; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set constrain(constrain)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof constrain !== 'boolean') { throw new TypeError(`'constrain' is not a boolean.`); }\n\n      this.#constrain = constrain;\n   }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0 || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set enabled(enabled)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Provides a validator that respects transforms in positional data constraining the position to within the target\n    * elements bounds.\n    *\n    * @param {ValidationData}   valData - The associated validation data for position updates.\n    *\n    * @returns {PositionData} Potentially adjusted position data.\n    */\n   validator(valData)\n   {\n      // Early out if element is undefined or local enabled state is false.\n      if (!this.#enabled) { return valData.position; }\n\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      // Ensure min / max width constraints when position width is a number; not 'auto' or 'inherit'. If constrain is\n      // true cap width bounds.\n      if (typeof valData.position.width === 'number')\n      {\n         const maxW = valData.maxWidth ?? (this.#constrain ? boundsWidth : Number.MAX_SAFE_INTEGER);\n         valData.position.width = Math.clamped(valData.width, valData.minWidth, maxW);\n      }\n\n      // Ensure min / max height constraints when position height is a number; not 'auto' or 'inherit'. If constrain\n      // is true cap height bounds.\n      if (typeof valData.position.height === 'number')\n      {\n         const maxH = valData.maxHeight ?? (this.#constrain ? boundsHeight : Number.MAX_SAFE_INTEGER);\n         valData.position.height = Math.clamped(valData.height, valData.minHeight, maxH);\n      }\n\n      // Get transform data. First set constraints including any margin top / left as offsets and width / height. Used\n      // when position width / height is 'auto'.\n      const data = valData.transforms.getData(valData.position, s_TRANSFORM_DATA, valData);\n\n      // Check the bounding rectangle against browser height / width. Adjust position based on how far the overlap of\n      // the bounding rect is outside the bounds height / width. The order below matters as the constraints are top /\n      // left oriented, so perform those checks last.\n\n      const initialX = data.boundingRect.x;\n      const initialY = data.boundingRect.y;\n\n      if (data.boundingRect.bottom + valData.marginTop > boundsHeight)\n      {\n         data.boundingRect.y += boundsHeight - data.boundingRect.bottom - valData.marginTop;\n      }\n\n      if (data.boundingRect.right + valData.marginLeft > boundsWidth)\n      {\n         data.boundingRect.x += boundsWidth - data.boundingRect.right - valData.marginLeft;\n      }\n\n      if (data.boundingRect.top - valData.marginTop < 0)\n      {\n         data.boundingRect.y += Math.abs(data.boundingRect.top - valData.marginTop);\n      }\n\n      if (data.boundingRect.left - valData.marginLeft < 0)\n      {\n         data.boundingRect.x += Math.abs(data.boundingRect.left - valData.marginLeft);\n      }\n\n      valData.position.left -= initialX - data.boundingRect.x;\n      valData.position.top -= initialY - data.boundingRect.y;\n\n      return valData.position;\n   }\n}\n","import { BasicBounds }     from './BasicBounds.js';\nimport { TransformBounds } from './TransformBounds.js';\n\nconst basicWindow = new BasicBounds({ lock: true });\nconst transformWindow = new TransformBounds({ lock: true });\n\nexport { basicWindow, BasicBounds, transformWindow, TransformBounds };\n","import { degToRad, mat4, vec3 }  from '@typhonjs-fvtt/runtime/svelte/math';\n\nimport * as constants            from '../constants.js';\n\nimport { TransformData }         from './TransformData.js';\n\n/** @type {number[]} */\nconst s_SCALE_VECTOR = [1, 1, 1];\n\n/** @type {number[]} */\nconst s_TRANSLATE_VECTOR = [0, 0, 0];\n\n/** @type {Matrix4} */\nconst s_MAT4_RESULT = mat4.create();\n\n/** @type {Matrix4} */\nconst s_MAT4_TEMP = mat4.create();\n\n/** @type {Vector3} */\nconst s_VEC3_TEMP = vec3.create();\n\nexport class Transforms\n{\n   /**\n    * Stores the transform keys in the order added.\n    *\n    * @type {string[]}\n    */\n   #orderList = [];\n\n   constructor()\n   {\n      this._data = {};\n   }\n\n   /**\n    * @returns {boolean} Whether there are active transforms in local data.\n    */\n   get isActive() { return this.#orderList.length > 0; }\n\n   /**\n    * @returns {number|undefined} Any local rotateX data.\n    */\n   get rotateX() { return this._data.rotateX; }\n\n   /**\n    * @returns {number|undefined} Any local rotateY data.\n    */\n   get rotateY() { return this._data.rotateY; }\n\n   /**\n    * @returns {number|undefined} Any local rotateZ data.\n    */\n   get rotateZ() { return this._data.rotateZ; }\n\n   /**\n    * @returns {number|undefined} Any local rotateZ scale.\n    */\n   get scale() { return this._data.scale; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateX() { return this._data.translateX; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateY() { return this._data.translateY; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateZ() { return this._data.translateZ; }\n\n   /**\n    * Sets the local rotateX data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateX(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateX === void 0) { this.#orderList.push('rotateX'); }\n\n         this._data.rotateX = value;\n      }\n      else\n      {\n         if (this._data.rotateX !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateX');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateX;\n      }\n   }\n\n   /**\n    * Sets the local rotateY data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateY(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateY === void 0) { this.#orderList.push('rotateY'); }\n\n         this._data.rotateY = value;\n      }\n      else\n      {\n         if (this._data.rotateY !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateY');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateY;\n      }\n   }\n\n   /**\n    * Sets the local rotateZ data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateZ(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateZ === void 0) { this.#orderList.push('rotateZ'); }\n\n         this._data.rotateZ = value;\n      }\n\n      else\n      {\n         if (this._data.rotateZ !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateZ');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateZ;\n      }\n   }\n\n   /**\n    * Sets the local scale data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set scale(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.scale === void 0) { this.#orderList.push('scale'); }\n\n         this._data.scale = value;\n      }\n      else\n      {\n         if (this._data.scale !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'scale');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.scale;\n      }\n   }\n\n   /**\n    * Sets the local translateX data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateX(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateX === void 0) { this.#orderList.push('translateX'); }\n\n         this._data.translateX = value;\n      }\n\n      else\n      {\n         if (this._data.translateX !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateX');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateX;\n      }\n   }\n\n   /**\n    * Sets the local translateY data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateY(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateY === void 0) { this.#orderList.push('translateY'); }\n\n         this._data.translateY = value;\n      }\n\n      else\n      {\n         if (this._data.translateY !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateY');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateY;\n      }\n   }\n\n   /**\n    * Sets the local translateZ data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateZ(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateZ === void 0) { this.#orderList.push('translateZ'); }\n\n         this._data.translateZ = value;\n      }\n\n      else\n      {\n         if (this._data.translateZ !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateZ');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateZ;\n      }\n   }\n\n   /**\n    * Returns the matrix3d CSS transform for the given position / transform data.\n    *\n    * @param {object} [data] - Optional position data otherwise use local stored transform data.\n    *\n    * @returns {string} The CSS matrix3d string.\n    */\n   getCSS(data = this._data)\n   {\n      return `matrix3d(${this.getMat4(data, s_MAT4_RESULT).join(',')})`;\n   }\n\n   /**\n    * Returns the matrix3d CSS transform for the given position / transform data.\n    *\n    * @param {object} [data] - Optional position data otherwise use local stored transform data.\n    *\n    * @returns {string} The CSS matrix3d string.\n    */\n   getCSSOrtho(data = this._data)\n   {\n      return `matrix3d(${this.getMat4Ortho(data, s_MAT4_RESULT).join(',')})`;\n   }\n\n   /**\n    * Collects all data including a bounding rect, transform matrix, and points array of the given {@link PositionData}\n    * instance with the applied local transform data.\n    *\n    * @param {PositionData} position - The position data to process.\n    *\n    * @param {TransformData} [output] - Optional TransformData output instance.\n    *\n    * @param {object} [validationData] - Optional validation data for adjustment parameters.\n    *\n    * @returns {TransformData} The output TransformData instance.\n    */\n   getData(position, output = new TransformData(), validationData = {})\n   {\n      const valWidth = validationData.width ?? 0;\n      const valHeight = validationData.height ?? 0;\n      const valOffsetTop = validationData.offsetTop ?? validationData.marginTop ?? 0;\n      const valOffsetLeft = validationData.offsetLeft ?? validationData.offsetLeft ?? 0;\n\n      position.top += valOffsetTop;\n      position.left += valOffsetLeft;\n\n      const width = Number.isFinite(position.width) ? position.width : valWidth;\n      const height = Number.isFinite(position.height) ? position.height : valHeight;\n\n      const rect = output.corners;\n\n      if (this.hasTransform(position))\n      {\n         rect[0][0] = rect[0][1] = rect[0][2] = 0;\n         rect[1][0] = width;\n         rect[1][1] = rect[1][2] = 0;\n         rect[2][0] = width;\n         rect[2][1] = height;\n         rect[2][2] = 0;\n         rect[3][0] = 0;\n         rect[3][1] = height;\n         rect[3][2] = 0;\n\n         const matrix = this.getMat4(position, output.mat4);\n\n         const translate = s_GET_ORIGIN_TRANSLATION(position.transformOrigin, width, height, output.originTranslations);\n\n         if (constants.transformOriginDefault === position.transformOrigin)\n         {\n            vec3.transformMat4(rect[0], rect[0], matrix);\n            vec3.transformMat4(rect[1], rect[1], matrix);\n            vec3.transformMat4(rect[2], rect[2], matrix);\n            vec3.transformMat4(rect[3], rect[3], matrix);\n         }\n         else\n         {\n            vec3.transformMat4(rect[0], rect[0], translate[0]);\n            vec3.transformMat4(rect[0], rect[0], matrix);\n            vec3.transformMat4(rect[0], rect[0], translate[1]);\n\n            vec3.transformMat4(rect[1], rect[1], translate[0]);\n            vec3.transformMat4(rect[1], rect[1], matrix);\n            vec3.transformMat4(rect[1], rect[1], translate[1]);\n\n            vec3.transformMat4(rect[2], rect[2], translate[0]);\n            vec3.transformMat4(rect[2], rect[2], matrix);\n            vec3.transformMat4(rect[2], rect[2], translate[1]);\n\n            vec3.transformMat4(rect[3], rect[3], translate[0]);\n            vec3.transformMat4(rect[3], rect[3], matrix);\n            vec3.transformMat4(rect[3], rect[3], translate[1]);\n         }\n\n         rect[0][0] = position.left + rect[0][0];\n         rect[0][1] = position.top + rect[0][1];\n         rect[1][0] = position.left + rect[1][0];\n         rect[1][1] = position.top + rect[1][1];\n         rect[2][0] = position.left + rect[2][0];\n         rect[2][1] = position.top + rect[2][1];\n         rect[3][0] = position.left + rect[3][0];\n         rect[3][1] = position.top + rect[3][1];\n      }\n      else\n      {\n         rect[0][0] = position.left;\n         rect[0][1] = position.top;\n         rect[1][0] = position.left + width;\n         rect[1][1] = position.top;\n         rect[2][0] = position.left + width;\n         rect[2][1] = position.top + height;\n         rect[3][0] = position.left;\n         rect[3][1] = position.top + height;\n\n         mat4.identity(output.mat4);\n      }\n\n      let maxX = Number.MIN_SAFE_INTEGER;\n      let maxY = Number.MIN_SAFE_INTEGER;\n      let minX = Number.MAX_SAFE_INTEGER;\n      let minY = Number.MAX_SAFE_INTEGER;\n\n      for (let cntr = 4; --cntr >= 0;)\n      {\n         if (rect[cntr][0] > maxX) { maxX = rect[cntr][0]; }\n         if (rect[cntr][0] < minX) { minX = rect[cntr][0]; }\n         if (rect[cntr][1] > maxY) { maxY = rect[cntr][1]; }\n         if (rect[cntr][1] < minY) { minY = rect[cntr][1]; }\n      }\n\n      const boundingRect = output.boundingRect;\n      boundingRect.x = minX;\n      boundingRect.y = minY;\n      boundingRect.width = maxX - minX;\n      boundingRect.height = maxY - minY;\n\n      position.top -= valOffsetTop;\n      position.left -= valOffsetLeft;\n\n      return output;\n   }\n\n   /**\n    * Creates a transform matrix based on local data applied in order it was added.\n    *\n    * If no data object is provided then the source is the local transform data. If another data object is supplied\n    * then the stored local transform order is applied then all remaining transform keys are applied. This allows the\n    * construction of a transform matrix in advance of setting local data and is useful in collision detection.\n    *\n    * @param {object}   [data] - PositionData instance or local transform data.\n    *\n    * @param {Matrix4}  [output] - The output mat4 instance.\n    *\n    * @returns {Matrix4} Transform matrix.\n    */\n   getMat4(data = this._data, output = mat4.create())\n   {\n      const matrix = mat4.identity(output);\n\n      // Bitwise tracks applied transform keys from local transform data.\n      let seenKeys = 0;\n\n      const orderList = this.#orderList;\n\n      // First apply ordered transforms from local transform data.\n      for (let cntr = 0; cntr < orderList.length; cntr++)\n      {\n         const key = orderList[cntr];\n\n         switch (key)\n         {\n            case 'rotateX':\n               seenKeys |= constants.transformKeysBitwise.rotateX;\n               mat4.multiply(matrix, matrix, mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateY':\n               seenKeys |= constants.transformKeysBitwise.rotateY;\n               mat4.multiply(matrix, matrix, mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateZ':\n               seenKeys |= constants.transformKeysBitwise.rotateZ;\n               mat4.multiply(matrix, matrix, mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'scale':\n               seenKeys |= constants.transformKeysBitwise.scale;\n               s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data[key];\n               mat4.multiply(matrix, matrix, mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n               break;\n\n            case 'translateX':\n               seenKeys |= constants.transformKeysBitwise.translateX;\n               s_TRANSLATE_VECTOR[0] = data.translateX;\n               s_TRANSLATE_VECTOR[1] = 0;\n               s_TRANSLATE_VECTOR[2] = 0;\n               mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n\n            case 'translateY':\n               seenKeys |= constants.transformKeysBitwise.translateY;\n               s_TRANSLATE_VECTOR[0] = 0;\n               s_TRANSLATE_VECTOR[1] = data.translateY;\n               s_TRANSLATE_VECTOR[2] = 0;\n               mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n\n            case 'translateZ':\n               seenKeys |= constants.transformKeysBitwise.translateZ;\n               s_TRANSLATE_VECTOR[0] = 0;\n               s_TRANSLATE_VECTOR[1] = 0;\n               s_TRANSLATE_VECTOR[2] = data.translateZ;\n               mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n         }\n      }\n\n      // Now apply any new keys not set in local transform data that have not been applied yet.\n      if (data !== this._data)\n      {\n         for (let cntr = 0; cntr < constants.transformKeys.length; cntr++)\n         {\n            const key = constants.transformKeys[cntr];\n\n            // Reject bad / no data or if the key has already been applied.\n            if (data[key] === null || (seenKeys & constants.transformKeysBitwise[key]) > 0) { continue; }\n\n            switch (key)\n            {\n               case 'rotateX':\n                  mat4.multiply(matrix, matrix, mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateY':\n                  mat4.multiply(matrix, matrix, mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateZ':\n                  mat4.multiply(matrix, matrix, mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'scale':\n                  s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data[key];\n                  mat4.multiply(matrix, matrix, mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n                  break;\n\n               case 'translateX':\n                  s_TRANSLATE_VECTOR[0] = data[key];\n                  s_TRANSLATE_VECTOR[1] = 0;\n                  s_TRANSLATE_VECTOR[2] = 0;\n                  mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n\n               case 'translateY':\n                  s_TRANSLATE_VECTOR[0] = 0;\n                  s_TRANSLATE_VECTOR[1] = data[key];\n                  s_TRANSLATE_VECTOR[2] = 0;\n                  mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n\n               case 'translateZ':\n                  s_TRANSLATE_VECTOR[0] = 0;\n                  s_TRANSLATE_VECTOR[1] = 0;\n                  s_TRANSLATE_VECTOR[2] = data[key];\n                  mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n            }\n         }\n      }\n\n      return matrix;\n   }\n\n   /**\n    * Provides an orthographic enhancement to convert left / top positional data to a translate operation.\n    *\n    * This transform matrix takes into account that the remaining operations are , but adds any left / top attributes from passed in data to\n    * translate X / Y.\n    *\n    * If no data object is provided then the source is the local transform data. If another data object is supplied\n    * then the stored local transform order is applied then all remaining transform keys are applied. This allows the\n    * construction of a transform matrix in advance of setting local data and is useful in collision detection.\n    *\n    * @param {object}   [data] - PositionData instance or local transform data.\n    *\n    * @param {Matrix4}  [output] - The output mat4 instance.\n    *\n    * @returns {Matrix4} Transform matrix.\n    */\n   getMat4Ortho(data = this._data, output = mat4.create())\n   {\n      const matrix = mat4.identity(output);\n\n      // Attempt to retrieve values from passed in data otherwise default to 0.\n      // Always perform the translation last regardless of order added to local transform data.\n      // Add data.left to translateX and data.top to translateY.\n      s_TRANSLATE_VECTOR[0] = (data.left ?? 0) + (data.translateX ?? 0);\n      s_TRANSLATE_VECTOR[1] = (data.top ?? 0) + (data.translateY ?? 0);\n      s_TRANSLATE_VECTOR[2] = data.translateZ ?? 0;\n      mat4.multiply(matrix, matrix, mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n\n      // Scale can also be applied out of order.\n      if (data.scale !== null)\n      {\n         s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data.scale;\n         mat4.multiply(matrix, matrix, mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n      }\n\n      // Early out if there is not rotation data.\n      if (data.rotateX === null && data.rotateY === null && data.rotateZ === null) { return matrix; }\n\n      // Rotation transforms must be applied in the order they are added.\n\n      // Bitwise tracks applied transform keys from local transform data.\n      let seenKeys = 0;\n\n      const orderList = this.#orderList;\n\n      // First apply ordered transforms from local transform data.\n      for (let cntr = 0; cntr < orderList.length; cntr++)\n      {\n         const key = orderList[cntr];\n\n         switch (key)\n         {\n            case 'rotateX':\n               seenKeys |= constants.transformKeysBitwise.rotateX;\n               mat4.multiply(matrix, matrix, mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateY':\n               seenKeys |= constants.transformKeysBitwise.rotateY;\n               mat4.multiply(matrix, matrix, mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateZ':\n               seenKeys |= constants.transformKeysBitwise.rotateZ;\n               mat4.multiply(matrix, matrix, mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n         }\n      }\n\n      // Now apply any new keys not set in local transform data that have not been applied yet.\n      if (data !== this._data)\n      {\n         for (let cntr = 0; cntr < constants.transformKeys.length; cntr++)\n         {\n            const key = constants.transformKeys[cntr];\n\n            // Reject bad / no data or if the key has already been applied.\n            if (data[key] === null || (seenKeys & constants.transformKeysBitwise[key]) > 0) { continue; }\n\n            switch (key)\n            {\n               case 'rotateX':\n                  mat4.multiply(matrix, matrix, mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateY':\n                  mat4.multiply(matrix, matrix, mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateZ':\n                  mat4.multiply(matrix, matrix, mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n            }\n         }\n      }\n\n      return matrix;\n   }\n\n   /**\n    * Tests an object if it contains transform keys and the values are finite numbers.\n    *\n    * @param {object} data - An object to test for transform data.\n    *\n    * @returns {boolean} Whether the given PositionData has transforms.\n    */\n   hasTransform(data)\n   {\n      for (const key of constants.transformKeys)\n      {\n         if (Number.isFinite(data[key])) { return true; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Resets internal data from the given object containing valid transform keys.\n    *\n    * @param {object}   data - An object with transform data.\n    */\n   reset(data)\n   {\n      for (const key in data)\n      {\n         if (constants.transformKeys.includes(key))\n         {\n            if (Number.isFinite(data[key]))\n            {\n               this._data[key] = data[key];\n            }\n            else\n            {\n               const index = this.#orderList.findIndex((entry) => entry === key);\n               if (index >= 0) { this.#orderList.splice(index, 1); }\n\n               delete this._data[key];\n            }\n         }\n      }\n   }\n}\n\n/**\n * Returns the translations necessary to translate a matrix operation based on the `transformOrigin` parameter of the\n * given position instance. The first entry / index 0 is the pre-translation and last entry / index 1 is the post-\n * translation.\n *\n * This method is used internally, but may be useful if you need the origin translation matrices to transform\n * bespoke points based on any `transformOrigin` set in {@link PositionData}.\n *\n * @param {string}   transformOrigin - The transform origin attribute from PositionData.\n *\n * @param {number}   width - The PositionData width or validation data width when 'auto'.\n *\n * @param {number}   height - The PositionData height or validation data height when 'auto'.\n *\n * @param {Matrix4[]}   output - Output Mat4 array.\n *\n * @returns {Matrix4[]} Output Mat4 array.\n */\nfunction s_GET_ORIGIN_TRANSLATION(transformOrigin, width, height, output)\n{\n   const vector = s_VEC3_TEMP;\n\n   switch (transformOrigin)\n   {\n      case 'top left':\n         vector[0] = vector[1] = 0;\n         mat4.fromTranslation(output[0], vector);\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'top center':\n         vector[0] = -width * 0.5;\n         vector[1] = 0;\n         mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'top right':\n         vector[0] = -width;\n         vector[1] = 0;\n         mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'center left':\n         vector[0] = 0;\n         vector[1] = -height * 0.5;\n         mat4.fromTranslation(output[0], vector);\n         vector[1] = height * 0.5;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case null: // By default null / no transform is center.\n      case 'center':\n         vector[0] = -width * 0.5;\n         vector[1] = -height * 0.5;\n         mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         vector[1] = height * 0.5;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'center right':\n         vector[0] = -width;\n         vector[1] = -height * 0.5;\n         mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         vector[1] = height * 0.5;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom left':\n         vector[0] = 0;\n         vector[1] = -height;\n         mat4.fromTranslation(output[0], vector);\n         vector[1] = height;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom center':\n         vector[0] = -width * 0.5;\n         vector[1] = -height;\n         mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         vector[1] = height;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom right':\n         vector[0] = -width;\n         vector[1] = -height;\n         mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         vector[1] = height;\n         mat4.fromTranslation(output[1], vector);\n         break;\n\n      // No valid transform origin parameter; set identity.\n      default:\n         mat4.identity(output[0]);\n         mat4.identity(output[1]);\n         break;\n   }\n\n   return output;\n}\n","import { writable }        from 'svelte/store';\n\nimport { TransformData }   from '../transform/TransformData.js';\nimport { PositionData }    from '../PositionData.js';\n\nexport class UpdateElementData\n{\n   constructor()\n   {\n      /**\n       * Stores the private data from Position.\n       *\n       * @type {PositionData}\n       */\n      this.data = void 0;\n\n      /**\n       * Provides a copy of local data sent to subscribers.\n       *\n       * @type {PositionData}\n       */\n      this.dataSubscribers = new PositionData();\n\n      /**\n       * Stores the current dimension data used for the readable `dimension` store.\n       *\n       * @type {{width: number | 'auto', height: number | 'auto'}}\n       */\n      this.dimensionData = { width: 0, height: 0 };\n\n      /**\n       * @type {PositionChangeSet}\n       */\n      this.changeSet = void 0;\n\n      /**\n       * @type {PositionOptions}\n       */\n      this.options = void 0;\n\n      /**\n       * Stores if this Position / update data is queued for update.\n       *\n       * @type {boolean}\n       */\n      this.queued = false;\n\n      /**\n       * @type {StyleCache}\n       */\n      this.styleCache = void 0;\n\n      /**\n       * @type {Transforms}\n       */\n      this.transforms = void 0;\n\n      /**\n       * Stores the current transform data used for the readable `transform` store. It is only active when there are\n       * subscribers to the store or calculateTransform options is true.\n       *\n       * @type {TransformData}\n       */\n      this.transformData = new TransformData();\n\n      /**\n       * @type {(function(PositionData): void)[]}\n       */\n      this.subscriptions = void 0;\n\n      /**\n       * @type {Writable<{width: (number|\"auto\"), height: (number|\"auto\")}>}\n       */\n      this.storeDimension = writable(this.dimensionData);\n\n      // When there are subscribers set option to calculate transform updates; set to false when no subscribers.\n\n      /**\n       * @type {Writable<TransformData>}\n       */\n      this.storeTransform = writable(this.transformData, () =>\n      {\n         this.options.transformSubscribed = true;\n         return () => this.options.transformSubscribed = false;\n      });\n\n      /**\n       * Stores the queued state for update element processing.\n       *\n       * @type {boolean}\n       */\n      this.queued = false;\n\n      // Seal data backing readable stores.\n      Object.seal(this.dimensionData);\n   }\n}\n","import { isWritableStore } from '@typhonjs-fvtt/runtime/svelte/store';\n\n/**\n * Svelte doesn't provide any events for the animate directive.\n *\n * The provided function below wraps a Svelte animate directive function generating bubbling events for start & end of\n * animation.\n *\n * These events are `animate:start` and `animate:end`.\n *\n * This is useful for instance if you are animating several nodes in a scrollable container where the overflow parameter\n * needs to be set to `none` while animating such that the scrollbar is not activated by the animation.\n *\n * Optionally you may also provide a boolean writable store that will be set to true when animation is active. In some\n * cases this leads to an easier implementation for gating on animation state.\n *\n * @example <caption>With events</caption>\n * const flipWithEvents = animateEvents(flip);\n * </script>\n *\n * <main on:animate:start={() => console.log('animate:start')\n *       on:animate:end={() => console.log('animate:end')}>\n *    {#each someData as entry (entry.id)}\n *       <section animate:flipWithEvents />\n *    {/each}\n\n * @example <caption>With optional store</caption>\n * const isAnimating = writable(false);\n * const flipWithEvents = animateEvents(flip, isAnimating);\n * </script>\n *\n * <main class:no-scroll={$isAnimating}>\n *    {#each someData as entry (entry.id)}\n *       <section animate:flipWithEvents />\n *    {/each}\n *\n * @param {(node: Element, { from: DOMRect, to: DOMRect }, params?: *) => import('svelte/animate').AnimationConfig} fn -\n *        A Svelte animation function.\n *\n * @param {import('svelte/store').Writable<boolean>} [store] - An optional boolean writable store that is set to true\n *                                                             when animation is active.\n *\n * @returns {(node: Element, { from: DOMRect, to: DOMRect }, params?: *) => import('svelte/animate').AnimationConfig}\n *          Wrapped animation function.\n */\nfunction animateEvents(fn, store = void 0)\n{\n   if (typeof fn !== 'function') { throw new TypeError(`'fn' is not a function.`); }\n   if (store !== void 0 && !isWritableStore(store)) { throw new TypeError(`'store' is not a writable store.`); }\n\n   // Track a single start / end sequence across all animations.\n   let startFired = false;\n   let endFired = false;\n\n   return (node, animations, params = {}) =>\n   {\n      const animationConfig = fn(node, animations, params);\n\n      // Store any existing tick function.\n      const existingTick = animationConfig.tick;\n\n      // Use tick callback to fire events only once when t / time is 0 and 1.\n      animationConfig.tick = (t, u) =>\n      {\n         // If there is any tick function then invoke it.\n         if (existingTick) { existingTick(t, u); }\n\n         if (!startFired && t === 0)\n         {\n            if (store) { store.set(true); }\n            node.dispatchEvent(new CustomEvent('animate:start', { bubbles: true }));\n            startFired = true;\n            endFired = false;\n         }\n\n         if (!endFired && t === 1)\n         {\n            if (store) { store.set(false); }\n            node.dispatchEvent(new CustomEvent('animate:end', { bubbles: true }));\n            endFired = true;\n            startFired = false;\n         }\n      };\n\n      return animationConfig;\n   };\n}\n\n/**\n * Awaits `requestAnimationFrame` calls by the counter specified. This allows asynchronous applications for direct /\n * inline style modification amongst other direct animation techniques.\n *\n * @param {number}   [cntr=1] - A positive integer greater than 0 for amount of requestAnimationFrames to wait.\n *\n * @returns {Promise<number>} Returns current time equivalent to `performance.now()`.\n */\nasync function nextAnimationFrame(cntr = 1)\n{\n   if (!Number.isInteger(cntr) || cntr < 1)\n   {\n      throw new TypeError(`nextAnimationFrame error: 'cntr' must be a positive integer greater than 0.`);\n   }\n\n   let currentTime = performance.now();\n   for (;--cntr >= 0;)\n   {\n      currentTime = await new Promise((resolve) => requestAnimationFrame(resolve));\n   }\n\n   return currentTime;\n}\n\nexport { animateEvents, nextAnimationFrame };\n//# sourceMappingURL=index.js.map\n","import { nextAnimationFrame }    from '@typhonjs-fvtt/runtime/svelte/animate';\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke {@link Position.elementUpdated} to await\n * on the returned promise that is resolved with the current render time via `nextAnimationFrame` /\n * `requestAnimationFrame`. This allows the underlying data model to be updated immediately while updates to the\n * element are in sync with the browser and potentially in the future be further throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n */\nexport class UpdateElementManager\n{\n   static list = [];\n   static listCntr = 0;\n\n   static updatePromise;\n\n   static get promise() { return this.updatePromise; }\n\n   /**\n    * Potentially adds the given element and internal updateData instance to the list.\n    *\n    * @param {HTMLElement}       el - An HTMLElement instance.\n    *\n    * @param {UpdateElementData} updateData - An UpdateElementData instance.\n    *\n    * @returns {Promise<number>} The unified next frame update promise. Returns `currentTime`.\n    */\n   static add(el, updateData)\n   {\n      if (this.listCntr < this.list.length)\n      {\n         const entry = this.list[this.listCntr];\n         entry[0] = el;\n         entry[1] = updateData;\n      }\n      else\n      {\n         this.list.push([el, updateData]);\n      }\n\n      this.listCntr++;\n      updateData.queued = true;\n\n      if (!this.updatePromise) { this.updatePromise = this.wait(); }\n\n      return this.updatePromise;\n   }\n\n   /**\n    * Await on `nextAnimationFrame` and iterate over list map invoking callback functions.\n    *\n    * @returns {Promise<number>} The next frame Promise / currentTime from nextAnimationFrame.\n    */\n   static async wait()\n   {\n      // Await the next animation frame. In the future this can be extended to multiple frames to divide update rate.\n      const currentTime = await nextAnimationFrame();\n\n      this.updatePromise = void 0;\n\n      for (let cntr = this.listCntr; --cntr >= 0;)\n      {\n         // Obtain data for entry.\n         const entry = this.list[cntr];\n         const el = entry[0];\n         const updateData = entry[1];\n\n         // Clear entry data.\n         entry[0] = void 0;\n         entry[1] = void 0;\n\n         // Reset queued state.\n         updateData.queued = false;\n\n         // Early out if the element is no longer connected to the DOM / shadow root.\n         // if (!el.isConnected || !updateData.changeSet.hasChange()) { continue; }\n         if (!el.isConnected) { continue; }\n\n         if (updateData.options.ortho)\n         {\n            s_UPDATE_ELEMENT_ORTHO(el, updateData);\n         }\n         else\n         {\n            s_UPDATE_ELEMENT(el, updateData);\n         }\n\n         // If calculate transform options is enabled then update the transform data and set the readable store.\n         if (updateData.options.calculateTransform || updateData.options.transformSubscribed)\n         {\n            s_UPDATE_TRANSFORM(el, updateData);\n         }\n\n         // Update all subscribers with changed data.\n         this.updateSubscribers(updateData);\n      }\n\n      this.listCntr = 0;\n\n      return currentTime;\n   }\n\n   /**\n    * Potentially immediately updates the given element.\n    *\n    * @param {HTMLElement}       el - An HTMLElement instance.\n    *\n    * @param {UpdateElementData} updateData - An UpdateElementData instance.\n    */\n   static immediate(el, updateData)\n   {\n      // Early out if the element is no longer connected to the DOM / shadow root.\n      // if (!el.isConnected || !updateData.changeSet.hasChange()) { continue; }\n      if (!el.isConnected) { return; }\n\n      if (updateData.options.ortho)\n      {\n         s_UPDATE_ELEMENT_ORTHO(el, updateData);\n      }\n      else\n      {\n         s_UPDATE_ELEMENT(el, updateData);\n      }\n\n      // If calculate transform options is enabled then update the transform data and set the readable store.\n      if (updateData.options.calculateTransform || updateData.options.transformSubscribed)\n      {\n         s_UPDATE_TRANSFORM(el, updateData);\n      }\n\n      // Update all subscribers with changed data.\n      this.updateSubscribers(updateData);\n   }\n\n   /**\n    * @param {UpdateElementData} updateData - Data change set.\n    */\n   static updateSubscribers(updateData)\n   {\n      const data = updateData.data;\n      const changeSet = updateData.changeSet;\n\n      if (!changeSet.hasChange()) { return; }\n\n      // Make a copy of the data.\n      const output = updateData.dataSubscribers.copy(data);\n\n      const subscriptions = updateData.subscriptions;\n\n      // Early out if there are no subscribers.\n      if (subscriptions.length > 0)\n      {\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](output); }\n      }\n\n      // Update dimension data if width / height has changed.\n      if (changeSet.width || changeSet.height)\n      {\n         updateData.dimensionData.width = data.width;\n         updateData.dimensionData.height = data.height;\n         updateData.storeDimension.set(updateData.dimensionData);\n      }\n\n      changeSet.set(false);\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke {@link Position.elementUpdated} to await\n * on the returned promise that is resolved with the current render time via `nextAnimationFrame` /\n * `requestAnimationFrame`. This allows the underlying data model to be updated immediately while updates to the\n * element are in sync with the browser and potentially in the future be further throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {UpdateElementData} updateData - Update data.\n */\nfunction s_UPDATE_ELEMENT(el, updateData)\n{\n   const changeSet = updateData.changeSet;\n   const data = updateData.data;\n\n   if (changeSet.left)\n   {\n      el.style.left = `${data.left}px`;\n   }\n\n   if (changeSet.top)\n   {\n      el.style.top = `${data.top}px`;\n   }\n\n   if (changeSet.zIndex)\n   {\n      el.style.zIndex = typeof data.zIndex === 'number' ? `${data.zIndex}` : null;\n   }\n\n   if (changeSet.width)\n   {\n      el.style.width = typeof data.width === 'number' ? `${data.width}px` : data.width;\n   }\n\n   if (changeSet.height)\n   {\n      el.style.height = typeof data.height === 'number' ? `${data.height}px` : data.height;\n   }\n\n   if (changeSet.transformOrigin)\n   {\n      // When set to 'center' we can simply set the transform to null which is center by default.\n      el.style.transformOrigin = data.transformOrigin === 'center' ? null : data.transformOrigin;\n   }\n\n   // Update all transforms in order added to transforms object.\n   if (changeSet.transform)\n   {\n      el.style.transform = updateData.transforms.isActive ? updateData.transforms.getCSS() : null;\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke {@link Position.elementUpdated} to await\n * on the returned promise that is resolved with the current render time via `nextAnimationFrame` /\n * `requestAnimationFrame`. This allows the underlying data model to be updated immediately while updates to the\n * element are in sync with the browser and potentially in the future be further throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {UpdateElementData} updateData - Update data.\n */\nfunction s_UPDATE_ELEMENT_ORTHO(el, updateData)\n{\n   const changeSet = updateData.changeSet;\n   const data = updateData.data;\n\n   if (changeSet.zIndex)\n   {\n      el.style.zIndex = typeof data.zIndex === 'number' ? `${data.zIndex}` : null;\n   }\n\n   if (changeSet.width)\n   {\n      el.style.width = typeof data.width === 'number' ? `${data.width}px` : data.width;\n   }\n\n   if (changeSet.height)\n   {\n      el.style.height = typeof data.height === 'number' ? `${data.height}px` : data.height;\n   }\n\n   if (changeSet.transformOrigin)\n   {\n      // When set to 'center' we can simply set the transform to null which is center by default.\n      el.style.transformOrigin = data.transformOrigin === 'center' ? null : data.transformOrigin;\n   }\n\n   // Update all transforms in order added to transforms object.\n   if (changeSet.left || changeSet.top || changeSet.transform)\n   {\n      el.style.transform = updateData.transforms.getCSSOrtho(data);\n   }\n}\n\n/**\n * Updates the applied transform data and sets the readble `transform` store.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {UpdateElementData} updateData - Update element data.\n */\nfunction s_UPDATE_TRANSFORM(el, updateData)\n{\n   s_VALIDATION_DATA.height = updateData.data.height !== 'auto' ? updateData.data.height :\n    updateData.styleCache.offsetHeight;\n\n   s_VALIDATION_DATA.width = updateData.data.width !== 'auto' ? updateData.data.width :\n    updateData.styleCache.offsetWidth;\n\n   s_VALIDATION_DATA.marginLeft = updateData.styleCache.marginLeft;\n\n   s_VALIDATION_DATA.marginTop = updateData.styleCache.marginTop;\n\n   // Get transform data. First set constraints including any margin top / left as offsets and width / height. Used\n   // when position width / height is 'auto'.\n   updateData.transforms.getData(updateData.data, updateData.transformData, s_VALIDATION_DATA);\n\n   updateData.storeTransform.set(updateData.transformData);\n}\n\nconst s_VALIDATION_DATA = {\n   height: void 0,\n   width: void 0,\n   marginLeft: void 0,\n   marginTop: void 0\n};\n","import {\n   propertyStore,\n   subscribeIgnoreFirst }        from '@typhonjs-fvtt/runtime/svelte/store';\n\nimport {\n   isIterable,\n   isObject,\n   isPlainObject }               from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { AnimationAPI }          from './animation/AnimationAPI.js';\nimport { AnimationGroupAPI }     from './animation/AnimationGroupAPI.js';\nimport * as constants            from './constants.js';\nimport { convertRelative }       from './convertRelative.js';\nimport * as positionInitial      from './initial/index.js';\nimport { PositionChangeSet }     from './PositionChangeSet.js';\nimport { PositionData }          from './PositionData.js';\nimport { PositionStateAPI }      from './PositionStateAPI.js';\nimport { StyleCache }            from './StyleCache.js';\nimport { TransformData }         from './transform/TransformData.js';\nimport { AdapterValidators }     from './validators/AdapterValidators.js';\nimport * as positionValidators   from './validators/index.js';\nimport { Transforms }            from './transform/Transforms.js';\nimport { UpdateElementData }     from './update/UpdateElementData.js';\nimport { UpdateElementManager }  from './update/UpdateElementManager.js';\n\n/**\n * Provides a store for position following the subscriber protocol in addition to providing individual writable derived\n * stores for each independent variable.\n */\nexport class Position\n{\n   /**\n    * @type {PositionData}\n    */\n   #data = new PositionData();\n\n   /**\n    * Provides the animation API.\n    *\n    * @type {AnimationAPI}\n    */\n   #animate = new AnimationAPI(this, this.#data);\n\n   /**\n    * Provides a way to turn on / off the position handling.\n    *\n    * @type {boolean}\n    */\n   #enabled = true;\n\n   /**\n    * Stores the style attributes that changed on update.\n    *\n    * @type {PositionChangeSet}\n    */\n   #positionChangeSet = new PositionChangeSet();\n\n   /**\n    * Stores ongoing options that are set in the constructor or by transform store subscription.\n    *\n    * @type {PositionOptions}\n    */\n   #options = {\n      calculateTransform: false,\n      initialHelper: void 0,\n      ortho: true,\n      transformSubscribed: false\n   };\n\n   /**\n    * The associated parent for positional data tracking. Used in validators.\n    *\n    * @type {PositionParent}\n    */\n   #parent;\n\n   /**\n    * @type {StorePosition}\n    */\n   #stores;\n\n   /**\n    * Stores an instance of the computer styles for the target element.\n    *\n    * @type {StyleCache}\n    */\n   #styleCache;\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {(function(PositionData): void)[]}\n    */\n   #subscriptions = [];\n\n   /**\n    * @type {Transforms}\n    */\n   #transforms = new Transforms();\n\n   /**\n    * @type {UpdateElementData}\n    */\n   #updateElementData;\n\n   /**\n    * Stores the UpdateElementManager wait promise.\n    *\n    * @type {Promise}\n    */\n   #updateElementPromise;\n\n   /**\n    * @type {AdapterValidators}\n    */\n   #validators;\n\n   /**\n    * @type {ValidatorData[]}\n    */\n   #validatorData;\n\n   /**\n    * @type {PositionStateAPI}\n    */\n   #state = new PositionStateAPI(this, this.#data, this.#transforms);\n\n   /**\n    * @returns {AnimationGroupAPI} Public Animation API.\n    */\n   static get Animate() { return AnimationGroupAPI; }\n\n   /**\n    * @returns {{browserCentered?: Centered, Centered?: *}} Initial position helpers.\n    */\n   static get Initial() { return positionInitial; }\n\n   /**\n    * Returns TransformData class / constructor.\n    *\n    * @returns {TransformData} TransformData class / constructor.\n    */\n   static get TransformData() { return TransformData; }\n\n   /**\n    * Returns default validators.\n    *\n    * Note: `basicWindow` and `BasicBounds` will eventually be removed.\n    *\n    * @returns {{basicWindow?: BasicBounds, transformWindow?: TransformBounds, TransformBounds?: *, BasicBounds?: *}}\n    *  Available validators.\n    */\n   static get Validators() { return positionValidators; }\n\n   /**\n    * Returns a duplicate of a given position instance copying any options and validators.\n    *\n    * // TODO: Consider more safety over options processing.\n    *\n    * @param {Position}          position - A position instance.\n    *\n    * @param {PositionOptions}   options - Position options.\n    *\n    * @returns {Position} A duplicate position instance.\n    */\n   static duplicate(position, options)\n   {\n      if (!(position instanceof Position)) { throw new TypeError(`'position' is not an instance of Position.`); }\n\n      const newPosition = new Position(options);\n\n      newPosition.#options = Object.assign({}, position.#options, options);\n      newPosition.#validators.add(...position.#validators);\n\n      newPosition.set(position.#data);\n\n      return newPosition;\n   }\n\n   /**\n    * @param {PositionParent|PositionOptionsAll}   [parent] - A potential parent element or object w/ `elementTarget`\n    *                                                      getter. May also be the PositionOptions object w/ 1 argument.\n    *\n    * @param {PositionOptionsAll}   [options] - Default values.\n    */\n   constructor(parent, options)\n   {\n      // Test if `parent` is a plain object; if so treat as options object.\n      if (isPlainObject(parent))\n      {\n         options = parent;\n      }\n      else\n      {\n         this.#parent = parent;\n      }\n\n      const data = this.#data;\n      const transforms = this.#transforms;\n\n      this.#styleCache = new StyleCache();\n\n      const updateData = new UpdateElementData();\n\n      updateData.changeSet = this.#positionChangeSet;\n      updateData.data = this.#data;\n      updateData.options = this.#options;\n      updateData.styleCache = this.#styleCache;\n      updateData.subscriptions = this.#subscriptions;\n      updateData.transforms = this.#transforms;\n\n      this.#updateElementData = updateData;\n\n      if (isObject(options))\n      {\n         // Set Position options\n         if (typeof options.calculateTransform === 'boolean')\n         {\n            this.#options.calculateTransform = options.calculateTransform;\n         }\n\n         if (typeof options.ortho === 'boolean')\n         {\n            this.#options.ortho = options.ortho;\n         }\n\n         // Set default values from options.\n\n         if (Number.isFinite(options.height) || options.height === 'auto' || options.height === 'inherit' ||\n          options.height === null)\n         {\n            data.height = updateData.dimensionData.height = typeof options.height === 'number' ?\n             Math.round(options.height) : options.height;\n         }\n\n         if (Number.isFinite(options.left) || options.left === null)\n         {\n            data.left = typeof options.left === 'number' ? Math.round(options.left) : options.left;\n         }\n\n         if (Number.isFinite(options.maxHeight) || options.maxHeight === null)\n         {\n            data.maxHeight = typeof options.maxHeight === 'number' ? Math.round(options.maxHeight) : options.maxHeight;\n         }\n\n         if (Number.isFinite(options.maxWidth) || options.maxWidth === null)\n         {\n            data.maxWidth = typeof options.maxWidth === 'number' ? Math.round(options.maxWidth) : options.maxWidth;\n         }\n\n         if (Number.isFinite(options.minHeight) || options.minHeight === null)\n         {\n            data.minHeight = typeof options.minHeight === 'number' ? Math.round(options.minHeight) : options.minHeight;\n         }\n\n         if (Number.isFinite(options.minWidth) || options.minWidth === null)\n         {\n            data.minWidth = typeof options.minWidth === 'number' ? Math.round(options.minWidth) : options.minWidth;\n         }\n\n         if (Number.isFinite(options.rotateX) || options.rotateX === null)\n         {\n            transforms.rotateX = data.rotateX = options.rotateX;\n         }\n\n         if (Number.isFinite(options.rotateY) || options.rotateY === null)\n         {\n            transforms.rotateY = data.rotateY = options.rotateY;\n         }\n\n         if (Number.isFinite(options.rotateZ) || options.rotateZ === null)\n         {\n            transforms.rotateZ = data.rotateZ = options.rotateZ;\n         }\n\n         if (Number.isFinite(options.scale) || options.scale === null)\n         {\n            transforms.scale = data.scale = options.scale;\n         }\n\n         if (Number.isFinite(options.top) || options.top === null)\n         {\n            data.top = typeof options.top === 'number' ? Math.round(options.top) : options.top;\n         }\n\n         if (typeof options.transformOrigin === 'string' || options.transformOrigin === null)\n         {\n            data.transformOrigin = constants.transformOrigins.includes(options.transformOrigin) ?\n             options.transformOrigin : null;\n         }\n\n         if (Number.isFinite(options.translateX) || options.translateX === null)\n         {\n            transforms.translateX = data.translateX = options.translateX;\n         }\n\n         if (Number.isFinite(options.translateY) || options.translateY === null)\n         {\n            transforms.translateY = data.translateY = options.translateY;\n         }\n\n         if (Number.isFinite(options.translateZ) || options.translateZ === null)\n         {\n            transforms.translateZ = data.translateZ = options.translateZ;\n         }\n\n         if (Number.isFinite(options.width) || options.width === 'auto' || options.width === 'inherit' ||\n          options.width === null)\n         {\n            data.width = updateData.dimensionData.width = typeof options.width === 'number' ?\n             Math.round(options.width) : options.width;\n         }\n\n         if (Number.isFinite(options.zIndex) || options.zIndex === null)\n         {\n            data.zIndex = typeof options.zIndex === 'number' ? Math.round(options.zIndex) : options.zIndex;\n         }\n      }\n\n      this.#stores = {\n         // The main properties for manipulating Position.\n         height: propertyStore(this, 'height'),\n         left: propertyStore(this, 'left'),\n         rotateX: propertyStore(this, 'rotateX'),\n         rotateY: propertyStore(this, 'rotateY'),\n         rotateZ: propertyStore(this, 'rotateZ'),\n         scale: propertyStore(this, 'scale'),\n         top: propertyStore(this, 'top'),\n         transformOrigin: propertyStore(this, 'transformOrigin'),\n         translateX: propertyStore(this, 'translateX'),\n         translateY: propertyStore(this, 'translateY'),\n         translateZ: propertyStore(this, 'translateZ'),\n         width: propertyStore(this, 'width'),\n         zIndex: propertyStore(this, 'zIndex'),\n\n         // Stores that control validation when width / height is not `auto`.\n         maxHeight: propertyStore(this, 'maxHeight'),\n         maxWidth: propertyStore(this, 'maxWidth'),\n         minHeight: propertyStore(this, 'minHeight'),\n         minWidth: propertyStore(this, 'minWidth'),\n\n         // Readable stores based on updates or from resize observer changes.\n         dimension: { subscribe: updateData.storeDimension.subscribe },\n         element: { subscribe: this.#styleCache.stores.element.subscribe },\n         resizeContentHeight: { subscribe: this.#styleCache.stores.resizeContentHeight.subscribe },\n         resizeContentWidth: { subscribe: this.#styleCache.stores.resizeContentWidth.subscribe },\n         resizeOffsetHeight: { subscribe: this.#styleCache.stores.resizeOffsetHeight.subscribe },\n         resizeOffsetWidth: { subscribe: this.#styleCache.stores.resizeOffsetWidth.subscribe },\n         transform: { subscribe: updateData.storeTransform.subscribe },\n\n         // Protected store that should only be set by resizeObserver action.\n         resizeObserved: this.#styleCache.stores.resizeObserved,\n      };\n\n      // When resize change from any applied resizeObserver action automatically set data for new validation run.\n      // A resizeObserver prop should be set to true for ApplicationShell components or usage of resizeObserver action\n      // to monitor for changes. This should only be used on elements that have 'auto' for width or height.\n      subscribeIgnoreFirst(this.#stores.resizeObserved, (resizeData) =>\n      {\n         const parent = this.#parent;\n         const el = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n\n         // Only invoke set if there is a target element and the resize data has a valid offset width & height.\n         if (el instanceof HTMLElement && Number.isFinite(resizeData?.offsetWidth) &&\n          Number.isFinite(resizeData?.offsetHeight))\n         {\n            this.set(data);\n         }\n      });\n\n      this.#stores.transformOrigin.values = constants.transformOrigins;\n\n      [this.#validators, this.#validatorData] = new AdapterValidators();\n\n      if (options?.initial || options?.positionInitial)\n      {\n         const initialHelper = options.initial ?? options.positionInitial;\n\n         if (typeof initialHelper?.getLeft !== 'function' || typeof initialHelper?.getTop !== 'function')\n         {\n            throw new Error(\n             `'options.initial' position helper does not contain 'getLeft' and / or 'getTop' functions.`);\n         }\n\n         this.#options.initialHelper = options.initial;\n      }\n\n      if (options?.validator)\n      {\n         if (isIterable(options?.validator)) { this.validators.add(...options.validator); }\n         else { this.validators.add(options.validator); }\n      }\n   }\n\n   /**\n    * Returns the animation API.\n    *\n    * @returns {AnimationAPI} Animation API.\n    */\n   get animate()\n   {\n      return this.#animate;\n   }\n\n   /**\n    * Returns the dimension data for the readable store.\n    *\n    * @returns {{width: number | 'auto', height: number | 'auto'}} Dimension data.\n    */\n   get dimension()\n   {\n      return this.#updateElementData.dimensionData;\n   }\n\n   /**\n    * Returns the enabled state.\n    *\n    * @returns {boolean} Enabled state.\n    */\n   get enabled()\n   {\n      return this.#enabled;\n   }\n\n   /**\n    * Returns the current HTMLElement being positioned.\n    *\n    * @returns {HTMLElement|undefined} Current HTMLElement being positioned.\n    */\n   get element()\n   {\n      return this.#styleCache.el;\n   }\n\n   /**\n    * Returns a promise that is resolved on the next element update with the time of the update.\n    *\n    * @returns {Promise<number>} Promise resolved on element update.\n    */\n   get elementUpdated()\n   {\n      return this.#updateElementPromise;\n   }\n\n   /**\n    * Returns the associated {@link PositionParent} instance.\n    *\n    * @returns {PositionParent} The PositionParent instance.\n    */\n   get parent() { return this.#parent; }\n\n   /**\n    * Returns the state API.\n    *\n    * @returns {PositionStateAPI} Position state API.\n    */\n   get state() { return this.#state; }\n\n   /**\n    * Returns the derived writable stores for individual data variables.\n    *\n    * @returns {StorePosition} Derived / writable stores.\n    */\n   get stores() { return this.#stores; }\n\n   /**\n    * Returns the transform data for the readable store.\n    *\n    * @returns {TransformData} Transform Data.\n    */\n   get transform()\n   {\n      return this.#updateElementData.transformData;\n   }\n\n   /**\n    * Returns the validators.\n    *\n    * @returns {AdapterValidators} validators.\n    */\n   get validators() { return this.#validators; }\n\n   /**\n    * Sets the enabled state.\n    *\n    * @param {boolean}  enabled - New enabled state.\n    */\n   set enabled(enabled)\n   {\n      if (typeof enabled !== 'boolean')\n      {\n         throw new TypeError(`'enabled' is not a boolean.`);\n      }\n\n      this.#enabled = enabled;\n   }\n\n   /**\n    * Sets the associated {@link PositionParent} instance. Resets the style cache and default data.\n    *\n    * @param {PositionParent|void} parent - A PositionParent instance.\n    */\n   set parent(parent)\n   {\n      if (parent !== void 0 && !(parent instanceof HTMLElement) && !isObject(parent))\n      {\n         throw new TypeError(`'parent' is not an HTMLElement, object, or undefined.`);\n      }\n\n      this.#parent = parent;\n\n      // Reset any stored default data & the style cache.\n      this.#state.remove({ name: '#defaultData' });\n      this.#styleCache.reset();\n\n      // If a parent is defined then invoke set to update any parent element.\n      if (parent) { this.set(this.#data); }\n   }\n\n// Data accessors ----------------------------------------------------------------------------------------------------\n\n   /**\n    * @returns {number|'auto'|'inherit'|null} height\n    */\n   get height() { return this.#data.height; }\n\n   /**\n    * @returns {number|null} left\n    */\n   get left() { return this.#data.left; }\n\n   /**\n    * @returns {number|null} maxHeight\n    */\n   get maxHeight() { return this.#data.maxHeight; }\n\n   /**\n    * @returns {number|null} maxWidth\n    */\n   get maxWidth() { return this.#data.maxWidth; }\n\n   /**\n    * @returns {number|null} minHeight\n    */\n   get minHeight() { return this.#data.minHeight; }\n\n   /**\n    * @returns {number|null} minWidth\n    */\n   get minWidth() { return this.#data.minWidth; }\n\n   /**\n    * @returns {number|null} rotateX\n    */\n   get rotateX() { return this.#data.rotateX; }\n\n   /**\n    * @returns {number|null} rotateY\n    */\n   get rotateY() { return this.#data.rotateY; }\n\n   /**\n    * @returns {number|null} rotateZ\n    */\n   get rotateZ() { return this.#data.rotateZ; }\n\n   /**\n    * @returns {number|null} alias for rotateZ\n    */\n   get rotation() { return this.#data.rotateZ; }\n\n   /**\n    * @returns {number|null} scale\n    */\n   get scale() { return this.#data.scale; }\n\n   /**\n    * @returns {number|null} top\n    */\n   get top() { return this.#data.top; }\n\n   /**\n    * @returns {string} transformOrigin\n    */\n   get transformOrigin() { return this.#data.transformOrigin; }\n\n   /**\n    * @returns {number|null} translateX\n    */\n   get translateX() { return this.#data.translateX; }\n\n   /**\n    * @returns {number|null} translateY\n    */\n   get translateY() { return this.#data.translateY; }\n\n   /**\n    * @returns {number|null} translateZ\n    */\n   get translateZ() { return this.#data.translateZ; }\n\n   /**\n    * @returns {number|'auto'|'inherit'|null} width\n    */\n   get width() { return this.#data.width; }\n\n   /**\n    * @returns {number|null} z-index\n    */\n   get zIndex() { return this.#data.zIndex; }\n\n   /**\n    * @param {number|string|null} height -\n    */\n   set height(height)\n   {\n      this.#stores.height.set(height);\n   }\n\n   /**\n    * @param {number|string|null} left -\n    */\n   set left(left)\n   {\n      this.#stores.left.set(left);\n   }\n\n   /**\n    * @param {number|string|null} maxHeight -\n    */\n   set maxHeight(maxHeight)\n   {\n      this.#stores.maxHeight.set(maxHeight);\n   }\n\n   /**\n    * @param {number|string|null} maxWidth -\n    */\n   set maxWidth(maxWidth)\n   {\n      this.#stores.maxWidth.set(maxWidth);\n   }\n\n   /**\n    * @param {number|string|null} minHeight -\n    */\n   set minHeight(minHeight)\n   {\n      this.#stores.minHeight.set(minHeight);\n   }\n\n   /**\n    * @param {number|string|null} minWidth -\n    */\n   set minWidth(minWidth)\n   {\n      this.#stores.minWidth.set(minWidth);\n   }\n\n   /**\n    * @param {number|string|null} rotateX -\n    */\n   set rotateX(rotateX)\n   {\n      this.#stores.rotateX.set(rotateX);\n   }\n\n   /**\n    * @param {number|string|null} rotateY -\n    */\n   set rotateY(rotateY)\n   {\n      this.#stores.rotateY.set(rotateY);\n   }\n\n   /**\n    * @param {number|string|null} rotateZ -\n    */\n   set rotateZ(rotateZ)\n   {\n      this.#stores.rotateZ.set(rotateZ);\n   }\n\n   /**\n    * @param {number|string|null} rotateZ - alias for rotateZ\n    */\n   set rotation(rotateZ)\n   {\n      this.#stores.rotateZ.set(rotateZ);\n   }\n\n   /**\n    * @param {number|string|null} scale -\n    */\n   set scale(scale)\n   {\n      this.#stores.scale.set(scale);\n   }\n\n   /**\n    * @param {number|string|null} top -\n    */\n   set top(top)\n   {\n      this.#stores.top.set(top);\n   }\n\n   /**\n    * @param {string} transformOrigin -\n    */\n   set transformOrigin(transformOrigin)\n   {\n      if (constants.transformOrigins.includes(transformOrigin)) { this.#stores.transformOrigin.set(transformOrigin); }\n   }\n\n   /**\n    * @param {number|string|null} translateX -\n    */\n   set translateX(translateX)\n   {\n      this.#stores.translateX.set(translateX);\n   }\n\n   /**\n    * @param {number|string|null} translateY -\n    */\n   set translateY(translateY)\n   {\n      this.#stores.translateY.set(translateY);\n   }\n\n   /**\n    * @param {number|string|null} translateZ -\n    */\n   set translateZ(translateZ)\n   {\n      this.#stores.translateZ.set(translateZ);\n   }\n\n   /**\n    * @param {number|string|null} width -\n    */\n   set width(width)\n   {\n      this.#stores.width.set(width);\n   }\n\n   /**\n    * @param {number|string|null} zIndex -\n    */\n   set zIndex(zIndex)\n   {\n      this.#stores.zIndex.set(zIndex);\n   }\n\n   /**\n    * Assigns current position to object passed into method.\n    *\n    * @param {object|PositionData}  [position] - Target to assign current position data.\n    *\n    * @param {PositionGetOptions}   [options] - Defines options for specific keys and substituting null for numeric\n    *                                           default values.\n    *\n    * @returns {PositionData} Passed in object with current position data.\n    */\n   get(position = {}, options)\n   {\n      const keys = options?.keys;\n      const excludeKeys = options?.exclude;\n      const numeric = options?.numeric ?? false;\n\n      if (isIterable(keys))\n      {\n         // Replace any null values potentially with numeric default values.\n         if (numeric)\n         {\n            for (const key of keys) { position[key] = this[key] ?? constants.numericDefaults[key]; }\n         }\n         else // Accept current values.\n         {\n            for (const key of keys) { position[key] = this[key]; }\n         }\n\n         // Remove any excluded keys.\n         if (isIterable(excludeKeys))\n         {\n            for (const key of excludeKeys) { delete position[key]; }\n         }\n\n         return position;\n      }\n      else\n      {\n         const data = Object.assign(position, this.#data);\n\n         // Remove any excluded keys.\n         if (isIterable(excludeKeys))\n         {\n            for (const key of excludeKeys) { delete data[key]; }\n         }\n\n         // Potentially set numeric defaults.\n         if (numeric) { constants.setNumericDefaults(data); }\n\n         return data;\n      }\n   }\n\n   /**\n    * @returns {PositionData} Current position data.\n    */\n   toJSON()\n   {\n      return Object.assign({}, this.#data);\n   }\n\n   /**\n    * All calculation and updates of position are implemented in {@link Position}. This allows position to be fully\n    * reactive and in control of updating inline styles for the application.\n    *\n    * Note: the logic for updating position is improved and changes a few aspects from the default\n    * {@link Application.setPosition}. The gate on `popOut` is removed, so to ensure no positional application occurs\n    * popOut applications can set `this.options.positionable` to false ensuring no positional inline styles are\n    * applied.\n    *\n    * The initial set call on an application with a target element will always set width / height as this is\n    * necessary for correct calculations.\n    *\n    * When a target element is present updated styles are applied after validation. To modify the behavior of set\n    * implement one or more validator functions and add them from the application via\n    * `this.position.validators.add(<Function>)`.\n    *\n    * Updates to any target element are decoupled from the underlying Position data. This method returns this instance\n    * that you can then await on the target element inline style update by using {@link Position.elementUpdated}.\n    *\n    * @param {PositionDataExtended} [position] - Position data to set.\n    *\n    * @returns {Position} This Position instance.\n    */\n   set(position = {})\n   {\n      if (typeof position !== 'object') { throw new TypeError(`Position - set error: 'position' is not an object.`); }\n\n      const parent = this.#parent;\n\n      // An early out to prevent `set` from taking effect if not enabled.\n      if (!this.#enabled)\n      {\n         return this;\n      }\n\n      // An early out to prevent `set` from taking effect if options `positionable` is false.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return this;\n      }\n\n      // Callers can specify to immediately update an associated element. This is useful if set is called from\n      // requestAnimationFrame / rAF. Library integrations like GSAP invoke set from rAF.\n      const immediateElementUpdate = position.immediateElementUpdate === true;\n\n      const data = this.#data;\n      const transforms = this.#transforms;\n\n      // Find the target HTML element and verify that it is connected storing it in `el`.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      const changeSet = this.#positionChangeSet;\n      const styleCache = this.#styleCache;\n\n      if (el)\n      {\n         // Cache the computed styles of the element.\n         if (!styleCache.hasData(el))\n         {\n            styleCache.update(el);\n\n            // Add will-change property if not already set in inline or computed styles.\n            if (!styleCache.hasWillChange)\n            {\n               // TODO: This is commented out as there is a Chrome bug that reduces quality / blurs\n               // child elements when `will-change: transform` is set.\n               // https://bugs.chromium.org/p/chromium/issues/detail?id=1343711#c4\n\n               // el.style.willChange = this.#options.ortho ? 'transform' : 'top, left, transform';\n            }\n\n            // Update all properties / clear queued state.\n            changeSet.set(true);\n            this.#updateElementData.queued = false;\n         }\n\n         // Converts any relative string position data to numeric inputs.\n         convertRelative(position, this);\n\n         position = this.#updatePosition(position, parent, el, styleCache);\n\n         // Check if a validator cancelled the update.\n         if (position === null) { return this; }\n      }\n\n      if (Number.isFinite(position.left))\n      {\n         position.left = Math.round(position.left);\n\n         if (data.left !== position.left) { data.left = position.left; changeSet.left = true; }\n      }\n\n      if (Number.isFinite(position.top))\n      {\n         position.top = Math.round(position.top);\n\n         if (data.top !== position.top) { data.top = position.top; changeSet.top = true; }\n      }\n\n      if (Number.isFinite(position.maxHeight) || position.maxHeight === null)\n      {\n         position.maxHeight = typeof position.maxHeight === 'number' ? Math.round(position.maxHeight) : null;\n\n         if (data.maxHeight !== position.maxHeight) { data.maxHeight = position.maxHeight; changeSet.maxHeight = true; }\n      }\n\n      if (Number.isFinite(position.maxWidth) || position.maxWidth === null)\n      {\n         position.maxWidth = typeof position.maxWidth === 'number' ? Math.round(position.maxWidth) : null;\n\n         if (data.maxWidth !== position.maxWidth) { data.maxWidth = position.maxWidth; changeSet.maxWidth = true; }\n      }\n\n      if (Number.isFinite(position.minHeight) || position.minHeight === null)\n      {\n         position.minHeight = typeof position.minHeight === 'number' ? Math.round(position.minHeight) : null;\n\n         if (data.minHeight !== position.minHeight) { data.minHeight = position.minHeight; changeSet.minHeight = true; }\n      }\n\n      if (Number.isFinite(position.minWidth) || position.minWidth === null)\n      {\n         position.minWidth = typeof position.minWidth === 'number' ? Math.round(position.minWidth) : null;\n\n         if (data.minWidth !== position.minWidth) { data.minWidth = position.minWidth; changeSet.minWidth = true; }\n      }\n\n      if (Number.isFinite(position.rotateX) || position.rotateX === null)\n      {\n         if (data.rotateX !== position.rotateX)\n         {\n            data.rotateX = transforms.rotateX = position.rotateX;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.rotateY) || position.rotateY === null)\n      {\n         if (data.rotateY !== position.rotateY)\n         {\n            data.rotateY = transforms.rotateY = position.rotateY;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.rotateZ) || position.rotateZ === null)\n      {\n         if (data.rotateZ !== position.rotateZ)\n         {\n            data.rotateZ = transforms.rotateZ = position.rotateZ;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.scale) || position.scale === null)\n      {\n         position.scale = typeof position.scale === 'number' ? Math.max(0, Math.min(position.scale, 1000)) : null;\n\n         if (data.scale !== position.scale)\n         {\n            data.scale = transforms.scale = position.scale;\n            changeSet.transform = true;\n         }\n      }\n\n      if ((typeof position.transformOrigin === 'string' && constants.transformOrigins.includes(\n       position.transformOrigin)) || position.transformOrigin === null)\n      {\n         if (data.transformOrigin !== position.transformOrigin)\n         {\n            data.transformOrigin = position.transformOrigin;\n            changeSet.transformOrigin = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateX) || position.translateX === null)\n      {\n         if (data.translateX !== position.translateX)\n         {\n            data.translateX = transforms.translateX = position.translateX;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateY) || position.translateY === null)\n      {\n         if (data.translateY !== position.translateY)\n         {\n            data.translateY = transforms.translateY = position.translateY;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateZ) || position.translateZ === null)\n      {\n         if (data.translateZ !== position.translateZ)\n         {\n            data.translateZ = transforms.translateZ = position.translateZ;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.zIndex))\n      {\n         position.zIndex = Math.round(position.zIndex);\n\n         if (data.zIndex !== position.zIndex) { data.zIndex = position.zIndex; changeSet.zIndex = true; }\n      }\n\n      if (Number.isFinite(position.width) || position.width === 'auto' || position.width === 'inherit' ||\n       position.width === null)\n      {\n         position.width = typeof position.width === 'number' ? Math.round(position.width) : position.width;\n\n         if (data.width !== position.width) { data.width = position.width; changeSet.width = true; }\n      }\n\n      if (Number.isFinite(position.height) || position.height === 'auto' || position.height === 'inherit' ||\n       position.height === null)\n      {\n         position.height = typeof position.height === 'number' ? Math.round(position.height) : position.height;\n\n         if (data.height !== position.height) { data.height = position.height; changeSet.height = true; }\n      }\n\n      if (el)\n      {\n         const defaultData = this.#state.getDefault();\n\n         // Set default data after first set operation that has a target element.\n         if (typeof defaultData !== 'object')\n         {\n            this.#state.save({ name: '#defaultData', ...Object.assign({}, data) });\n         }\n\n         // If `immediateElementUpdate` is true in position data passed to `set` then update the element immediately.\n         // This is for rAF based library integrations like GSAP.\n         if (immediateElementUpdate)\n         {\n            UpdateElementManager.immediate(el, this.#updateElementData);\n            this.#updateElementPromise = Promise.resolve(performance.now());\n         }\n         // Else if not queued then queue an update for the next rAF callback.\n         else if (!this.#updateElementData.queued)\n         {\n            this.#updateElementPromise = UpdateElementManager.add(el, this.#updateElementData);\n         }\n      }\n      else\n      {\n         // Notify main store subscribers.\n         UpdateElementManager.updateSubscribers(this.#updateElementData);\n      }\n\n      return this;\n   }\n\n   /**\n    *\n    * @param {function(PositionData): void} handler - Callback function that is invoked on update / changes. Receives\n    *                                                 a copy of the PositionData.\n    *\n    * @returns {(function(): void)} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(Object.assign({}, this.#data));                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   /**\n    * @param {PositionDataExtended} opts -\n    *\n    * @param {number|null} opts.left -\n    *\n    * @param {number|null} opts.top -\n    *\n    * @param {number|null} opts.maxHeight -\n    *\n    * @param {number|null} opts.maxWidth -\n    *\n    * @param {number|null} opts.minHeight -\n    *\n    * @param {number|null} opts.minWidth -\n    *\n    * @param {number|'auto'|null} opts.width -\n    *\n    * @param {number|'auto'|null} opts.height -\n    *\n    * @param {number|null} opts.rotateX -\n    *\n    * @param {number|null} opts.rotateY -\n    *\n    * @param {number|null} opts.rotateZ -\n    *\n    * @param {number|null} opts.scale -\n    *\n    * @param {string} opts.transformOrigin -\n    *\n    * @param {number|null} opts.translateX -\n    *\n    * @param {number|null} opts.translateY -\n    *\n    * @param {number|null} opts.translateZ -\n    *\n    * @param {number|null} opts.zIndex -\n    *\n    * @param {number|null} opts.rotation - alias for rotateZ\n    *\n    * @param {*} opts.rest -\n    *\n    * @param {object} parent -\n    *\n    * @param {HTMLElement} el -\n    *\n    * @param {StyleCache} styleCache -\n    *\n    * @returns {null|PositionData} Updated position data or null if validation fails.\n    */\n   #updatePosition({\n      // Directly supported parameters\n      left, top, maxWidth, maxHeight, minWidth, minHeight, width, height, rotateX, rotateY, rotateZ, scale,\n       transformOrigin, translateX, translateY, translateZ, zIndex,\n\n      // Aliased parameters\n      rotation,\n\n      ...rest\n   } = {}, parent, el, styleCache)\n   {\n      let currentPosition = s_DATA_UPDATE.copy(this.#data);\n\n      // Update width if an explicit value is passed, or if no width value is set on the element.\n      if (el.style.width === '' || width !== void 0)\n      {\n         if (width === 'auto' || (currentPosition.width === 'auto' && width !== null))\n         {\n            currentPosition.width = 'auto';\n            width = styleCache.offsetWidth;\n         }\n         else if (width === 'inherit' || (currentPosition.width === 'inherit' && width !== null))\n         {\n            currentPosition.width = 'inherit';\n            width = styleCache.offsetWidth;\n         }\n         else\n         {\n            const newWidth = Number.isFinite(width) ? width : currentPosition.width;\n            currentPosition.width = width = Number.isFinite(newWidth) ? Math.round(newWidth) : styleCache.offsetWidth;\n         }\n      }\n      else\n      {\n         width = Number.isFinite(currentPosition.width) ? currentPosition.width : styleCache.offsetWidth;\n      }\n\n      // Update height if an explicit value is passed, or if no height value is set on the element.\n      if (el.style.height === '' || height !== void 0)\n      {\n         if (height === 'auto' || (currentPosition.height === 'auto' && height !== null))\n         {\n            currentPosition.height = 'auto';\n            height = styleCache.offsetHeight;\n         }\n         else if (height === 'inherit' || (currentPosition.height === 'inherit' && height !== null))\n         {\n            currentPosition.height = 'inherit';\n            height = styleCache.offsetHeight;\n         }\n         else\n         {\n            const newHeight = Number.isFinite(height) ? height : currentPosition.height;\n            currentPosition.height = height = Number.isFinite(newHeight) ? Math.round(newHeight) :\n             styleCache.offsetHeight;\n         }\n      }\n      else\n      {\n         height = Number.isFinite(currentPosition.height) ? currentPosition.height : styleCache.offsetHeight;\n      }\n\n      // Update left\n      if (Number.isFinite(left))\n      {\n         currentPosition.left = left;\n      }\n      else if (!Number.isFinite(currentPosition.left))\n      {\n         // Potentially use any initial position helper if available or set to 0.\n         currentPosition.left = typeof this.#options.initialHelper?.getLeft === 'function' ?\n          this.#options.initialHelper.getLeft(width) : 0;\n      }\n\n      // Update top\n      if (Number.isFinite(top))\n      {\n         currentPosition.top = top;\n      }\n      else if (!Number.isFinite(currentPosition.top))\n      {\n         // Potentially use any initial position helper if available or set to 0.\n         currentPosition.top = typeof this.#options.initialHelper?.getTop === 'function' ?\n          this.#options.initialHelper.getTop(height) : 0;\n      }\n\n      if (Number.isFinite(maxHeight) || maxHeight === null)\n      {\n         currentPosition.maxHeight = Number.isFinite(maxHeight) ? Math.round(maxHeight) : null;\n      }\n\n      if (Number.isFinite(maxWidth) || maxWidth === null)\n      {\n         currentPosition.maxWidth = Number.isFinite(maxWidth) ? Math.round(maxWidth) : null;\n      }\n\n      if (Number.isFinite(minHeight) || minHeight === null)\n      {\n         currentPosition.minHeight = Number.isFinite(minHeight) ? Math.round(minHeight) : null;\n      }\n\n      if (Number.isFinite(minWidth) || minWidth === null)\n      {\n         currentPosition.minWidth = Number.isFinite(minWidth) ? Math.round(minWidth) : null;\n      }\n\n      // Update rotate X/Y/Z, scale, z-index\n      if (Number.isFinite(rotateX) || rotateX === null) { currentPosition.rotateX = rotateX; }\n      if (Number.isFinite(rotateY) || rotateY === null) { currentPosition.rotateY = rotateY; }\n\n      // Handle alias for rotateZ. First check if `rotateZ` is valid and different from the current value. Next check if\n      // `rotation` is valid and use it for `rotateZ`.\n      if (rotateZ !== currentPosition.rotateZ && (Number.isFinite(rotateZ) || rotateZ === null))\n      {\n         currentPosition.rotateZ = rotateZ;\n      }\n      else if (rotation !== currentPosition.rotateZ && (Number.isFinite(rotation) || rotation === null))\n      {\n         currentPosition.rotateZ = rotation;\n      }\n\n      if (Number.isFinite(translateX) || translateX === null) { currentPosition.translateX = translateX; }\n      if (Number.isFinite(translateY) || translateY === null) { currentPosition.translateY = translateY; }\n      if (Number.isFinite(translateZ) || translateZ === null) { currentPosition.translateZ = translateZ; }\n\n      if (Number.isFinite(scale) || scale === null)\n      {\n         currentPosition.scale = typeof scale === 'number' ? Math.max(0, Math.min(scale, 1000)) : null;\n      }\n\n      if (typeof transformOrigin === 'string' || transformOrigin === null)\n      {\n         currentPosition.transformOrigin = constants.transformOrigins.includes(transformOrigin) ? transformOrigin :\n          null;\n      }\n\n      if (Number.isFinite(zIndex) || zIndex === null)\n      {\n         currentPosition.zIndex = typeof zIndex === 'number' ? Math.round(zIndex) : zIndex;\n      }\n\n      const validatorData = this.#validatorData;\n\n      // If there are any validators allow them to potentially modify position data or reject the update.\n      if (this.#validators.enabled && validatorData.length)\n      {\n         s_VALIDATION_DATA.parent = parent;\n\n         s_VALIDATION_DATA.el = el;\n\n         s_VALIDATION_DATA.computed = styleCache.computed;\n\n         s_VALIDATION_DATA.transforms = this.#transforms;\n\n         s_VALIDATION_DATA.height = height;\n\n         s_VALIDATION_DATA.width = width;\n\n         s_VALIDATION_DATA.marginLeft = styleCache.marginLeft;\n\n         s_VALIDATION_DATA.marginTop = styleCache.marginTop;\n\n         s_VALIDATION_DATA.maxHeight = styleCache.maxHeight ?? currentPosition.maxHeight;\n\n         s_VALIDATION_DATA.maxWidth = styleCache.maxWidth ?? currentPosition.maxWidth;\n\n         // Given a parent w/ reactive state and is minimized ignore styleCache min-width/height.\n         const isMinimized = parent?.reactive?.minimized ?? false;\n\n         // Note the use of || for accessing the style cache as the left hand is ignored w/ falsy values such as '0'.\n         s_VALIDATION_DATA.minHeight = isMinimized ? currentPosition.minHeight ?? 0 :\n          styleCache.minHeight || (currentPosition.minHeight ?? 0);\n\n         s_VALIDATION_DATA.minWidth = isMinimized ? currentPosition.minWidth ?? 0 :\n          styleCache.minWidth || (currentPosition.minWidth ?? 0);\n\n         for (let cntr = 0; cntr < validatorData.length; cntr++)\n         {\n            s_VALIDATION_DATA.position = currentPosition;\n            s_VALIDATION_DATA.rest = rest;\n            currentPosition = validatorData[cntr].validator(s_VALIDATION_DATA);\n\n            if (currentPosition === null) { return null; }\n         }\n      }\n\n      // Return the updated position object.\n      return currentPosition;\n   }\n}\n\nconst s_DATA_UPDATE = new PositionData();\n\n/**\n * @type {ValidationData}\n */\nconst s_VALIDATION_DATA = {\n   position: void 0,\n   parent: void 0,\n   el: void 0,\n   computed: void 0,\n   transforms: void 0,\n   height: void 0,\n   width: void 0,\n   marginLeft: void 0,\n   marginTop: void 0,\n   maxHeight: void 0,\n   maxWidth: void 0,\n   minHeight: void 0,\n   minWidth: void 0,\n   rest: void 0\n};\n\nObject.seal(s_VALIDATION_DATA);\n\n/**\n * @typedef {object} PositionInitialHelper\n *\n * @property {(width: number) => number} getLeft - Returns the left position given the width of the browser window.\n *\n * @property {(height: number) => number} getTop - Returns the top position given the height of the browser window.\n */\n\n/**\n * @typedef {object} PositionDataExtended\n *\n * @property {number|string|null} [height] -\n *\n * @property {number|string|null} [left] -\n *\n * @property {number|string|null} [maxHeight] -\n *\n * @property {number|string|null} [maxWidth] -\n *\n * @property {number|string|null} [minHeight] -\n *\n * @property {number|string|null} [minWidth] -\n *\n * @property {number|string|null} [rotateX] -\n *\n * @property {number|string|null} [rotateY] -\n *\n * @property {number|string|null} [rotateZ] -\n *\n * @property {number|string|null} [scale] -\n *\n * @property {number|string|null} [top] -\n *\n * @property {string|null} [transformOrigin] -\n *\n * @property {number|string|null} [translateX] -\n *\n * @property {number|string|null} [translateY] -\n *\n * @property {number|string|null} [translateZ] -\n *\n * @property {number|string|null} [width] -\n *\n * @property {number|string|null} [zIndex] -\n *\n * Extended properties -----------------------------------------------------------------------------------------------\n *\n * @property {boolean} [immediateElementUpdate] - When true any associated element is updated immediately.\n *\n * @property {number|null} [rotation] - Alias for `rotateZ`.\n */\n\n/**\n * @typedef {object} PositionGetOptions\n *\n * @property {Iterable<string>} keys - When provided only these keys are copied.\n *\n * @property {Iterable<string>} exclude - When provided these keys are excluded.\n *\n * @property {boolean} numeric - When true any `null` values are converted into defaults.\n */\n\n/**\n * @typedef {object} PositionOptions - Options set in constructor.\n *\n * @property {boolean} calculateTransform - When true always calculate transform data.\n *\n * @property {PositionInitialHelper} initialHelper - Provides a helper for setting initial position data.\n *\n * @property {boolean} ortho - Sets Position to orthographic mode using just transform / matrix3d for positioning.\n *\n * @property {boolean} transformSubscribed - Set to true when there are subscribers to the readable transform store.\n */\n\n/**\n * @typedef {PositionOptions & PositionData} PositionOptionsAll\n */\n\n/**\n * @typedef {HTMLElement | object} PositionParent\n *\n * @property {Function} [elementTarget] - Potentially returns any parent object.\n */\n\n/**\n * @typedef {object} ResizeObserverData\n *\n * @property {number|undefined} contentHeight -\n *\n * @property {number|undefined} contentWidth -\n *\n * @property {number|undefined} offsetHeight -\n *\n * @property {number|undefined} offsetWidth -\n */\n\n/**\n * @typedef {object} StorePosition - Provides individual writable stores for {@link Position}.\n *\n * @property {import('svelte/store').Readable<{width: number, height: number}>} dimension - Readable store for dimension\n *                                                                                          data.\n *\n * @property {import('svelte/store').Readable<HTMLElement>} element - Readable store for current element.\n *\n * @property {import('svelte/store').Writable<number|null>} left - Derived store for `left` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} top - Derived store for `top` updates.\n *\n * @property {import('svelte/store').Writable<number|'auto'|null>} width - Derived store for `width` updates.\n *\n * @property {import('svelte/store').Writable<number|'auto'|null>} height - Derived store for `height` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} maxHeight - Derived store for `maxHeight` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} maxWidth - Derived store for `maxWidth` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} minHeight - Derived store for `minHeight` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} minWidth - Derived store for `minWidth` updates.\n *\n * @property {import('svelte/store').Readable<number|undefined>} resizeContentHeight - Readable store for `contentHeight`.\n *\n * @property {import('svelte/store').Readable<number|undefined>} resizeContentWidth - Readable store for `contentWidth`.\n *\n * @property {import('svelte/store').Writable<ResizeObserverData>} resizeObserved - Protected store for resize observer updates.\n *\n * @property {import('svelte/store').Readable<number|undefined>} resizeOffsetHeight - Readable store for `offsetHeight`.\n *\n * @property {import('svelte/store').Readable<number|undefined>} resizeOffsetWidth - Readable store for `offsetWidth`.\n *\n * @property {import('svelte/store').Writable<number|null>} rotate - Derived store for `rotate` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} rotateX - Derived store for `rotateX` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} rotateY - Derived store for `rotateY` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} rotateZ - Derived store for `rotateZ` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} scale - Derived store for `scale` updates.\n *\n * @property {import('svelte/store').Readable<TransformData>} transform - Readable store for transform data.\n *\n * @property {import('svelte/store').Writable<string>} transformOrigin - Derived store for `transformOrigin`.\n *\n * @property {import('svelte/store').Writable<number|null>} translateX - Derived store for `translateX` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} translateY - Derived store for `translateY` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} translateZ - Derived store for `translateZ` updates.\n *\n * @property {import('svelte/store').Writable<number|null>} zIndex - Derived store for `zIndex` updates.\n */\n\n/**\n * @typedef {object} ValidationData\n *\n * @property {PositionData} position -\n *\n * @property {PositionParent} parent -\n *\n * @property {HTMLElement} el -\n *\n * @property {CSSStyleDeclaration} computed -\n *\n * @property {Transforms} transforms -\n *\n * @property {number} height -\n *\n * @property {number} width -\n *\n * @property {number|undefined} marginLeft -\n *\n * @property {number|undefined} marginTop -\n *\n * @property {number|undefined} maxHeight -\n *\n * @property {number|undefined} maxWidth -\n *\n * @property {number|undefined} minHeight -\n *\n * @property {number|undefined} minWidth -\n *\n * @property {object} rest - The rest of any data submitted to {@link Position.set}\n */\n","import { linear }             from 'svelte/easing';\n\nimport { lerp }               from '@typhonjs-fvtt/runtime/svelte/math';\nimport { isObject }           from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Provides the ability the save / restore application state for positional and UI state such as minimized status.\n *\n * You can restore a saved state with animation; please see the options of {@link ApplicationState.restore}.\n */\nexport class ApplicationState\n{\n   /** @type {ApplicationShellExt} */\n   #application;\n\n   /** @type {Map<string, ApplicationStateData>} */\n   #dataSaved = new Map();\n\n   /**\n    * @param {ApplicationShellExt}   application - The application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n\n      Object.seal(this);\n   }\n\n   /**\n    * Returns current application state along with any extra data passed into method.\n    *\n    * @param {object} [extra] - Extra data to add to application state.\n    *\n    * @returns {ApplicationStateData} Passed in object with current application state.\n    */\n   get(extra = {})\n   {\n      return Object.assign(extra, {\n         position: this.#application?.position?.get(),\n         beforeMinimized: this.#application?.position?.state.get({ name: '#beforeMinimized' }),\n         options: Object.assign({}, this.#application?.options),\n         ui: { minimized: this.#application?.reactive?.minimized }\n      });\n   }\n\n   /**\n    * Returns any stored save state by name.\n    *\n    * @param {string}   name - Saved data set name.\n    *\n    * @returns {ApplicationStateData} The saved data set.\n    */\n   getSave({ name })\n   {\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`ApplicationState - getSave error: 'name' is not a string.`);\n      }\n\n      return this.#dataSaved.get(name);\n   }\n\n   /**\n    * Removes and returns any application state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Name to remove and retrieve.\n    *\n    * @returns {ApplicationStateData} Saved application data.\n    */\n   remove({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`ApplicationState - remove: 'name' is not a string.`); }\n\n      const data = this.#dataSaved.get(name);\n      this.#dataSaved.delete(name);\n\n      return data;\n   }\n\n   /**\n    * Restores a saved application state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * @param {object}            params - Parameters\n    *\n    * @param {string}            params.name - Saved data set name.\n    *\n    * @param {boolean}           [params.remove=false] - Remove data set.\n    *\n    * @param {boolean}           [params.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [params.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [params.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [params.ease=linear] - Easing function.\n    *\n    * @param {Function}          [params.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {ApplicationStateData|Promise<ApplicationStateData>} Saved application data.\n    */\n   restore({ name, remove = false, async = false, animateTo = false, duration = 0.1, ease = linear,\n    interpolate = lerp })\n   {\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`ApplicationState - restore error: 'name' is not a string.`);\n      }\n\n      const dataSaved = this.#dataSaved.get(name);\n\n      if (dataSaved)\n      {\n         if (remove) { this.#dataSaved.delete(name); }\n\n         if (async)\n         {\n            return this.set(dataSaved, { async, animateTo, duration, ease, interpolate }).then(() => dataSaved);\n         }\n         else\n         {\n            this.set(dataSaved, { async, animateTo, duration, ease, interpolate });\n         }\n      }\n\n      return dataSaved;\n   }\n\n   /**\n    * Saves current application state with the opportunity to add extra data to the saved state.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - name to index this saved data.\n    *\n    * @param {...*}     [options.extra] - Extra data to add to saved data.\n    *\n    * @returns {ApplicationStateData} Current application data\n    */\n   save({ name, ...extra })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`ApplicationState - save error: 'name' is not a string.`); }\n\n      const data = this.get(extra);\n\n      this.#dataSaved.set(name, data);\n\n      return data;\n   }\n\n   /**\n    * Restores a saved application state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * Note: If serializing application state any minimized apps will use the before minimized state on initial render\n    * of the app as it is currently not possible to render apps with Foundry VTT core API in the minimized state.\n    *\n    * TODO: THIS METHOD NEEDS TO BE REFACTORED WHEN TRL IS MADE INTO A STANDALONE FRAMEWORK.\n    *\n    * @param {ApplicationStateData}   data - Saved data set name.\n    *\n    * @param {object}            [opts] - Optional parameters\n    *\n    * @param {boolean}           [opts.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [opts.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [opts.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [opts.ease=linear] - Easing function.\n    *\n    * @param {Function}          [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {ApplicationShellExt|Promise<ApplicationShellExt>} When synchronous the application or Promise when\n    *                                                             animating resolving with application.\n    */\n   set(data, { async = false, animateTo = false, duration = 0.1, ease = linear, interpolate = lerp } = {})\n   {\n      if (!isObject(data))\n      {\n         throw new TypeError(`ApplicationState - restore error: 'data' is not an object.`);\n      }\n\n      const application = this.#application;\n\n      if (!isObject(data?.position))\n      {\n         console.warn(`ApplicationState.set warning: 'data.position' is not an object.`);\n         return application;\n      }\n\n      // TODO: TAKE NOTE THAT WE ARE ACCESSING A FOUNDRY APP v1 GETTER HERE TO DETERMINE IF APPLICATION IS RENDERED.\n      // TODO: THIS NEEDS TO BE REFACTORED WHEN CONVERTING TRL TO A GENERIC FRAMEWORK.\n      const rendered = application.rendered;\n\n      if (animateTo && !rendered)\n      {\n         console.warn(`ApplicationState.set warning: Application is not rendered and 'animateTo' is true.`);\n         return application;\n      }\n\n      // Update data directly with no store or inline style updates.\n      if (animateTo)  // Animate to saved data.\n      {\n         // Provide special handling to potentially change transform origin as this parameter is not animated.\n         if (data.position.transformOrigin !== application.position.transformOrigin)\n         {\n            application.position.transformOrigin = data.position.transformOrigin;\n         }\n\n         if (isObject(data?.ui))\n         {\n            const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n            if (application?.reactive?.minimized && !minimized)\n            {\n               application.maximize({ animate: false, duration: 0 });\n            }\n         }\n\n         const promise = application.position.animate.to(data.position,\n          { duration, ease, interpolate }).finished.then((cancelled) =>\n         {\n            if (cancelled) { return application; }\n\n            // Merge in saved options to application.\n            if (isObject(data?.options))\n            {\n               application?.reactive.mergeOptions(data.options);\n            }\n\n            if (isObject(data?.ui))\n            {\n               const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n               // Application is currently minimized and stored state is not, so reset minimized state without\n               // animation.\n               if (!application?.reactive?.minimized && minimized)\n               {\n                  application.minimize({ animate: false, duration: 0 });\n               }\n            }\n\n            if (isObject(data?.beforeMinimized))\n            {\n               application.position.state.set({ name: '#beforeMinimized', ...data.beforeMinimized });\n            }\n\n            return application;\n         });\n\n         // Return a Promise with the application that resolves after animation ends.\n         if (async) { return promise; }\n      }\n      else\n      {\n         if (rendered)\n         {\n            // Merge in saved options to application.\n            if (isObject(data?.options))\n            {\n               application?.reactive.mergeOptions(data.options);\n            }\n\n            if (isObject(data?.ui))\n            {\n               const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n               // Application is currently minimized and stored state is not, so reset minimized state without\n               // animation.\n               if (application?.reactive?.minimized && !minimized)\n               {\n                  application.maximize({ animate: false, duration: 0 });\n               }\n               else if (!application?.reactive?.minimized && minimized)\n               {\n                  application.minimize({ animate: false, duration });\n               }\n            }\n\n            if (isObject(data?.beforeMinimized))\n            {\n               application.position.state.set({ name: '#beforeMinimized', ...data.beforeMinimized });\n            }\n\n            // Default options is to set data for an immediate update.\n            application.position.set(data.position);\n         }\n         else\n         {\n            // When not rendered set position to the 'beforeMinimized' data if it exists otherwise set w/ 'position'.\n            // Currently, w/ Foundry core Application API it is impossible to initially render an app in the minimized\n            // state.\n\n            let positionData = data.position;\n\n            if (isObject(data.beforeMinimized))\n            {\n               // Take before minimized data.\n               positionData = data.beforeMinimized;\n\n               // Apply position left / top to before minimized data. This covers the case when an app is minimized,\n               // but then moved. This allows restoration of the before minimized parameters w/ the last position\n               // location.\n               positionData.left = data.position.left;\n               positionData.top = data.position.top;\n            }\n\n            application.position.set(positionData);\n         }\n      }\n\n      return application;\n   }\n}\n\n/**\n * @typedef {object} ApplicationStateData\n *\n * @property {PositionDataExtended}   position - Application position.\n *\n * @property {object}         beforeMinimized - Any application saved position state for #beforeMinimized\n *\n * @property {object}         options - Application options.\n *\n * @property {object}         ui - Application UI state.\n */\n","import { isObject } from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Provides a helper class for {@link SvelteApplication} by combining all methods that work on the {@link SvelteData[]}\n * of mounted components. This class is instantiated and can be retrieved by the getter `svelte` via SvelteApplication.\n */\nexport class GetSvelteData\n{\n   /**\n    * @type {MountedAppShell[]|null[]}\n    */\n   #applicationShellHolder;\n\n   /**\n    * @type {SvelteData[]}\n    */\n   #svelteData;\n\n   /**\n    * Keep a direct reference to the SvelteData array in an associated {@link SvelteApplication}.\n    *\n    * @param {MountedAppShell[]|null[]}  applicationShellHolder - A reference to the MountedAppShell array.\n    *\n    * @param {SvelteData[]}  svelteData - A reference to the SvelteData array of mounted components.\n    */\n   constructor(applicationShellHolder, svelteData)\n   {\n      this.#applicationShellHolder = applicationShellHolder;\n      this.#svelteData = svelteData;\n   }\n\n   /**\n    * Returns any mounted {@link MountedAppShell}.\n    *\n    * @returns {MountedAppShell|null} Any mounted application shell.\n    */\n   get applicationShell() { return this.#applicationShellHolder[0]; }\n\n   /**\n    * Returns the indexed Svelte component.\n    *\n    * @param {number}   index -\n    *\n    * @returns {object} The loaded Svelte component.\n    */\n   component(index)\n   {\n      const data = this.#svelteData[index];\n      return isObject(data) ? data?.component : void 0;\n   }\n\n   /**\n    * Returns the Svelte component entries iterator.\n    *\n    * @returns {Generator<Array<number|SvelteComponent>>} Svelte component entries iterator.\n    * @yields\n    */\n   *componentEntries()\n   {\n      for (let cntr = 0; cntr < this.#svelteData.length; cntr++)\n      {\n         yield [cntr, this.#svelteData[cntr].component];\n      }\n   }\n\n   /**\n    * Returns the Svelte component values iterator.\n    *\n    * @returns {Generator<SvelteComponent>} Svelte component values iterator.\n    * @yields\n    */\n   *componentValues()\n   {\n      for (let cntr = 0; cntr < this.#svelteData.length; cntr++)\n      {\n         yield this.#svelteData[cntr].component;\n      }\n   }\n\n   /**\n    * Returns the indexed SvelteData entry.\n    *\n    * @param {number}   index -\n    *\n    * @returns {SvelteData} The loaded Svelte config + component.\n    */\n   data(index)\n   {\n      return this.#svelteData[index];\n   }\n\n   /**\n    * Returns the {@link SvelteData} instance for a given component.\n    *\n    * @param {object} component - Svelte component.\n    *\n    * @returns {SvelteData} -  The loaded Svelte config + component.\n    */\n   dataByComponent(component)\n   {\n      for (const data of this.#svelteData)\n      {\n         if (data.component === component) { return data; }\n      }\n\n      return void 0;\n   }\n\n   /**\n    * Returns the SvelteData entries iterator.\n    *\n    * @returns {IterableIterator<[number, SvelteData]>} SvelteData entries iterator.\n    */\n   dataEntries()\n   {\n      return this.#svelteData.entries();\n   }\n\n   /**\n    * Returns the SvelteData values iterator.\n    *\n    * @returns {IterableIterator<SvelteData>} SvelteData values iterator.\n    */\n   dataValues()\n   {\n      return this.#svelteData.values();\n   }\n\n   /**\n    * Returns the length of the mounted Svelte component list.\n    *\n    * @returns {number} Length of mounted Svelte component list.\n    */\n   get length()\n   {\n      return this.#svelteData.length;\n   }\n}\n","import {\n   isApplicationShell,\n   isObject,\n   parseSvelteConfig }  from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Instantiates and attaches a Svelte component to the main inserted HTML.\n *\n * @param {object}            opts - Optional parameters.\n *\n * @param {object}            opts.app - The target application\n *\n * @param {HTMLElement}       opts.template - Any HTML template.\n *\n * @param {object}            opts.config - Svelte component options\n *\n * @param {Function}          opts.elementRootUpdate - A callback to assign to the external context.\n *\n * @returns {SvelteData} The config + instantiated Svelte component.\n */\nexport function loadSvelteConfig({ app, template, config, elementRootUpdate } = {})\n{\n   const svelteOptions = isObject(config.options) ? config.options : {};\n\n   let target;\n\n   // A specific HTMLElement to append Svelte component.\n   if (config.target instanceof HTMLElement)\n   {\n      target = config.target;\n   }\n   // A string target defines a selector to find in existing HTML.\n   else if (template instanceof HTMLElement && typeof config.target === 'string')\n   {\n      target = template.querySelector(config.target);\n   }\n   else                                            // No target defined, create a document fragment.\n   {\n      target = document.createDocumentFragment();\n   }\n\n   if (target === void 0)\n   {\n      console.log(\n       `%c[TRL] loadSvelteConfig error - could not find target selector, '${config.target}', for config:\\n`,\n       'background: rgb(57,34,34)', config);\n\n      throw new Error();\n   }\n\n   const NewSvelteComponent = config.class;\n\n   const svelteConfig = parseSvelteConfig({ ...config, target }, app);\n\n   const externalContext = svelteConfig.context.get('#external');\n\n   // Inject the Foundry application instance and `elementRootUpdate` to the external context.\n   externalContext.application = app;\n   externalContext.elementRootUpdate = elementRootUpdate;\n   externalContext.sessionStorage = app.reactive.sessionStorage;\n\n   let eventbus;\n\n   // Potentially inject any TyphonJS eventbus and track the proxy in the SvelteData instance.\n   if (isObject(app._eventbus) && typeof app._eventbus.createProxy === 'function')\n   {\n      eventbus = app._eventbus.createProxy();\n      externalContext.eventbus = eventbus;\n   }\n\n   // Seal external context so that it can't be extended.\n   Object.seal(externalContext);\n\n   // TODO: Remove deprecation warning in the future -----------------------------------------------------------------\n\n   svelteConfig.context.set('external', new Proxy({}, {\n      get(targetUnused, prop)\n      {\n         console.warn(`[TRL] Deprecation warning: Please change getContext('external') to getContext('#external').`);\n         return externalContext[prop];\n      }\n   }));\n\n   // TODO: Remove deprecation warning in the future -----------------------------------------------------------------\n\n   // Create the Svelte component.\n   /**\n    * @type {import('svelte').SvelteComponent}\n    */\n   const component = new NewSvelteComponent(svelteConfig);\n\n   // Set any eventbus to the config.\n   svelteConfig.eventbus = eventbus;\n\n   /**\n    * @type {HTMLElement}\n    */\n   let element;\n\n   // We can directly get the root element from components which follow the application store contract.\n   if (isApplicationShell(component))\n   {\n      element = component.elementRoot;\n   }\n\n   // Detect if target is a synthesized DocumentFragment with a child element. Child elements will be present\n   // if the Svelte component mounts and renders initial content into the document fragment.\n   if (target instanceof DocumentFragment && target.firstElementChild)\n   {\n      if (element === void 0) { element = target.firstElementChild; }\n      template.append(target);\n   }\n   else if (config.target instanceof HTMLElement && element === void 0)\n   {\n      if (config.target instanceof HTMLElement && typeof svelteOptions.selectorElement !== 'string')\n      {\n         console.log(\n          `%c[TRL] loadSvelteConfig error - HTMLElement target with no 'selectorElement' defined.\\n` +\n          `\\nNote: If configuring an application shell and directly targeting a HTMLElement did you bind an` +\n          `'elementRoot' and include '<svelte:options accessors={true}/>'?\\n` +\n          `\\nOffending config:\\n`, 'background: rgb(57,34,34)', config);\n\n         throw new Error();\n      }\n\n      // The target is an HTMLElement so find the Application element from `selectorElement` option.\n      element = target.querySelector(svelteOptions.selectorElement);\n\n      if (element === null || element === void 0)\n      {\n         console.log(\n          `%c[TRL] loadSvelteConfig error - HTMLElement target with 'selectorElement', '${\n           svelteOptions.selectorElement}', not found for config:\\n`,\n          'background: rgb(57,34,34)', config);\n\n         throw new Error();\n      }\n   }\n\n   // If the configuration / original target is an HTML element then do not inject HTML.\n   const injectHTML = !(config.target instanceof HTMLElement);\n\n   return { config: svelteConfig, component, element, injectHTML };\n}\n","import { derived, writable }  from \"svelte/store\";\n\nimport {\n   propertyStore,\n   subscribeIgnoreFirst,\n   TJSSessionStorage }        from '@typhonjs-fvtt/runtime/svelte/store';\n\nimport {\n   deepMerge,\n   safeAccess,\n   safeSet }                  from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Contains the reactive functionality / Svelte stores associated with SvelteApplication and retrievable by\n * {@link SvelteApplication.reactive}.\n *\n * There are several reactive getters for UI state such and for two-way bindings / stores see\n * {@link SvelteReactive.storeUIState}:\n * - {@link SvelteReactive.dragging}\n * - {@link SvelteReactive.minimized}\n * - {@link SvelteReactive.resizing}\n *\n * There are also reactive getters / setters for {@link SvelteApplicationOptions} and Foundry\n * {@link ApplicationOptions}. You can use the following as one way bindings and update the associated stores. For\n * two-way bindings / stores see {@link SvelteReactive.storeAppOptions}.\n *\n * - {@link SvelteReactive.draggable}\n * - {@link SvelteReactive.focusAuto}\n * - {@link SvelteReactive.focusKeep}\n * - {@link SvelteReactive.focusTrap}\n * - {@link SvelteReactive.headerButtonNoClose}\n * - {@link SvelteReactive.headerButtonNoLabel}\n * - {@link SvelteReactive.headerIcon}\n * - {@link SvelteReactive.headerNoTitleMinimized}\n * - {@link SvelteReactive.minimizable}\n * - {@link SvelteReactive.popOut}\n * - {@link SvelteReactive.positionable}\n * - {@link SvelteReactive.resizable}\n * - {@link SvelteReactive.title}\n *\n * An instance of TJSSessionStorage is accessible via {@link SvelteReactive.sessionStorage}. Optionally you can pass\n * in an existing instance that can be shared across multiple SvelteApplications by setting\n * {@link SvelteApplicationOptions.sessionStorage}.\n *\n * -------------------------------------------------------------------------------------------------------------------\n *\n * This API is not sealed, and it is recommended that you extend it with accessors to get / set data that is reactive\n * in your application. An example of setting an exported prop `document` from the main mounted application shell.\n *\n * @example\n * import { hasSetter } from '@typhonjs-fvtt/runtime/svelte/util';\n *\n * // Note: make a normal comment.\n * //  * @member {object} document - Adds accessors to SvelteReactive to get / set the document associated with\n * //  *                             Document with the mounted application shell Svelte component.\n * //  *\n * //  * @memberof SvelteReactive#\n * //  *\n * Object.defineProperty(this.reactive, 'document', {\n *    get: () => this.svelte?.applicationShell?.document,\n *    set: (document) =>\n *    {\n *       const component = this.svelte?.applicationShell;\n *       if (hasSetter(component, 'document')) { component.document = document; }\n *    }\n * });\n */\nexport class SvelteReactive\n{\n   /**\n    * @type {SvelteApplication}\n    */\n   #application;\n\n   /**\n    * @type {boolean}\n    */\n   #initialized = false;\n\n   /** @type {TJSSessionStorage} */\n   #sessionStorage;\n\n   /**\n    * The Application option store which is injected into mounted Svelte component context under the `external` key.\n    *\n    * @type {StoreAppOptions}\n    */\n   #storeAppOptions;\n\n   /**\n    * Stores the update function for `#storeAppOptions`.\n    *\n    * @type {import('svelte/store').Writable.update}\n    */\n   #storeAppOptionsUpdate;\n\n   /**\n    * Stores the UI state data to make it accessible via getters.\n    *\n    * @type {object}\n    */\n   #dataUIState;\n\n   /**\n    * The UI option store which is injected into mounted Svelte component context under the `external` key.\n    *\n    * @type {StoreUIOptions}\n    */\n   #storeUIState;\n\n   /**\n    * Stores the update function for `#storeUIState`.\n    *\n    * @type {import('svelte/store').Writable.update}\n    */\n   #storeUIStateUpdate;\n\n   /**\n    * Stores the unsubscribe functions from local store subscriptions.\n    *\n    * @type {import('svelte/store').Unsubscriber[]}\n    */\n   #storeUnsubscribe = [];\n\n   /**\n    * @param {SvelteApplication} application - The host Foundry application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n      const optionsSessionStorage = application?.options?.sessionStorage;\n\n      if (optionsSessionStorage !== void 0 && !(optionsSessionStorage instanceof TJSSessionStorage))\n      {\n         throw new TypeError(`'options.sessionStorage' is not an instance of TJSSessionStorage.`);\n      }\n\n      this.#sessionStorage = optionsSessionStorage !== void 0 ? optionsSessionStorage : new TJSSessionStorage();\n   }\n\n   /**\n    * Initializes reactive support. Package private for internal use.\n    *\n    * @returns {SvelteStores|void} Internal methods to interact with Svelte stores.\n    * @package\n    */\n   initialize()\n   {\n      if (this.#initialized) { return; }\n\n      this.#initialized = true;\n\n      this.#storesInitialize();\n\n      return {\n         appOptionsUpdate: this.#storeAppOptionsUpdate,\n         uiOptionsUpdate: this.#storeUIStateUpdate,\n         subscribe: this.#storesSubscribe.bind(this),\n         unsubscribe: this.#storesUnsubscribe.bind(this)\n      };\n   }\n\n// Store getters -----------------------------------------------------------------------------------------------------\n\n   /**\n    * @returns {TJSSessionStorage} Returns TJSSessionStorage instance.\n    */\n   get sessionStorage()\n   {\n      return this.#sessionStorage;\n   }\n\n   /**\n    * Returns the store for app options.\n    *\n    * @returns {StoreAppOptions} App options store.\n    */\n   get storeAppOptions() { return this.#storeAppOptions; }\n\n   /**\n    * Returns the store for UI options.\n    *\n    * @returns {StoreUIOptions} UI options store.\n    */\n   get storeUIState() { return this.#storeUIState; }\n\n// Only reactive getters ---------------------------------------------------------------------------------------------\n\n   /**\n    * Returns the current dragging UI state.\n    *\n    * @returns {boolean} Dragging UI state.\n    */\n   get dragging() { return this.#dataUIState.dragging; }\n\n   /**\n    * Returns the current minimized UI state.\n    *\n    * @returns {boolean} Minimized UI state.\n    */\n   get minimized() { return this.#dataUIState.minimized; }\n\n   /**\n    * Returns the current resizing UI state.\n    *\n    * @returns {boolean} Resizing UI state.\n    */\n   get resizing() { return this.#dataUIState.resizing; }\n\n// Reactive getter / setters -----------------------------------------------------------------------------------------\n\n   /**\n    * Returns the draggable app option.\n    *\n    * @returns {boolean} Draggable app option.\n    */\n   get draggable() { return this.#application?.options?.draggable; }\n\n   /**\n    * Returns the focusAuto app option.\n    *\n    * @returns {boolean} When true auto-management of app focus is enabled.\n    */\n   get focusAuto() { return this.#application?.options?.focusAuto; }\n\n   /**\n    * Returns the focusKeep app option.\n    *\n    * @returns {boolean} When `focusAuto` and `focusKeep` is true; keeps internal focus.\n    */\n   get focusKeep() { return this.#application?.options?.focusKeep; }\n\n   /**\n    * Returns the focusTrap app option.\n    *\n    * @returns {boolean} When true focus trapping / wrapping is enabled keeping focus inside app.\n    */\n   get focusTrap() { return this.#application?.options?.focusTrap; }\n\n   /**\n    * Returns the headerButtonNoClose app option.\n    *\n    * @returns {boolean} Remove the close the button in header app option.\n    */\n   get headerButtonNoClose() { return this.#application?.options?.headerButtonNoClose; }\n\n   /**\n    * Returns the headerButtonNoLabel app option.\n    *\n    * @returns {boolean} Remove the labels from buttons in header app option.\n    */\n   get headerButtonNoLabel() { return this.#application?.options?.headerButtonNoLabel; }\n\n   /**\n    * Returns the headerIcon app option.\n    *\n    * @returns {string|void} URL for header app icon.\n    */\n   get headerIcon() { return this.#application?.options?.headerIcon; }\n\n   /**\n    * Returns the headerNoTitleMinimized app option.\n    *\n    * @returns {boolean} When true removes the header title when minimized.\n    */\n   get headerNoTitleMinimized() { return this.#application?.options?.headerNoTitleMinimized; }\n\n   /**\n    * Returns the minimizable app option.\n    *\n    * @returns {boolean} Minimizable app option.\n    */\n   get minimizable() { return this.#application?.options?.minimizable; }\n\n   /**\n    * Returns the Foundry popOut state; {@link Application.popOut}\n    *\n    * @returns {boolean} Positionable app option.\n    */\n   get popOut() { return this.#application.popOut; }\n\n   /**\n    * Returns the positionable app option; {@link SvelteApplicationOptions.positionable}\n    *\n    * @returns {boolean} Positionable app option.\n    */\n   get positionable() { return this.#application?.options?.positionable; }\n\n   /**\n    * Returns the resizable option.\n    *\n    * @returns {boolean} Resizable app option.\n    */\n   get resizable() { return this.#application?.options?.resizable; }\n\n   /**\n    * Returns the title accessor from the parent Application class; {@link Application.title}\n    * TODO: Application v2; note that super.title localizes `this.options.title`; IMHO it shouldn't.\n    *\n    * @returns {string} Title.\n    */\n   get title() { return this.#application.title; }\n\n   /**\n    * Sets `this.options.draggable` which is reactive for application shells.\n    *\n    * @param {boolean}  draggable - Sets the draggable option.\n    */\n   set draggable(draggable)\n   {\n      if (typeof draggable === 'boolean') { this.setOptions('draggable', draggable); }\n   }\n\n   /**\n    * Sets `this.options.focusAuto` which is reactive for application shells.\n    *\n    * @param {boolean}  focusAuto - Sets the focusAuto option.\n    */\n   set focusAuto(focusAuto)\n   {\n      if (typeof focusAuto === 'boolean') { this.setOptions('focusAuto', focusAuto); }\n   }\n\n   /**\n    * Sets `this.options.focusKeep` which is reactive for application shells.\n    *\n    * @param {boolean}  focusKeep - Sets the focusKeep option.\n    */\n   set focusKeep(focusKeep)\n   {\n      if (typeof focusKeep === 'boolean') { this.setOptions('focusKeep', focusKeep); }\n   }\n\n   /**\n    * Sets `this.options.focusTrap` which is reactive for application shells.\n    *\n    * @param {boolean}  focusTrap - Sets the focusTrap option.\n    */\n   set focusTrap(focusTrap)\n   {\n      if (typeof focusTrap === 'boolean') { this.setOptions('focusTrap', focusTrap); }\n   }\n\n   /**\n    * Sets `this.options.headerButtonNoClose` which is reactive for application shells.\n    *\n    * @param {boolean}  headerButtonNoClose - Sets the headerButtonNoClose option.\n    */\n   set headerButtonNoClose(headerButtonNoClose)\n   {\n      if (typeof headerButtonNoClose === 'boolean') { this.setOptions('headerButtonNoClose', headerButtonNoClose); }\n   }\n\n   /**\n    * Sets `this.options.headerButtonNoLabel` which is reactive for application shells.\n    *\n    * @param {boolean}  headerButtonNoLabel - Sets the headerButtonNoLabel option.\n    */\n   set headerButtonNoLabel(headerButtonNoLabel)\n   {\n      if (typeof headerButtonNoLabel === 'boolean') { this.setOptions('headerButtonNoLabel', headerButtonNoLabel); }\n   }\n\n   /**\n    * Sets `this.options.headerIcon` which is reactive for application shells.\n    *\n    * @param {string|void}  headerIcon - Sets the headerButtonNoLabel option.\n    */\n   set headerIcon(headerIcon)\n   {\n      if (headerIcon === void 0 || typeof headerIcon === 'string') { this.setOptions('headerIcon', headerIcon); }\n   }\n\n   /**\n    * Sets `this.options.headerNoTitleMinimized` which is reactive for application shells.\n    *\n    * @param {boolean}  headerNoTitleMinimized - Sets the headerNoTitleMinimized option.\n    */\n   set headerNoTitleMinimized(headerNoTitleMinimized)\n   {\n      if (typeof headerNoTitleMinimized === 'boolean')\n      {\n         this.setOptions('headerNoTitleMinimized', headerNoTitleMinimized);\n      }\n   }\n\n   /**\n    * Sets `this.options.minimizable` which is reactive for application shells that are also pop out.\n    *\n    * @param {boolean}  minimizable - Sets the minimizable option.\n    */\n   set minimizable(minimizable)\n   {\n      if (typeof minimizable === 'boolean') { this.setOptions('minimizable', minimizable); }\n   }\n\n   /**\n    * Sets `this.options.popOut` which is reactive for application shells. This will add / remove this application\n    * from `ui.windows`.\n    *\n    * @param {boolean}  popOut - Sets the popOut option.\n    */\n   set popOut(popOut)\n   {\n      if (typeof popOut === 'boolean') { this.setOptions('popOut', popOut); }\n   }\n\n   /**\n    * Sets `this.options.positionable` enabling / disabling {@link SvelteApplication.position.set}.\n    *\n    * @param {boolean}  positionable - Sets the positionable option.\n    */\n   set positionable(positionable)\n   {\n      if (typeof positionable === 'boolean') { this.setOptions('positionable', positionable); }\n   }\n\n   /**\n    * Sets `this.options.resizable` which is reactive for application shells.\n    *\n    * @param {boolean}  resizable - Sets the resizable option.\n    */\n   set resizable(resizable)\n   {\n      if (typeof resizable === 'boolean') { this.setOptions('resizable', resizable); }\n   }\n\n   /**\n    * Sets `this.options.title` which is reactive for application shells.\n    *\n    * Note: Will set empty string if title is undefined or null.\n    *\n    * @param {string|undefined|null}   title - Application title; will be localized, so a translation key is fine.\n    */\n   set title(title)\n   {\n      if (typeof title === 'string')\n      {\n         this.setOptions('title', title);\n      }\n      else if (title === void 0 || title === null)\n      {\n         this.setOptions('title', '');\n      }\n   }\n\n   // Reactive Options API -------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a way to safely get this applications options given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {*}        [defaultValue] - A default value returned if the accessor is not found.\n    *\n    * @returns {*} Value at the accessor.\n    */\n   getOptions(accessor, defaultValue)\n   {\n      return safeAccess(this.#application.options, accessor, defaultValue);\n   }\n\n   /**\n    * Provides a way to merge `options` into this applications options and update the appOptions store.\n    *\n    * @param {object}   options - The options object to merge with `this.options`.\n    */\n   mergeOptions(options)\n   {\n      this.#storeAppOptionsUpdate((instanceOptions) => deepMerge(instanceOptions, options));\n   }\n\n   /**\n    * Provides a way to safely set this applications options given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * Additionally if an application shell Svelte component is mounted and exports the `appOptions` property then\n    * the application options is set to `appOptions` potentially updating the application shell / Svelte component.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {*}        value - Value to set.\n    */\n   setOptions(accessor, value)\n   {\n      const success = safeSet(this.#application.options, accessor, value);\n\n      // If `this.options` modified then update the app options store.\n      if (success)\n      {\n         this.#storeAppOptionsUpdate(() => this.#application.options);\n      }\n   }\n\n   /**\n    * Initializes the Svelte stores and derived stores for the application options and UI state.\n    *\n    * While writable stores are created the update method is stored in private variables locally and derived Readable\n    * stores are provided for essential options which are commonly used.\n    *\n    * These stores are injected into all Svelte components mounted under the `external` context: `storeAppOptions` and\n    * ` storeUIState`.\n    */\n   #storesInitialize()\n   {\n      const writableAppOptions = writable(this.#application.options);\n\n      // Keep the update function locally, but make the store essentially readable.\n      this.#storeAppOptionsUpdate = writableAppOptions.update;\n\n      /**\n       * Create custom store. The main subscribe method for all app options changes is provided along with derived\n       * writable stores for all reactive options.\n       *\n       * @type {StoreAppOptions}\n       */\n      const storeAppOptions = {\n         subscribe: writableAppOptions.subscribe,\n\n         draggable: propertyStore(writableAppOptions, 'draggable'),\n         focusAuto: propertyStore(writableAppOptions, 'focusAuto'),\n         focusKeep: propertyStore(writableAppOptions, 'focusKeep'),\n         focusTrap: propertyStore(writableAppOptions, 'focusTrap'),\n         headerButtonNoClose: propertyStore(writableAppOptions, 'headerButtonNoClose'),\n         headerButtonNoLabel: propertyStore(writableAppOptions, 'headerButtonNoLabel'),\n         headerIcon: propertyStore(writableAppOptions, 'headerIcon'),\n         headerNoTitleMinimized: propertyStore(writableAppOptions, 'headerNoTitleMinimized'),\n         minimizable: propertyStore(writableAppOptions, 'minimizable'),\n         popOut: propertyStore(writableAppOptions, 'popOut'),\n         positionable: propertyStore(writableAppOptions, 'positionable'),\n         resizable: propertyStore(writableAppOptions, 'resizable'),\n         title: propertyStore(writableAppOptions, 'title')\n      };\n\n      Object.freeze(storeAppOptions);\n\n      this.#storeAppOptions = storeAppOptions;\n\n      this.#dataUIState = {\n         dragging: false,\n         headerButtons: [],\n         minimized: this.#application._minimized,\n         resizing: false\n      };\n\n      // Create a store for UI state data.\n      const writableUIOptions = writable(this.#dataUIState);\n\n      // Keep the update function locally, but make the store essentially readable.\n      this.#storeUIStateUpdate = writableUIOptions.update;\n\n      /**\n       * @type {StoreUIOptions}\n       */\n      const storeUIState = {\n         subscribe: writableUIOptions.subscribe,\n\n         dragging: propertyStore(writableUIOptions, 'dragging'),\n         headerButtons: derived(writableUIOptions, ($options, set) => set($options.headerButtons)),\n         minimized: derived(writableUIOptions, ($options, set) => set($options.minimized)),\n         resizing: propertyStore(writableUIOptions, 'resizing')\n      };\n\n      Object.freeze(storeUIState);\n\n      // Initialize the store with options set in the Application constructor.\n      this.#storeUIState = storeUIState;\n   }\n\n   /**\n    * Registers local store subscriptions for app options. `popOut` controls registering this app with `ui.windows`.\n    *\n    * @see SvelteApplication._injectHTML\n    */\n   #storesSubscribe()\n   {\n      // Register local subscriptions.\n\n      // Handles updating header buttons to add / remove the close button.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.headerButtonNoClose, (value) =>\n      {\n         this.updateHeaderButtons({ headerButtonNoClose: value });\n      }));\n\n      // Handles updating header buttons to add / remove button labels.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.headerButtonNoLabel, (value) =>\n      {\n         this.updateHeaderButtons({ headerButtonNoLabel: value });\n      }));\n\n      // Handles adding / removing this application from `ui.windows` when popOut changes.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.popOut, (value) =>\n      {\n         if (value && this.#application.rendered)\n         {\n            globalThis.ui.windows[this.#application.appId] = this.#application;\n         }\n         else\n         {\n            delete globalThis.ui.windows[this.#application.appId];\n         }\n      }));\n   }\n\n   /**\n    * Unsubscribes from any locally monitored stores.\n    *\n    * @see SvelteApplication.close\n    */\n   #storesUnsubscribe()\n   {\n      this.#storeUnsubscribe.forEach((unsubscribe) => unsubscribe());\n      this.#storeUnsubscribe = [];\n   }\n\n   /**\n    * Updates the UI Options store with the current header buttons. You may dynamically add / remove header buttons\n    * if using an application shell Svelte component. In either overriding `_getHeaderButtons` or responding to the\n    * Hooks fired return a new button array and the uiOptions store is updated and the application shell will render\n    * the new buttons.\n    *\n    * Optionally you can set in the SvelteApplication app options {@link SvelteApplicationOptions.headerButtonNoClose}\n    * to remove the close button and {@link SvelteApplicationOptions.headerButtonNoLabel} to true and labels will be\n    * removed from the header buttons.\n    *\n    * @param {object} opts - Optional parameters (for internal use)\n    *\n    * @param {boolean} opts.headerButtonNoClose - The value for `headerButtonNoClose`.\n    *\n    * @param {boolean} opts.headerButtonNoLabel - The value for `headerButtonNoLabel`.\n    */\n   updateHeaderButtons({ headerButtonNoClose = this.#application.options.headerButtonNoClose,\n    headerButtonNoLabel = this.#application.options.headerButtonNoLabel } = {})\n   {\n      let buttons = this.#application._getHeaderButtons();\n\n      // Remove close button if this.options.headerButtonNoClose is true;\n      if (typeof headerButtonNoClose === 'boolean' && headerButtonNoClose)\n      {\n         buttons = buttons.filter((button) => button.class !== 'close');\n      }\n\n      // Remove labels if this.options.headerButtonNoLabel is true;\n      if (typeof headerButtonNoLabel === 'boolean' && headerButtonNoLabel)\n      {\n         for (const button of buttons) { button.label = void 0; }\n      }\n\n      this.#storeUIStateUpdate((options) =>\n      {\n         options.headerButtons = buttons;\n         return options;\n      });\n   }\n}\n","// import { Position }           from '@typhonjs-fvtt/runtime/svelte/store';\nimport { Position }           from './position/Position.js';\n\nimport {\n   A11yHelper,\n   deepMerge,\n   hasGetter,\n   isApplicationShell,\n   isHMRProxy,\n   isObject,\n   outroAndDestroy }          from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport {\n   ApplicationState,\n   GetSvelteData,\n   loadSvelteConfig,\n   SvelteReactive }           from './internal/index.js';\n\n/**\n * Provides a Svelte aware extension to Application to control the app lifecycle appropriately. You can declaratively\n * load one or more components from `defaultOptions`.\n */\nexport class SvelteApplication extends Application\n{\n   /**\n    * Stores the first mounted component which follows the application shell contract.\n    *\n    * @type {MountedAppShell[]|null[]} Application shell.\n    */\n   #applicationShellHolder = [null];\n\n   /**\n    * Stores and manages application state for saving / restoring / serializing.\n    *\n    * @type {ApplicationState}\n    */\n   #applicationState;\n\n   /**\n    * Stores the target element which may not necessarily be the main element.\n    *\n    * @type {HTMLElement}\n    */\n   #elementTarget = null;\n\n   /**\n    * Stores the content element which is set for application shells.\n    *\n    * @type {HTMLElement}\n    */\n   #elementContent = null;\n\n   /**\n    * Stores initial z-index from `_renderOuter` to set to target element / Svelte component.\n    *\n    * @type {number}\n    */\n   #initialZIndex = 95;\n\n   /**\n    * Stores on mount state which is checked in _render to trigger onSvelteMount callback.\n    *\n    * @type {boolean}\n    */\n   #onMount = false;\n\n   /**\n    * The position store.\n    *\n    * @type {Position}\n    */\n   #position;\n\n   /**\n    * Contains the Svelte stores and reactive accessors.\n    *\n    * @type {SvelteReactive}\n    */\n   #reactive;\n\n   /**\n    * Stores SvelteData entries with instantiated Svelte components.\n    *\n    * @type {SvelteData[]}\n    */\n   #svelteData = [];\n\n   /**\n    * Provides a helper class that combines multiple methods for interacting with the mounted components tracked in\n    * {@link SvelteData}.\n    *\n    * @type {GetSvelteData}\n    */\n   #getSvelteData = new GetSvelteData(this.#applicationShellHolder, this.#svelteData);\n\n   /**\n    * Contains methods to interact with the Svelte stores.\n    *\n    * @type {SvelteStores}\n    */\n   #stores;\n\n   /**\n    * @param {SvelteApplicationOptions} options - The options for the application.\n    *\n    * @inheritDoc\n    */\n   constructor(options = {})\n   {\n      super(options);\n\n      this.#applicationState = new ApplicationState(this);\n\n      // Initialize Position with the position object set by Application.\n      this.#position = new Position(this, {\n         ...this.position,\n         ...this.options,\n         initial: this.options.positionInitial,\n         ortho: this.options.positionOrtho,\n         validator: this.options.positionValidator\n      });\n\n      // Remove old position field.\n      delete this.position;\n\n      /**\n       * Define accessors to retrieve Position by `this.position`.\n       *\n       * @member {Position} position - Adds accessors to SvelteApplication to get / set the position data.\n       *\n       * @memberof SvelteApplication#\n       */\n      Object.defineProperty(this, 'position', {\n         get: () => this.#position,\n         set: (position) => { if (isObject(position)) { this.#position.set(position); } }\n      });\n\n      this.#reactive = new SvelteReactive(this);\n\n      this.#stores = this.#reactive.initialize();\n   }\n\n   /**\n    * Specifies the default options that SvelteApplication supports.\n    *\n    * @returns {SvelteApplicationOptions} options - Application options.\n    * @see https://foundryvtt.com/api/interfaces/client.ApplicationOptions.html\n    */\n   static get defaultOptions()\n   {\n      return deepMerge(super.defaultOptions, {\n         defaultCloseAnimation: true,     // If false the default slide close animation is not run.\n         draggable: true,                 // If true then application shells are draggable.\n         focusAuto: true,                 // When true auto-management of app focus is enabled.\n         focusKeep: false,                // When `focusAuto` and `focusKeep` is true; keeps internal focus.\n         focusSource: void 0,             // Stores any A11yFocusSource data that is applied when app is closed.\n         focusTrap: true,                 // When true focus trapping / wrapping is enabled keeping focus inside app.\n         headerButtonNoClose: false,      // If true then the close header button is removed.\n         headerButtonNoLabel: false,      // If true then header button labels are removed for application shells.\n         headerIcon: void 0,              // Sets a header icon given an image URL.\n         headerNoTitleMinimized: false,   // If true then header title is hidden when application is minimized.\n         minHeight: MIN_WINDOW_HEIGHT,    // Assigned to position. Number specifying minimum window height.\n         minWidth: MIN_WINDOW_WIDTH,      // Assigned to position. Number specifying minimum window width.\n         positionable: true,              // If false then `position.set` does not take effect.\n         positionInitial: Position.Initial.browserCentered,      // A helper for initial position placement.\n         positionOrtho: true,             // When true Position is optimized for orthographic use.\n         positionValidator: Position.Validators.transformWindow, // A function providing the default validator.\n         sessionStorage: void 0,          // An instance of SessionStorage to share across SvelteApplications.\n         svelte: void 0,                  // A Svelte configuration object.\n         transformOrigin: 'top left'      // By default, 'top / left' respects rotation when minimizing.\n      });\n   }\n\n   /**\n    * Returns the content element if an application shell is mounted.\n    *\n    * @returns {HTMLElement} Content element.\n    */\n   get elementContent() { return this.#elementContent; }\n\n   /**\n    * Returns the target element or main element if no target defined.\n    *\n    * @returns {HTMLElement} Target element.\n    */\n   get elementTarget() { return this.#elementTarget; }\n\n   /**\n    * Returns the reactive accessors & Svelte stores for SvelteApplication.\n    *\n    * @returns {SvelteReactive} The reactive accessors & Svelte stores.\n    */\n   get reactive() { return this.#reactive; }\n\n   /**\n    * Returns the application state manager.\n    *\n    * @returns {ApplicationState} The application state manager.\n    */\n   get state() { return this.#applicationState; }\n\n   /**\n    * Returns the Svelte helper class w/ various methods to access mounted Svelte components.\n    *\n    * @returns {GetSvelteData} GetSvelteData\n    */\n   get svelte() { return this.#getSvelteData; }\n\n   /**\n    * In this case of when a template is defined in app options `html` references the inner HTML / template. However,\n    * to activate classic v1 tabs for a Svelte component the element target is passed as an array simulating JQuery as\n    * the element is retrieved immediately and the core listeners use standard DOM queries.\n    *\n    * @inheritDoc\n    * @protected\n    * @ignore\n    */\n   _activateCoreListeners(html)\n   {\n      super._activateCoreListeners(typeof this.options.template === 'string' ? html : [this.#elementTarget]);\n   }\n\n   /**\n    * Provide an override to set this application as the active window regardless of z-index. Changes behaviour from\n    * Foundry core. This is important / used for instance in dialog key handling for left / right button selection.\n    *\n    * @param {object} [opts] - Optional parameters.\n    *\n    * @param {boolean} [opts.force=false] - Force bring to top; will increment z-index by popOut order.\n    *\n    */\n   bringToTop({ force = false } = {})\n   {\n      if (force || this.popOut) { super.bringToTop(); }\n\n      // If the activeElement is not `document.body` and not contained in this app via elementTarget then blur the\n      // current active element and make `document.body`focused. This allows <esc> key to close all open apps / windows.\n      if (document.activeElement !== document.body && !this.elementTarget.contains(document.activeElement))\n      {\n         // Blur current active element.\n         if (document.activeElement instanceof HTMLElement) { document.activeElement.blur(); }\n\n         // Make document body focused.\n         document.body.focus();\n      }\n\n      globalThis.ui.activeWindow = this;\n   }\n\n   /**\n    * Note: This method is fully overridden and duplicated as Svelte components need to be destroyed manually and the\n    * best visual result is to destroy them after the default slide up animation occurs, but before the element\n    * is removed from the DOM.\n    *\n    * If you destroy the Svelte components before the slide up animation the Svelte elements are removed immediately\n    * from the DOM. The purpose of overriding ensures the slide up animation is always completed before\n    * the Svelte components are destroyed and then the element is removed from the DOM.\n    *\n    * Close the application and un-register references to it within UI mappings.\n    * This function returns a Promise which resolves once the window closing animation concludes\n    *\n    * @param {object}   [options] - Optional parameters.\n    *\n    * @param {boolean}  [options.force] - Force close regardless of render state.\n    *\n    * @returns {Promise<void>}    A Promise which resolves once the application is closed.\n    * @ignore\n    */\n   async close(options = {})\n   {\n      const states = Application.RENDER_STATES;\n      if (!options.force && ![states.RENDERED, states.ERROR].includes(this._state)) { return; }\n\n      // Unsubscribe from any local stores.\n      this.#stores.unsubscribe();\n\n      /**\n       * @ignore\n       */\n      this._state = states.CLOSING;\n\n      /**\n       * Get the element.\n       *\n       * @type {HTMLElement}\n       */\n      const el = this.#elementTarget;\n      if (!el) { return this._state = states.CLOSED; }\n\n      // Make any window content overflow hidden to avoid any scrollbars appearing in default or Svelte outro\n      // transitions.\n      const content = el.querySelector('.window-content');\n      if (content)\n      {\n         content.style.overflow = 'hidden';\n\n         // Set all children of content to overflow hidden as if there is going to be additional scrolling elements\n         // they are likely one level deep.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = 'hidden';\n         }\n      }\n\n      // Dispatch Hooks for closing the base and subclass applications\n      for (const cls of this.constructor._getInheritanceChain())\n      {\n         /**\n          * A hook event that fires whenever this Application is closed.\n          *\n          * @param {Application} app                     The Application instance being closed\n          *\n          * @param {jQuery[]} html                       The application HTML when it is closed\n          *\n          * @function closeApplication\n          *\n          * @memberof hookEvents\n          */\n         Hooks.call(`close${cls.name}`, this, el);\n      }\n\n      // If options `defaultCloseAnimation` is false then do not execute the standard slide up animation.\n      // This allows Svelte components to provide any out transition. Application shells will automatically set\n      // `defaultCloseAnimation` based on any out transition set or unset.\n      const animate = typeof this.options.defaultCloseAnimation === 'boolean' ? this.options.defaultCloseAnimation :\n       true;\n\n      if (animate)\n      {\n         // Set min height for full slide.\n         el.style.minHeight = '0';\n\n         const { paddingBottom, paddingTop } = globalThis.getComputedStyle(el);\n\n         // Slide-up application.\n         await el.animate([\n            { maxHeight: `${el.clientHeight}px`, paddingTop, paddingBottom },\n            { maxHeight: 0, paddingTop: 0, paddingBottom: 0 }\n         ], { duration: 250, easing: 'ease-in', fill: 'forwards' }).finished;\n      }\n\n      // Stores the Promises returned from running outro transitions and destroying each Svelte component.\n      const svelteDestroyPromises = [];\n\n      // Manually invoke the destroy callbacks for all Svelte components.\n      for (const entry of this.#svelteData)\n      {\n         // Use `outroAndDestroy` to run outro transitions before destroying.\n         svelteDestroyPromises.push(outroAndDestroy(entry.component));\n\n         // If any proxy eventbus has been added then remove all event registrations from the component.\n         const eventbus = entry.config.eventbus;\n         if (isObject(eventbus) && typeof eventbus.off === 'function')\n         {\n            eventbus.off();\n            entry.config.eventbus = void 0;\n         }\n      }\n\n      // Await all Svelte components to destroy.\n      await Promise.all(svelteDestroyPromises);\n\n      // Reset SvelteData like this to maintain reference to GetSvelteData / `this.svelte`.\n      this.#svelteData.length = 0;\n\n      // Remove element from the DOM. Most SvelteComponents have already removed it.\n      el.remove();\n\n      // Silently restore any width / height state before minimized as applicable.\n      this.position.state.restore({\n         name: '#beforeMinimized',\n         properties: ['width', 'height'],\n         silent: true,\n         remove: true\n      });\n\n      // Clean up data\n      this.#applicationShellHolder[0] = null;\n      /**\n       * @ignore\n       */\n      this._element = null;\n      this.#elementContent = null;\n      this.#elementTarget = null;\n      delete globalThis.ui.windows[this.appId];\n      /**\n       * @ignore\n       */\n      this._minimized = false;\n      /**\n       * @ignore\n       */\n      this._scrollPositions = null;\n      this._state = states.CLOSED;\n\n      this.#onMount = false;\n\n      // Update the minimized UI store options.\n      this.#stores.uiOptionsUpdate((storeOptions) => deepMerge(storeOptions, { minimized: this._minimized }));\n\n      // Apply any stored focus options and then remove them from options.\n      A11yHelper.applyFocusSource(this.options.focusSource);\n\n      delete this.options.focusSource;\n   }\n\n   /**\n    * Inject the Svelte components defined in `this.options.svelte`. The Svelte component can attach to the existing\n    * pop-out of Application or provide no template and render into a document fragment which is then attached to the\n    * DOM.\n    *\n    * @param {JQuery} html -\n    *\n    * @inheritDoc\n    * @ignore\n    */\n   _injectHTML(html)\n   {\n      if (this.popOut && html.length === 0 && Array.isArray(this.options.svelte))\n      {\n         throw new Error(\n          'SvelteApplication - _injectHTML - A popout app with no template can only support one Svelte component.');\n      }\n\n      // Make sure the store is updated with the latest header buttons. Also allows filtering buttons before display.\n      this.reactive.updateHeaderButtons();\n\n      // Create a function to generate a callback for Svelte components to invoke to update the tracked elements for\n      // application shells in the rare cases that the main element root changes. The update is only trigged on\n      // successive changes of `elementRoot`. Returns a boolean to indicate the element roots are updated.\n      const elementRootUpdate = () =>\n      {\n         let cntr = 0;\n\n         return (elementRoot) =>\n         {\n            if (elementRoot !== null && elementRoot !== void 0 && cntr++ > 0)\n            {\n               this.#updateApplicationShell();\n               return true;\n            }\n\n            return false;\n         };\n      };\n\n      if (Array.isArray(this.options.svelte))\n      {\n         for (const svelteConfig of this.options.svelte)\n         {\n            const svelteData = loadSvelteConfig({\n               app: this,\n               template: html[0],\n               config: svelteConfig,\n               elementRootUpdate\n            });\n\n            if (isApplicationShell(svelteData.component))\n            {\n               if (this.svelte.applicationShell !== null)\n               {\n                  throw new Error(\n                   `SvelteApplication - _injectHTML - An application shell is already mounted; offending config:\n                    ${JSON.stringify(svelteConfig)}`);\n               }\n\n               this.#applicationShellHolder[0] = svelteData.component;\n\n               // If Vite / HMR / svelte_hmr is enabled then add a hook to receive callbacks when the ProxyComponent\n               // refreshes. Update the element root accordingly and force an update to Position.\n               // See this issue for info about `on_hmr`:\n               // https://github.com/sveltejs/svelte-hmr/issues/57\n               if (isHMRProxy(svelteData.component) && Array.isArray(svelteData.component?.$$?.on_hmr))\n               {\n                  svelteData.component.$$.on_hmr.push(() => () => this.#updateApplicationShell());\n               }\n            }\n\n            this.#svelteData.push(svelteData);\n         }\n      }\n      else if (isObject(this.options.svelte))\n      {\n         const svelteData = loadSvelteConfig({\n            app: this,\n            template: html[0],\n            config: this.options.svelte,\n            elementRootUpdate\n         });\n\n         if (isApplicationShell(svelteData.component))\n         {\n            // A sanity check as shouldn't hit this case as only one component is being mounted.\n            if (this.svelte.applicationShell !== null)\n            {\n               throw new Error(\n                `SvelteApplication - _injectHTML - An application shell is already mounted; offending config:\n                 ${JSON.stringify(this.options.svelte)}`);\n            }\n\n            this.#applicationShellHolder[0] = svelteData.component;\n\n            // If Vite / HMR / svelte_hmr is enabled then add a hook to receive callbacks when the ProxyComponent\n            // refreshes. Update the element root accordingly and force an update to Position.\n            // See this issue for info about `on_hmr`:\n            // https://github.com/sveltejs/svelte-hmr/issues/57\n            if (isHMRProxy(svelteData.component) && Array.isArray(svelteData.component?.$$?.on_hmr))\n            {\n               svelteData.component.$$.on_hmr.push(() => () => this.#updateApplicationShell());\n            }\n         }\n\n         this.#svelteData.push(svelteData);\n      }\n\n      // Detect if this is a synthesized DocumentFragment.\n      const isDocumentFragment = html.length && html[0] instanceof DocumentFragment;\n\n      // If any of the Svelte components mounted directly targets an HTMLElement then do not inject HTML.\n      let injectHTML = true;\n      for (const svelteData of this.#svelteData)\n      {\n         if (!svelteData.injectHTML) { injectHTML = false; break; }\n      }\n      if (injectHTML) { super._injectHTML(html); }\n\n      if (this.svelte.applicationShell !== null)\n      {\n         this._element = $(this.svelte.applicationShell.elementRoot);\n\n         // Detect if the application shell exports an `elementContent` accessor.\n         this.#elementContent = hasGetter(this.svelte.applicationShell, 'elementContent') ?\n          this.svelte.applicationShell.elementContent : null;\n\n         // Detect if the application shell exports an `elementTarget` accessor.\n         this.#elementTarget = hasGetter(this.svelte.applicationShell, 'elementTarget') ?\n          this.svelte.applicationShell.elementTarget : null;\n      }\n      else if (isDocumentFragment) // Set the element of the app to the first child element in order of Svelte components mounted.\n      {\n         for (const svelteData of this.#svelteData)\n         {\n            if (svelteData.element instanceof HTMLElement)\n            {\n               this._element = $(svelteData.element);\n               break;\n            }\n         }\n      }\n\n      // Potentially retrieve a specific target element if `selectorTarget` is defined otherwise make the target the\n      // main element.\n      if (this.#elementTarget === null)\n      {\n         this.#elementTarget = typeof this.options.selectorTarget === 'string' ?\n          this._element[0].querySelector(this.options.selectorTarget) : this._element[0];\n      }\n\n      if (this.#elementTarget === null || this.#elementTarget === void 0)\n      {\n         throw new Error(`SvelteApplication - _injectHTML: Target element '${this.options.selectorTarget}' not found.`);\n      }\n\n      // The initial zIndex may be set in application options or for popOut applications is stored by `_renderOuter`\n      // in `this.#initialZIndex`.\n      if (typeof this.options.positionable === 'boolean' && this.options.positionable)\n      {\n         this.#elementTarget.style.zIndex = typeof this.options.zIndex === 'number' ? this.options.zIndex :\n          this.#initialZIndex ?? 95;\n      }\n\n      // Subscribe to local store handling.\n      this.#stores.subscribe();\n   }\n\n   /**\n    * Provides a mechanism to update the UI options store for maximized.\n    *\n    * Note: the sanity check is duplicated from {@link Application.maximize} the store is updated _before_\n    * performing the rest of animations. This allows application shells to remove / show any resize handlers\n    * correctly. Extra constraint data is stored in a saved position state in {@link SvelteApplication.minimize}\n    * to animate the content area.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.animate=true] - When true perform default maximizing animation.\n    *\n    * @param {number}   [opts.duration=0.1] - Controls content area animation duration in seconds.\n    */\n   async maximize({ animate = true, duration = 0.1 } = {})\n   {\n      if (!this.popOut || [false, null].includes(this._minimized)) { return; }\n\n      this._minimized = null;\n\n      const durationMS = duration * 1000; // For WAAPI.\n\n      // Get content\n      const element = this.elementTarget;\n      const header = element.querySelector('.window-header');\n      const content = element.querySelector('.window-content');\n\n      // Get the complete position before minimized. Used to reset min width & height to initial values later.\n      const positionBefore = this.position.state.get({ name: '#beforeMinimized' });\n\n      // First animate / restore width / async.\n      if (animate)\n      {\n         await this.position.state.restore({\n            name: '#beforeMinimized',\n            async: true,\n            animateTo: true,\n            properties: ['width'],\n            duration: 0.1\n         });\n      }\n\n      element.classList.remove('minimized');\n\n      // Reset display none on all children of header.\n      for (let cntr = header.children.length; --cntr >= 0;) { header.children[cntr].style.display = null; }\n\n      content.style.display = null;\n\n      let constraints;\n\n      if (animate)\n      {\n         // Next animate / restore height synchronously and remove key. Retrieve constraints data for slide up animation\n         // below.\n         ({ constraints } = this.position.state.restore({\n            name: '#beforeMinimized',\n            animateTo: true,\n            properties: ['height'],\n            remove: true,\n            duration\n         }));\n      }\n      else\n      {\n         ({ constraints } = this.position.state.remove({ name: '#beforeMinimized' }));\n      }\n\n      // Slide down content with stored constraints.\n      await content.animate([\n         { maxHeight: 0, paddingTop: 0, paddingBottom: 0, offset: 0 },\n         { ...constraints, offset: 1 },\n         { maxHeight: '100%', offset: 1 },\n      ], { duration: durationMS, fill: 'forwards' }).finished; // WAAPI in ms.\n\n      // Restore previous min width & height from saved data, app options, or default Foundry values.\n      this.position.set({\n         minHeight: positionBefore.minHeight ?? this.options?.minHeight ?? MIN_WINDOW_HEIGHT,\n         minWidth: positionBefore.minWidth ?? this.options?.minWidth ?? MIN_WINDOW_WIDTH,\n      });\n\n      // Remove inline styles that override any styles assigned to the app.\n      element.style.minWidth = null;\n      element.style.minHeight = null;\n\n      this._minimized = false;\n\n      // Using a 50ms timeout prevents any instantaneous display of scrollbars with the above maximize animation.\n      setTimeout(() =>\n      {\n         content.style.overflow = null;\n\n         // Reset all children of content removing overflow hidden.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = null;\n         }\n      }, 50);\n\n      this.#stores.uiOptionsUpdate((options) => deepMerge(options, { minimized: false }));\n   }\n\n   /**\n    * Provides a mechanism to update the UI options store for minimized.\n    *\n    * Note: the sanity check is duplicated from {@link Application.minimize} the store is updated _before_\n    * performing the rest of animations. This allows application shells to remove / show any resize handlers\n    * correctly. Extra constraint data is stored in a saved position state in {@link SvelteApplication.minimize}\n    * to animate the content area.\n    *\n    * @param {object}   [opts] - Optional parameters\n    *\n    * @param {boolean}  [opts.animate=true] - When true perform default minimizing animation.\n    *\n    * @param {number}   [opts.duration=0.1] - Controls content area animation duration in seconds.\n    */\n   async minimize({ animate = true, duration = 0.1 } = {})\n   {\n      if (!this.rendered || !this.popOut || [true, null].includes(this._minimized)) { return; }\n\n      this.#stores.uiOptionsUpdate((options) => deepMerge(options, { minimized: true }));\n\n      this._minimized = null;\n\n      const durationMS = duration * 1000; // For WAAPI.\n\n      const element = this.elementTarget;\n\n      // Get content\n      const header = element.querySelector('.window-header');\n      const content = element.querySelector('.window-content');\n\n      // Save current max / min height & width.\n      const beforeMinWidth = this.position.minWidth;\n      const beforeMinHeight = this.position.minHeight;\n\n      // Set minimized min width & height for header bar.\n      this.position.set({ minWidth: 100, minHeight: 30 });\n\n      // Also set inline styles to override any styles scoped to the app.\n      element.style.minWidth = '100px';\n      element.style.minHeight = '30px';\n\n      if (content)\n      {\n         content.style.overflow = 'hidden';\n\n         // Set all children of content to overflow hidden as if there is going to be additional scrolling elements\n         // they are likely one level deep.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = 'hidden';\n         }\n      }\n\n      const { paddingBottom, paddingTop } = globalThis.getComputedStyle(content);\n\n      // Extra data that is saved with the current position. Used during `maximize`.\n      const constraints = {\n         maxHeight: `${content.clientHeight}px`,\n         paddingTop,\n         paddingBottom\n      };\n\n      // Slide-up content\n      if (animate)\n      {\n         const animation = content.animate([\n            constraints,\n            { maxHeight: 0, paddingTop: 0, paddingBottom: 0 }\n         ], { duration: durationMS, fill: 'forwards' }); // WAAPI in ms.\n\n         // Set display style to none when animation finishes.\n         animation.finished.then(() => content.style.display = 'none');\n      }\n      else\n      {\n         setTimeout(() => content.style.display = 'none', durationMS);\n      }\n\n      // Save current position state and add the constraint data to use in `maximize`.\n      const saved = this.position.state.save({ name: '#beforeMinimized', constraints });\n\n      // Set the initial before min width & height.\n      saved.minWidth = beforeMinWidth;\n      saved.minHeight = beforeMinHeight;\n\n      const headerOffsetHeight = header.offsetHeight;\n\n      // minHeight needs to be adjusted to header height.\n      this.position.minHeight = headerOffsetHeight;\n\n      if (animate)\n      {\n         // First await animation of height upward.\n         await this.position.animate.to({ height: headerOffsetHeight }, { duration }).finished;\n      }\n\n      // Set all header buttons besides close and the window title to display none.\n      for (let cntr = header.children.length; --cntr >= 0;)\n      {\n         const className = header.children[cntr].className;\n\n         if (className.includes('window-title') || className.includes('close')) { continue; }\n\n         // v10+ of Foundry core styles automatically hides anything besides the window title and close button, so\n         // explicitly set display to block.\n         if (className.includes('keep-minimized'))\n         {\n            header.children[cntr].style.display = 'block';\n            continue;\n         }\n\n         header.children[cntr].style.display = 'none';\n      }\n\n      if (animate)\n      {\n         // Await animation of width to the left / minimum width.\n         await this.position.animate.to({ width: MIN_WINDOW_WIDTH }, { duration: 0.1 }).finished;\n      }\n\n      element.classList.add('minimized');\n\n      this._minimized = true;\n   }\n\n   /**\n    * Provides a callback after all Svelte components are initialized.\n    *\n    * @param {object}      [opts] - Optional parameters.\n    *\n    * @param {HTMLElement} [opts.element] - HTMLElement container for main application element.\n    *\n    * @param {HTMLElement} [opts.elementContent] - HTMLElement container for content area of application shells.\n    *\n    * @param {HTMLElement} [opts.elementTarget] - HTMLElement container for main application target element.\n    */\n   onSvelteMount({ element, elementContent, elementTarget } = {}) {} // eslint-disable-line no-unused-vars\n\n   /**\n    * Provides a callback after the main application shell is remounted. This may occur during HMR / hot module\n    * replacement or directly invoked from the `elementRootUpdate` callback passed to the application shell component\n    * context.\n    *\n    * @param {object}      [opts] - Optional parameters.\n    *\n    * @param {HTMLElement} [opts.element] - HTMLElement container for main application element.\n    *\n    * @param {HTMLElement} [opts.elementContent] - HTMLElement container for content area of application shells.\n    *\n    * @param {HTMLElement} [opts.elementTarget] - HTMLElement container for main application target element.\n    */\n   onSvelteRemount({ element, elementContent, elementTarget } = {}) {} // eslint-disable-line no-unused-vars\n\n   /**\n    * Override replacing HTML as Svelte components control the rendering process. Only potentially change the outer\n    * application frame / title for pop-out applications.\n    *\n    * @inheritDoc\n    * @ignore\n    */\n   _replaceHTML(element, html)  // eslint-disable-line no-unused-vars\n   {\n      if (!element.length) { return; }\n\n      this.reactive.updateHeaderButtons();\n   }\n\n   /**\n    * Provides an override verifying that a new Application being rendered for the first time doesn't have a\n    * corresponding DOM element already loaded. This is a check that only occurs when `this._state` is\n    * `Application.RENDER_STATES.NONE`. It is useful in particular when SvelteApplication has a static ID\n    * explicitly set in `this.options.id` and long intro / outro transitions are assigned. If a new application\n    * sharing this static ID attempts to open / render for the first time while an existing DOM element sharing\n    * this static ID exists then the initial render is cancelled below rather than crashing later in the render\n    * cycle {@link Position.set}.\n    *\n    * @inheritDoc\n    * @protected\n    * @ignore\n    */\n   async _render(force = false, options = {})\n   {\n      // Store any focusSource instance.\n      if (isObject(options?.focusSource)) { this.options.focusSource = options.focusSource; }\n\n      if (this._state === Application.RENDER_STATES.NONE &&\n       document.querySelector(`#${this.id}`) instanceof HTMLElement)\n      {\n         console.warn(`SvelteApplication - _render: A DOM element already exists for CSS ID '${this.id\n         }'. Cancelling initial render for new application with appId '${this.appId}'.`);\n\n         return;\n      }\n\n      await super._render(force, options);\n\n      if (!this.#onMount)\n      {\n         this.onSvelteMount({ element: this._element[0], elementContent: this.#elementContent, elementTarget:\n          this.#elementTarget });\n\n         this.#onMount = true;\n      }\n   }\n\n   /**\n    * Render the inner application content. Only render a template if one is defined otherwise provide an empty\n    * JQuery element per the core Foundry API.\n    *\n    * @param {object} data         The data used to render the inner template\n    *\n    * @returns {Promise.<JQuery>}   A promise resolving to the constructed jQuery object\n    *\n    * @protected\n    * @ignore\n    */\n   async _renderInner(data)\n   {\n      const html = typeof this.template === 'string' ? await renderTemplate(this.template, data) :\n       document.createDocumentFragment();\n\n      return $(html);\n   }\n\n   /**\n    * Stores the initial z-index set in `_renderOuter` which is used in `_injectHTML` to set the target element\n    * z-index after the Svelte component is mounted.\n    *\n    * @returns {Promise<JQuery>} Outer frame / unused.\n    * @protected\n    * @ignore\n    */\n   async _renderOuter()\n   {\n      const html = await super._renderOuter();\n      this.#initialZIndex = html[0].style.zIndex;\n      return html;\n   }\n\n   /**\n    * All calculation and updates of position are implemented in {@link Position.set}. This allows position to be fully\n    * reactive and in control of updating inline styles for the application.\n    *\n    * This method remains for backward compatibility with Foundry. If you have a custom override quite likely you need\n    * to update to using the {@link Position.validators} functionality.\n    *\n    * @param {PositionDataExtended}   [position] - Position data.\n    *\n    * @returns {Position} The updated position object for the application containing the new values\n    */\n   setPosition(position)\n   {\n      return this.position.set(position);\n   }\n\n   /**\n    * This method is invoked by the `elementRootUpdate` callback that is added to the external context passed to\n    * Svelte components. When invoked it updates the local element roots tracked by SvelteApplication.\n    *\n    * This method may also be invoked by HMR / hot module replacement via `svelte-hmr`.\n    */\n   #updateApplicationShell()\n   {\n      const applicationShell = this.svelte.applicationShell;\n\n      if (applicationShell !== null)\n      {\n         this._element = $(applicationShell.elementRoot);\n\n         // Detect if the application shell exports an `elementContent` accessor.\n         this.#elementContent = hasGetter(applicationShell, 'elementContent') ?\n          applicationShell.elementContent : null;\n\n         // Detect if the application shell exports an `elementTarget` accessor.\n         this.#elementTarget = hasGetter(applicationShell, 'elementTarget') ?\n          applicationShell.elementTarget : null;\n\n         if (this.#elementTarget === null)\n         {\n            this.#elementTarget = typeof this.options.selectorTarget === 'string' ?\n             this._element[0].querySelector(this.options.selectorTarget) : this._element[0];\n         }\n\n         // The initial zIndex may be set in application options or for popOut applications is stored by `_renderOuter`\n         // in `this.#initialZIndex`.\n         if (typeof this.options.positionable === 'boolean' && this.options.positionable)\n         {\n            this.#elementTarget.style.zIndex = typeof this.options.zIndex === 'number' ? this.options.zIndex :\n             this.#initialZIndex ?? 95;\n\n            super.bringToTop();\n\n            // Ensure that new root element has inline position styles set.\n            this.position.set(this.position.get());\n         }\n\n         super._activateCoreListeners([this.#elementTarget]);\n\n         this.onSvelteRemount({ element: this._element[0], elementContent: this.#elementContent, elementTarget:\n          this.#elementTarget });\n      }\n   }\n}\n\n/**\n * @typedef {ApplicationOptions} SvelteApplicationOptions\n *\n * @property {boolean}  [defaultCloseAnimation=true] - If false the default slide close animation is not run.\n *\n * @property {boolean}  [draggable=true] - If true then application shells are draggable.\n *\n * @property {boolean}  [focusAuto=true] - When true auto-management of app focus is enabled.\n *\n * @property {boolean}  [focusKeep=false] - When `focusAuto` and `focusKeep` is true; keeps internal focus.\n *\n * @property {object}   [focusSource] - Defines A11yHelper focus source to apply when application closes.\n *\n * @property {boolean}  [headerButtonNoClose=false] - If true then the close header button is removed.\n *\n * @property {boolean}  [headerButtonNoLabel=false] - If true then header button labels are removed.\n *\n * @property {boolean}  [headerNoTitleMinimized=false] - If true then header title is hidden when minimized.\n *\n * @property {number}   [minHeight=MIN_WINDOW_HEIGHT] - Assigned to position. Number specifying minimum window height.\n *\n * @property {number}   [minWidth=MIN_WINDOW_WIDTH] - Assigned to position. Number specifying minimum window width.\n *\n * @property {boolean}  [positionable=true] - If false then `position.set` does not take effect.\n *\n * @property {PositionInitialHelper}   [positionInitial] - A helper for initial position placement.\n *\n * @property {boolean}  [positionOrtho=true] - When true Position is optimized for orthographic use.\n *\n * @property {PositionValidatorOptions}   [positionValidator] - A validator function or data or list of validators.\n *\n * @property {object}   [sessionStorage] - An instance of TJSSessionStorage to share across SvelteApplications.\n *\n * @property {object}   [svelte] - A Svelte configuration object defining the main component.\n *\n * @property {string}   [transformOrigin='top left'] - By default, 'top / left' respects rotation when minimizing.\n */\n\n/**\n * @typedef {object} SvelteData\n *\n * @property {object}                           config -\n *\n * @property {import('svelte').SvelteComponent} component -\n *\n * @property {HTMLElement}                      element -\n *\n * @property {boolean}                          injectHTML -\n */\n\n/**\n * @typedef {object} SvelteStores\n *\n * @property {import('svelte/store').Writable.update} appOptionsUpdate - Update function for app options store.\n *\n * @property {Function} subscribe - Subscribes to local stores.\n *\n * @property {import('svelte/store').Writable.update} uiOptionsUpdate - Update function for UI options store.\n *\n * @property {Function} unsubscribe - Unsubscribes from local stores.\n */\n","import { StyleManager } from '@typhonjs-fvtt/runtime/svelte/util';\n\nconst s_STYLE_KEY = '#__trl-root-styles';\n\nconst cssVariables = new StyleManager({ docKey: s_STYLE_KEY, version: 1 });\n\nexport { cssVariables };\n","import { isUpdatableStore, isWritableStore } from '@typhonjs-fvtt/runtime/svelte/store';\nimport { styleParsePixels, isObject, debounce, hasSetter, isIterable } from '@typhonjs-fvtt/runtime/svelte/util';\nimport { cubicOut } from 'svelte/easing';\n\n/**\n * Provides an action to always blur the element when any pointer up event occurs on the element.\n *\n * @param {HTMLElement}   node - The node to handle always blur on pointer up.\n *\n * @returns {{destroy: Function}} Lifecycle functions.\n */\nfunction alwaysBlur(node)\n{\n   /**\n    * Blurs node if active element.\n    */\n   function blurNode()\n   {\n      setTimeout(() => { if (document.activeElement === node) { node.blur(); } }, 0);\n   }\n\n   node.addEventListener('pointerup', blurNode);\n\n   return {\n      destroy: () => node.removeEventListener('pointerup', blurNode)\n   };\n}\n\n/**\n * Provides an action to monitor the given HTMLElement node with `ResizeObserver` posting width / height changes\n * to the target in various ways depending on the shape of the target. The target can be one of the following and the\n * precedence order is listed from top to bottom:\n *\n * - has a `resizeObserved` function as attribute; offset then content width / height are passed as parameters.\n * - has a `setContentBounds` function as attribute; content width / height are passed as parameters.\n * - has a `setDimension` function as attribute; offset width / height are passed as parameters.\n * - target is an object; offset and content width / height attributes are directly set on target.\n * - target is a function; the function is invoked with offset then content width / height parameters.\n * - has a writable store `resizeObserved` as an attribute; updated with offset & content width / height.\n * - has an object 'stores' that has a writable store `resizeObserved` as an attribute; updated with offset &\n *   content width / height.\n *\n * Note: Svelte currently uses an archaic IFrame based workaround to monitor offset / client width & height changes.\n * A more up to date way to do this is with ResizeObserver. To track when Svelte receives ResizeObserver support\n * monitor this issue: {@link https://github.com/sveltejs/svelte/issues/4233}\n *\n * Can-I-Use: {@link https://caniuse.com/resizeobserver}\n *\n * @param {HTMLElement}          node - The node associated with the action.\n *\n * @param {ResizeObserverTarget} target - An object or function to update with observed width & height changes.\n *\n * @returns {{update: Function, destroy: Function}} The action lifecycle methods.\n * @see {@link https://github.com/sveltejs/svelte/issues/4233}\n */\nfunction resizeObserver(node, target)\n{\n   ResizeObserverManager.add(node, target);\n\n   return {\n      update: (newTarget) =>\n      {\n         ResizeObserverManager.remove(node, target);\n         target = newTarget;\n         ResizeObserverManager.add(node, target);\n      },\n\n      destroy: () =>\n      {\n         ResizeObserverManager.remove(node, target);\n      }\n   };\n}\n\n/**\n * Provides a function that when invoked with an element updates the cached styles for each subscriber of the element.\n *\n * The style attributes cached to calculate offset height / width include border & padding dimensions. You only need\n * to update the cache if you change border or padding attributes of the element.\n *\n * @param {HTMLElement} el - An HTML element.\n */\nresizeObserver.updateCache = function(el)\n{\n   if (!(el instanceof HTMLElement)) { throw new TypeError(`resizeObserverUpdate error: 'el' is not an HTMLElement.`); }\n\n   const subscribers = s_MAP.get(el);\n\n   if (Array.isArray(subscribers))\n   {\n      const computed = globalThis.getComputedStyle(el);\n\n      // Cache styles first from any inline styles then computed styles defaulting to 0 otherwise.\n      // Used to create the offset width & height values from the context box ResizeObserver provides.\n      const borderBottom = styleParsePixels(el.style.borderBottom) ?? styleParsePixels(computed.borderBottom) ?? 0;\n      const borderLeft = styleParsePixels(el.style.borderLeft) ?? styleParsePixels(computed.borderLeft) ?? 0;\n      const borderRight = styleParsePixels(el.style.borderRight) ?? styleParsePixels(computed.borderRight) ?? 0;\n      const borderTop = styleParsePixels(el.style.borderTop) ?? styleParsePixels(computed.borderTop) ?? 0;\n      const paddingBottom = styleParsePixels(el.style.paddingBottom) ?? styleParsePixels(computed.paddingBottom) ?? 0;\n      const paddingLeft = styleParsePixels(el.style.paddingLeft) ?? styleParsePixels(computed.paddingLeft) ?? 0;\n      const paddingRight = styleParsePixels(el.style.paddingRight) ?? styleParsePixels(computed.paddingRight) ?? 0;\n      const paddingTop = styleParsePixels(el.style.paddingTop) ?? styleParsePixels(computed.paddingTop) ?? 0;\n\n      const additionalWidth = borderLeft + borderRight + paddingLeft + paddingRight;\n      const additionalHeight = borderTop + borderBottom + paddingTop + paddingBottom;\n\n      for (const subscriber of subscribers)\n      {\n         subscriber.styles.additionalWidth = additionalWidth;\n         subscriber.styles.additionalHeight = additionalHeight;\n         s_UPDATE_SUBSCRIBER(subscriber, subscriber.contentWidth, subscriber.contentHeight);\n      }\n   }\n};\n\n// Below is the static ResizeObserverManager ------------------------------------------------------------------------\n\nconst s_MAP = new Map();\n\n/**\n * Provides a static / single instance of ResizeObserver that can notify listeners in different ways.\n *\n * The action, {@link resizeObserver}, utilizes ResizeObserverManager for automatic registration and removal\n * via Svelte.\n */\nclass ResizeObserverManager\n{\n   /**\n    * Add an HTMLElement and ResizeObserverTarget instance for monitoring. Create cached style attributes for the\n    * given element include border & padding dimensions for offset width / height calculations.\n    *\n    * @param {HTMLElement}    el - The element to observe.\n    *\n    * @param {ResizeObserverTarget} target - A target that contains one of several mechanisms for updating resize data.\n    */\n   static add(el, target)\n   {\n      const updateType = s_GET_UPDATE_TYPE(target);\n\n      if (updateType === 0)\n      {\n         throw new Error(`'target' does not match supported ResizeObserverManager update mechanisms.`);\n      }\n\n      const computed = globalThis.getComputedStyle(el);\n\n      // Cache styles first from any inline styles then computed styles defaulting to 0 otherwise.\n      // Used to create the offset width & height values from the context box ResizeObserver provides.\n      const borderBottom = styleParsePixels(el.style.borderBottom) ?? styleParsePixels(computed.borderBottom) ?? 0;\n      const borderLeft = styleParsePixels(el.style.borderLeft) ?? styleParsePixels(computed.borderLeft) ?? 0;\n      const borderRight = styleParsePixels(el.style.borderRight) ?? styleParsePixels(computed.borderRight) ?? 0;\n      const borderTop = styleParsePixels(el.style.borderTop) ?? styleParsePixels(computed.borderTop) ?? 0;\n      const paddingBottom = styleParsePixels(el.style.paddingBottom) ?? styleParsePixels(computed.paddingBottom) ?? 0;\n      const paddingLeft = styleParsePixels(el.style.paddingLeft) ?? styleParsePixels(computed.paddingLeft) ?? 0;\n      const paddingRight = styleParsePixels(el.style.paddingRight) ?? styleParsePixels(computed.paddingRight) ?? 0;\n      const paddingTop = styleParsePixels(el.style.paddingTop) ?? styleParsePixels(computed.paddingTop) ?? 0;\n\n      const data = {\n         updateType,\n         target,\n\n         // Stores most recent contentRect.width and contentRect.height values from ResizeObserver.\n         contentWidth: 0,\n         contentHeight: 0,\n\n         // Convenience data for total border & padding for offset width & height calculations.\n         styles: {\n            additionalWidth: borderLeft + borderRight + paddingLeft + paddingRight,\n            additionalHeight: borderTop + borderBottom + paddingTop + paddingBottom\n         }\n      };\n\n      if (s_MAP.has(el))\n      {\n         const subscribers = s_MAP.get(el);\n         subscribers.push(data);\n      }\n      else\n      {\n         s_MAP.set(el, [data]);\n      }\n\n      s_RESIZE_OBSERVER.observe(el);\n   }\n\n   /**\n    * Removes all targets from monitoring when just an element is provided otherwise removes a specific target\n    * from the monitoring map. If no more targets remain then the element is removed from monitoring.\n    *\n    * @param {HTMLElement}          el - Element to remove from monitoring.\n    *\n    * @param {ResizeObserverTarget} [target] - A specific target to remove from monitoring.\n    */\n   static remove(el, target = void 0)\n   {\n      const subscribers = s_MAP.get(el);\n      if (Array.isArray(subscribers))\n      {\n         const index = subscribers.findIndex((entry) => entry.target === target);\n         if (index >= 0)\n         {\n            // Update target subscriber with undefined values.\n            s_UPDATE_SUBSCRIBER(subscribers[index], void 0, void 0);\n\n            subscribers.splice(index, 1);\n         }\n\n         // Remove element monitoring if last target removed.\n         if (subscribers.length === 0)\n         {\n            s_MAP.delete(el);\n            s_RESIZE_OBSERVER.unobserve(el);\n         }\n      }\n   }\n}\n\n/**\n * Defines the various shape / update type of the given target.\n *\n * @type {Record<string, number>}\n */\nconst s_UPDATE_TYPES = {\n   none: 0,\n   attribute: 1,\n   function: 2,\n   resizeObserved: 3,\n   setContentBounds: 4,\n   setDimension: 5,\n   storeObject: 6,\n   storesObject: 7\n};\n\nconst s_RESIZE_OBSERVER = new ResizeObserver((entries) =>\n{\n   for (const entry of entries)\n   {\n      const subscribers = s_MAP.get(entry?.target);\n\n      if (Array.isArray(subscribers))\n      {\n         const contentWidth = entry.contentRect.width;\n         const contentHeight = entry.contentRect.height;\n\n         for (const subscriber of subscribers)\n         {\n            s_UPDATE_SUBSCRIBER(subscriber, contentWidth, contentHeight);\n         }\n      }\n   }\n});\n\n/**\n * Determines the shape of the target instance regarding valid update mechanisms to set width & height changes.\n *\n * @param {*}  target - The target instance.\n *\n * @returns {number} Update type value.\n */\nfunction s_GET_UPDATE_TYPE(target)\n{\n   if (target?.resizeObserved instanceof Function) { return s_UPDATE_TYPES.resizeObserved; }\n   if (target?.setDimension instanceof Function) { return s_UPDATE_TYPES.setDimension; }\n   if (target?.setContentBounds instanceof Function) { return s_UPDATE_TYPES.setContentBounds; }\n\n   const targetType = typeof target;\n\n   // Does the target have resizeObserved writable store?\n   if (targetType !== null && (targetType === 'object' || targetType === 'function'))\n   {\n      if (isUpdatableStore(target.resizeObserved))\n      {\n         return s_UPDATE_TYPES.storeObject;\n      }\n\n      // Now check for a child stores object which is a common TRL pattern for exposing stores.\n      const stores = target?.stores;\n      if (isObject(stores) || typeof stores === 'function')\n      {\n         if (isUpdatableStore(stores.resizeObserved))\n         {\n            return s_UPDATE_TYPES.storesObject;\n         }\n      }\n   }\n\n   if (targetType !== null && targetType === 'object') { return s_UPDATE_TYPES.attribute; }\n\n   if (targetType === 'function') { return s_UPDATE_TYPES.function; }\n\n   return s_UPDATE_TYPES.none;\n}\n\n/**\n * Updates a subscriber target with given content width & height values. Offset width & height is calculated from\n * the content values + cached styles.\n *\n * @param {object}            subscriber - Internal data about subscriber.\n *\n * @param {number|undefined}  contentWidth - ResizeObserver contentRect.width value or undefined.\n *\n * @param {number|undefined}  contentHeight - ResizeObserver contentRect.height value or undefined.\n */\nfunction s_UPDATE_SUBSCRIBER(subscriber, contentWidth, contentHeight)\n{\n   const styles = subscriber.styles;\n\n   subscriber.contentWidth = contentWidth;\n   subscriber.contentHeight = contentHeight;\n\n   const offsetWidth = Number.isFinite(contentWidth) ? contentWidth + styles.additionalWidth : void 0;\n   const offsetHeight = Number.isFinite(contentHeight) ? contentHeight + styles.additionalHeight : void 0;\n\n   const target = subscriber.target;\n\n   switch (subscriber.updateType)\n   {\n      case s_UPDATE_TYPES.attribute:\n         target.contentWidth = contentWidth;\n         target.contentHeight = contentHeight;\n         target.offsetWidth = offsetWidth;\n         target.offsetHeight = offsetHeight;\n         break;\n\n      case s_UPDATE_TYPES.function:\n         target?.(offsetWidth, offsetHeight, contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.resizeObserved:\n         target.resizeObserved?.(offsetWidth, offsetHeight, contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.setContentBounds:\n         target.setContentBounds?.(contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.setDimension:\n         target.setDimension?.(offsetWidth, offsetHeight);\n         break;\n\n      case s_UPDATE_TYPES.storeObject:\n         target.resizeObserved.update((object) =>\n         {\n            object.contentHeight = contentHeight;\n            object.contentWidth = contentWidth;\n            object.offsetHeight = offsetHeight;\n            object.offsetWidth = offsetWidth;\n\n            return object;\n         });\n         break;\n\n      case s_UPDATE_TYPES.storesObject:\n         target.stores.resizeObserved.update((object) =>\n         {\n            object.contentHeight = contentHeight;\n            object.contentWidth = contentWidth;\n            object.offsetHeight = offsetHeight;\n            object.offsetWidth = offsetWidth;\n\n            return object;\n         });\n         break;\n   }\n}\n\n/**\n * @typedef {object | Function} ResizeObserverTarget\n *\n * @property {number} [contentHeight] -\n *\n * @property {number} [contentWidth] -\n *\n * @property {number} [offsetHeight] -\n *\n * @property {number} [offsetWidth] -\n *\n * @property {Writable<object> | Function} [resizedObserver] - Either a function or a writable store.\n *\n * @property {Function} [setContentSize] - A function that is invoked with content width & height changes.\n *\n * @property {Function} [setDimension] - A function that is invoked with offset width & height changes.\n *\n * @property {{resizedObserver: Writable<object>}} [stores] - An object with a writable store.\n */\n\n/**\n * Provides an action to save `scrollTop` of an element with a vertical scrollbar. This action should be used on the\n * scrollable element and must include a writable store that holds the active store for the current `scrollTop` value.\n * You may switch the stores externally and this action will set the `scrollTop` based on the newly set store. This is\n * useful for instance providing a select box that controls the scrollable container.\n *\n * @param {HTMLElement} element - The target scrollable HTML element.\n *\n * @param {import('svelte/store').Writable<number>}   store - A writable store that stores the element scrollTop.\n *\n * @returns {{destroy: Function, update: Function}} Lifecycle functions.\n */\nfunction applyScrolltop(element, store)\n{\n   if (!isWritableStore(store))\n   {\n      throw new TypeError(`applyScrolltop error: 'store' must be a writable Svelte store.`);\n   }\n\n   /**\n    * Updates element `scrollTop`.\n    *\n    * @param {number}   value -\n    */\n   function storeUpdate(value)\n   {\n      if (!Number.isFinite(value)) { return; }\n\n      // For some reason for scrollTop to take on first update from a new element setTimeout is necessary.\n      setTimeout(() => element.scrollTop = value, 0);\n   }\n\n   let unsubscribe = store.subscribe(storeUpdate);\n\n   const resizeControl = resizeObserver(element, debounce(() =>\n   {\n      if (element.isConnected) { store.set(element.scrollTop); }\n   }, 500));\n\n   /**\n    * Save target `scrollTop` to the current set store.\n    *\n    * @param {Event} event -\n    */\n   function onScroll(event)\n   {\n      store.set(event.target.scrollTop);\n   }\n\n   const debounceFn = debounce((e) => onScroll(e), 500);\n\n   element.addEventListener('scroll', debounceFn);\n\n   return {\n      update: (newStore) =>\n      {\n         unsubscribe();\n         store = newStore;\n\n         if (!isWritableStore(store))\n         {\n            throw new TypeError(`applyScrolltop.update error: 'store' must be a writable Svelte store.`);\n         }\n\n         unsubscribe = store.subscribe(storeUpdate);\n      },\n\n      destroy: () =>\n      {\n         element.removeEventListener('scroll', debounceFn);\n         unsubscribe();\n         resizeControl.destroy();\n      }\n   };\n}\n\n/**\n * Provides an action to blur the element when any pointer down event occurs outside the element. This can be useful\n * for input elements including select to blur / unfocus the element when any pointer down occurs outside the element.\n *\n * @param {HTMLElement}   node - The node to handle automatic blur on focus loss.\n *\n * @returns {{destroy: Function}} Lifecycle functions.\n */\nfunction autoBlur(node)\n{\n   /**\n    * Removes listener on blur.\n    */\n   function onBlur() { document.body.removeEventListener('pointerdown', onPointerDown); }\n\n   /**\n    * Adds listener on focus.\n    */\n   function onFocus() { document.body.addEventListener('pointerdown', onPointerDown); }\n\n   /**\n    * Blur the node if a pointer down event happens outside the node.\n    *\n    * @param {PointerEvent} event -\n    */\n   function onPointerDown(event)\n   {\n      if (event.target === node || node.contains(event.target)) { return; }\n\n      if (document.activeElement === node) { node.blur(); }\n   }\n\n   node.addEventListener('blur', onBlur);\n   node.addEventListener('focus', onFocus);\n\n   return {\n      destroy: () =>\n      {\n         document.body.removeEventListener('pointerdown', onPointerDown);\n         node.removeEventListener('blur', onBlur);\n         node.removeEventListener('focus', onFocus);\n      }\n   };\n}\n\n/**\n * Provides an action to monitor focus state of a given element and set an associated store with current focus state.\n *\n * This action is usable with any writable store.\n *\n * @param {HTMLElement} node - Target element.\n *\n * @param {import('svelte/store').Writable<boolean>}  storeFocused - Update store for focus changes.\n *\n * @returns {{update: (function(object): void), destroy: (function(): void)}} Action lifecycle methods.\n */\nfunction isFocused(node, storeFocused)\n{\n   let localFocused = false;\n\n   /**\n    * Updates `storeFocused` w/ current focused state.\n    *\n    * @param {boolean}  current - current focused state.\n    */\n   function setFocused(current)\n   {\n      localFocused = current;\n\n      if (isWritableStore(storeFocused)) { storeFocused.set(localFocused); }\n   }\n\n   /**\n    * Focus event listener.\n    */\n   function onFocus()\n   {\n      setFocused(true);\n   }\n\n   /**\n    * Blur event listener.\n    */\n   function onBlur()\n   {\n      setFocused(false);\n   }\n\n   /**\n    * Activate listeners.\n    */\n   function activateListeners()\n   {\n      node.addEventListener('focus', onFocus);\n      node.addEventListener('blur', onBlur);\n   }\n\n   /**\n    * Remove listeners.\n    */\n   function removeListeners()\n   {\n      node.removeEventListener('focus', onFocus);\n      node.removeEventListener('blur', onBlur);\n   }\n\n   activateListeners();\n\n   return {\n      update: (newStoreFocused) =>  // eslint-disable-line no-shadow\n      {\n         storeFocused = newStoreFocused;\n         setFocused(localFocused);\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\n/**\n * Provides an action to forward on key down & up events. This can be any object that has associated `keydown` and\n * `keyup` methods. See {@link KeyStore} for a store implementation.\n *\n * @param {HTMLElement} node - Target element.\n *\n * @param {{keydown: Function, keyup: Function}}   keyStore - Object to forward events key down / up events to...\n *\n * @returns {{update: (function(object): void), destroy: (function(): void)}} Action lifecycle methods.\n */\nfunction keyforward(node, keyStore)\n{\n   if (typeof keyStore?.keydown !== 'function' || typeof keyStore.keyup !== 'function')\n   {\n      throw new TypeError(`'keyStore' doesn't have required 'keydown' or 'keyup' methods.`);\n   }\n\n   /**\n    * @param {KeyboardEvent} event -\n    */\n   function onKeydown(event)\n   {\n      keyStore.keydown(event);\n   }\n\n   /**\n    * @param {KeyboardEvent} event -\n    */\n   function onKeyup(event)\n   {\n      keyStore.keyup(event);\n   }\n\n   /**\n    * Activates key listeners.\n    */\n   function activateListeners()\n   {\n      node.addEventListener('keydown', onKeydown);\n      node.addEventListener('keyup', onKeyup);\n   }\n\n   /**\n    * Removes key listeners.\n    */\n   function removeListeners()\n   {\n      node.removeEventListener('keydown', onKeydown);\n      node.removeEventListener('keyup', onKeyup);\n   }\n\n   activateListeners();\n\n   return {\n      update: (newKeyStore) =>  // eslint-disable-line no-shadow\n      {\n         keyStore = newKeyStore;\n\n         if (typeof keyStore?.keydown !== 'function' || typeof keyStore.keyup !== 'function')\n         {\n            throw new TypeError(`'newKeyStore' doesn't have required 'keydown' or 'keyup' methods.`);\n         }\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\n/**\n * Provides an action to apply style properties provided as an object.\n *\n * @param {HTMLElement} node - Target element\n *\n * @param {object}      properties - Key / value object of properties to set.\n *\n * @returns {Function} Update function.\n */\nfunction applyStyles(node, properties)\n{\n   /** Sets properties on node. */\n   function setProperties()\n   {\n      if (typeof properties !== 'object') { return; }\n\n      for (const prop of Object.keys(properties))\n      {\n         node.style.setProperty(`${prop}`, properties[prop]);\n      }\n   }\n\n   setProperties();\n\n   return {\n      update(newProperties)\n      {\n         properties = newProperties;\n         setProperties();\n      }\n   };\n}\n\n/**\n * Provides an action to apply a Position instance to a HTMLElement and invoke `position.parent`\n *\n * @param {HTMLElement}       node - The node associated with the action.\n *\n * @param {Position}          position - A position instance.\n *\n * @returns {{update: Function, destroy: Function}} The action lifecycle methods.\n */\nfunction applyPosition(node, position)\n{\n   if (hasSetter(position, 'parent')) { position.parent = node; }\n\n   return {\n      update: (newPosition) =>\n      {\n         // Sanity case to short circuit update if positions are the same instance.\n         if (newPosition === position && newPosition.parent === position.parent) { return; }\n\n         if (hasSetter(position)) { position.parent = void 0; }\n\n         position = newPosition;\n\n         if (hasSetter(position, 'parent')) { position.parent = node; }\n      },\n\n      destroy: () => { if (hasSetter(position, 'parent')) { position.parent = void 0; } }\n   };\n}\n\n/**\n * Provides an action to enable pointer dragging of an HTMLElement and invoke `position.set` on a given {@link Position}\n * instance provided. When the attached boolean store state changes the draggable action is enabled or disabled.\n *\n * @param {HTMLElement}       node - The node associated with the action.\n *\n * @param {object}            params - Required parameters.\n *\n * @param {Position}          params.position - A position instance.\n *\n * @param {boolean}           [params.active=true] - A boolean value; attached to a readable store.\n *\n * @param {number}            [params.button=0] - MouseEvent button; {@link https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button}.\n *\n * @param {import('svelte/store').Writable<boolean>} [params.storeDragging] - A writable store that tracks \"dragging\"\n *                                                                            state.\n *\n * @param {boolean}           [params.ease=true] - When true easing is enabled.\n *\n * @param {object}            [params.easeOptions] - Gsap `to / `quickTo` vars object.\n *\n * @param {Iterable<string>}  [params.hasTargetClassList] - When defined any event targets that have a class in this\n *                                                          list are allowed.\n *\n * @param {Iterable<string>}  [params.ignoreTargetClassList] - When defined any event targets that have a class in this\n *                                                             list are ignored.\n *\n * @returns {{update: Function, destroy: Function}} The action lifecycle methods.\n */\nfunction draggable(node, { position, active = true, button = 0, storeDragging = void 0, ease = false,\n easeOptions = { duration: 0.1, ease: cubicOut }, hasTargetClassList, ignoreTargetClassList })\n{\n   if (hasTargetClassList !== void 0 && !isIterable(hasTargetClassList))\n   {\n      throw new TypeError(`'hasTargetClassList' is not iterable.`);\n   }\n\n   if (ignoreTargetClassList !== void 0 && !isIterable(ignoreTargetClassList))\n   {\n      throw new TypeError(`'ignoreTargetClassList' is not iterable.`);\n   }\n\n   /**\n    * Duplicate the app / Positionable starting position to track differences.\n    *\n    * @type {object}\n    */\n   let initialPosition = null;\n\n   /**\n    * Stores the initial X / Y on drag down.\n    *\n    * @type {object}\n    */\n   let initialDragPoint = {};\n\n   /**\n    * Stores the current dragging state and gates the move pointer as the dragging store is not\n    * set until the first pointer move.\n    *\n    * @type {boolean}\n    */\n   let dragging = false;\n\n   /**\n    * Stores the quickTo callback to use for optimized tweening when easing is enabled.\n    *\n    * @type {quickToCallback}\n    */\n   let quickTo = position.animate.quickTo(['top', 'left'], easeOptions);\n\n   /**\n    * Remember event handlers associated with this action so they may be later unregistered.\n    *\n    * @type {object}\n    */\n   const handlers = {\n      dragDown: ['pointerdown', (e) => onDragPointerDown(e), false],\n      dragMove: ['pointermove', (e) => onDragPointerChange(e), false],\n      dragUp: ['pointerup', (e) => onDragPointerUp(e), false]\n   };\n\n   /**\n    * Activates listeners.\n    */\n   function activateListeners()\n   {\n      // Drag handlers\n      node.addEventListener(...handlers.dragDown);\n      node.classList.add('draggable');\n   }\n\n   /**\n    * Removes listeners.\n    */\n   function removeListeners()\n   {\n      if (typeof storeDragging?.set === 'function') { storeDragging.set(false); }\n\n      // Drag handlers\n      node.removeEventListener(...handlers.dragDown);\n      node.removeEventListener(...handlers.dragMove);\n      node.removeEventListener(...handlers.dragUp);\n      node.classList.remove('draggable');\n   }\n\n   if (active)\n   {\n      activateListeners();\n   }\n\n   /**\n    * Handle the initial pointer down that activates dragging behavior for the positionable.\n    *\n    * @param {PointerEvent} event - The pointer down event.\n    */\n   function onDragPointerDown(event)\n   {\n      if (event.button !== button || !event.isPrimary) { return; }\n\n      // Do not process if the position system is not enabled.\n      if (!position.enabled) { return; }\n\n      // Potentially ignore this event if `ignoreTargetClassList` is defined and the `event.target` has a matching\n      // class.\n      if (ignoreTargetClassList !== void 0 && event.target instanceof HTMLElement)\n      {\n         for (const targetClass of ignoreTargetClassList)\n         {\n            if (event.target.classList.contains(targetClass)) { return; }\n         }\n      }\n\n      // Potentially ignore this event if `hasTargetClassList` is defined and the `event.target` does not have any\n      // matching class from the list.\n      if (hasTargetClassList !== void 0 && event.target instanceof HTMLElement)\n      {\n         let foundTarget = false;\n\n         for (const targetClass of hasTargetClassList)\n         {\n            if (event.target.classList.contains(targetClass))\n            {\n               foundTarget = true;\n               break;\n            }\n         }\n\n         if (!foundTarget) { return; }\n      }\n\n      event.preventDefault();\n\n      dragging = false;\n\n      // Record initial position.\n      initialPosition = position.get();\n      initialDragPoint = { x: event.clientX, y: event.clientY };\n\n      // Add move and pointer up handlers.\n      node.addEventListener(...handlers.dragMove);\n      node.addEventListener(...handlers.dragUp);\n\n      node.setPointerCapture(event.pointerId);\n   }\n\n   /**\n    * Move the positionable.\n    *\n    * @param {PointerEvent} event - The pointer move event.\n    */\n   function onDragPointerChange(event)\n   {\n      // See chorded button presses for pointer events:\n      // https://www.w3.org/TR/pointerevents3/#chorded-button-interactions\n      // TODO: Support different button configurations for PointerEvents.\n      if ((event.buttons & 1) === 0)\n      {\n         onDragPointerUp(event);\n         return;\n      }\n\n      if (event.button !== -1 || !event.isPrimary) { return; }\n\n      event.preventDefault();\n\n      // Only set store dragging on first move event.\n      if (!dragging && typeof storeDragging?.set === 'function')\n      {\n         dragging = true;\n         storeDragging.set(true);\n      }\n\n      /** @type {number} */\n      const newLeft = initialPosition.left + (event.clientX - initialDragPoint.x);\n      /** @type {number} */\n      const newTop = initialPosition.top + (event.clientY - initialDragPoint.y);\n\n      if (ease)\n      {\n         quickTo(newTop, newLeft);\n      }\n      else\n      {\n         s_POSITION_DATA.left = newLeft;\n         s_POSITION_DATA.top = newTop;\n\n         position.set(s_POSITION_DATA);\n      }\n   }\n\n   /**\n    * Finish dragging and set the final position and removing listeners.\n    *\n    * @param {PointerEvent} event - The pointer up event.\n    */\n   function onDragPointerUp(event)\n   {\n      event.preventDefault();\n\n      dragging = false;\n      if (typeof storeDragging?.set === 'function') { storeDragging.set(false); }\n\n      node.removeEventListener(...handlers.dragMove);\n      node.removeEventListener(...handlers.dragUp);\n   }\n\n   return {\n      // The default of active being true won't automatically add listeners twice.\n      update: (options) =>\n      {\n         if (typeof options.active === 'boolean')\n         {\n            active = options.active;\n            if (active) { activateListeners(); }\n            else { removeListeners(); }\n         }\n\n         if (typeof options.button === 'number')\n         {\n            button = options.button;\n         }\n\n         if (options.position !== void 0 && options.position !== position)\n         {\n            position = options.position;\n            quickTo = position.animate.quickTo(['top', 'left'], easeOptions);\n         }\n\n         if (typeof options.ease === 'boolean') { ease = options.ease; }\n\n         if (isObject(options.easeOptions))\n         {\n            easeOptions = options.easeOptions;\n            quickTo.options(easeOptions);\n         }\n\n         if (options.hasTargetClassList !== void 0)\n         {\n            if (!isIterable(options.hasTargetClassList))\n            {\n               throw new TypeError(`'hasTargetClassList' is not iterable.`);\n            }\n            else\n            {\n               hasTargetClassList = options.hasTargetClassList;\n            }\n         }\n\n         if (options.ignoreTargetClassList !== void 0)\n         {\n            if (!isIterable(options.ignoreTargetClassList))\n            {\n               throw new TypeError(`'ignoreTargetClassList' is not iterable.`);\n            }\n            else\n            {\n               ignoreTargetClassList = options.ignoreTargetClassList;\n            }\n         }\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\nclass DraggableOptions\n{\n   #ease = false;\n\n   #easeOptions = { duration: 0.1, ease: cubicOut };\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {(function(DraggableOptions): void)[]}\n    */\n   #subscriptions = [];\n\n   constructor({ ease, easeOptions } = {})\n   {\n      // Define the following getters directly on this instance and make them enumerable. This allows them to be\n      // picked up w/ `Object.assign`.\n      Object.defineProperty(this, 'ease', {\n         get: () => { return this.#ease; },\n         set: (newEase) =>\n         {\n            if (typeof newEase !== 'boolean') { throw new TypeError(`'ease' is not a boolean.`); }\n\n            this.#ease = newEase;\n            this.#updateSubscribers();\n         },\n         enumerable: true\n      });\n\n      Object.defineProperty(this, 'easeOptions', {\n         get: () => { return this.#easeOptions; },\n         set: (newEaseOptions) =>\n         {\n            if (newEaseOptions === null || typeof newEaseOptions !== 'object')\n            {\n               throw new TypeError(`'easeOptions' is not an object.`);\n            }\n\n            if (newEaseOptions.duration !== void 0)\n            {\n               if (!Number.isFinite(newEaseOptions.duration))\n               {\n                  throw new TypeError(`'easeOptions.duration' is not a finite number.`);\n               }\n\n               if (newEaseOptions.duration < 0) { throw new Error(`'easeOptions.duration' is less than 0.`); }\n\n               this.#easeOptions.duration = newEaseOptions.duration;\n            }\n\n            if (newEaseOptions.ease !== void 0)\n            {\n               if (typeof newEaseOptions.ease !== 'function' && typeof newEaseOptions.ease !== 'string')\n               {\n                  throw new TypeError(`'easeOptions.ease' is not a function or string.`);\n               }\n\n               this.#easeOptions.ease = newEaseOptions.ease;\n            }\n\n            this.#updateSubscribers();\n         },\n         enumerable: true\n      });\n\n      // Set default options.\n      if (ease !== void 0) { this.ease = ease; }\n      if (easeOptions !== void 0) { this.easeOptions = easeOptions; }\n   }\n\n\n   /**\n    * @returns {number} Get ease duration\n    */\n   get easeDuration() { return this.#easeOptions.duration; }\n\n   /**\n    * @returns {string|Function} Get easing function value.\n    */\n   get easeValue() { return this.#easeOptions.ease; }\n\n\n   /**\n    * @param {number}   duration - Set ease duration.\n    */\n   set easeDuration(duration)\n   {\n      if (!Number.isFinite(duration))\n      {\n         throw new TypeError(`'duration' is not a finite number.`);\n      }\n\n      if (duration < 0) { throw new Error(`'duration' is less than 0.`); }\n\n      this.#easeOptions.duration = duration;\n      this.#updateSubscribers();\n   }\n\n   /**\n    * @param {string|Function} value - Get easing function value.\n    */\n   set easeValue(value)\n   {\n      if (typeof value !== 'function' && typeof value !== 'string')\n      {\n         throw new TypeError(`'value' is not a function or string.`);\n      }\n\n      this.#easeOptions.ease = value;\n      this.#updateSubscribers();\n   }\n\n   /**\n    * Resets all options data to default values.\n    */\n   reset()\n   {\n      this.#ease = false;\n      this.#easeOptions = { duration: 0.1, ease: cubicOut };\n      this.#updateSubscribers();\n   }\n\n   /**\n    * Resets easing options to default values.\n    */\n   resetEase()\n   {\n      this.#easeOptions = { duration: 0.1, ease: cubicOut };\n      this.#updateSubscribers();\n   }\n\n   /**\n    *\n    * @param {function(DraggableOptions): void} handler - Callback function that is invoked on update / changes.\n    *                                                 Receives the DraggableOptions object / instance.\n    *\n    * @returns {(function(): void)} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(this);                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   #updateSubscribers()\n   {\n      const subscriptions = this.#subscriptions;\n\n      // Early out if there are no subscribers.\n      if (subscriptions.length > 0)\n      {\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](this); }\n      }\n   }\n}\n\n/**\n * Define a function to get a DraggableOptions instance.\n *\n * @param {{ ease?: boolean, easeOptions?: object }} options - Draggable options.\n *\n * @returns {DraggableOptions} A new options instance.\n */\ndraggable.options = (options) => new DraggableOptions(options);\n\n/**\n * Used for direct call to `position.set`.\n *\n * @type {{top: number, left: number}}\n */\nconst s_POSITION_DATA = { left: 0, top: 0 };\n\nexport { alwaysBlur, applyPosition, applyScrolltop, applyStyles, autoBlur, draggable, isFocused, keyforward, resizeObserver };\n//# sourceMappingURL=index.js.map\n","import { cubicInOut, linear, cubicOut } from '../easing/index.mjs';\nimport { split_css_unit, is_function, assign } from '../internal/index.mjs';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\n\nfunction blur(node, { delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 } = {}) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const f = style.filter === 'none' ? '' : style.filter;\n    const od = target_opacity * (1 - opacity);\n    const [value, unit] = split_css_unit(amount);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `opacity: ${target_opacity - (od * u)}; filter: ${f} blur(${u * value}${unit});`\n    };\n}\nfunction fade(node, { delay = 0, duration = 400, easing = linear } = {}) {\n    const o = +getComputedStyle(node).opacity;\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `opacity: ${t * o}`\n    };\n}\nfunction fly(node, { delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 } = {}) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const od = target_opacity * (1 - opacity);\n    const [xValue, xUnit] = split_css_unit(x);\n    const [yValue, yUnit] = split_css_unit(y);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * xValue}${xUnit}, ${(1 - t) * yValue}${yUnit});\n\t\t\topacity: ${target_opacity - (od * u)}`\n    };\n}\nfunction slide(node, { delay = 0, duration = 400, easing = cubicOut, axis = 'y' } = {}) {\n    const style = getComputedStyle(node);\n    const opacity = +style.opacity;\n    const primary_property = axis === 'y' ? 'height' : 'width';\n    const primary_property_value = parseFloat(style[primary_property]);\n    const secondary_properties = axis === 'y' ? ['top', 'bottom'] : ['left', 'right'];\n    const capitalized_secondary_properties = secondary_properties.map((e) => `${e[0].toUpperCase()}${e.slice(1)}`);\n    const padding_start_value = parseFloat(style[`padding${capitalized_secondary_properties[0]}`]);\n    const padding_end_value = parseFloat(style[`padding${capitalized_secondary_properties[1]}`]);\n    const margin_start_value = parseFloat(style[`margin${capitalized_secondary_properties[0]}`]);\n    const margin_end_value = parseFloat(style[`margin${capitalized_secondary_properties[1]}`]);\n    const border_width_start_value = parseFloat(style[`border${capitalized_secondary_properties[0]}Width`]);\n    const border_width_end_value = parseFloat(style[`border${capitalized_secondary_properties[1]}Width`]);\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => 'overflow: hidden;' +\n            `opacity: ${Math.min(t * 20, 1) * opacity};` +\n            `${primary_property}: ${t * primary_property_value}px;` +\n            `padding-${secondary_properties[0]}: ${t * padding_start_value}px;` +\n            `padding-${secondary_properties[1]}: ${t * padding_end_value}px;` +\n            `margin-${secondary_properties[0]}: ${t * margin_start_value}px;` +\n            `margin-${secondary_properties[1]}: ${t * margin_end_value}px;` +\n            `border-${secondary_properties[0]}-width: ${t * border_width_start_value}px;` +\n            `border-${secondary_properties[1]}-width: ${t * border_width_end_value}px;`\n    };\n}\nfunction scale(node, { delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 } = {}) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const sd = 1 - start;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - (sd * u)});\n\t\t\topacity: ${target_opacity - (od * u)}\n\t\t`\n    };\n}\nfunction draw(node, { delay = 0, speed, duration, easing = cubicInOut } = {}) {\n    let len = node.getTotalLength();\n    const style = getComputedStyle(node);\n    if (style.strokeLinecap !== 'butt') {\n        len += parseInt(style.strokeWidth);\n    }\n    if (duration === undefined) {\n        if (speed === undefined) {\n            duration = 800;\n        }\n        else {\n            duration = len / speed;\n        }\n    }\n    else if (typeof duration === 'function') {\n        duration = duration(len);\n    }\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_, u) => `\n\t\t\tstroke-dasharray: ${len};\n\t\t\tstroke-dashoffset: ${u * len};\n\t\t`\n    };\n}\nfunction crossfade(_a) {\n    var { fallback } = _a, defaults = __rest(_a, [\"fallback\"]);\n    const to_receive = new Map();\n    const to_send = new Map();\n    function crossfade(from_node, node, params) {\n        const { delay = 0, duration = d => Math.sqrt(d) * 30, easing = cubicOut } = assign(assign({}, defaults), params);\n        const from = from_node.getBoundingClientRect();\n        const to = node.getBoundingClientRect();\n        const dx = from.left - to.left;\n        const dy = from.top - to.top;\n        const dw = from.width / to.width;\n        const dh = from.height / to.height;\n        const d = Math.sqrt(dx * dx + dy * dy);\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        const opacity = +style.opacity;\n        return {\n            delay,\n            duration: is_function(duration) ? duration(d) : duration,\n            easing,\n            css: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${t + (1 - t) * dh});\n\t\t\t`\n        };\n    }\n    function transition(items, counterparts, intro) {\n        return (node, params) => {\n            items.set(params.key, node);\n            return () => {\n                if (counterparts.has(params.key)) {\n                    const other_node = counterparts.get(params.key);\n                    counterparts.delete(params.key);\n                    return crossfade(other_node, node, params);\n                }\n                // if the node is disappearing altogether\n                // (i.e. wasn't claimed by the other list)\n                // then we need to supply an outro\n                items.delete(params.key);\n                return fallback && fallback(node, params, intro);\n            };\n        };\n    }\n    return [\n        transition(to_send, to_receive, false),\n        transition(to_receive, to_send, true)\n    ];\n}\n\nexport { blur, crossfade, draw, fade, fly, scale, slide };\n","import { linear } from 'svelte/easing';\nimport { lerp } from '@typhonjs-fvtt/runtime/svelte/math';\nimport { fade, slide } from 'svelte/transition';\n\n/**\n * Provides a rotate transition. For options `easing` is applied to to the rotate transition. The default easing is\n * linear.\n *\n * Note: that when reversing the transition that time goes from `1 - 0`, so if specific options are applied for\n * rotating out transition then `end` and `initial` are swapped.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      options - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {Function}    [options.easing=linear] - The easing function to apply to the rotate transition.\n *\n * @param {number}      [options.end=0] - End rotation in degrees.\n *\n * @param {number}      [options.initial=0] - Initial rotation in degrees.\n *\n * @returns {{duration: number, css: (function(*=): string), delay: number, easing: (x: number) => number}}\n *  Transition object.\n */\nfunction rotate(node, options)\n{\n   const easingRotate = options.easing ?? linear;\n\n   const initialDeg = options.initial ?? 0;\n   const endDeg = options.end ?? 0;\n\n   return {\n      delay: options.delay ?? 0,\n      duration: options.duration ?? 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const rotateT = easingRotate(t);\n         return `transform: rotate(${lerp(initialDeg, endDeg, rotateT)}deg)`;\n      }\n   };\n}\n\n/**\n * Combines rotate & fade transitions into a single transition. For options `easing` this is applied to both transitions,\n * however if provided `easingRotate` and / or `easingFade` will take precedence. The default easing is linear.\n *\n * Note: that when reversing the transition that time goes from `1 - 0`, so if specific options are applied for\n * rotating out transition then `end` and `initial` are swapped.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      options - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {Function}    [options.easing=linear] - The easing function to apply to both slide & fade transitions.\n *\n * @param {Function}    [options.easingFade=linear] - The easing function to apply to the fade transition.\n *\n * @param {Function}    [options.easingRotate=linear] - The easing function to apply to the rotate transition.\n *\n * @param {number}      [options.end=0] - End rotation in degrees.\n *\n * @param {number}      [options.initial=0] - Initial rotation in degrees.\n *\n * @returns {{duration: number, css: (function(*=): string), delay: number, easing: (x: number) => number}}\n *  Transition object.\n */\nfunction rotateFade(node, options)\n{\n   const easingFade = options.easingFade || options.easing || linear;\n   const easingRotate = options.easingRotate || options.easing || linear;\n\n   const fadeTransition = fade(node);\n\n   const initialDeg = options.initial ?? 0;\n   const endDeg = options.end ?? 0;\n\n   return {\n      delay: options.delay ?? 0,\n      duration: options.duration ?? 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const fadeT = easingFade(t);\n         const rotateT = easingRotate(t);\n\n         return `transform: rotate(${lerp(initialDeg, endDeg, rotateT)}deg); ${fadeTransition.css(fadeT, 1 - fadeT)}`;\n      }\n   };\n}\n\n/**\n * Combines slide & fade transitions into a single transition. For options `easing` this is applied to both transitions,\n * however if provided `easingSlide` and / or `easingFade` will take precedence. The default easing is linear.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      options - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {Function}    [options.easing=linear] - The easing function to apply to both slide & fade transitions.\n *\n * @param {Function}    [options.easingFade=linear] - The easing function to apply to the fade transition.\n *\n * @param {Function}    [options.easingSlide=linear] - The easing function to apply to the slide transition.\n *\n * @returns {{duration: number, css: (function(*=): string), delay: number, easing: (x: number) => number}}\n *  Transition object.\n */\nfunction slideFade(node, options)\n{\n   const fadeEasing = options.easingFade || options.easing || linear;\n   const slideEasing = options.easingSlide || options.easing || linear;\n\n   const fadeTransition = fade(node);\n   const slideTransition = slide(node);\n\n   return {\n      delay: options.delay || 0,\n      duration: options.duration || 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const fadeT = fadeEasing(t);\n         const slideT = slideEasing(t);\n         return `${slideTransition.css(slideT, 1 - slideT)}; ${fadeTransition.css(fadeT, 1 - fadeT)}`;\n      }\n   };\n}\n\n/**\n * Converts a Svelte transition to an animation. Both transitions & animations use the same CSS / styles solution and\n * resulting data so wrap the transition function with the signature of an animation.\n *\n * @param {(node: Element, params?: object) => import('svelte/transition').TransitionConfig} fn -\n *        A Svelte transition function.\n *\n * @returns {(node: Element, { from: DOMRect, to: DOMRect }, params?: object) => import('svelte/transition').TransitionConfig} -\n *          Transition function converted to an animation.\n */\nfunction toAnimation(fn)\n{\n   return (node, animations, params = {}) => fn(node, params);\n}\n\nconst s_DEFAULT_TRANSITION = () => void 0;\nconst s_DEFAULT_TRANSITION_OPTIONS = {};\n\nexport { rotate, rotateFade, s_DEFAULT_TRANSITION, s_DEFAULT_TRANSITION_OPTIONS, slideFade, toAnimation };\n//# sourceMappingURL=index.js.map\n","<script>\n   import { applyStyles }              from '@typhonjs-fvtt/runtime/svelte/action';\n\n   import {\n      s_DEFAULT_TRANSITION,\n      s_DEFAULT_TRANSITION_OPTIONS }   from '@typhonjs-fvtt/runtime/svelte/transition';\n\n   import { isObject }                 from '@typhonjs-fvtt/runtime/svelte/util';\n\n   /** @type {string} */\n   export let background = '#50505080';\n\n   /** @type {boolean} */\n   export let captureInput = true;\n\n   /** @type {string} */\n   export let id = void 0;\n\n   /** @type {boolean} */\n   export let slotSeparate = void 0;\n\n   /** @type {Record<string, string>} */\n   export let styles = void 0;\n\n   /** @type {number} */\n   export let zIndex = Number.MAX_SAFE_INTEGER;\n\n   /** @type {HTMLDivElement} */\n   let backgroundEl, containerEl, glassPaneEl;\n\n   $: slotSeparate = typeof slotSeparate === 'boolean' ? slotSeparate : false;\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // The following block is somewhat complex, but allows transition options to be updated reactively during\n   // runtime execution.\n\n   // Exports properties to set a transition w/ in / out options.\n   export let transition = void 0;\n   export let inTransition = s_DEFAULT_TRANSITION;\n   export let outTransition = s_DEFAULT_TRANSITION;\n\n   // Exports properties to set options for any transitions.\n   export let transitionOptions = void 0;\n   export let inTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS;\n   export let outTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS;\n\n   // Tracks last transition state.\n   let oldTransition = void 0;\n   let oldTransitionOptions = void 0\n\n   // Run this reactive block when the last transition state is not equal to the current state.\n   $: if (oldTransition !== transition)\n   {\n      // If transition is defined and not the default transition then set it to both in and out transition otherwise\n      // set the default transition to both in & out transitions.\n      const newTransition = s_DEFAULT_TRANSITION !== transition && typeof transition === 'function' ? transition :\n       s_DEFAULT_TRANSITION;\n\n      inTransition = newTransition;\n      outTransition = newTransition;\n\n      oldTransition = newTransition;\n   }\n\n   // Run this reactive block when the last transition options state is not equal to the current options state.\n   $: if (oldTransitionOptions !== transitionOptions)\n   {\n      const newOptions = transitionOptions !== s_DEFAULT_TRANSITION_OPTIONS && isObject(transitionOptions) ?\n       transitionOptions : s_DEFAULT_TRANSITION_OPTIONS;\n\n      inTransitionOptions = newOptions;\n      outTransitionOptions = newOptions;\n\n      oldTransitionOptions = newOptions;\n   }\n\n   // Handle cases if inTransition is unset; assign noop default transition function.\n   $: if (typeof inTransition !== 'function') { inTransition = s_DEFAULT_TRANSITION; }\n\n   // Handle cases if outTransition is unset; assign noop default transition function.\n   $: if (typeof outTransition !== 'function') { outTransition = s_DEFAULT_TRANSITION; }\n\n   // Handle cases if inTransitionOptions is unset; assign empty default transition options.\n   $: if (typeof inTransitionOptions !== 'object') { inTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS; }\n\n   // Handle cases if outTransitionOptions is unset; assign empty default transition options.\n   $: if (typeof outTransitionOptions !== 'object') { outTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS; }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Swallows / stops propagation for all events where the event target is not contained by the glass pane element.\n    *\n    * @param {Event} event - The event to swallow.\n    */\n   function swallow(event)\n   {\n      const targetEl = event.target;\n\n      if (targetEl !== glassPaneEl && targetEl !== backgroundEl  && targetEl !== containerEl &&\n        glassPaneEl.contains(targetEl))\n      {\n         return;\n      }\n\n      if (captureInput)\n      {\n         event.preventDefault();\n         event.stopImmediatePropagation();\n      }\n   }\n</script>\n\n<!-- Capture all input -->\n<svelte:window\n        on:contextmenu|capture={swallow}\n        on:dblclick|capture={swallow}\n        on:keydown|capture={swallow}\n        on:keyup|capture={swallow}\n        on:mousedown|capture={swallow}\n        on:mousemove|capture={swallow}\n        on:mouseup|capture={swallow}\n        on:pointerdown|capture={swallow}\n        on:pointermove|capture={swallow}\n        on:pointerup|capture={swallow}\n        on:touchend|capture={swallow}\n        on:touchmove|capture={swallow}\n        on:touchstart|capture={swallow}\n        on:wheel|capture={swallow}\n/>\n\n<div id={id}\n     bind:this={glassPaneEl}\n     class=tjs-glass-pane\n     style:z-index={zIndex}>\n\n   {#if slotSeparate}\n      <div class=tjs-glass-pane-background\n           bind:this={backgroundEl}\n           style:background={background}\n           in:inTransition={inTransitionOptions}\n           out:outTransition={outTransitionOptions}\n           use:applyStyles={styles} />\n\n      <div class=tjs-glass-pane-container bind:this={containerEl}>\n         <slot />\n      </div>\n   {:else}\n      <div class=tjs-glass-pane-background\n           bind:this={backgroundEl}\n           style:background={background}\n           in:inTransition={inTransitionOptions}\n           out:outTransition={outTransitionOptions}\n           use:applyStyles={styles} >\n         <slot />\n      </div>\n   {/if}\n</div>\n\n<style>\n   .tjs-glass-pane, .tjs-glass-pane-background , .tjs-glass-pane-container {\n      position: absolute;\n      overflow: hidden;\n\n      height: 100%;\n      width: 100%;\n      max-height: 100%;\n      max-width: 100%;\n   }\n</style>\n","import { writable } from 'svelte/store';\n\n/**\n * Provides the internal context to all application shells.\n */\nexport class AppShellContextInternal\n{\n   /** @type {InternalAppStores} */\n   #stores;\n\n   constructor()\n   {\n      this.#stores = {\n         elementContent: writable(void 0),\n         elementRoot: writable(void 0)\n      };\n\n      Object.freeze(this.#stores);\n      Object.seal(this);\n   }\n\n   /**\n    * @returns {InternalAppStores} The internal context stores for elementContent / elementRoot\n    */\n   get stores()\n   {\n      return this.#stores;\n   }\n}\n\n/**\n * @typedef {object} InternalAppStores\n *\n * @property {import('svelte/store').Writable<HTMLElement>} elementContent - The window content element.\n *\n * @property {import('svelte/store').Writable<HTMLElement>} elementRoot - The window root element.\n */\n","/**\n * A helper to create a set of radio checkbox input elements in a named set.\n * The provided keys are the possible radio values while the provided values are human readable labels.\n *\n * @param {string} name         The radio checkbox field name\n *\n * @param {object} choices      A mapping of radio checkbox values to human readable labels\n *\n * @param {object} options      Options which customize the radio boxes creation\n *\n * @param {string} options.checked    Which key is currently checked?\n *\n * @param {boolean} options.localize  Pass each label through string localization?\n *\n * @returns {string} HTML for radio boxes.\n *\n * @example <caption>The provided input data</caption>\n * let groupName = \"importantChoice\";\n * let choices = {a: \"Choice A\", b: \"Choice B\"};\n * let chosen = \"a\";\n *\n * @example <caption>The template HTML structure</caption>\n * <div class=\"form-group\">\n *   <label>Radio Group Label</label>\n *   <div class=\"form-fields\">\n *     {@html radioBoxes(groupName, choices, { checked: chosen, localize: true})}\n *   </div>\n * </div>\n */\nfunction radioBoxes(name, choices, options)\n{\n   const checked = options['checked'] || null;\n\n   const localize = options['localize'] || false;\n\n   let html = '';\n\n   for (let [key, label] of Object.entries(choices)) // eslint-disable-line prefer-const\n   {\n      if (localize) { label = globalThis.game.i18n.localize(label); }\n      const isChecked = checked === key;\n      html += `<label class=\"checkbox\"><input type=\"radio\" name=\"${name}\" value=\"${key}\" ${isChecked ? \"checked\" : \"\"}> ${label}</label>`;\n   }\n\n   return new globalThis.Handlebars.SafeString(html);\n}\n\n/**\n * Converts the `selectOptions` Handlebars helper to be Svelte compatible. This is useful when initially converting\n * over an app to Svelte and for essential usage to several dialogs that mirror the core Foundry experience. For\n * an example of usage see {@link TJSDocumentOwnership}.\n *\n * A helper to create a set of <option> elements in a <select> block based on a provided dictionary.\n * The provided keys are the option values while the provided values are human-readable labels.\n * This helper supports both single-select as well as multi-select input fields.\n *\n * @param {object} choices                     A mapping of radio checkbox values to human readable labels\n *\n * @param {object} options                     Helper options\n *\n * @param {string|string[]} [options.selected] Which key or array of keys that are currently selected?\n *\n * @param {boolean} [options.localize=false]   Pass each label through string localization?\n *\n * @param {string} [options.blank]             Add a blank option as the first option with this label\n *\n * @param {string} [options.nameAttr]          Look up a property in the choice object values to use as the option value\n *\n * @param {string} [options.labelAttr]         Look up a property in the choice object values to use as the option label\n *\n * @param {boolean} [options.inverted=false]   Use the choice object value as the option value, and the key as the label\n *                                             instead of vice-versa\n *\n * @returns {string} The <options> HTML element(s).\n *\n * @example <caption>The provided input data</caption>\n * let choices = {a: 'Choice A', b: 'Choice B'};\n * let value = 'a';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices { selected: value, localize: true })}\n * </select>\n *\n * @example <caption>The resulting HTML</caption>\n * <select name=\"importantChoice\">\n *   <option value=\"a\" selected>Choice A</option>\n *   <option value=\"b\">Choice B</option>\n * </select>\n *\n * @example <caption>Using inverted</caption>\n * let choices = {'Choice A': 'a', 'Choice B': 'b'};\n * let value = 'a';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, inverted: true })}\n * </select>\n *\n * @example <caption>Using nameAttr and labelAttr with objects</caption>\n * let choices = {foo: {key: 'a', label: 'Choice A'}, bar: {key: 'b', label: 'Choice B'}};\n * let value = 'b';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, nameAttr: 'key', labelAttr: 'label' })}\n * </select>\n *\n * @example <caption>Using nameAttr and labelAttr with arrays</caption>\n * let choices = [{key: 'a', label: 'Choice A'}, {key: 'b', label: 'Choice B'}];\n * let value = 'b';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, nameAttr: 'key', labelAttr: 'label' })}\n * </select>\n */\nfunction selectOptions(choices, options)\n{\n   const { localize = false, blank = null, sort = false, nameAttr, labelAttr, inverted } = options;\n   let { selected = null } = options;\n\n   selected = selected instanceof Array ? selected.map(String) : [String(selected)];\n\n   // Prepare the choices as an array of objects\n   const selectChoices = [];\n\n   if (choices instanceof Array)\n   {\n      for (const choice of choices)\n      {\n         const name = String(choice[nameAttr]);\n         let label = choice[labelAttr];\n         if (localize) { label = globalThis.game.i18n.localize(label); }\n         selectChoices.push({ name, label });\n      }\n   }\n   else\n   {\n      for (const choice of Object.entries(choices))\n      {\n         const [key, value] = inverted ? choice.reverse() : choice;\n         const name = String(nameAttr ? value[nameAttr] : key);\n         let label = labelAttr ? value[labelAttr] : value;\n         if (localize) { label = globalThis.game.i18n.localize(label); }\n         selectChoices.push({ name, label });\n      }\n   }\n\n   // Sort the array of options\n   if (sort) { selectChoices.sort((a, b) => a.label.localeCompare(b.label)); }\n\n   // Prepend a blank option\n   if (blank !== null)\n   {\n      const label = localize ? globalThis.game.i18n.localize(blank) : blank;\n      selectChoices.unshift({ name: '', label });\n   }\n\n   // Create the HTML\n   let html = '';\n   for (const option of selectChoices)\n   {\n      const label = globalThis.Handlebars.escapeExpression(option.label);\n      const isSelected = selected.includes(option.name);\n      html += `<option value=\"${option.name}\" ${isSelected ? \"selected\" : \"\"}>${label}</option>`;\n   }\n\n   return new globalThis.Handlebars.SafeString(html);\n}\n\n/**\n * Localize a string including variable formatting for input arguments. Provide a string ID which defines the localized\n * template. Variables can be included in the template enclosed in braces and will be substituted using those named\n * keys.\n *\n * @param {string}   stringId - The string ID to translate.\n *\n * @param {object}   [data] - Provided input data.\n *\n * @returns {string} The translated and formatted string\n */\nfunction localize(stringId, data)\n{\n   const result = typeof data !== 'object' ? globalThis.game.i18n.localize(stringId) :\n    globalThis.game.i18n.format(stringId, data);\n\n   return result !== void 0 ? result : '';\n}\n\nexport { localize, radioBoxes, selectOptions };\n//# sourceMappingURL=index.js.map\n","<script>\n   /**\n    * Provides an app header button conforming to the Foundry {@link ApplicationHeaderButton} type. Additionally, a\n    * `title` field is supported to give a tool tip for the button. For backward compatibility `onclick` is supported,\n    * but for uniformity across TRL defining an `onPress` function is recommended. If defined it is invoked when\n    * the button is clicked or `Enter` key pressed and state is updated accordingly.\n    *\n    * TRL also supports the following extra button data:\n    * - {keyCode='Enter'}           keyCode: A string conforming to `KeyboardEvent.code` to activate `onPress` callback.\n    * - {keepMinimized=false}       keepMinimized: When true the button is not removed when app minimized.\n    * - {Function}                  onContextMenu: Invoked when right mouse button or contextmenu key is pressed.\n    * - {Function}                  onPress: Invoked when left mouse button or `keyCode` key is pressed.\n    * - {Record<string, string>}    styles: Additional inline styles to apply to button.\n    * - {string}                    title: Tooltip title.\n    */\n   import { applyStyles }   from '@typhonjs-fvtt/runtime/svelte/action';\n   import { localize }      from '@typhonjs-fvtt/runtime/svelte/helper';\n   import { isObject }      from '@typhonjs-fvtt/runtime/svelte/util';\n\n   export let button = void 0;\n\n   const s_REGEX_HTML = /^\\s*<.*>$/;\n\n   $: title = isObject(button) && typeof button.title === 'string' ? localize(button.title) : '';\n\n   // Handle icon and treat bare strings as the icon class; otherwise assume the icon is fully formed HTML.\n   $: icon = isObject(button) && typeof button.icon !== 'string' ? void 0 : s_REGEX_HTML.test(button.icon) ?\n    button.icon : `<i class=\"${button.icon}\" title=\"${title}\"></i>`;\n\n   $: label = isObject(button) && typeof button.label === 'string' ? localize(button.label) : void 0;\n\n   $: keepMinimized = isObject(button) && typeof button.keepMinimized === 'boolean' ? button.keepMinimized : false;\n\n   $: keyCode = isObject(button) && typeof button.keyCode === 'string' ? button.keyCode : 'Enter';\n\n   $: styles = isObject(button) && isObject(button.styles) ? button.styles : void 0;\n\n   function onClick(event)\n   {\n      // Accept `onPress or `onclick` as the function / data to invoke.\n      const invoke = button?.onPress ?? button?.onclick;\n\n      if (typeof invoke === 'function')\n      {\n         invoke.call(button, event);\n         button = button; // This provides a reactive update if button data changes.\n      }\n   }\n\n   function onContextMenu(event)\n   {\n      // Accept `onContextMenu` as the function / data to invoke.\n      const invoke = button?.onContextMenu;\n\n      if (typeof invoke === 'function')\n      {\n         invoke.call(button, event);\n         button = button; // This provides a reactive update if button data changes.\n      }\n   }\n\n   /**\n    * Consume / stop propagation of key down when key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeydown(event)\n   {\n      if (event.code === keyCode)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Handle press event if key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeyup(event)\n   {\n      if (event.code === keyCode)\n      {\n         const invoke = button.onPress ?? button.onclick;\n\n         if (typeof invoke === 'function')\n         {\n            invoke.call(button, event);\n            button = button; // This provides a reactive update if button data changes.\n         }\n\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n</script>\n\n<svelte:options accessors={true}/>\n\n<!-- svelte-ignore a11y-missing-attribute -->\n<a on:click|preventDefault|stopPropagation={onClick}\n   on:contextmenu|preventDefault|stopPropagation={onContextMenu}\n   on:keydown={onKeydown}\n   on:keyup={onKeyup}\n   use:applyStyles={styles}\n   class=\"header-button {button.class}\"\n   class:keep-minimized={keepMinimized}\n   aria-label={label}\n   tabindex=0\n   role=button>\n    {@html icon}{#if label}<span class:has-icon={icon !== void 0}>{label}</span>{/if}\n</a>\n\n<style>\n   a {\n      padding: var(--tjs-app-header-button-padding, 0 3px);\n   }\n\n   a :global(i) {\n      padding: var(--tjs-app-header-button-icon-padding, 0);\n   }\n\n   a:hover {\n      text-shadow: var(--tjs-app-header-button-text-shadow-hover, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   a:focus-visible {\n      box-shadow: var(--tjs-app-header-button-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\n      outline: var(--tjs-app-header-button-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\n      transition: var(--tjs-app-header-button-transition-focus-visible, var(--tjs-default-transition-focus-visible));\n      text-shadow: var(--tjs-app-header-button-text-shadow-focus-visible, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   span {\n      padding: var(--tjs-app-header-button-label-padding, 0);\n   }\n\n   span.has-icon {\n      padding: var(--tjs-app-header-button-label-padding, 0 0 0 3px);\n   }\n</style>\n","<script>\n   import { getContext }            from 'svelte';\n   import { cubicOut }              from 'svelte/easing';\n\n   import {\n      draggable as dragDefault }    from '@typhonjs-fvtt/runtime/svelte/action';\n\n   import { localize }              from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   import {\n      isObject,\n      isSvelteComponent }           from '@typhonjs-fvtt/runtime/svelte/util';\n\n   import TJSHeaderButton           from './TJSHeaderButton.svelte';\n\n   export let draggable = void 0;\n   export let draggableOptions = void 0;\n\n   const { application } = getContext('#external');\n\n   // Focus related app options stores.\n   const { focusAuto, focusKeep } = application.reactive.storeAppOptions;\n\n   const { elementRoot } = getContext('#internal').stores;\n\n   const storeTitle = application.reactive.storeAppOptions.title;\n   const storeDraggable = application.reactive.storeAppOptions.draggable;\n   const storeDragging = application.reactive.storeUIState.dragging;\n   const storeHeaderButtons = application.reactive.storeUIState.headerButtons;\n   const storeHeaderIcon = application.reactive.storeAppOptions.headerIcon;\n   const storeHeaderNoTitleMinimized = application.reactive.storeAppOptions.headerNoTitleMinimized;\n   const storeMinimizable = application.reactive.storeAppOptions.minimizable;\n   const storeMinimized = application.reactive.storeUIState.minimized;\n\n   // These classes in the window header allow dragging.\n   const s_DRAG_TARGET_CLASSLIST = Object.freeze(['tjs-app-icon', 'tjs-window-header-spacer',\n    'window-header', 'window-title']);\n\n   let dragOptions;\n\n   $: draggable = typeof draggable === 'function' ? draggable : dragDefault;\n\n   // Combines external options with defaults for TJSApplicationHeader. By default, easing is turned on w/ duration of\n   // 0.08 seconds and cubicOut, but can be overridden by any provided `draggableOptions`. `position`, `active`, and\n   // `storeDragging` are always overridden by application position / stores.\n   $: dragOptions = Object.assign({}, { ease: true, easeOptions: { duration: 0.08, ease: cubicOut } },\n    isObject(draggableOptions) ? draggableOptions : {}, { position: application.position, active:\n     $storeDraggable, storeDragging, hasTargetClassList: s_DRAG_TARGET_CLASSLIST });\n\n   let displayHeaderTitle;\n\n   $: displayHeaderTitle = $storeHeaderNoTitleMinimized && $storeMinimized ? 'none' : null;\n\n   let buttonsLeft;\n   let buttonsRight;\n\n   $:\n   {\n      buttonsLeft = [];\n      buttonsRight = [];\n\n      for (const button of $storeHeaderButtons)\n      {\n         const buttonsList = typeof button?.alignLeft === 'boolean' && button?.alignLeft ? buttonsLeft : buttonsRight;\n\n         // If the button is a Svelte component set it as the class otherwise use `TJSHeaderButton` w/ button as props.\n         buttonsList.push(isSvelteComponent(button) ? { class: button, props: {} } :\n          { class: TJSHeaderButton, props: { button } });\n      }\n   }\n\n   function minimizable(node, booleanStore)\n   {\n      const callback = (event) =>\n      {\n         // Only toggle minimize state if window title or header is the event target. Also allow toggle state if the\n         // event target has 'keep-minimized' class.\n         if (event.target.classList.contains('window-title') || event.target.classList.contains('window-header') ||\n           event.target.classList.contains('keep-minimized'))\n         {\n            application._onToggleMinimize(event);\n         }\n      }\n\n      function activateListeners() { node.addEventListener('dblclick', callback); }\n      function removeListeners() { node.removeEventListener('dblclick', callback); }\n\n      if (booleanStore) { activateListeners(); }\n\n      return {\n         update: (booleanStore) =>  // eslint-disable-line no-shadow\n         {\n            if (booleanStore) { activateListeners(); }\n            else { removeListeners(); }\n         },\n\n         destroy: () => removeListeners()\n      };\n   }\n\n   /**\n    * Explicitly focus `elementRoot` if pointer event is not consumed by header buttons / components. This allows\n    * keyboard tab navigation to select header buttons.\n    *\n    * Note: if `focusKeep` app option store is set to true `elementRoot` is only focused if the current browser wide\n    * active element is not contained inside the app element.\n    */\n   function onPointerdown(event)\n   {\n      const rootEl = $elementRoot;\n\n      if ($focusAuto && rootEl instanceof HTMLElement && rootEl?.isConnected)\n      {\n         if ($focusKeep)\n         {\n            const focusOutside = document.activeElement instanceof HTMLElement &&\n             !rootEl.contains(document.activeElement);\n\n            // Only focus the content element if the active element is outside the app; maintaining internal focused\n            // element.\n            if (focusOutside)\n            {\n               rootEl.focus();\n            }\n            else\n            {\n               event.preventDefault();\n            }\n         }\n         else\n         {\n            rootEl.focus();\n         }\n      }\n   }\n</script>\n\n{#key draggable}\n   <header class=\"window-header flexrow\"\n           use:draggable={dragOptions}\n           use:minimizable={$storeMinimizable}\n           on:pointerdown={onPointerdown}>\n      {#if typeof $storeHeaderIcon === 'string'}\n         <img class=\"tjs-app-icon keep-minimized\" src={$storeHeaderIcon} alt=icon>\n      {/if}\n      <h4 class=window-title style:display={displayHeaderTitle}>\n         {localize($storeTitle)}\n      </h4>\n      {#each buttonsLeft as button}\n         <svelte:component this={button.class} {...button.props} />\n      {/each}\n      <span class=\"tjs-window-header-spacer keep-minimized\" />\n      {#each buttonsRight as button}\n         <svelte:component this={button.class} {...button.props} />\n      {/each}\n   </header>\n{/key}\n\n<style>\n   /**\n    * Provides a zero space element that expands to the right creating the gap between window title and left aligned\n    * buttons and right aligned buttons. Note the use of a negative left margin to remove the gap between elements.\n    */\n   .tjs-window-header-spacer {\n      flex: 0;\n      margin-left: calc(-1 * var(--tjs-app-header-gap, 5px));\n      margin-right: auto;\n   }\n\n   .window-header {\n      flex: var(--tjs-app-header-flex, 0 0 30px);\n      gap: var(--tjs-app-header-gap, 5px);\n      padding: var(--tjs-app-header-padding, 0 4px);\n   }\n\n   .window-header .tjs-app-icon {\n      align-self: center;\n      border-radius: var(--tjs-app-header-icon-border-radius, 4px);\n      flex: 0 0 var(--tjs-app-header-icon-width, 24px);\n      height: var(--tjs-app-header-icon-height, 24px);\n   }\n\n   .window-title {\n      gap: var(--tjs-app-header-gap, 5px);\n      max-width: fit-content;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n   }\n</style>\n","<script>\n   import { A11yHelper }        from '@typhonjs-fvtt/runtime/svelte/util';\n\n   /** @type {HTMLElement} */\n   export let elementRoot = void 0;\n\n   /** @type {boolean} */\n   export let enabled = true;\n\n   let ignoreElements, wrapEl;\n\n   $: if (wrapEl) { ignoreElements = new Set([wrapEl]); }\n\n   function onFocus()\n   {\n      // Early out if not enabled.\n      if (!enabled) { return; }\n\n      if (elementRoot instanceof HTMLElement)\n      {\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(elementRoot, ignoreElements);\n\n         if (firstFocusEl instanceof HTMLElement && firstFocusEl !== wrapEl)\n         {\n            firstFocusEl.focus();\n         }\n         else\n         {\n            // No focus target found, so focus elementRoot.\n            elementRoot.focus();\n         }\n      }\n   }\n</script>\n\n<!-- svelte-ignore a11y-no-noninteractive-tabindex -->\n<div bind:this={wrapEl} class=tjs-focus-wrap tabindex=0 on:focus={onFocus} />\n\n<style>\n    div {\n        width: 0;\n        height: 0;\n        flex: 0;\n    }\n\n    div:focus {\n        outline: none;\n    }\n</style>\n","<script>\n   import { getContext }         from 'svelte';\n\n   export let isResizable = false;\n\n   const application = getContext('#external').application;\n\n   // Allows retrieval of the element root at runtime.\n   const storeElementRoot = getContext('storeElementRoot');\n\n   const storeResizable = application.reactive.storeAppOptions.resizable;\n\n   const storeMinimized = application.reactive.storeUIState.minimized;\n   const storeResizing = application.reactive.storeUIState.resizing;\n\n   let elementResize;\n\n   $: if (elementResize)\n   {\n      // Instead of creating a derived store it is easier to use isResizable and the minimized store below.\n      elementResize.style.display = isResizable && !$storeMinimized ? 'block' : 'none';\n\n      // Add / remove `resizable` class from element root.\n      const elementRoot = $storeElementRoot;\n      if (elementRoot) { elementRoot.classList[isResizable ? 'add' : 'remove']('resizable'); }\n   }\n\n   /**\n    * Provides an action to handle resizing the application shell based on the resizable app option.\n    *\n    * @param {HTMLElement}       node - The node associated with the action.\n    *\n    * @param {object}            [opts] - Optional parameters.\n    *\n    * @param {boolean}           [opts.active=true] - A boolean value; attached to a readable store.\n    *\n    * @param {Writable<boolean>} [opts.storeResizing] - A writable store that tracks \"resizing\" state.\n    *\n    * @returns {{update: Function, destroy: Function}} The action lifecycle methods.\n    */\n   function resizable(node, { active = true, storeResizing = void 0 } = {})\n   {\n      /**\n       * Duplicate the app / Positionable starting position to track differences.\n       *\n       * @type {object}\n       */\n      let position = null;\n\n      /**\n       * Stores the initial X / Y on drag down.\n       *\n       * @type {object}\n       */\n      let initialPosition = {};\n\n      /**\n       * Stores the current resizing state and gates the move pointer as the resizing store is not\n       * set until the first pointer move.\n       *\n       * @type {boolean}\n       */\n      let resizing = false;\n\n      /**\n       * Remember event handlers associated with this action so they may be later unregistered.\n       *\n       * @type {Object}\n       */\n      const handlers = {\n         resizeDown: ['pointerdown', (e) => onResizePointerDown(e), false],\n         resizeMove: ['pointermove', (e) => onResizePointerMove(e), false],\n         resizeUp: ['pointerup', (e) => onResizePointerUp(e), false]\n      };\n\n      /**\n       * Activates listeners.\n       */\n      function activateListeners()\n      {\n         // Resize handlers\n         node.addEventListener(...handlers.resizeDown);\n\n         isResizable = true;\n\n         node.style.display = 'block';\n      }\n\n      /**\n       * Removes listeners.\n       */\n      function removeListeners()\n      {\n         if (typeof storeResizing?.set === 'function') { storeResizing.set(false); }\n\n         // Resize handlers\n         node.removeEventListener(...handlers.resizeDown);\n         node.removeEventListener(...handlers.resizeMove);\n         node.removeEventListener(...handlers.resizeUp);\n\n         node.style.display = 'none';\n\n         isResizable = false;\n      }\n\n      // On mount if resizable is true then activate listeners otherwise set element display to `none`.\n      if (active)\n      {\n         activateListeners();\n      }\n      else\n      {\n         node.style.display = 'none';\n      }\n\n      /**\n       * Handle the initial pointer down that activates resizing capture.\n       */\n      function onResizePointerDown(event)\n      {\n         event.preventDefault();\n\n         resizing = false;\n\n         // Record initial position\n         position = application.position.get();\n\n         if (position.height === 'auto') { position.height = $storeElementRoot.clientHeight; }\n         if (position.width === 'auto') { position.width = $storeElementRoot.clientWidth; }\n\n         initialPosition = { x: event.clientX, y: event.clientY };\n\n         // Add temporary handlers\n         node.addEventListener(...handlers.resizeMove);\n         node.addEventListener(...handlers.resizeUp);\n\n         node.setPointerCapture(event.pointerId);\n      }\n\n      /**\n       * Sets the width / height of the positionable application.\n       */\n      function onResizePointerMove(event)\n      {\n         event.preventDefault();\n\n         if (!resizing && typeof storeResizing?.set === 'function')\n         {\n            resizing = true;\n            storeResizing.set(true);\n         }\n\n         application.position.set({\n            width: position.width + (event.clientX - initialPosition.x),\n            height: position.height + (event.clientY - initialPosition.y)\n         });\n      }\n\n      /**\n       * Conclude the dragging behavior when the pointer is released setting the final position and\n       * removing listeners.\n       */\n      function onResizePointerUp(event)\n      {\n         resizing = false;\n         if (typeof storeResizing?.set === 'function') { storeResizing.set(false); }\n\n         event.preventDefault();\n         node.removeEventListener(...handlers.resizeMove);\n         node.removeEventListener(...handlers.resizeUp);\n\n         application._onResize(event);\n      }\n\n      return {\n         update: ({ active }) =>  // eslint-disable-line no-shadow\n         {\n            if (active) { activateListeners(); }\n            else { removeListeners(); }\n         },\n\n         destroy: () => removeListeners()\n      };\n   }\n\n</script>\n\n<div class=\"window-resizable-handle\"\n     use:resizable={{active: $storeResizable, storeResizing}}\n     bind:this={elementResize}>\n   <i class=\"fas fa-arrows-alt-h\"></i>\n</div>\n","<script>\n   /**\n    * Provides an application shell is a main top level slotted component that provides a reactive\n    * outer wrapper and header bar for the main content component.\n    */\n\n   import {\n      getContext,\n      onMount,\n      setContext }                     from 'svelte';\n\n   import {\n      applyStyles,\n      resizeObserver }                 from '@typhonjs-fvtt/runtime/svelte/action';\n\n   import {\n      A11yHelper,\n      isObject }                       from '@typhonjs-fvtt/runtime/svelte/util';\n\n   import { AppShellContextInternal }  from './AppShellContextInternal.js';\n   import TJSApplicationHeader         from './TJSApplicationHeader.svelte';\n   import TJSFocusWrap                 from './TJSFocusWrap.svelte';\n   import ResizableHandle              from './ResizableHandle.svelte';\n\n   import {\n      s_DEFAULT_TRANSITION_OPTIONS }   from '@typhonjs-fvtt/runtime/svelte/transition';\n\n   // Bound to the content and root elements. Can be used by parent components. SvelteApplication will also\n   // use 'elementRoot' to set the element of the Application. You can also provide `elementContent` and\n   // `elementTarget`. Please see SvelteApplication lifecycle documentation.\n   export let elementContent = void 0;\n   export let elementRoot = void 0;\n\n   // Allows custom draggable implementations to be forwarded to TJSApplicationHeader.\n   export let draggable = void 0;\n   export let draggableOptions = void 0;\n\n   // The children array can be specified by a parent via prop or is read below from the external context.\n   // export let children = void 0;\n\n   // Explicit style overrides for the main app and content elements. Uses action `applyStyles`.\n   export let stylesApp = void 0;\n   export let stylesContent = void 0;\n\n   // If a parent component binds and sets `appOffsetHeight` to true then a resizeObserver action is enabled on the\n   // outer application `div`. Additionally, the SvelteApplication position resizeObserved store is updated.\n   export let appOffsetHeight = false;\n   export let appOffsetWidth = false;\n\n   // Set to `resizeObserver` if either of the above props are truthy otherwise a null operation.\n   const appResizeObserver = !!appOffsetHeight || !!appOffsetWidth ? resizeObserver : () => null;\n\n   // If a parent component binds and sets `contentOffsetHeight` or `contentOffsetWidth` to true then a\n   // resizeObserver action is enabled on the content `section`.\n   export let contentOffsetHeight = false;\n   export let contentOffsetWidth = false;\n\n   // Set to `resizeObserver` if either of the above props are truthy otherwise a null operation.\n   const contentResizeObserver = !!contentOffsetHeight || !!contentOffsetWidth ? resizeObserver : () => null;\n\n   // Provides the internal context for data / stores of the application shell.\n   const internal = new AppShellContextInternal();\n\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\n\n   // Internal context for `elementContent` / `elementRoot` stores.\n   setContext('#internal', internal);\n\n   // Only update the `elementContent` store if the new `elementContent` is not null or undefined.\n   $: if (elementContent !== void 0 && elementContent !== null)\n   {\n      getContext('#internal').stores.elementContent.set(elementContent);\n   }\n\n   // Only update the `elementRoot` store if the new `elementRoot` is not null or undefined.\n   $: if (elementRoot !== void 0 && elementRoot !== null)\n   {\n      getContext('#internal').stores.elementRoot.set(elementRoot);\n   }\n\n   // Store application reference.\n   const { application } = getContext('#external');\n\n   // Focus related app options stores.\n   const { focusAuto, focusKeep, focusTrap } = application.reactive.storeAppOptions;\n\n   const { minimized } = application.reactive.storeUIState;\n\n   let focusWrapEnabled;\n\n   // Enable TJSFocusWrap component when focus trapping app option is true and app is not minimized.\n   $: focusWrapEnabled = $focusAuto && $focusTrap && !$minimized;\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // The following block is somewhat complex, but allows transition options to be updated reactively during\n   // runtime execution.\n\n   // Exports properties to set a transition w/ in / out options.\n   export let transition = void 0;\n   export let inTransition = void 0;\n   export let outTransition = void 0;\n\n   // Exports properties to set options for any transitions.\n   export let transitionOptions = void 0;\n   export let inTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS;\n   export let outTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS;\n\n   // Tracks last transition state.\n   let oldTransition = void 0;\n   let oldTransitionOptions = void 0\n\n   // Run this reactive block when the last transition state is not equal to the current state.\n   $: if (oldTransition !== transition)\n   {\n      // If transition is defined and not the default transition then set it to both in and out transition otherwise\n      // set the default transition to both in & out transitions.\n      const newTransition = typeof transition === 'function' ? transition : void 0;\n\n      inTransition = newTransition;\n      outTransition = newTransition;\n\n      oldTransition = newTransition;\n   }\n\n   // Run this reactive block when the last transition options state is not equal to the current options state.\n   $: if (oldTransitionOptions !== transitionOptions)\n   {\n      const newOptions = transitionOptions !== s_DEFAULT_TRANSITION_OPTIONS && isObject(transitionOptions) ?\n       transitionOptions : s_DEFAULT_TRANSITION_OPTIONS;\n\n      inTransitionOptions = newOptions;\n      outTransitionOptions = newOptions;\n\n      oldTransitionOptions = newOptions;\n   }\n\n   // Handle cases if inTransition is unset; assign noop default transition function.\n   $: if (typeof inTransition !== 'function') { inTransition = void 0; }\n\n   $:\n   {\n      // Handle cases if outTransition is unset; assign noop default transition function.\n      if (typeof outTransition !== 'function') { outTransition = void 0; }\n\n      // Set jquery close animation to either run or not when an out transition is changed.\n      if (application && typeof application?.options?.defaultCloseAnimation === 'boolean')\n      {\n         application.options.defaultCloseAnimation = outTransition === void 0;\n      }\n   }\n\n   // Handle cases if inTransitionOptions is unset; assign empty default transition options.\n   $: if (typeof inTransitionOptions !== 'object') { inTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS; }\n\n   // Handle cases if outTransitionOptions is unset; assign empty default transition options.\n   $: if (typeof outTransitionOptions !== 'object') { outTransitionOptions = s_DEFAULT_TRANSITION_OPTIONS; }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // Focus `elementRoot` on mount to allow keyboard tab navigation of header buttons.\n   onMount(() => elementRoot.focus());\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a handler for the custom `close:popup` event fired by `svelte-standard` components like TJSMenu. The\n    * intention is to handle focus management of a component that is no longer connected in the DOM. If a target element\n    * that is the source of the close event is attached attempt to resolve internal focus to the application.\n    *\n    * @param {CustomEvent}  event - A custom event for `close:popup`.\n    */\n   function onClosePopup(event)\n   {\n      // Early out as automatic focus management is not enabled.\n      if (!$focusAuto) { return; }\n\n      const targetEl = event?.detail?.target;\n\n      // Early out if there is no target element.\n      if (!(targetEl instanceof HTMLElement)) { return; }\n\n      // Early out if the target element is focusable as it will gain focus naturally.\n      if (A11yHelper.isFocusable(targetEl)) { return; }\n\n      const elementRootContains = elementRoot.contains(targetEl);\n\n      // First check for if the target is elementRoot or elementContent then fallback to contains checks.\n      if (targetEl === elementRoot)\n      {\n         elementRoot.focus();\n      }\n      else if (targetEl === elementContent)\n      {\n         elementContent.focus();\n      }\n      else if (elementRootContains)\n      {\n         if (elementContent.contains(targetEl))\n         {\n            elementContent.focus();\n         }\n         else\n         {\n            elementRoot.focus();\n         }\n      }\n   }\n\n   /**\n    * Provides focus cycling inside the application capturing `<Shift-Tab>` and if `elementRoot` or `firstFocusEl` is\n    * the actively focused element then last focusable element is focused skipping `TJSFocusWrap`.\n    *\n    * Also, if a popout app all key down events will bring this application to the top such that when focus is trapped\n    * the app is top most.\n    *\n    * @param {KeyboardEvent} event - Keyboard Event.\n    */\n   function onKeydown(event)\n   {\n      if (focusWrapEnabled && event.shiftKey && event.code === 'Tab')\n      {\n         // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\n         const allFocusable = A11yHelper.getFocusableElements(elementRoot, s_IGNORE_CLASSES);\n\n         // Find first and last focusable elements.\n         const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\n         const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\n\n         // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable element\n         // is the active element.\n         if (elementRoot === document.activeElement || firstFocusEl === document.activeElement)\n         {\n            if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\n\n            event.preventDefault();\n            event.stopPropagation();\n         }\n      }\n\n      // Make sure this application is top most when it receives keyboard events.\n      if (typeof application?.options?.popOut === 'boolean' && application.options.popOut &&\n       application !== globalThis.ui?.activeWindow)\n      {\n         application.bringToTop.call(application);\n      }\n   }\n\n   /**\n    * If the application is a popOut application then when clicked bring to top if not already the Foundry\n    * `activeWindow`.\n    */\n   function onPointerdownApp()\n   {\n      if (typeof application?.options?.popOut === 'boolean' && application.options.popOut &&\n       application !== globalThis.ui?.activeWindow)\n      {\n         application.bringToTop.call(application);\n      }\n   }\n\n   /**\n    * Focus `elementContent` if the event target is not focusable and `focusAuto` is enabled.\n    *\n    * Note: `focusAuto` is an app option store. This check is a bit tricky as `section.window-content` has a tabindex\n    * of '-1', so it is focusable manually.\n    */\n   function onPointerdownContent(event)\n   {\n      const focusable = A11yHelper.isFocusable(event.target);\n\n      if (!focusable && $focusAuto)\n      {\n         if ($focusKeep)\n         {\n            const focusOutside = document.activeElement instanceof HTMLElement &&\n             !elementRoot.contains(document.activeElement);\n\n            // Only focus the content element if the active element is outside the app; maintaining internal focused\n            // element.\n            if (focusOutside)\n            {\n               elementContent.focus();\n            }\n            else\n            {\n               event.preventDefault();\n            }\n         }\n         else\n         {\n            elementContent.focus();\n         }\n      }\n   }\n\n   /**\n    * Callback for content resizeObserver action. This is enabled when contentOffsetHeight or contentOffsetWidth is\n    * bound.\n    *\n    * @param {number}   offsetWidth - Observed offsetWidth.\n    *\n    * @param {number}   offsetHeight - Observed offsetHeight\n    */\n   function resizeObservedContent(offsetWidth, offsetHeight)\n   {\n      contentOffsetWidth = offsetWidth;\n      contentOffsetHeight = offsetHeight;\n   }\n\n   /**\n    * Callback for app resizeObserver action. This is enabled when appOffsetHeight or appOffsetWidth is\n    * bound. Additionally, the Application position resizeObserved store is updated.\n    *\n    * @param {number}   contentWidth - Observed contentWidth.\n    * @param {number}   contentHeight - Observed contentHeight\n    * @param {number}   offsetWidth - Observed offsetWidth.\n    * @param {number}   offsetHeight - Observed offsetHeight\n    */\n   function resizeObservedApp(offsetWidth, offsetHeight, contentWidth, contentHeight)\n   {\n      application.position.stores.resizeObserved.update((object) =>\n      {\n         object.contentWidth = contentWidth;\n         object.contentHeight = contentHeight;\n         object.offsetWidth = offsetWidth;\n         object.offsetHeight = offsetHeight;\n\n         return object;\n      });\n\n      appOffsetHeight = offsetHeight;\n      appOffsetWidth = offsetWidth;\n   }\n\n   /**\n    * Transitions can cause side effects. Work around this issue by using an if conditional.\n    * Due to timing issues and the onDestroy / outro transitions can cause elementRoot / elementContent to be set to\n    * null when swapped dynamically. There is a feature request to allow transition functions to be undefined:\n    *\n    * @see: https://github.com/sveltejs/svelte/issues/6942\n    */\n</script>\n\n<svelte:options accessors={true}/>\n\n{#if inTransition || outTransition}\n   <div id={application.id}\n        class=\"app window-app {application.options.classes.join(' ')}\"\n        data-appid={application.appId}\n        bind:this={elementRoot}\n        in:inTransition={inTransitionOptions}\n        out:outTransition={outTransitionOptions}\n        on:close:popup|preventDefault|stopPropagation={onClosePopup}\n        on:keydown|capture={onKeydown}\n        on:pointerdown={onPointerdownApp}\n        use:applyStyles={stylesApp}\n        use:appResizeObserver={resizeObservedApp}\n        tabindex=-1>\n      <TJSApplicationHeader {draggable} {draggableOptions} />\n      <section class=window-content\n               bind:this={elementContent}\n               on:pointerdown={onPointerdownContent}\n               use:applyStyles={stylesContent}\n               use:contentResizeObserver={resizeObservedContent}\n               tabindex=-1>\n         <slot />\n      </section>\n      <ResizableHandle />\n      <TJSFocusWrap {elementRoot} />\n   </div>\n{:else}\n   <div id={application.id}\n        class=\"app window-app {application.options.classes.join(' ')}\"\n        data-appid={application.appId}\n        bind:this={elementRoot}\n        on:close:popup|preventDefault|stopPropagation={onClosePopup}\n        on:keydown|capture={onKeydown}\n        on:pointerdown={onPointerdownApp}\n        use:applyStyles={stylesApp}\n        use:appResizeObserver={resizeObservedApp}\n        tabindex=-1>\n      <TJSApplicationHeader {draggable} {draggableOptions} />\n      <section class=window-content\n               bind:this={elementContent}\n               on:pointerdown={onPointerdownContent}\n               use:applyStyles={stylesContent}\n               use:contentResizeObserver={resizeObservedContent}\n               tabindex=-1>\n         <slot />\n      </section>\n      <ResizableHandle />\n      <TJSFocusWrap {elementRoot} enabled={focusWrapEnabled} />\n   </div>\n{/if}\n\n<style>\n   /* Note: this is different than stock Foundry and allows rounded corners from .app core styles */\n   .window-app {\n      overflow: var(--tjs-app-overflow, hidden);\n   }\n\n   .window-app:focus-visible {\n      outline: var(--tjs-app-outline-focus-visible, var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent));\n   }\n\n   .window-content:focus-visible {\n      outline: var(--tjs-app-content-outline-focus-visible, var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent));\n   }\n\n   /* Override Foundry default; adjust --tjs-app-header-gap to change gap size */\n   .window-app :global(.window-header a) {\n      flex: none;\n      margin: 0;\n   }\n\n   /* Override Foundry default; See TJSHeaderButton for CSS variables */\n   .window-app :global(.window-header i[class^=fa]) {\n      margin: 0\n   }\n</style>\n","<script>\n   import {\n      getContext,\n      onDestroy,\n      onMount }            from 'svelte';\n\n   import { applyStyles }  from '@typhonjs-fvtt/runtime/svelte/action';\n   import { localize }     from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   import {\n      A11yHelper,\n      isObject,\n      isSvelteComponent,\n      parseSvelteConfig }  from '@typhonjs-fvtt/runtime/svelte/util';\n\n   export let data = void 0;\n   export let preventDefault = false;\n   export let stopPropagation = false;\n\n   export let dialogComponent = void 0;\n\n   const s_REGEX_HTML = /^\\s*<.*>$/;\n\n   let buttons;\n\n   /** @type {HTMLDivElement} */\n   let contentEl;\n\n   /** @type {HTMLDivElement} */\n   let buttonsEl;\n\n   let content = void 0;\n   let dialogClass;\n   let dialogProps = {};\n\n   let { elementRoot } = getContext('#internal').stores;\n\n   let { application } = getContext('#external');\n\n   let managedPromise = getContext('#managedPromise');\n\n   let currentButtonId = data.default;\n\n   // Remove key listeners from elementRoot.\n   onDestroy(() =>\n   {\n      const rootEl = $elementRoot;\n      if (rootEl instanceof HTMLElement)\n      {\n         rootEl.removeEventListener('keydown', onKeydown)\n         rootEl.removeEventListener('keyup', onKeyup)\n      }\n   })\n\n   // If `focusFirst` is true then focus first focusable element iin dialog content.\n   onMount(() =>\n   {\n      if (focusFirst)\n      {\n         const focusEl = A11yHelper.getFirstFocusableElement(contentEl);\n\n         if (focusEl instanceof HTMLElement)\n         {\n            // Focus on next tick to allow application / dialog to mount to bypass ApplicationShell onMount focus\n            // handling.\n            setTimeout(() => focusEl.focus(), 0);\n         }\n      }\n   });\n\n   // Add key listeners to elementRoot when it is bound.\n   $: if ($elementRoot)\n   {\n      const rootEl = $elementRoot;\n      if (rootEl instanceof HTMLElement)\n      {\n         rootEl.addEventListener('keydown', onKeydown)\n         rootEl.addEventListener('keyup', onKeyup)\n      }\n   }\n\n   // Automatically close the dialog on button click handler completion.\n   $: autoClose = typeof data.autoClose === 'boolean' ? data.autoClose : true;\n\n   // When true the first focusable element that isn't a button is focused.\n   $: focusFirst = typeof data.focusFirst === 'boolean' ? data.focusFirst : false;\n\n   // Focus current button when `buttonsEl` is bound.\n   $: if (!focusFirst && buttonsEl instanceof HTMLElement)\n   {\n      const buttonEl = buttonsEl.querySelector(`.${currentButtonId}`);\n      if (buttonEl instanceof HTMLElement) { buttonEl.focus(); }\n   }\n\n   // When false the dialog does not automatically close when button selected.\n   $: resolveId = typeof data.resolveId === 'boolean' ? data.resolveId : false;\n\n   // If `data.buttons` is not an object then set an empty array otherwise reduce the button data.\n   $:\n   {\n      buttons = !isObject(data.buttons) ? [] : Object.keys(data.buttons).reduce((array, key) =>\n      {\n         const b = data.buttons[key];\n\n         // Handle icon and treat bare strings as the icon class; otherwise assume the icon is fully formed HTML.\n         const icon = typeof b.icon !== 'string' ? void 0 : s_REGEX_HTML.test(b.icon) ? b.icon :\n          `<i class=\"${b.icon}\"></i>`;\n\n         const autoClose = typeof b.autoClose === 'boolean' ? b.autoClose : true;\n\n         const disabled = typeof b.disabled === 'boolean' ? b.disabled : false;\n\n         const label = typeof b.label === 'string' ? `${icon !== void 0 ? ' ' : ''}${localize(b.label)}` : '';\n\n         const title = typeof b.title === 'string' ? localize(b.title) : void 0;\n\n         // Test any condition supplied otherwise default to true.\n         const condition = typeof b.condition === 'function' ? b.condition.call(b) : b.condition ?? true;\n\n         if (condition) { array.push({ ...b, id: key, autoClose, icon, label, title, disabled }); }\n\n         return array;\n      }, []);\n   }\n\n   /**\n    * This reactivity block will trigger on arrow left / right key presses _and_ when buttons change. It is OK for it to\n    * trigger on both.\n    */\n   $: if (!buttons.find((button) => button.id === currentButtonId)) { currentButtonId = void 0; }\n\n   $: if (content !== data.content) // Only update the content if it has changed.\n   {\n      content = data.content;\n\n      try\n      {\n         if (isSvelteComponent(content))\n         {\n            dialogClass = content;\n            dialogProps = {};\n         }\n         else if (isObject(content))\n         {\n            const svelteConfig = parseSvelteConfig(content, application);\n            dialogClass = svelteConfig.class;\n            dialogProps = svelteConfig.props ?? {};\n\n            // Check for any children parsed and added to the external context.\n            const children = svelteConfig?.context?.get('external')?.children;\n\n            // If so add to dialogProps.\n            if (Array.isArray(children)) { dialogProps.children = children; }\n         }\n         else\n         {\n            dialogClass = void 0;\n            dialogProps = {};\n         }\n      }\n      catch (err)\n      {\n         dialogClass = void 0;\n         dialogProps = {};\n\n         content = err.message;\n         console.error(err);\n      }\n   }\n\n   /**\n    * Handle button click.\n    *\n    * @param {object}   button - button data.\n    *\n    * TODO: When app eventbus is available send event for UI notification instead of Foundry API usage.\n    *\n    * @returns {*}\n    */\n   function onClick(button)\n   {\n      try\n      {\n         let result = void 0;\n\n         const callback = button?.onPress;\n\n         switch (typeof callback)\n         {\n            case 'function':\n               // Pass back the TJSDialog instance.\n               result = callback(application);\n               break;\n\n            case 'string':\n               // Attempt lookup by function name in dialog instance component.\n               if (dialogComponent !== void 0 && typeof dialogComponent[callback] === 'function')\n               {\n                  result = dialogComponent[callback](application);\n               }\n               else\n               {\n                  if (dialogComponent === void 0)\n                  {\n                     console.warn(`[TRL] TJSDialog warning: 'onPress' defined as a string with no associated ` +\n                      `content Svelte component.`);\n                  }\n                  else if (typeof dialogComponent?.[callback] !== 'function')\n                  {\n                     console.warn(`[TRL] TJSDialog warning: The content Svelte component does not contain an ` +\n                      `associated function '${callback}'. Did you remember to add ` +\n                       `'<svelte:options accessors={true} />' and export the function?`);\n                  }\n               }\n               break;\n         }\n\n         // By default, both 'button.autoClose' & autoClose are true, so skip auto-closing when either is false.\n         if (button.autoClose && autoClose)\n         {\n            // If `resolveId` dialog option is true and current result is undefined then set result to the button ID.\n            if (resolveId && result === void 0) { result = button.id; }\n\n            managedPromise.resolve(result);\n         }\n      }\n      catch(err)\n      {\n         const notifyError = typeof data.notifyError === 'boolean' ? data.notifyError : true;\n         if (notifyError)\n         {\n            // TODO: When app eventbus is available send event for UI notification instead of Foundry API usage.\n            globalThis.ui.notifications.error(err, { console: false });\n         }\n\n         // Attempt to first reject the error with any current managed Promise otherwise rethrow error.\n         if (!managedPromise.reject(err)) { throw err; }\n      }\n      finally\n      {\n         // By default, both 'button.autoClose' & autoClose are true, so skip auto-closing when either is false.\n         if (button.autoClose && autoClose) { application.close(); }\n      }\n   }\n\n   /**\n    * Handles key down events for stopping propagation for arrow keys. Also handles tab / focus traversal with a timeout\n    * to update `currentButtonId` on the next clock tick comparing against `document.activeElement`.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeydown(event)\n   {\n      switch (event.code)\n      {\n         case 'ArrowLeft':\n         case 'ArrowRight':\n         case 'Enter':\n            event.stopPropagation();\n            break;\n\n         case 'Tab':\n            event.stopPropagation();\n\n            // Check `activeElement` on next tick to potentially update `currentButtonId` from tab / keyboard\n            // navigation.\n            setTimeout(() =>\n            {\n               const activeElement = document.activeElement;\n               if (activeElement instanceof HTMLElement && buttonsEl instanceof HTMLElement &&\n                buttonsEl.contains(activeElement))\n               {\n                  // Find class that isn't `dialog-button` or `default` and is a key in `data.buttons`.\n                  for (let cntr = 0; cntr < activeElement.classList.length; cntr++)\n                  {\n                     const item = activeElement.classList.item(cntr);\n                     if (item !== 'dialog-button' && item !== 'default' && typeof data.buttons[item] !== void 0)\n                     {\n                        currentButtonId = item;\n                        break;\n                     }\n                  }\n               }\n            }, 0);\n            break;\n\n         default:\n            if (preventDefault) { event.preventDefault(); }\n            if (stopPropagation) { event.stopPropagation(); }\n            break;\n      }\n   }\n\n   /**\n    * Handles key up events for arrow key button navigation.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeyup(event)\n   {\n      switch (event.code)\n      {\n         case 'ArrowLeft':\n         {\n            event.preventDefault();\n            event.stopPropagation();\n\n            const activeEl = document.activeElement;\n\n            if (buttonsEl instanceof HTMLElement)\n            {\n               // Only advance button via arrow key if a button is already focused.\n               if (activeEl instanceof HTMLElement && buttonsEl.contains(activeEl))\n               {\n                  const currentIndex = buttons.findIndex((button) => button.id === currentButtonId);\n                  if (buttons.length && currentIndex > 0) { currentButtonId = buttons[currentIndex - 1].id; }\n               }\n\n               const buttonEl = buttonsEl.querySelector(`.${currentButtonId}`);\n               if (buttonEl instanceof HTMLElement) { buttonEl.focus(); }\n            }\n            break;\n         }\n\n         case 'ArrowRight':\n         {\n            event.preventDefault();\n            event.stopPropagation();\n\n            const activeEl = document.activeElement;\n\n            if (buttonsEl instanceof HTMLElement)\n            {\n               // Only advance button via arrow key if a button is already focused  or there is no current button ID\n               if (activeEl instanceof HTMLElement && (buttonsEl.contains(activeEl) || currentButtonId === void 0))\n               {\n                  const currentIndex = buttons.findIndex((button) => button.id === currentButtonId);\n                  if (buttons.length && currentIndex < buttons.length - 1) { currentButtonId = buttons[currentIndex + 1].id; }\n               }\n\n               const buttonEl = buttonsEl.querySelector(`.${currentButtonId}`);\n               if (buttonEl instanceof HTMLElement) { buttonEl.focus(); }\n            }\n            break;\n         }\n\n         case 'Enter':\n            event.preventDefault();\n            event.stopPropagation();\n            break;\n\n         default:\n            if (preventDefault) { event.preventDefault(); }\n            if (stopPropagation) { event.stopPropagation(); }\n            break;\n      }\n   }\n</script>\n\n<main>\n   <div bind:this={contentEl} class=dialog-content>\n      {#if typeof content === 'string'}\n         {@html content}\n      {:else if dialogClass}\n         <svelte:component bind:this={dialogComponent} this={dialogClass} {...dialogProps} />\n      {/if}\n   </div>\n\n   {#if buttons.length}\n   <div bind:this={buttonsEl} class=dialog-buttons>\n      {#each buttons as button (button.id)}\n      <button class=\"dialog-button {button.id}\"\n              on:click|preventDefault|stopPropagation={() => onClick(button)}\n              on:focus={() => currentButtonId = button.id}\n              disabled={button.disabled}\n              use:applyStyles={button.styles}>\n         <span title={button.title}>{#if button.icon}{@html button.icon}{/if}{button.label}</span>\n      </button>\n      {/each}\n   </div>\n   {/if}\n</main>\n\n<style>\n   .dialog-buttons {\n      padding-top: 8px;\n   }\n</style>\n","<script>\n   import {\n      getContext,\n      onDestroy,\n      onMount,\n      setContext }         from 'svelte';\n\n   import { fade }         from 'svelte/transition';\n\n   import { isObject }     from '@typhonjs-fvtt/runtime/svelte/util';\n\n   import ApplicationShell from '../application/ApplicationShell.svelte';\n   import DialogContent    from './DialogContent.svelte';\n   import TJSGlassPane     from '../TJSGlassPane.svelte';\n\n   // ApplicationShell contract.\n   export let elementContent = void 0;\n   export let elementRoot = void 0;\n\n   // The dialog data.\n   export let data = {};\n\n   export let dialogComponent = void 0;\n\n   export let managedPromise = void 0;\n\n   const application = getContext('#external').application;\n\n   setContext('#managedPromise', managedPromise);\n\n   const s_MODAL_TRANSITION = fade;\n   const s_MODAL_TRANSITION_OPTIONS = { duration: 200 };\n   const s_MODAL_BACKGROUND = '#50505080'\n\n   let modal = void 0;\n\n   // Stores props for the ApplicationShell.\n   const appProps = {\n      // Stores any transition functions.\n      transition: void 0,\n      inTransition: void 0,\n      outTransition: void 0,\n\n      // Stores properties to set for options for any transitions.\n      transitionOptions: void 0,\n      inTransitionOptions: void 0,\n      outTransitionOptions: void 0,\n\n      // Stores any style overrides for application shell.\n      stylesApp: void 0,\n      stylesContent: void 0\n   }\n\n   const modalProps = {\n      // Background CSS style string.\n      background: void 0,\n      slotSeparate: void 0,\n      styles: void 0,\n\n      // Stores any transition functions.\n      transition: void 0,\n      inTransition: void 0,\n      outTransition: void 0,\n\n      // Stores properties to set for options for any transitions.\n      transitionOptions: void 0,\n      inTransitionOptions: void 0,\n      outTransitionOptions: void 0,\n   }\n\n   let zIndex = void 0;\n\n   let minimizable = true;\n\n   // Only set modal once on mount. You can't change between a modal an non-modal dialog during runtime.\n   if (modal === void 0) { modal = typeof data?.modal === 'boolean' ? data.modal : false; }\n\n   // Special modal handling -----------------------------------------------------------------------------------------\n\n   if (modal)\n   {\n      // Add a capture listener on window keydown to act before any other event listener.\n      onDestroy(() => window.removeEventListener('keydown', onKeydownModal, { capture: true }));\n      onMount(() => window.addEventListener('keydown', onKeydownModal, { capture: true }));\n   }\n   else\n   {\n      // Add a listener on document keydown to act before or equal with other event listeners.\n      onDestroy(() => document.removeEventListener('keydown', onKeydown));\n      onMount(() => document.addEventListener('keydown', onKeydown));\n   }\n\n   // Aria Attributes ------------------------------------------------------------------------------------------------\n\n   $: if (elementRoot instanceof HTMLElement)\n   {\n      elementRoot.setAttribute('role', 'dialog');\n\n      if (modal) { elementRoot.setAttribute('aria-modal', 'true'); }\n   }\n\n   // SvelteApplication options --------------------------------------------------------------------------------------\n\n   // Retrieve values from the DialogData object and also potentially set any SvelteApplication accessors.\n   // Explicit checks are performed against existing local variables as the only externally reactive variable is `data`.\n   // All of the checks below trigger when there are any external changes to the `data` prop.\n   // Prevent any unnecessary changing of local & `application` variables unless actual changes occur.\n\n   $: if (isObject(data))\n   {\n      const newZIndex = Number.isInteger(data.zIndex) || data.zIndex === null ? data.zIndex :\n       modal ? Number.MAX_SAFE_INTEGER : Number.MAX_SAFE_INTEGER - 1\n      if (zIndex !== newZIndex) { zIndex = newZIndex; }\n\n      // Update the main foundry options when data changes. Perform explicit checks against existing data in `application`.\n      const newDraggable = typeof data.draggable === 'boolean' ? data.draggable : void 0;\n      if (newDraggable !== void 0 && application.reactive.draggable !== newDraggable)\n      {\n         application.reactive.draggable = newDraggable;\n      }\n\n      const newFocusAuto = typeof data.focusAuto === 'boolean' ? data.focusAuto : void 0;\n      if (newFocusAuto !== void 0 && application.reactive.focusAuto !== newFocusAuto)\n      {\n         application.reactive.focusAuto = newFocusAuto;\n      }\n\n      const newFocusKeep = typeof data.focusKeep === 'boolean' ? data.focusKeep : void 0;\n      if (newFocusKeep !== void 0 && application.reactive.focusKeep !== newFocusKeep)\n      {\n         application.reactive.focusKeep = newFocusKeep;\n      }\n\n      const newFocusTrap = typeof data.focusTrap === 'boolean' ? data.focusTrap : void 0;\n      if (newFocusTrap !== void 0 && application.reactive.focusTrap !== newFocusTrap)\n      {\n         application.reactive.focusTrap = newFocusTrap;\n      }\n\n      const newMinimizable = typeof data.minimizable === 'boolean' ? data.minimizable : void 0;\n      if (newMinimizable !== void 0 && application.reactive.minimizable !== newMinimizable)\n      {\n         application.reactive.minimizable = newMinimizable;\n      }\n\n      const newResizable = typeof data.resizable === 'boolean' ? data.resizable : void 0;\n      if (newResizable !== void 0 && application.reactive.resizable !== newResizable)\n      {\n         application.reactive.resizable = newResizable;\n      }\n\n      // Note application.title from Application localizes `options.title`, so compare with `application.options.title`.\n      const newTitle = data.title ?? 'Dialog';\n      if (newTitle !== application?.options?.title) { application.reactive.title = newTitle; }\n\n      if (application.position.zIndex !== zIndex) { application.position.zIndex = zIndex; }\n   }\n\n   // ApplicationShell transition options ----------------------------------------------------------------------------\n\n   $: if (isObject(data?.transition))\n   {\n      // Store data.transitions to shorten statements below.\n      const d = data.transition;\n\n      if (d?.transition !== appProps.transition) { appProps.transition = d.transition; }\n      if (d?.inTransition !== appProps.inTransition) { appProps.inTransition = d.inTransition; }\n      if (d?.outTransition !== appProps.outTransition) { appProps.outTransition = d.outTransition; }\n      if (d?.transitionOptions !== appProps.transitionOptions) { appProps.transitionOptions = d.transitionOptions; }\n\n      if (d?.inTransitionOptions !== appProps.inTransitionOptions)\n      {\n         appProps.inTransitionOptions = d.inTransitionOptions;\n      }\n\n      if (d?.outTransitionOptions !== appProps.outTransitionOptions)\n      {\n         appProps.outTransitionOptions = d.outTransitionOptions;\n      }\n   }\n\n   // Modal options --------------------------------------------------------------------------------------------------\n\n   $:\n   {\n      const newModalBackground = typeof data?.modalOptions?.background === 'string' ? data.modalOptions.background :\n       s_MODAL_BACKGROUND;\n\n      if (newModalBackground !== modalProps.background) { modalProps.background = newModalBackground; }\n   }\n\n   $:\n   {\n      const newModalSlotSeparate = typeof data?.modalOptions?.slotSeparate === 'boolean' ?\n       data.modalOptions.slotSeparate : void 0;\n\n      if (newModalSlotSeparate !== modalProps.slotSeparate) { modalProps.slotSeparate = newModalSlotSeparate; }\n   }\n\n   $:\n   {\n      const newModalStyles = isObject(data?.modalOptions?.styles) ? data.modalOptions.styles : void 0;\n\n      if (newModalStyles !== modalProps.styles) { modalProps.styles = newModalStyles; }\n   }\n\n   $: if (isObject(data?.modalOptions?.transition))\n   {\n      // Store data.transitions to shorten statements below.\n      const d = data.modalOptions.transition;\n\n      if (d?.transition !== modalProps.transition)\n      {\n         modalProps.transition = typeof d?.transition === 'function' ? d.transition : s_MODAL_TRANSITION;\n      }\n\n      if (d?.inTransition !== modalProps.inTransition) { modalProps.inTransition = d.inTransition; }\n      if (d?.outTransition !== modalProps.outTransition) { modalProps.outTransition = d.outTransition; }\n\n      // Provide default transition options if not defined.\n      if (d?.transitionOptions !== modalProps.transitionOptions)\n      {\n         modalProps.transitionOptions = isObject(d?.transitionOptions) ? d.transitionOptions :\n          s_MODAL_TRANSITION_OPTIONS;\n      }\n\n      if (d?.inTransitionOptions !== modalProps.inTransitionOptions)\n      {\n         modalProps.inTransitionOptions = d.inTransitionOptions;\n      }\n\n      if (d?.outTransitionOptions !== modalProps.outTransitionOptions)\n      {\n         modalProps.outTransitionOptions = d.outTransitionOptions;\n      }\n   }\n   else  // Provide a fallback / default glass pane transition when `data.modalOptions.transition` is not defined.\n   {\n      const newModalTransition = typeof data?.modalOptions?.transition?.transition === 'function' ?\n       data.modalOptions.transition.transition : s_MODAL_TRANSITION;\n\n      if (newModalTransition !== modalProps.transition) { modalProps.transition = newModalTransition; }\n\n      const newModalTransitionOptions = isObject(data?.modalOptions?.transitionOptions) ?\n       data.modalOptions.transitionOptions : s_MODAL_TRANSITION_OPTIONS;\n\n      if (newModalTransitionOptions !== modalProps.transitionOptions)\n      {\n         modalProps.transitionOptions = newModalTransitionOptions;\n      }\n   }\n\n   /**\n    * Handles closing all open TJSDialog instances when <Esc> key is pressed.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeydown(event)\n   {\n      if (event.code === 'Escape')\n      {\n         event.preventDefault();\n         event.stopPropagation();\n         application.close();\n      }\n   }\n\n   /**\n    * Handles closing any modal window and is assigned to `window` with capture acting before any other browser wide\n    * event listeners stopping immediate propagation.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeydownModal(event)\n   {\n      if (event.code === 'Escape')\n      {\n         event.preventDefault();\n         event.stopImmediatePropagation();\n         application.close();\n      }\n   }\n</script>\n\n<svelte:options accessors={true}/>\n\n{#if modal}\n   <TJSGlassPane id={`${application.id}-glasspane`} {...modalProps} {zIndex}>\n      <ApplicationShell bind:elementRoot bind:elementContent {...appProps} appOffsetHeight={true}>\n         <DialogContent bind:dialogComponent {data} stopPropagation={true} />\n      </ApplicationShell>\n   </TJSGlassPane>\n{:else}\n   <ApplicationShell bind:elementRoot bind:elementContent {...appProps} appOffsetHeight={true}>\n      <DialogContent bind:dialogComponent {data} />\n   </ApplicationShell>\n{/if}\n","import { cssVariables } from './cssVariables.js';\n\nexport { default as TJSComponentShell }   from './TJSComponentShell.svelte';\nexport { default as TJSContainer }        from './TJSContainer.svelte';\nexport { default as TJSGlassPane }        from './TJSGlassPane.svelte';\nexport *                                  from './application/index.js';\nexport *                                  from './dialog/index.js';\n\n/**\n * @typedef {object} TransformData\n *\n * @property {Function} transition - A transition applying to both in & out.\n *\n * @property {Function} inTransition - A transition applying to in.\n *\n * @property {Function} outTransition - A transition applying to out.\n *\n * @property {object}   transitionOptions - The options config object for in & out transitions.\n *\n * @property {object}   inTransitionOptions - The options config object for in transitions.\n *\n * @property {object}   outTransitionOptions - The options config object for out transitions.\n */\n\n/**\n * Provides default CSS variables for core components.\n */\ncssVariables.setProperties({\n   // Anchor text shadow / header buttons\n   '--tjs-default-text-shadow-focus-hover': '0 0 8px var(--color-shadow-primary)',\n\n   // TJSApplicationShell app background.\n   '--tjs-app-background': `url(\"${globalThis.foundry.utils.getRoute('/ui/denim075.png')}\")`,\n}, false);\n","import {\n   deepMerge,\n   safeAccess,\n   safeSet }   from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Provides storage for all dialog options adding `get`, `merge` and `set` methods that safely access and update\n * data changed to the mounted DialogShell component reactively.\n */\nexport class TJSDialogData\n{\n   /**\n    * @type {SvelteApplication}\n    */\n   #application;\n\n   /**\n    * Provides configuration of the dialog button bar.\n    *\n    * @type {Record<string, TJSDialogButtonData>}\n    */\n   buttons;\n\n   /**\n    * A Svelte configuration object or HTML string content.\n    *\n    * @type {object|string}\n    */\n   content;\n\n   /**\n    * The default button ID to focus initially.\n    *\n    * @type {string}\n    */\n   default;\n\n   /**\n    * The dialog is draggable when true.\n    *\n    * @type {boolean}\n    */\n   draggable;\n\n   /**\n    * When true auto-management of app focus is enabled.\n    *\n    * @type {boolean}\n    */\n   focusAuto;\n\n   /**\n    * When true the first focusable element that isn't a button is focused.\n    *\n    * @type {boolean}\n    */\n   focusFirst;\n\n   /**\n    * When `focusAuto` and `focusKeep` is true; keeps internal focus.\n    *\n    * @type {boolean}\n    */\n   focusKeep;\n\n   /**\n    * When true the dialog is minimizable.\n    *\n    * @type {boolean}\n    */\n   minimizable;\n\n   /**\n    * When true a modal dialog is displayed.\n    *\n    * @type {boolean}\n    */\n   modal;\n\n   /**\n    * Additional options for modal dialog display.\n    *\n    * @type {object}\n    * TODO: Better specify type / options.\n    */\n   modalOptions;\n\n   /**\n    * When true and an error is raised in dialog callback functions post a UI error notification.\n    *\n    * @type {boolean}\n    */\n   notifyError;\n\n   /**\n    * Callback invoked when dialog is closed; no button option selected. When defined as a string any matching function\n    * by name exported from content Svelte component is invoked.\n    *\n    * @type {string|((application: TJSDialog) => any)}\n    */\n   onClose;\n\n   /**\n    * When true and a Promise has been created by {@link TJSDialog.wait} and the Promise is not in the process of being\n    * resolved or rejected on close of the dialog any `onClose` function is invoked and any result that is undefined\n    * will cause the Promise to then be rejected.\n    *\n    * @type {boolean}\n    */\n   rejectClose;\n\n   /**\n    * When true the dialog is resizable.\n    *\n    * @type {boolean}\n    */\n   resizable;\n\n   /**\n    * When true and resolving any Promises and there are undefined results from any button callbacks the button ID is\n    * resolved.\n    *\n    * @type {boolean}\n    */\n   resolveId;\n\n   /**\n    * The dialog window title.\n    *\n    * @type {string}\n    */\n   title;\n\n   /**\n    * Transition options for the dialog.\n    *\n    * @type {object}\n    * TODO: Better specify type / options.\n    */\n   transition;\n\n   /**\n    * A specific z-index for the dialog. Pass null for the dialog to act like other applications in regard bringing to\n    * top when activated.\n    *\n    * @type {number|null}\n    */\n   zIndex;\n\n   /**\n    * @param {SvelteApplication} application - The host Foundry application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n   }\n\n   /**\n    * Provides a way to safely get this dialogs data given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {*}        [defaultValue] - A default value returned if the accessor is not found.\n    *\n    * @returns {*} Value at the accessor.\n    */\n   get(accessor, defaultValue)\n   {\n      return safeAccess(this, accessor, defaultValue);\n   }\n\n   /**\n    * @param {object} data - Merge provided data object into Dialog data.\n    */\n   merge(data)\n   {\n      deepMerge(this, data);\n\n      const component = this.#application.svelte.component(0);\n      if (component?.data) { component.data = this; }\n   }\n\n   /**\n    * Provides a way to safely set this dialogs data given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * Automatically the dialog data will be updated in the associated DialogShell Svelte component.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {*}        value - Value to set.\n    *\n    * @returns {boolean} True if successful.\n    */\n   set(accessor, value)\n   {\n      const success = safeSet(this, accessor, value);\n\n      // If `this.options` modified then update the app options store.\n      if (success)\n      {\n         const component = this.#application.svelte.component(0);\n         if (component?.data) { component.data = this; }\n      }\n\n      return success;\n   }\n}\n","import { DialogShell }        from '@typhonjs-fvtt/runtime/svelte/component/core';\n\nimport {\n   deepMerge,\n   isObject,\n   ManagedPromise }           from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { TJSDialogData }      from './internal/TJSDialogData.js';\nimport { SvelteApplication }  from './SvelteApplication.js';\n\n/**\n * Provides a reactive dialog implementation configured from a unique dialog options object. The dialog features a\n * bottom button bar for user selection.\n *\n * A glasspane / modal option with various styling and transition capabilities is available when setting `modal: true`.\n *\n * Most importantly the `content` attribute of dialog data can be a Svelte component configuration object to render\n * your custom component as the dialog content. When using a Svelte component as the content you can assign a string\n * to the various `on<XXX>` dialog callbacks and an exported function from your component will be invoked to handle the\n * button callback. All dialog button callbacks and `onClose` callback receive a single argument which is the dialog /\n * application instance.\n *\n * When making a form with form validation or other dialog that you don't want to close immediately on button press you\n * can set `autoClose: false`, however you are 100% in control of resolving any Promise callbacks from button presses\n * and also closing the application. Each button can also be configured with `autoClose: false` in the button data.\n *\n * There is a handy Promise management capability to track a single Promise for the lifetime of a dialog available\n * at {@link TJSDialog.managedPromise}. By default when the user closes the dialog / application any managed Promise is\n * resolved with `null`. The managed Promise is available in any Svelte content component by using\n * `const managedPromise = getContext('#managedPromise')`. When handling any custom resolution particularly when\n * setting `autoClose: false` for a given button you are 100% in control of resolving or rejecting asynchronous data to\n * return from the dialog.\n *\n * To create and wait upon a managed promise for asynchronous return results use the static or member variation of\n * {@link TJSDialog.wait}.\n *\n * Please refer to {@link TJSDialogOptions} for the various options used to construct the dialog.\n *\n * There are a couple of static helper methods to quickly create standard dialogs such as a 'yes' / 'no' confirmation\n * dialog with {@link TJSDialog.confirm} and an 'ok' single button dialog with {@link TJSDialog.prompt}.\n *\n * TODO: document all extended dialog data parameters such as transition options / modal transitions.\n */\nexport class TJSDialog extends SvelteApplication\n{\n   /** @type {TJSDialogData} */\n   #data;\n\n   /** @type {ManagedPromise} */\n   #managedPromise;\n\n   /**\n    * @param {TJSDialogOptions}           data - Dialog options.\n    *\n    * @param {SvelteApplicationOptions}   [options] - SvelteApplication options.\n    */\n   constructor(data, options = {})\n   {\n      super(options);\n\n      this.#managedPromise = new ManagedPromise();\n\n      this.#data = new TJSDialogData(this);\n      this.data = data;\n\n      /**\n       * @member {object} dialogComponent - A getter to SvelteData to retrieve any mounted Svelte component as the\n       *                                    dialog content.\n       *\n       * @memberof GetSvelteData#\n       * @readonly\n       */\n      Object.defineProperty(this.svelte, 'dialogComponent', {\n         get: () => this.svelte?.applicationShell?.dialogComponent,\n      });\n   }\n\n   /**\n    * Default options for TJSDialog. Provides a default width and setting `height` to `auto` to always display dialog\n    * content even if it changes. The default `DialogShell` / `svelte` options should not be changed and instead mount\n    * the dialog content component by supplying a Svelte configuration object to dialog data `content` field.\n    *\n    * @returns {SvelteApplicationOptions} Default options\n    */\n   static get defaultOptions()\n   {\n      return deepMerge(super.defaultOptions, {\n         classes: ['dialog'],\n         width: 400,\n         height: 'auto',\n         svelte: {\n            class: DialogShell,\n            intro: true,\n            target: document.body,\n            props: function() // `this` is the TJSDialog instance when invoked.\n            {\n               return {\n                  data: this.#data,\n                  managedPromise: this.#managedPromise\n               };\n            }\n         }\n      });\n   }\n\n   /**\n    * Returns the dialog data.\n    *\n    * @returns {TJSDialogData} Dialog data.\n    */\n   get data() { return this.#data; }\n\n   /**\n    * @returns {ManagedPromise} Returns the managed promise.\n    */\n   get managedPromise() { return this.#managedPromise; }\n\n   /**\n    * Sets the dialog data; this is reactive.\n    *\n    * @param {object}   data - Dialog data.\n    */\n   set data(data)\n   {\n      if (!isObject(data)) { throw new TypeError(`TJSDialog set data error: 'data' is not an object'.`); }\n\n      const descriptors = Object.getOwnPropertyDescriptors(this.#data);\n\n      // Remove old data for all configurable descriptors.\n      for (const descriptor in descriptors)\n      {\n         if (descriptors[descriptor].configurable) { delete this.#data[descriptor]; }\n      }\n\n      // Merge new data and perform a reactive update.\n      this.#data.merge(data);\n   }\n\n   /**\n    * Close the dialog and un-register references to it within UI mappings.\n    * This function returns a Promise which resolves once the window closing animation concludes.\n    *\n    * @param {object}   [options] - Optional parameters.\n    *\n    * @param {boolean}  [options.force] - Force close regardless of render state.\n    *\n    * @returns {Promise<void>} A Promise which resolves once the application is closed with the callback value or\n    *                          `true`.\n    */\n   async close(options)\n   {\n      try\n      {\n         // Note: When handling a managed promise if a button selection has already been made the managed promise is\n         // already processing and the resolution below is skipped.\n         if (this.#managedPromise.isActive && !this.#managedPromise.isProcessing)\n         {\n            const result = TJSDialog.#invokeFn(this.#data.onClose, this, null);\n            const rejectClose = typeof this.#data.rejectClose === 'boolean' ? this.#data.rejectClose : false;\n\n            if (rejectClose && result === null)\n            {\n               this.#managedPromise.reject(new Error('TJSDialog was closed without a choice being made.'));\n            }\n            else\n            {\n               this.#managedPromise.resolve(result);\n            }\n         }\n      }\n      catch (err)\n      {\n         const notifyError = typeof this.#data.notifyError === 'boolean' ? this.#data.notifyError : true;\n         if (notifyError)\n         {\n            // TODO: When app eventbus is available send event for UI notification instead of Foundry API usage.\n            globalThis.ui.notifications.error(err, { console: false });\n         }\n\n         // If there is a managed Promise reject it or re-throw error.\n         if (!this.#managedPromise.reject(err)) { throw err; }\n      }\n      finally\n      {\n         await super.close(options);\n      }\n   }\n\n   /**\n    * Brings to top or renders this dialog returning a Promise that is resolved any button pressed or when the dialog\n    * is closed.\n    *\n    * Creates an anonymous data defined TJSDialog returning a Promise that can be awaited upon for the user to make a\n    * choice.\n    *\n    * Note: `null` is returned if the dialog is closed without a user making a choice.\n    *\n    * @template T\n    *\n    * @param {object}   [options] - Options.\n    *\n    * @param {boolean}  [options.reuse=false] - When true if there is an existing managed Promise this allows multiple\n    *        sources to await on the same result.\n    *\n    * @returns {Promise<T>} A promise for dialog resolution.\n    */\n   async wait(options)\n   {\n      // TODO: Direct usage of Foundry core Application API.\n      if (this.rendered)\n      {\n         this.bringToTop();\n      }\n      else\n      {\n         this.render(true, { focus: true });\n      }\n\n      // Return a managed Promise which is automatically resolved on button press via `DialogContent` component or when\n      // the dialog is closed.\n      return this.#managedPromise.create(options);\n   }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * A helper factory method to create simple confirmation dialog windows which consist of simple yes / no prompts.\n    * If you require more flexibility, a custom TJSDialog instance is preferred. The default focused button is 'yes'.\n    * You can change the default focused button by setting `default` to `yes` or `no`.\n    *\n    * @template T\n    *\n    * @param {TJSDialogOptions} data - Confirm dialog options.\n    *\n    * @param {string|((application: TJSDialog) => any)} [data.onYes] - Callback function upon `yes`; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {string|((application: TJSDialog) => any)} [data.onNo] - Callback function upon `no`; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {SvelteApplicationOptions}  [options]  SvelteApplication options passed to the TJSDialog constructor.\n    *\n    * @returns {Promise<T>} A promise which resolves with result of yes / no callbacks or true / false.\n    *\n    * @example\n    * const result = await TJSDialog.confirm({\n    *  title: 'A Yes or No Question',\n    *  content: '<p>Choose wisely.</p>',\n    *  onYes: () => 'YES Result'\n    *  onNo: () => 'NO Result'\n    * });\n    *\n    * // Logs 'YES result', 'NO Result', or null if the user closed the dialog without making a selection.\n    * console.log(result);\n    */\n   static async confirm({ onYes, onNo, ...data } = {}, options = {})\n   {\n      // Allow overwriting of default icon and labels.\n      const mergedButtons = deepMerge({\n         yes: {\n            icon: 'fas fa-check',\n            label: 'Yes'\n         },\n         no: {\n            icon: 'fas fa-times',\n            label: 'No',\n         }\n      }, data.buttons ?? {});\n\n      return this.wait({\n         ...data,\n         buttons: deepMerge(mergedButtons, {\n            yes: {\n               onPress: (application) => this.#invokeFn(onYes, application, true)\n            },\n            no: {\n               onPress: (application) => this.#invokeFn(onNo, application, false)\n            }\n         }),\n         default: data.default ?? 'yes'\n      }, options);\n   }\n\n   /**\n    * A helper method to invoke a callback function directly or lookup an exported function with the same name from any\n    * content Svelte component to invoke. This is used internally to apply default values for `confirm` and `prompt`.\n    *\n    * @param {string|((application: TJSDialog) => any)} callback - Callback function to invoke; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {TJSDialog} application - TJSDialog instance passed to callback.\n    *\n    * @param {*} [defaultResult] - An optional default result to return; undefined if not specified.\n    *\n    * @returns {*} Result.\n    */\n   static #invokeFn(callback, application, defaultResult = void 0)\n   {\n      let result = defaultResult;\n\n      switch (typeof callback)\n      {\n         case 'function':\n            // Pass the dialog instance to the callback.\n            result = callback(application);\n            break;\n\n         case 'string':\n         {\n            const dialogComponent = application?.svelte?.dialogComponent;\n\n            // Attempt lookup by function name in dialog instance component.\n            if (dialogComponent !== void 0 && typeof dialogComponent?.[callback] === 'function')\n            {\n               result = dialogComponent?.[callback](application);\n            }\n            else\n            {\n               if (dialogComponent === void 0)\n               {\n                  console.warn(`[TRL] TJSDialog warning: 'onPress' defined as a string with no ` +\n                   `associated content Svelte component.`);\n               }\n               else if (typeof dialogComponent?.[callback] !== 'function')\n               {\n                  console.warn(`[TRL] TJSDialog warning: The content Svelte component does not contain ` +\n                   `an associated function '${callback}'. Did you remember to add ` +\n                   `'<svelte:options accessors={true} />' and export the function?`);\n               }\n            }\n            break;\n         }\n      }\n\n      return result;\n   }\n\n   /**\n    * A helper factory method to display a basic \"prompt\" style TJSDialog with a single button.\n    *\n    * @template T\n    *\n    * @param {TJSDialogOptions} [data] - Prompt dialog options.\n    *\n    * @param {string|((application: TJSDialog) => any)} [data.onOk] - Callback function upon `ok`; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {string}   [data.label] - The OK prompt button text.\n    *\n    * @param {string}   [data.icon=\"fas fa-check\"] - Set another icon besides `fas fa-check` for button.\n    *\n    * @param {SvelteApplicationOptions}  [options]  SvelteApplication options passed to the TJSDialog constructor.\n    *\n    * @returns {Promise<T>} The returned value from the provided callback function or `true` if the button\n    *          is pressed.\n    *\n    * @example\n    * const result = await TJSDialog.prompt({\n    *  title: 'Are you OK?',\n    *  content: '<p>Are you OK?.</p>',\n    *  label: 'Feeling Fine!'\n    *  onOk: () => 'OK'\n    * });\n    *\n    * // Logs 'OK' or null if the user closed the dialog without making a selection.\n    * console.log(result);\n    */\n   static async prompt({ onOk, label, icon = 'fas fa-check', ...data } = {}, options = {})\n   {\n      return this.wait({\n         ...data,\n         buttons: {\n            ok: {\n               icon,\n               label,\n               onPress: (application) => this.#invokeFn(onOk, application, true)\n            }\n         },\n         default: 'ok'\n      }, options);\n   }\n\n   /**\n    * Creates an anonymous data defined TJSDialog returning a Promise that can be awaited upon for the user to make a\n    * choice.\n    *\n    * Note: By default `null` is returned if the dialog is closed without a user making a choice.\n    *\n    * @template T\n    *\n    * @param {TJSDialogOptions}  data - Dialog data passed to the TJSDialog constructor.\n    *\n    * @param {SvelteApplicationOptions}  [options]  SvelteApplication options passed to the TJSDialog constructor.\n    *\n    * @returns {Promise<T>} A Promise that resolves to the chosen result.\n    */\n   static async wait(data, options = {})\n   {\n      if (!isObject(data)) { throw new TypeError(`TJSDialog.wait error: 'data' is not an object'.`); }\n\n      // Instantiate and render the dialog.\n      return new this({ ...data }, options).wait();\n   }\n}\n\n/**\n * @typedef {object} TJSDialogOptions - Defines the common dialog configuration data.\n *\n * @property {Record<string, TJSDialogButtonData>}  [buttons={}] - Provides configuration of the dialog button bar.\n *\n * @property {object|string}  content - A Svelte configuration object or HTML string content.\n *\n * @property {string}   [default] - The default button ID to focus initially.\n *\n * @property {boolean}  [draggable=true] - The dialog is draggable when true.\n *\n * @property {boolean}  [focusAuto=true] - When true auto-management of app focus is enabled.\n *\n * @property {boolean}  [focusFirst=false] - When true the first focusable element that isn't a button is focused.\n *\n * @property {boolean}  [focusKeep=false] - When `focusAuto` and `focusKeep` is true; keeps internal focus.\n *\n * @property {boolean}  [focusTrap=true] - When true focus trapping / wrapping is enabled keeping focus inside app.\n *\n * @property {boolean}  [minimizable=true] - When true the dialog is minimizable.\n *\n * @property {boolean}  [modal=false] - When true a modal dialog is displayed.\n *\n * @property {object}   [modalOptions] - Additional options for modal dialog display.\n *\n * @property {boolean}  [notifyError=true] - When true and an error is raised in dialog callback functions post a UI\n *           error notification.\n *\n * @property {string|((application: TJSDialog) => any)} [onClose] - Callback invoked when dialog is closed; no button\n *           option selected. When defined as a string any matching function by name exported from content Svelte\n *           component is invoked.\n *\n * @property {boolean}  [rejectClose=false] - When true and a Promise has been created by {@link TJSDialog.wait} and\n *           the Promise is not in the process of being resolved or rejected on close of the dialog any `onClose`\n *           function is invoked and any result that is undefined will cause the Promise to then be rejected.\n *\n * @property {boolean}  [resizable=false] - When true the dialog is resizable.\n *\n * @property {boolean}  [resolveId=false] - When true and resolving any Promises and there are undefined results from\n *           any button callbacks the button ID is resolved.\n *\n * @property {string}   [title] - The dialog window title.\n *\n * @property {object}   [transition] - Transition options for the dialog.\n *\n * @property {number|null} [zIndex] - A specific z-index for the dialog. Pass null for the dialog to act like other\n *           applications in regard bringing to top when activated.\n */\n\n/**\n * @typedef {object} TJSDialogButtonData - TJSDialog button data.\n *\n * @property {boolean} [autoClose=true] - When false the dialog does not automatically close when button selected.\n *\n * @property {boolean|(() => boolean)} [condition] - Determines if the button is accessible providing a truthy value.\n *\n * @property {string} [label] - Button label; will be localized.\n *\n * @property {string} [icon] - Button icon; you should supply the direct Font Awesome class names: IE \"fas fa-check\".\n *\n * @property {string|((application: TJSDialog) => any)} [onPress] - Callback for button press. When defined as a\n *           string any matching function by name exported from content Svelte component is invoked.\n *\n * @property {Record<string, string>} [styles] - Inline styles to apply to the button.\n */\n","import { SvelteApplication } from './SvelteApplication.js';\n\nexport * from './SvelteApplication.js';\nexport * from './TJSDialog.js';\n\n// TODO: temporary\nexport * from './position/Position.js';\n\n// Handle `PopOut!` module hooks to allow applications to popout to their own browser window -------------------------\n\nHooks.on('PopOut:loading', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = false; }\n});\n\nHooks.on('PopOut:popin', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = true; }\n});\n\nHooks.on('PopOut:close', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = true; }\n});\n\n/**\n * @typedef {object} MountedAppShell - Application shell contract for Svelte components.\n *\n * @property {HTMLElement} elementRoot - The root element / exported prop.\n *\n * @property {HTMLElement} [elementContent] - The content element / exported prop.\n *\n * @property {HTMLElement} [elementTarget] - The target element / exported prop.\n */\n\n/**\n * @typedef {ApplicationShell} ApplicationShellExt\n *\n * @property {SvelteReactive} reactive -\n *\n * @property {object} options -\n *\n * @property {Position} position -\n */\n\n/**\n * @typedef {object} StoreAppOptions - Provides a custom readable Svelte store for Application options state.\n *\n * @property {import('svelte/store').Readable<object>} subscribe - Subscribe to all app options updates.\n *\n * @property {import('svelte/store').Writable<boolean>} draggable - Derived store for `draggable` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} focusAuto - Derived store for `focusAuto` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} focusKeep - Derived store for `focusKeep` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} focusTrap - Derived store for `focusTrap` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} headerButtonNoClose - Derived store for `headerButtonNoClose`\n *                                                                            updates.\n *\n * @property {import('svelte/store').Writable<boolean>} headerButtonNoLabel - Derived store for `headerButtonNoLabel`\n *                                                                            updates.\n *\n * @property {import('svelte/store').Writable<string>} headerIcon - Derived store for `headerIcon` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} headerNoTitleMinimized - Derived store for\n *                                                                               `headerNoTitleMinimized` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} minimizable - Derived store for `minimizable` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} popOut - Derived store for `popOut` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} positionable - Derived store for `positionable` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} resizable - Derived store for `resizable` updates.\n *\n * @property {import('svelte/store').Writable<string>} title - Derived store for `title` updates.\n */\n\n/**\n * @typedef {object} StoreUIOptions - Provides a custom readable Svelte store for UI options state.\n *\n * @property {import('svelte/store').Readable.subscribe} subscribe - Subscribe to all UI options updates.\n *\n * @property {import('svelte/store').Writable<boolean>} dragging - Derived store for `dragging` updates.\n *\n * @property {import('svelte/store').Readable<ApplicationHeaderButton[]>} headerButtons - Derived store for\n *                                                                                        `headerButtons` updates.\n *\n * @property {import('svelte/store').Readable<boolean>} minimized - Derived store for `minimized` updates.\n *\n * @property {import('svelte/store').Writable<boolean>} resizing - Derived store for `resizing` updates.\n */\n\n/**\n * @typedef {object} TransformData\n *\n * @property {Function} transition - A transition applying to both in & out.\n *\n * @property {Function} inTransition - A transition applying to in.\n *\n * @property {Function} outTransition - A transition applying to out.\n *\n * @property {object}   transitionOptions - The options config object for in & out transitions.\n *\n * @property {object}   inTransitionOptions - The options config object for in transitions.\n *\n * @property {object}   outTransitionOptions - The options config object for out transitions.\n */\n","<script>\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n\r\n  export let key;\r\n  export let data;\r\n  export let disabled = false;\r\n\r\n</script>\r\n\r\n<div class=\"item-pile-setting form-scope item-piles-flexrow\">\r\n\r\n\t<div class=\"label-side\">\r\n\t\t<label>{localize(data.name)} <a>\r\n\t\t\t<i data-tooltip=\"Reset data\" class=\"fas fa-undo reset-setting\"\r\n\t\t\t\t on:click={() => { data.value = data.default; }}></i></a>\r\n\t\t</label>\r\n\t\t<p class=\"notes\">{localize(data.hint)}</p>\r\n\t</div>\r\n\r\n\t<div class=\"form-fields input-side\">\r\n\r\n\t\t{#if data.type === Boolean}\r\n\r\n\t\t\t<input type=\"checkbox\" bind:checked={data.value} disabled={disabled}/>\r\n\r\n\t\t{:else if data.choices}\r\n\r\n\t\t\t<div class=\"choice-container\">\r\n\t\t\t\t<select name={data.key} bind:value={data.value} disabled={disabled}>\r\n\t\t\t\t\t{#each Object.entries(data.choices) as [key, choice], index (index)}\r\n\t\t\t\t\t\t{#if data.type === Number}\r\n\t\t\t\t\t\t\t<option value=\"{index}\">{localize(choice)}</option>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<option value=\"{key}\">{localize(choice)}</option>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\r\n\t\t{:else if data.type === Number}\r\n\r\n\t\t\t<input\r\n\t\t\t\ttype=\"number\"\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tbind:value={data.value}\r\n\t\t\t\tclass:invalid={!data.value && data.value !== 0}\r\n\t\t\t\tstep={data.step}\r\n\t\t\t\tmin={data.min}\r\n\t\t\t\tmax={data.max}\r\n\t\t\t/>\r\n\r\n\t\t{:else}\r\n\r\n\t\t\t<div class=\"item-pile-setting-container\">\r\n\t\t\t\t<input type=\"text\" bind:value={data.value} disabled={disabled}/>\r\n\t\t\t\t{#if data.localize}\r\n\t\t\t\t\t<input type=\"text\" disabled value={localize(data.value)}/>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t{/if}\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-pile-setting:not(:last-child) {\r\n\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.4rem;\r\n    padding-bottom: 0.4rem;\r\n\r\n  }\r\n\t\r\n  .item-pile-setting {\r\n\r\n    .reset-setting {\r\n      font-size: 0.75rem;\r\n      margin-left: 0.5rem;\r\n      opacity: 0.5;\r\n      transition: opacity 250ms;\r\n\r\n      &:hover {\r\n        opacity: 1.0;\r\n      }\r\n    }\r\n\r\n    .invalid {\r\n      border: 2px solid #d93131;\r\n    }\r\n\r\n    label {\r\n      flex: 1 0 auto;\r\n    }\r\n\r\n    .form-fields {\r\n      flex: 0 1 auto;\r\n      align-self: center;\r\n    }\r\n\r\n    select {\r\n      min-width: 200px;\r\n    }\r\n\r\n    .item-pile-setting-container {\r\n      min-width: 200px;\r\n      display: flex;\r\n      flex-direction: column;\r\n\r\n      input:first-child {\r\n        margin-bottom: 0.25rem;\r\n      }\r\n    }\r\n\r\n    .label-side {\r\n      flex: 1;\r\n      margin-right: 1rem;\r\n    }\r\n\r\n    .choice-container {\r\n      max-width: 400px;\r\n    }\r\n\r\n    input[type=\"number\"] {\r\n      min-width: 100px;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  export let value;\r\n  export let type;\r\n  export let placeholder = \"\";\r\n  export let showImage = false;\r\n  export let showInput = true;\r\n\r\n  let filePicker = false;\r\n\r\n  function handleClick() {\r\n    if (!filePicker) {\r\n      filePicker = new FilePicker({\r\n        type: type,\r\n        current: value,\r\n        callback: path => {\r\n          value = path;\r\n          filePicker = false;\r\n        }\r\n      });\r\n    }\r\n\r\n    filePicker.render(true, { focus: true });\r\n  }\r\n\r\n</script>\r\n\r\n<div>\r\n\t{#if showImage}\r\n\t\t<div class=\"item-piles-img-container\">\r\n\t\t\t<img class=\"item-piles-img\" src={value}/>\r\n\t\t</div>\r\n\t{/if}\r\n\t{#if showInput}\r\n\t\t<input type=\"text\" placeholder=\"{placeholder}\" bind:value=\"{value}\"/>\r\n\t{/if}\r\n\t<button on:click={handleClick} type=\"button\"><i class=\"fas fa-file-import\"></i></button>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n    width: 100%;\r\n    display: inline-flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem !important;\r\n      flex: 0;\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  export let callback;\r\n  export let isHovering;\r\n  export let active = true;\r\n  export let enterCallback = () => {\r\n  };\r\n  export let overCallback = () => {\r\n  };\r\n  export let leaveCallback = () => {\r\n  };\r\n\r\n  function dropData(event, ...args) {\r\n    if (!active) return;\r\n    counter = 0;\r\n    let data;\r\n    try {\r\n      data = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n    callback(data, event, ...args);\r\n  }\r\n\r\n  let counter = 0;\r\n\r\n  function enter(event) {\r\n    if (!active) return;\r\n    counter++;\r\n    if (counter === 1) {\r\n      enterCallback(event);\r\n    }\r\n  }\r\n\r\n  function leave(event) {\r\n    if (!active) return;\r\n    counter--;\r\n    if (counter === 0) {\r\n      leaveCallback(event);\r\n    }\r\n  }\r\n\r\n  $: isHovering = counter > 0;\r\n\r\n</script>\r\n\r\n<div\r\n  on:dragenter={enter}\r\n  on:dragleave={leave}\r\n  on:dragstart|preventDefault\r\n  on:dragover={overCallback}\r\n  on:drop|preventDefault={dropData}\r\n  style={$$props.style}\r\n>\r\n  <slot/>\r\n</div>\r\n","<script>\r\n  import FilePicker from \"../../components/FilePicker.svelte\";\r\n  import DropZone from \"../../components/DropZone.svelte\";\r\n  import * as Helpers from \"../../../helpers/helpers.js\";\r\n  import { applyStyles } from '@typhonjs-fvtt/runtime/svelte/action';\r\n\r\n  export let store;\r\n\r\n  const currenciesStore = store.currencies;\r\n  let isHovering = false;\r\n\r\n  $: currencies = $currenciesStore;\r\n  $: {\r\n    $currenciesStore;\r\n    store.sortCurrencies();\r\n  }\r\n\r\n  async function dropData(data) {\r\n\r\n    if (!data.type) {\r\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n    }\r\n\r\n    if (data.type !== \"Item\") {\r\n      throw Helpers.custom_error(\"You must drop an item, not \" + data.type.toLowerCase() + \"!\")\r\n    }\r\n\r\n    store.addItem(data);\r\n\r\n  }\r\n\r\n  $: style = {\r\n    \"grid-template-columns\": `${store.secondary ? \"\" : \"28px\"} 1.25fr ${store.secondary ? \"\" : \"60px\"} 0.5fr 60px 1fr 28px`\r\n  }\r\n\r\n</script>\r\n\r\n<DropZone callback={dropData} bind:isHovering={isHovering}>\r\n\t<div class=\"item-piles-sortable-list-columns header\" use:applyStyles={style}>\r\n\t\t{#if !store.secondary}\r\n\t\t\t<div style=\"justify-content:flex-start;\">Primary</div>\r\n\t\t{/if}\r\n\t\t<div>Name</div>\r\n\t\t{#if !store.secondary}\r\n\t\t\t<div>Exchange</div>\r\n\t\t{/if}\r\n\t\t<div>Short</div>\r\n\t\t<div>Icon</div>\r\n\t\t<div>Data</div>\r\n\t\t<div><a on:click={() => store.addAttribute()}><i class=\"fas fa-plus\"></i></a></div>\r\n\t</div>\r\n\t<div class=\"table-container\">\r\n\t\t{#if isHovering}\r\n\t\t\t<div class=\"drop-to-add\">Drop to add</div>\r\n\t\t{/if}\r\n\t\t{#if !currencies.length}\r\n\t\t\t<div class=\"item-piles-sortable-list-columns\">\r\n\t\t\t\t<div class=\"full-span\" class:invisible={isHovering}>\r\n\t\t\t\t\tDrop an item or click the plus button to get started!\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t\t{#each currencies as item, index (item.id)}\r\n\t\t\t<div class=\"item-piles-sortable-list-columns\" use:applyStyles={style}>\r\n\t\t\t\t{#if !store.secondary}\r\n\t\t\t\t\t<div><input type=\"checkbox\" checked={item.primary} on:change={() => store.setPrimary(index)}/></div>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<div><input type=\"text\" bind:value={item.name}/></div>\r\n\t\t\t\t{#if !store.secondary}\r\n\t\t\t\t\t<div><input type=\"number\" step=\"0.000000001\" bind:value={item.exchangeRate}/></div>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<div><input type=\"text\" bind:value={item.abbreviation}/></div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<FilePicker type=\"imagevideo\" showImage={true} showInput={false} bind:value={item.img}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{#if item.type === \"attribute\"}\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={item.data.path} placeholder=\"system.attributes.hp.value\"/>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => store.editItem(index)}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-eye\"></i> View item\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<button type=\"button\" class=\"delete-button\" on:click={() => store.removeEntry(index)}>\r\n\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\t</div>\r\n</DropZone>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-sortable-list-columns {\r\n\r\n    .full-span {\r\n      padding: 2rem 1rem;\r\n      grid-column: 1/-1;\r\n      font-size: 1.5rem;\r\n      border-radius: 5px;\r\n      border: 2px dashed rgba(0, 0, 0, 0.35);\r\n    }\r\n  }\r\n\r\n  .invisible {\r\n    opacity: 0;\r\n  }\r\n\r\n  .table-container {\r\n    position: relative;\r\n  }\r\n\r\n  .drop-to-add {\r\n    position: absolute;\r\n    top: 0;\r\n    bottom: 0;\r\n    right: 0;\r\n    left: 0;\r\n    border-radius: 5px;\r\n    box-shadow: inset 0 0 15px 5px rgb(0, 0, 0, 0.5);\r\n    background-color: rgba(255, 255, 255, 0.75);\r\n    z-index: 100000;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-size: 2rem;\r\n  }\r\n\r\n</style>\r\n","import { writable, get } from 'svelte/store';\r\nimport * as Utilities from \"../../../helpers/utilities.js\";\r\nimport CONSTANTS from \"../../../constants/constants.js\";\r\nimport * as Helpers from \"../../../helpers/helpers.js\";\r\nimport { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\nexport default class CurrencyStore {\r\n\r\n  constructor(data, secondary = false) {\r\n    this.secondary = secondary;\r\n    this.currencies = writable(data.map((entry, index) => {\r\n      return {\r\n        ...entry,\r\n        index,\r\n        id: entry.data?.path ?? entry.data?._id ?? randomID()\r\n      }\r\n    }));\r\n  }\r\n\r\n  setPrimary(index) {\r\n    if (this.secondary) return;\r\n    this.currencies.update(currencies => {\r\n      currencies.forEach((entry, entryIndex) => {\r\n        entry.primary = entryIndex === index;\r\n      });\r\n      return currencies;\r\n    });\r\n  }\r\n\r\n  sortCurrencies() {\r\n    if (this.secondary) return;\r\n    this.currencies.update(currencies => {\r\n      currencies.sort((a, b) => {\r\n        return b.exchangeRate - a.exchangeRate;\r\n      });\r\n      return currencies;\r\n    });\r\n  }\r\n\r\n  addAttribute() {\r\n    this.currencies.update(currencies => {\r\n      currencies.push(foundry.utils.mergeObject({\r\n        type: \"attribute\",\r\n        name: \"New Attribute\",\r\n        img: \"\",\r\n        abbreviation: \"{#}N\",\r\n        data: {\r\n          path: \"\"\r\n        }\r\n      }, this.secondary ? {} : {\r\n        primary: !currencies.length,\r\n        exchangeRate: 1\r\n      }));\r\n      return currencies;\r\n    });\r\n  }\r\n\r\n  async addItem(data) {\r\n\r\n    let uuid = false;\r\n    if (data.pack) {\r\n      uuid = \"Compendium\" + data.pack + \".\" + data.id;\r\n    }\r\n\r\n    let item = await Item.implementation.fromDropData(data);\r\n    let itemData = item.toObject();\r\n\r\n    if (!itemData) {\r\n      console.error(data);\r\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n    }\r\n\r\n    this.currencies.update(currencies => {\r\n      const itemCurrencies = currencies.map(entry => entry.data?.item ?? {});\r\n      const foundItem = Utilities.findSimilarItem(itemCurrencies, itemData);\r\n      if (foundItem) {\r\n        const index = itemCurrencies.indexOf(foundItem);\r\n        currencies[index].data = {\r\n          uuid,\r\n          item: itemData\r\n        }\r\n        Helpers.custom_notify(`Updated item data for ${localize(currencies[index].name)} (item name ${itemData.name})`)\r\n      } else {\r\n        currencies.push(foundry.utils.mergeObject({\r\n          id: randomID(),\r\n          type: \"item\",\r\n          name: itemData.name,\r\n          img: itemData.img,\r\n          abbreviation: \"{#} \" + itemData.name,\r\n          data: {\r\n            uuid,\r\n            item: itemData\r\n          },\r\n        }, this.secondary ? {} : {\r\n          primary: !currencies.length,\r\n          exchangeRate: 1\r\n        }));\r\n      }\r\n      return currencies;\r\n    });\r\n  }\r\n\r\n  async editItem(index) {\r\n    const currencies = get(this.currencies);\r\n    const data = currencies[index].data;\r\n    let item;\r\n    if (data.uuid) {\r\n      item = await fromUuid(data.uuid);\r\n    } else {\r\n      let itemData = data.item;\r\n      if (itemData._id) delete itemData._id;\r\n      if (itemData.ownership) delete itemData.ownership;\r\n      const items = Array.from(game.items);\r\n      item = Utilities.findSimilarItem(items, itemData);\r\n      if (!item) {\r\n        setProperty(itemData, CONSTANTS.FLAGS.TEMPORARY_ITEM, true);\r\n        item = await Item.implementation.create(itemData);\r\n        Helpers.custom_notify(`An item has been created for ${item.name} - drag and drop it into the list to update the stored item data`)\r\n      }\r\n    }\r\n    item.sheet.render(true);\r\n  }\r\n\r\n  removeEntry(index) {\r\n    this.currencies.update(currencies => {\r\n      currencies.splice(index, 1);\r\n      return currencies;\r\n    })\r\n  }\r\n\r\n  export() {\r\n    return get(this.currencies);\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import { ApplicationShell } from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { getSetting } from \"../../../helpers/helpers.js\";\r\n  import SETTINGS from \"../../../constants/settings.js\";\r\n  import CurrencyList from \"./CurrencyList.svelte\";\r\n  import CurrencyStore from \"./currency-store.js\"\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let data;\r\n  export let secondary = false\r\n\r\n  export let elementRoot;\r\n\r\n  const store = new CurrencyStore(data || getSetting(SETTINGS.CURRENCIES), secondary);\r\n\r\n  let form;\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(store.export());\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\r\n\t\t<p>{localize(`ITEM-PILES.Applications.${secondary ? \"Secondary\" : \"\"}CurrenciesEditor.Explanation`)}</p>\r\n\r\n\t\t<p class=\"small\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.CurrenciesEditor.ExplanationSmallAttributes\")}\r\n\t\t</p>\r\n\r\n\t\t<p class=\"small item-piles-bottom-divider\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.CurrenciesEditor.ExplanationSmallItems\")}\r\n\t\t</p>\r\n\r\n\t\t<CurrencyList {store}/>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  form {\r\n    padding: 0 0.25rem;\r\n    position: relative;\r\n  }\r\n\r\n  footer {\r\n    border-top: 1px solid rgba(0, 0, 0, 0.5);\r\n    margin-top: 0.5rem;\r\n    padding-top: 0.5rem;\r\n    display: flex;\r\n  }\r\n\r\n  .small {\r\n    font-size: 0.75rem;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { getActiveApps } from \"../../helpers/helpers.js\";\r\n\r\nexport default class Editor extends SvelteApplication {\r\n\r\n  constructor(data, options) {\r\n    super({\r\n      svelte: {\r\n        props: {\r\n          data\r\n        }\r\n      },\r\n      ...options\r\n    });\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 400,\r\n      height: \"auto\",\r\n      classes: [\"item-piles-app\"],\r\n      close: () => this.options.resolve(null),\r\n      svelte: {\r\n        target: document.body,\r\n      }\r\n    })\r\n  }\r\n\r\n  static async show(data, options = {}) {\r\n    const app = options?.id ? getActiveApps(options?.id, true) : false;\r\n    if (app) return app.render(false, { focus: true });\r\n    return new Promise(resolve => {\r\n      options.resolve = resolve;\r\n      return new this(data, options).render(true, { focus: true });\r\n    });\r\n  }\r\n}\r\n","import CurrenciesEditorShell from './currencies-editor-shell.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport class CurrenciesEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.CurrenciesEditor.Title\"),\r\n      width: 630,\r\n      svelte: {\r\n        class: CurrenciesEditorShell,\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport class SecondaryCurrenciesEditor extends CurrenciesEditor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.SecondaryCurrenciesEditor.Title\"),\r\n      svelte: {\r\n        props: {\r\n          secondary: true\r\n        }\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n\r\n  import { getSetting, setSetting } from \"../../../helpers/helpers.js\";\r\n  import SETTINGS from \"../../../constants/settings.js\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { get, writable } from \"svelte/store\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let data;\r\n  export let elementRoot;\r\n\r\n  let form;\r\n\r\n  const itemFilters = writable(data ? data : getSetting(SETTINGS.ITEM_FILTERS))\r\n\r\n  function add() {\r\n    itemFilters.update(val => {\r\n      val.push({ path: \"\", filters: \"\" });\r\n      return val;\r\n    })\r\n  }\r\n\r\n  function remove(index) {\r\n    itemFilters.update(val => {\r\n      val.splice(index, 1)\r\n      return val;\r\n    })\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(get(itemFilters));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.FilterEditor.Explanation\")}</p>\r\n\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>{localize(\"ITEM-PILES.Applications.FilterEditor.Path\")}</th>\r\n\t\t\t\t<th>{localize(\"ITEM-PILES.Applications.FilterEditor.Filters\")}</th>\r\n\t\t\t\t<th class=\"custom-small\"><a on:click={add} class=\"item-piles-clickable\"><i class=\"fas fa-plus\"></i></a></th>\r\n\t\t\t</tr>\r\n\t\t\t{#each $itemFilters as { path, filters }, index (index)}\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td><input type=\"text\" required placeholder=\"type\" bind:value=\"{path}\"/></td>\r\n\t\t\t\t\t<td><input type=\"text\" required placeholder=\"class, spell, feat\" bind:value=\"{filters}\"/></td>\r\n\t\t\t\t\t<td class=\"custom-small\">\r\n\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t{/each}\r\n\t\t</table>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .custom-small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import ItemFiltersShell from './item-filters-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class ItemFiltersEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: \"ITEM-PILES.Applications.FilterEditor.Title\",\r\n      svelte: {\r\n        class: ItemFiltersShell,\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { get, writable } from \"svelte/store\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  let form;\r\n\r\n  export let elementRoot;\r\n  export let data;\r\n\r\n  const keyValuePair = application.options?.keyValuePair ?? false;\r\n  const stringListStore = writable(data);\r\n\r\n  function add() {\r\n    stringListStore.update(val => {\r\n      if (keyValuePair) {\r\n        val.push([\"\", \"\"]);\r\n      } else {\r\n        val.push(\"\");\r\n      }\r\n      return val;\r\n    })\r\n  }\r\n\r\n  function remove(index) {\r\n    stringListStore.update(val => {\r\n      val.splice(index, 1);\r\n      return val;\r\n    })\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(get(stringListStore));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\r\n\t\t{#if application.options.content}\r\n\t\t\t<p>{localize(application.options.content)}</p>\r\n\t\t{/if}\r\n\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t{#if keyValuePair}\r\n\t\t\t\t\t<th>{localize(application.options?.columnKey)}</th>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<th>{localize(application.options?.column)}</th>\r\n\t\t\t\t<th class=\"small\"><a on:click={add} class=\"item-piles-clickable\"><i class=\"fas fa-plus\"></i></a></th>\r\n\t\t\t</tr>\r\n\t\t\t{#if keyValuePair}\r\n\t\t\t\t{#each $stringListStore as [key, path], index (index)}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><input type=\"text\" required bind:value=\"{key}\"/></td>\r\n\t\t\t\t\t\t<td><input type=\"text\" bind:value=\"{path}\"/></td>\r\n\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t{:else}\r\n\t\t\t\t{#each $stringListStore as path, index (index)}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><input type=\"text\" required bind:value=\"{path}\"/></td>\r\n\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t{/if}\r\n\t\t</table>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import StringListEditorShell from './string-list-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class StringListEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      svelte: {\r\n        class: StringListEditorShell\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  export let value;\r\n  export let min = 0;\r\n  export let max = 200;\r\n  export let maxInput = Infinity;\r\n  export let step = 1;\r\n  export let divideBy = 100;\r\n\r\n  let displayValue = value * divideBy;\r\n\r\n  $: {\r\n    value = displayValue / divideBy;\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"slider-group\" style={$$props.style}>\r\n  <input type=\"range\" {min} {step} {max} bind:value=\"{displayValue}\"/>\r\n  <input type=\"number\" {min} {step} max={maxInput} required bind:value=\"{displayValue}\"/>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .slider-group {\r\n    display: flex;\r\n    align-items: center;\r\n    flex: 3;\r\n\r\n    input[type=\"range\"] {\r\n      flex: 3;\r\n    }\r\n\r\n    input[type=\"number\"] {\r\n      flex: 0 1 40px;\r\n      margin-left: 1rem;\r\n      height: 20px;\r\n      font-size: 0.8rem;\r\n    }\r\n  }\r\n\r\n</style>","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import SliderInput from \"../../components/SliderInput.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { getSourceActorFromDropData, getUuid } from \"../../../helpers/utilities.js\";\r\n  import { get, writable } from \"svelte/store\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  let form;\r\n\r\n  export let data;\r\n  export let elementRoot;\r\n\r\n  const priceModifiers = writable(data.map(data => {\r\n    data.actor = globalThis.fromUuidSync(data.actorUuid);\r\n    if (!data.actor) return false;\r\n    return data;\r\n  }).filter(Boolean));\r\n\r\n  function remove(index) {\r\n    priceModifiers.update(val => {\r\n      val.splice(index, 1)\r\n      return val;\r\n    })\r\n  }\r\n\r\n  async function updateSettings() {\r\n    let result = get(priceModifiers);\r\n    result.forEach(data => {\r\n      data.actorUuid = getUuid(data.actor);\r\n    })\r\n    application.options.resolve?.(result);\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  async function dropData(event) {\r\n\r\n    event.preventDefault();\r\n\r\n    let data;\r\n    try {\r\n      data = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n\r\n    if (data.type !== \"Actor\") return;\r\n\r\n    const actor = getSourceActorFromDropData(data);\r\n\r\n    if (!actor) return;\r\n\r\n    priceModifiers.update(val => {\r\n\r\n      if (val.find(data => data.actor === actor)) return val;\r\n\r\n      val.push({\r\n        override: false,\r\n        actor: actor,\r\n        buyPriceModifier: 1,\r\n        sellPriceModifier: 0.5\r\n      });\r\n\r\n      return val;\r\n\r\n    })\r\n  }\r\n\r\n  function preventDefault(event) {\r\n    event.preventDefault();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Explanation\")}</p>\r\n\r\n\t\t<div on:dragstart={preventDefault} on:drop={dropData} on:dragover={preventDefault}\r\n\t\t\t\t class:border-highlight={!$priceModifiers.length}>\r\n\r\n\t\t\t{#if $priceModifiers.length}\r\n\t\t\t\t<table>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th style=\"width:5%;\">{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Override\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:25%;\">{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Actor\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:5%;\"></th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t{#each $priceModifiers as priceData, index (index)}\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={priceData.override}>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<a class=\"item-piles-actor-name-clickable\"\r\n\t\t\t\t\t\t\t\t\t on:click={(priceData.actor.sheet.render(true, { bypassItemPiles: true }))}>{priceData.actor.name}</a>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t\t<SliderInput bind:value={priceData.buyPriceModifier}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t\t<SliderInput bind:value={priceData.sellPriceModifier}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</table>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<p class=\"item-piles-text-center\">{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.DragDrop\")}</p>\r\n\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .border-highlight {\r\n    padding: 1rem;\r\n    margin: 0.25rem;\r\n    border-radius: 10px;\r\n    border: 2px dashed gray;\r\n  }\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import PriceModifiersEditorShell from './price-modifiers-editor-shell.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class PriceModifiersEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Title\"),\r\n      width: 600,\r\n      svelte: {\r\n        class: PriceModifiersEditorShell\r\n      }\r\n    })\r\n  }\r\n}\r\n","import { cubicOut } from '../easing/index.mjs';\nimport { is_function } from '../internal/index.mjs';\n\nfunction flip(node, { from, to }, params = {}) {\n    const style = getComputedStyle(node);\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const [ox, oy] = style.transformOrigin.split(' ').map(parseFloat);\n    const dx = (from.left + from.width * ox / to.width) - (to.left + ox);\n    const dy = (from.top + from.height * oy / to.height) - (to.top + oy);\n    const { delay = 0, duration = (d) => Math.sqrt(d) * 120, easing = cubicOut } = params;\n    return {\n        delay,\n        duration: is_function(duration) ? duration(Math.sqrt(dx * dx + dy * dy)) : duration,\n        easing,\n        css: (t, u) => {\n            const x = u * dx;\n            const y = u * dy;\n            const sx = t + u * from.width / to.width;\n            const sy = t + u * from.height / to.height;\n            return `transform: ${transform} translate(${x}px, ${y}px) scale(${sx}, ${sy});`;\n        }\n    };\n}\n\nexport { flip };\n","// external events\nconst FINALIZE_EVENT_NAME = \"finalize\";\nconst CONSIDER_EVENT_NAME = \"consider\";\n\n/**\n * @typedef {Object} Info\n * @property {string} trigger\n * @property {string} id\n * @property {string} source\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\nexport function dispatchFinalizeEvent(el, items, info) {\n    el.dispatchEvent(\n        new CustomEvent(FINALIZE_EVENT_NAME, {\n            detail: {items, info}\n        })\n    );\n}\n\n/**\n * Dispatches a consider event\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\nexport function dispatchConsiderEvent(el, items, info) {\n    el.dispatchEvent(\n        new CustomEvent(CONSIDER_EVENT_NAME, {\n            detail: {items, info}\n        })\n    );\n}\n\n// internal events\nexport const DRAGGED_ENTERED_EVENT_NAME = \"draggedEntered\";\nexport const DRAGGED_LEFT_EVENT_NAME = \"draggedLeft\";\nexport const DRAGGED_OVER_INDEX_EVENT_NAME = \"draggedOverIndex\";\nexport const DRAGGED_LEFT_DOCUMENT_EVENT_NAME = \"draggedLeftDocument\";\n\nexport const DRAGGED_LEFT_TYPES = {\n    LEFT_FOR_ANOTHER: \"leftForAnother\",\n    OUTSIDE_OF_ANY: \"outsideOfAny\"\n};\n\nexport function dispatchDraggedElementEnteredContainer(containerEl, indexObj, draggedEl) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_ENTERED_EVENT_NAME, {\n            detail: {indexObj, draggedEl}\n        })\n    );\n}\n\n/**\n * @param containerEl - the dropzone the element left\n * @param draggedEl - the dragged element\n * @param theOtherDz - the new dropzone the element entered\n */\nexport function dispatchDraggedElementLeftContainerForAnother(containerEl, draggedEl, theOtherDz) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n            detail: {draggedEl, type: DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER, theOtherDz}\n        })\n    );\n}\n\nexport function dispatchDraggedElementLeftContainerForNone(containerEl, draggedEl) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n            detail: {draggedEl, type: DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY}\n        })\n    );\n}\nexport function dispatchDraggedElementIsOverIndex(containerEl, indexObj, draggedEl) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_OVER_INDEX_EVENT_NAME, {\n            detail: {indexObj, draggedEl}\n        })\n    );\n}\nexport function dispatchDraggedLeftDocument(draggedEl) {\n    window.dispatchEvent(\n        new CustomEvent(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, {\n            detail: {draggedEl}\n        })\n    );\n}\n","import {DRAGGED_ENTERED_EVENT_NAME, DRAGGED_LEFT_EVENT_NAME, DRAGGED_OVER_INDEX_EVENT_NAME} from \"./helpers/dispatcher\";\n\nexport const TRIGGERS = {\n    DRAG_STARTED: \"dragStarted\",\n    DRAGGED_ENTERED: DRAGGED_ENTERED_EVENT_NAME,\n    DRAGGED_ENTERED_ANOTHER: \"dragEnteredAnother\",\n    DRAGGED_OVER_INDEX: DRAGGED_OVER_INDEX_EVENT_NAME,\n    DRAGGED_LEFT: DRAGGED_LEFT_EVENT_NAME,\n    DRAGGED_LEFT_ALL: \"draggedLeftAll\",\n    DROPPED_INTO_ZONE: \"droppedIntoZone\",\n    DROPPED_INTO_ANOTHER: \"droppedIntoAnother\",\n    DROPPED_OUTSIDE_OF_ANY: \"droppedOutsideOfAny\",\n    DRAG_STOPPED: \"dragStopped\"\n};\n\nexport const SOURCES = {\n    POINTER: \"pointer\",\n    KEYBOARD: \"keyboard\"\n};\n\nexport const SHADOW_ITEM_MARKER_PROPERTY_NAME = \"isDndShadowItem\";\nexport const SHADOW_ELEMENT_ATTRIBUTE_NAME = \"data-is-dnd-shadow-item\";\nexport const SHADOW_PLACEHOLDER_ITEM_ID = \"id:dnd-shadow-placeholder-0000\";\nexport const DRAGGED_ELEMENT_ID = \"dnd-action-dragged-el\";\n\nexport let ITEM_ID_KEY = \"id\";\nlet activeDndZoneCount = 0;\nexport function incrementActiveDropZoneCount() {\n    activeDndZoneCount++;\n}\nexport function decrementActiveDropZoneCount() {\n    if (activeDndZoneCount === 0) {\n        throw new Error(\"Bug! trying to decrement when there are no dropzones\");\n    }\n    activeDndZoneCount--;\n}\n\n/**\n * Allows using another key instead of \"id\" in the items data. This is global and applies to all dndzones.\n * Has to be called when there are no rendered dndzones whatsoever.\n * @param {String} newKeyName\n * @throws {Error} if it was called when there are rendered dndzones or if it is given the wrong type (not a string)\n */\nexport function overrideItemIdKeyNameBeforeInitialisingDndZones(newKeyName) {\n    if (activeDndZoneCount > 0) {\n        throw new Error(\"can only override the id key before initialising any dndzone\");\n    }\n    if (typeof newKeyName !== \"string\") {\n        throw new Error(\"item id key has to be a string\");\n    }\n    printDebug(() => [\"overriding item id key name\", newKeyName]);\n    ITEM_ID_KEY = newKeyName;\n}\n\nexport const isOnServer = typeof window === \"undefined\";\n\nexport let printDebug = () => {};\n\n/**\n * Allows the user to show/hide console debug output\n * * @param {Boolean} isDebug\n */\nexport function setDebugMode(isDebug) {\n    if (isDebug) {\n        printDebug = (generateMessage, logFunction = console.debug) => {\n            const message = generateMessage();\n            if (Array.isArray(message)) {\n                logFunction(...message);\n            } else {\n                logFunction(message);\n            }\n        };\n    } else {\n        printDebug = () => {};\n    }\n}\n","// This is based off https://stackoverflow.com/questions/27745438/how-to-compute-getboundingclientrect-without-considering-transforms/57876601#57876601\n// It removes the transforms that are potentially applied by the flip animations\n/**\n * Gets the bounding rect but removes transforms (ex: flip animation)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\nexport function getBoundingRectNoTransforms(el) {\n    let ta;\n    const rect = el.getBoundingClientRect();\n    const style = getComputedStyle(el);\n    const tx = style.transform;\n\n    if (tx) {\n        let sx, sy, dx, dy;\n        if (tx.startsWith(\"matrix3d(\")) {\n            ta = tx.slice(9, -1).split(/, /);\n            sx = +ta[0];\n            sy = +ta[5];\n            dx = +ta[12];\n            dy = +ta[13];\n        } else if (tx.startsWith(\"matrix(\")) {\n            ta = tx.slice(7, -1).split(/, /);\n            sx = +ta[0];\n            sy = +ta[3];\n            dx = +ta[4];\n            dy = +ta[5];\n        } else {\n            return rect;\n        }\n\n        const to = style.transformOrigin;\n        const x = rect.x - dx - (1 - sx) * parseFloat(to);\n        const y = rect.y - dy - (1 - sy) * parseFloat(to.slice(to.indexOf(\" \") + 1));\n        const w = sx ? rect.width / sx : el.offsetWidth;\n        const h = sy ? rect.height / sy : el.offsetHeight;\n        return {\n            x: x,\n            y: y,\n            width: w,\n            height: h,\n            top: y,\n            right: x + w,\n            bottom: y + h,\n            left: x\n        };\n    } else {\n        return rect;\n    }\n}\n\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position and removes transforms)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\nexport function getAbsoluteRectNoTransforms(el) {\n    const rect = getBoundingRectNoTransforms(el);\n    return {\n        top: rect.top + window.scrollY,\n        bottom: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        right: rect.right + window.scrollX\n    };\n}\n\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\nexport function getAbsoluteRect(el) {\n    const rect = el.getBoundingClientRect();\n    return {\n        top: rect.top + window.scrollY,\n        bottom: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        right: rect.right + window.scrollX\n    };\n}\n\n/**\n * finds the center :)\n * @typedef {Object} Rect\n * @property {number} top\n * @property {number} bottom\n * @property {number} left\n * @property {number} right\n * @param {Rect} rect\n * @return {{x: number, y: number}}\n */\nexport function findCenter(rect) {\n    return {\n        x: (rect.left + rect.right) / 2,\n        y: (rect.top + rect.bottom) / 2\n    };\n}\n\n/**\n * @typedef {Object} Point\n * @property {number} x\n * @property {number} y\n * @param {Point} pointA\n * @param {Point} pointB\n * @return {number}\n */\nfunction calcDistance(pointA, pointB) {\n    return Math.sqrt(Math.pow(pointA.x - pointB.x, 2) + Math.pow(pointA.y - pointB.y, 2));\n}\n\n/**\n * @param {Point} point\n * @param {Rect} rect\n * @return {boolean|boolean}\n */\nexport function isPointInsideRect(point, rect) {\n    return point.y <= rect.bottom && point.y >= rect.top && point.x >= rect.left && point.x <= rect.right;\n}\n\n/**\n * find the absolute coordinates of the center of a dom element\n * @param el {HTMLElement}\n * @returns {{x: number, y: number}}\n */\nexport function findCenterOfElement(el) {\n    return findCenter(getAbsoluteRect(el));\n}\n\n/**\n * @param {HTMLElement} elA\n * @param {HTMLElement} elB\n * @return {boolean}\n */\nexport function isCenterOfAInsideB(elA, elB) {\n    const centerOfA = findCenterOfElement(elA);\n    const rectOfB = getAbsoluteRectNoTransforms(elB);\n    return isPointInsideRect(centerOfA, rectOfB);\n}\n\n/**\n * @param {HTMLElement|ChildNode} elA\n * @param {HTMLElement|ChildNode} elB\n * @return {number}\n */\nexport function calcDistanceBetweenCenters(elA, elB) {\n    const centerOfA = findCenterOfElement(elA);\n    const centerOfB = findCenterOfElement(elB);\n    return calcDistance(centerOfA, centerOfB);\n}\n\n/**\n * @param {HTMLElement} el - the element to check\n * @returns {boolean} - true if the element in its entirety is off screen including the scrollable area (the normal dom events look at the mouse rather than the element)\n */\nexport function isElementOffDocument(el) {\n    const rect = getAbsoluteRect(el);\n    return rect.right < 0 || rect.left > document.documentElement.scrollWidth || rect.bottom < 0 || rect.top > document.documentElement.scrollHeight;\n}\n\n/**\n * If the point is inside the element returns its distances from the sides, otherwise returns null\n * @param {Point} point\n * @param {HTMLElement} el\n * @return {null|{top: number, left: number, bottom: number, right: number}}\n */\nexport function calcInnerDistancesBetweenPointAndSidesOfElement(point, el) {\n    const rect = getAbsoluteRect(el);\n    if (!isPointInsideRect(point, rect)) {\n        return null;\n    }\n    return {\n        top: point.y - rect.top,\n        bottom: rect.bottom - point.y,\n        left: point.x - rect.left,\n        // TODO - figure out what is so special about right (why the rect is too big)\n        right: Math.min(rect.right, document.documentElement.clientWidth) - point.x\n    };\n}\n","import {isCenterOfAInsideB, calcDistanceBetweenCenters, getAbsoluteRectNoTransforms, isPointInsideRect, findCenterOfElement} from \"./intersection\";\nimport {printDebug, SHADOW_ELEMENT_ATTRIBUTE_NAME} from \"../constants\";\n\nlet dzToShadowIndexToRect;\n\n/**\n * Resets the cache that allows for smarter \"would be index\" resolution. Should be called after every drag operation\n */\nexport function resetIndexesCache() {\n    printDebug(() => \"resetting indexes cache\");\n    dzToShadowIndexToRect = new Map();\n}\nresetIndexesCache();\n\n/**\n * Resets the cache that allows for smarter \"would be index\" resolution for a specific dropzone, should be called after the zone was scrolled\n * @param {HTMLElement} dz\n */\nexport function resetIndexesCacheForDz(dz) {\n    printDebug(() => \"resetting indexes cache for dz\");\n    dzToShadowIndexToRect.delete(dz);\n}\n\n/**\n * Caches the coordinates of the shadow element when it's in a certain index in a certain dropzone.\n * Helpful in order to determine \"would be index\" more effectively\n * @param {HTMLElement} dz\n * @return {number} - the shadow element index\n */\nfunction cacheShadowRect(dz) {\n    const shadowElIndex = Array.from(dz.children).findIndex(child => child.getAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME));\n    if (shadowElIndex >= 0) {\n        if (!dzToShadowIndexToRect.has(dz)) {\n            dzToShadowIndexToRect.set(dz, new Map());\n        }\n        dzToShadowIndexToRect.get(dz).set(shadowElIndex, getAbsoluteRectNoTransforms(dz.children[shadowElIndex]));\n        return shadowElIndex;\n    }\n    return undefined;\n}\n\n/**\n * @typedef {Object} Index\n * @property {number} index - the would be index\n * @property {boolean} isProximityBased - false if the element is actually over the index, true if it is not over it but this index is the closest\n */\n/**\n * Find the index for the dragged element in the list it is dragged over\n * @param {HTMLElement} floatingAboveEl\n * @param {HTMLElement} collectionBelowEl\n * @returns {Index|null} -  if the element is over the container the Index object otherwise null\n */\nexport function findWouldBeIndex(floatingAboveEl, collectionBelowEl) {\n    if (!isCenterOfAInsideB(floatingAboveEl, collectionBelowEl)) {\n        return null;\n    }\n    const children = collectionBelowEl.children;\n    // the container is empty, floating element should be the first\n    if (children.length === 0) {\n        return {index: 0, isProximityBased: true};\n    }\n    const shadowElIndex = cacheShadowRect(collectionBelowEl);\n\n    // the search could be more efficient but keeping it simple for now\n    // a possible improvement: pass in the lastIndex it was found in and check there first, then expand from there\n    for (let i = 0; i < children.length; i++) {\n        if (isCenterOfAInsideB(floatingAboveEl, children[i])) {\n            const cachedShadowRect = dzToShadowIndexToRect.has(collectionBelowEl) && dzToShadowIndexToRect.get(collectionBelowEl).get(i);\n            if (cachedShadowRect) {\n                if (!isPointInsideRect(findCenterOfElement(floatingAboveEl), cachedShadowRect)) {\n                    return {index: shadowElIndex, isProximityBased: false};\n                }\n            }\n            return {index: i, isProximityBased: false};\n        }\n    }\n    // this can happen if there is space around the children so the floating element has\n    //entered the container but not any of the children, in this case we will find the nearest child\n    let minDistanceSoFar = Number.MAX_VALUE;\n    let indexOfMin = undefined;\n    // we are checking all of them because we don't know whether we are dealing with a horizontal or vertical container and where the floating element entered from\n    for (let i = 0; i < children.length; i++) {\n        const distance = calcDistanceBetweenCenters(floatingAboveEl, children[i]);\n        if (distance < minDistanceSoFar) {\n            minDistanceSoFar = distance;\n            indexOfMin = i;\n        }\n    }\n    return {index: indexOfMin, isProximityBased: true};\n}\n","import {calcInnerDistancesBetweenPointAndSidesOfElement} from \"./intersection\";\nconst SCROLL_ZONE_PX = 25;\n\nexport function makeScroller() {\n    let scrollingInfo;\n    function resetScrolling() {\n        scrollingInfo = {directionObj: undefined, stepPx: 0};\n    }\n    resetScrolling();\n    // directionObj {x: 0|1|-1, y:0|1|-1} - 1 means down in y and right in x\n    function scrollContainer(containerEl) {\n        const {directionObj, stepPx} = scrollingInfo;\n        if (directionObj) {\n            containerEl.scrollBy(directionObj.x * stepPx, directionObj.y * stepPx);\n            window.requestAnimationFrame(() => scrollContainer(containerEl));\n        }\n    }\n    function calcScrollStepPx(distancePx) {\n        return SCROLL_ZONE_PX - distancePx;\n    }\n\n    /**\n     * If the pointer is next to the sides of the element to scroll, will trigger scrolling\n     * Can be called repeatedly with updated pointer and elementToScroll values without issues\n     * @return {boolean} - true if scrolling was needed\n     */\n    function scrollIfNeeded(pointer, elementToScroll) {\n        if (!elementToScroll) {\n            return false;\n        }\n        const distances = calcInnerDistancesBetweenPointAndSidesOfElement(pointer, elementToScroll);\n        if (distances === null) {\n            resetScrolling();\n            return false;\n        }\n        const isAlreadyScrolling = !!scrollingInfo.directionObj;\n        let [scrollingVertically, scrollingHorizontally] = [false, false];\n        // vertical\n        if (elementToScroll.scrollHeight > elementToScroll.clientHeight) {\n            if (distances.bottom < SCROLL_ZONE_PX) {\n                scrollingVertically = true;\n                scrollingInfo.directionObj = {x: 0, y: 1};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.bottom);\n            } else if (distances.top < SCROLL_ZONE_PX) {\n                scrollingVertically = true;\n                scrollingInfo.directionObj = {x: 0, y: -1};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.top);\n            }\n            if (!isAlreadyScrolling && scrollingVertically) {\n                scrollContainer(elementToScroll);\n                return true;\n            }\n        }\n        // horizontal\n        if (elementToScroll.scrollWidth > elementToScroll.clientWidth) {\n            if (distances.right < SCROLL_ZONE_PX) {\n                scrollingHorizontally = true;\n                scrollingInfo.directionObj = {x: 1, y: 0};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.right);\n            } else if (distances.left < SCROLL_ZONE_PX) {\n                scrollingHorizontally = true;\n                scrollingInfo.directionObj = {x: -1, y: 0};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.left);\n            }\n            if (!isAlreadyScrolling && scrollingHorizontally) {\n                scrollContainer(elementToScroll);\n                return true;\n            }\n        }\n        resetScrolling();\n        return false;\n    }\n\n    return {\n        scrollIfNeeded,\n        resetScrolling\n    };\n}\n","/**\n * @param {Object} object\n * @return {string}\n */\nexport function toString(object) {\n    return JSON.stringify(object, null, 2);\n}\n\n/**\n * Finds the depth of the given node in the DOM tree\n * @param {HTMLElement} node\n * @return {number} - the depth of the node\n */\nexport function getDepth(node) {\n    if (!node) {\n        throw new Error(\"cannot get depth of a falsy node\");\n    }\n    return _getDepth(node, 0);\n}\nfunction _getDepth(node, countSoFar = 0) {\n    if (!node.parentElement) {\n        return countSoFar - 1;\n    }\n    return _getDepth(node.parentElement, countSoFar + 1);\n}\n\n/**\n * A simple util to shallow compare objects quickly, it doesn't validate the arguments so pass objects in\n * @param {Object} objA\n * @param {Object} objB\n * @return {boolean} - true if objA and objB are shallow equal\n */\nexport function areObjectsShallowEqual(objA, objB) {\n    if (Object.keys(objA).length !== Object.keys(objB).length) {\n        return false;\n    }\n    for (const keyA in objA) {\n        if (!{}.hasOwnProperty.call(objB, keyA) || objB[keyA] !== objA[keyA]) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * Shallow compares two arrays\n * @param arrA\n * @param arrB\n * @return {boolean} - whether the arrays are shallow equal\n */\nexport function areArraysShallowEqualSameOrder(arrA, arrB) {\n    if (arrA.length !== arrB.length) {\n        return false;\n    }\n    for (let i = 0; i < arrA.length; i++) {\n        if (arrA[i] !== arrB[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n","import {findWouldBeIndex, resetIndexesCache, resetIndexesCacheForDz} from \"./listUtil\";\nimport {findCenterOfElement, isElementOffDocument} from \"./intersection\";\nimport {\n    dispatchDraggedElementEnteredContainer,\n    dispatchDraggedElementLeftContainerForAnother,\n    dispatchDraggedElementLeftContainerForNone,\n    dispatchDraggedLeftDocument,\n    dispatchDraggedElementIsOverIndex\n} from \"./dispatcher\";\nimport {makeScroller} from \"./scroller\";\nimport {getDepth} from \"./util\";\nimport {printDebug} from \"../constants\";\n\nconst INTERVAL_MS = 200;\nconst TOLERANCE_PX = 10;\nconst {scrollIfNeeded, resetScrolling} = makeScroller();\nlet next;\n\n/**\n * Tracks the dragged elements and performs the side effects when it is dragged over a drop zone (basically dispatching custom-events scrolling)\n * @param {Set<HTMLElement>} dropZones\n * @param {HTMLElement} draggedEl\n * @param {number} [intervalMs = INTERVAL_MS]\n */\nexport function observe(draggedEl, dropZones, intervalMs = INTERVAL_MS) {\n    // initialization\n    let lastDropZoneFound;\n    let lastIndexFound;\n    let lastIsDraggedInADropZone = false;\n    let lastCentrePositionOfDragged;\n    // We are sorting to make sure that in case of nested zones of the same type the one \"on top\" is considered first\n    const dropZonesFromDeepToShallow = Array.from(dropZones).sort((dz1, dz2) => getDepth(dz2) - getDepth(dz1));\n\n    /**\n     * The main function in this module. Tracks where everything is/ should be a take the actions\n     */\n    function andNow() {\n        const currentCenterOfDragged = findCenterOfElement(draggedEl);\n        const scrolled = scrollIfNeeded(currentCenterOfDragged, lastDropZoneFound);\n        // we only want to make a new decision after the element was moved a bit to prevent flickering\n        if (\n            !scrolled &&\n            lastCentrePositionOfDragged &&\n            Math.abs(lastCentrePositionOfDragged.x - currentCenterOfDragged.x) < TOLERANCE_PX &&\n            Math.abs(lastCentrePositionOfDragged.y - currentCenterOfDragged.y) < TOLERANCE_PX\n        ) {\n            next = window.setTimeout(andNow, intervalMs);\n            return;\n        }\n        if (isElementOffDocument(draggedEl)) {\n            printDebug(() => \"off document\");\n            dispatchDraggedLeftDocument(draggedEl);\n            return;\n        }\n\n        lastCentrePositionOfDragged = currentCenterOfDragged;\n        // this is a simple algorithm, potential improvement: first look at lastDropZoneFound\n        let isDraggedInADropZone = false;\n        for (const dz of dropZonesFromDeepToShallow) {\n            if (scrolled) resetIndexesCacheForDz(lastDropZoneFound);\n            const indexObj = findWouldBeIndex(draggedEl, dz);\n            if (indexObj === null) {\n                // it is not inside\n                continue;\n            }\n            const {index} = indexObj;\n            isDraggedInADropZone = true;\n            // the element is over a container\n            if (dz !== lastDropZoneFound) {\n                lastDropZoneFound && dispatchDraggedElementLeftContainerForAnother(lastDropZoneFound, draggedEl, dz);\n                dispatchDraggedElementEnteredContainer(dz, indexObj, draggedEl);\n                lastDropZoneFound = dz;\n            } else if (index !== lastIndexFound) {\n                dispatchDraggedElementIsOverIndex(dz, indexObj, draggedEl);\n                lastIndexFound = index;\n            }\n            // we handle looping with the 'continue' statement above\n            break;\n        }\n        // the first time the dragged element is not in any dropzone we need to notify the last dropzone it was in\n        if (!isDraggedInADropZone && lastIsDraggedInADropZone && lastDropZoneFound) {\n            dispatchDraggedElementLeftContainerForNone(lastDropZoneFound, draggedEl);\n            lastDropZoneFound = undefined;\n            lastIndexFound = undefined;\n            lastIsDraggedInADropZone = false;\n        } else {\n            lastIsDraggedInADropZone = true;\n        }\n        next = window.setTimeout(andNow, intervalMs);\n    }\n    andNow();\n}\n\n// assumption - we can only observe one dragged element at a time, this could be changed in the future\nexport function unobserve() {\n    printDebug(() => \"unobserving\");\n    clearTimeout(next);\n    resetScrolling();\n    resetIndexesCache();\n}\n","import {makeScroller} from \"./scroller\";\nimport {printDebug} from \"../constants\";\nimport {resetIndexesCache} from \"./listUtil\";\n\nconst INTERVAL_MS = 300;\nlet mousePosition;\n\n/**\n * Do not use this! it is visible for testing only until we get over the issue Cypress not triggering the mousemove listeners\n * // TODO - make private (remove export)\n * @param {{clientX: number, clientY: number}} e\n */\nexport function updateMousePosition(e) {\n    const c = e.touches ? e.touches[0] : e;\n    mousePosition = {x: c.clientX, y: c.clientY};\n}\nconst {scrollIfNeeded, resetScrolling} = makeScroller();\nlet next;\n\nfunction loop() {\n    if (mousePosition) {\n        const scrolled = scrollIfNeeded(mousePosition, document.documentElement);\n        if (scrolled) resetIndexesCache();\n    }\n    next = window.setTimeout(loop, INTERVAL_MS);\n}\n\n/**\n * will start watching the mouse pointer and scroll the window if it goes next to the edges\n */\nexport function armWindowScroller() {\n    printDebug(() => \"arming window scroller\");\n    window.addEventListener(\"mousemove\", updateMousePosition);\n    window.addEventListener(\"touchmove\", updateMousePosition);\n    loop();\n}\n\n/**\n * will stop watching the mouse pointer and won't scroll the window anymore\n */\nexport function disarmWindowScroller() {\n    printDebug(() => \"disarming window scroller\");\n    window.removeEventListener(\"mousemove\", updateMousePosition);\n    window.removeEventListener(\"touchmove\", updateMousePosition);\n    mousePosition = undefined;\n    window.clearTimeout(next);\n    resetScrolling();\n}\n","/**\n * Fixes svelte issue when cloning node containing (or being) <select> which will loose it's value.\n * Since svelte manages select value internally.\n * @see https://github.com/sveltejs/svelte/issues/6717\n * @see https://github.com/isaacHagoel/svelte-dnd-action/issues/306\n * \n * @param {HTMLElement} el \n * @returns \n */\nexport function svelteNodeClone(el) {\n  const cloned = el.cloneNode(true);\n\n  const values = [];\n  const elIsSelect = el.tagName === \"SELECT\";\n  const selects = elIsSelect ? [el] : [...el.querySelectorAll('select')];\n  for (const select of selects) {\n    values.push(select.value);\n  }\n\n  if (selects.length <= 0) {\n    return cloned;\n  }\n\n  const clonedSelects = elIsSelect ? [cloned] : [...cloned.querySelectorAll('select')];\n  for (let i = 0; i < clonedSelects.length; i++) {\n    const select = clonedSelects[i];\n    const value = values[i];\n    const optionEl = select.querySelector(`option[value=\"${value}\"`);\n    if (optionEl) {\n      optionEl.setAttribute('selected', true);\n    }\n  }\n\n  return cloned;\n}\n","import {SHADOW_ELEMENT_ATTRIBUTE_NAME, DRAGGED_ELEMENT_ID} from \"../constants\";\nimport {findCenter} from \"./intersection\";\nimport {svelteNodeClone} from \"./svelteNodeClone\";\n\nconst TRANSITION_DURATION_SECONDS = 0.2;\n\n/**\n * private helper function - creates a transition string for a property\n * @param {string} property\n * @return {string} - the transition string\n */\nfunction trs(property) {\n    return `${property} ${TRANSITION_DURATION_SECONDS}s ease`;\n}\n/**\n * clones the given element and applies proper styles and transitions to the dragged element\n * @param {HTMLElement} originalElement\n * @param {Point} [positionCenterOnXY]\n * @return {Node} - the cloned, styled element\n */\nexport function createDraggedElementFrom(originalElement, positionCenterOnXY) {\n    const rect = originalElement.getBoundingClientRect();\n    const draggedEl = svelteNodeClone(originalElement);\n    copyStylesFromTo(originalElement, draggedEl);\n    draggedEl.id = DRAGGED_ELEMENT_ID;\n    draggedEl.style.position = \"fixed\";\n    let elTopPx = rect.top;\n    let elLeftPx = rect.left;\n    draggedEl.style.top = `${elTopPx}px`;\n    draggedEl.style.left = `${elLeftPx}px`;\n    if (positionCenterOnXY) {\n        const center = findCenter(rect);\n        elTopPx -= center.y - positionCenterOnXY.y;\n        elLeftPx -= center.x - positionCenterOnXY.x;\n        window.setTimeout(() => {\n            draggedEl.style.top = `${elTopPx}px`;\n            draggedEl.style.left = `${elLeftPx}px`;\n        }, 0);\n    }\n    draggedEl.style.margin = \"0\";\n    // we can't have relative or automatic height and width or it will break the illusion\n    draggedEl.style.boxSizing = \"border-box\";\n    draggedEl.style.height = `${rect.height}px`;\n    draggedEl.style.width = `${rect.width}px`;\n    draggedEl.style.transition = `${trs(\"top\")}, ${trs(\"left\")}, ${trs(\"background-color\")}, ${trs(\"opacity\")}, ${trs(\"color\")} `;\n    // this is a workaround for a strange browser bug that causes the right border to disappear when all the transitions are added at the same time\n    window.setTimeout(() => (draggedEl.style.transition += `, ${trs(\"width\")}, ${trs(\"height\")}`), 0);\n    draggedEl.style.zIndex = \"9999\";\n    draggedEl.style.cursor = \"grabbing\";\n\n    return draggedEl;\n}\n\n/**\n * styles the dragged element to a 'dropped' state\n * @param {HTMLElement} draggedEl\n */\nexport function moveDraggedElementToWasDroppedState(draggedEl) {\n    draggedEl.style.cursor = \"grab\";\n}\n\n/**\n * Morphs the dragged element style, maintains the mouse pointer within the element\n * @param {HTMLElement} draggedEl\n * @param {HTMLElement} copyFromEl - the element the dragged element should look like, typically the shadow element\n * @param {number} currentMouseX\n * @param {number} currentMouseY\n */\nexport function morphDraggedElementToBeLike(draggedEl, copyFromEl, currentMouseX, currentMouseY) {\n    copyStylesFromTo(copyFromEl, draggedEl);\n    const newRect = copyFromEl.getBoundingClientRect();\n    const draggedElRect = draggedEl.getBoundingClientRect();\n    const widthChange = newRect.width - draggedElRect.width;\n    const heightChange = newRect.height - draggedElRect.height;\n    if (widthChange || heightChange) {\n        const relativeDistanceOfMousePointerFromDraggedSides = {\n            left: (currentMouseX - draggedElRect.left) / draggedElRect.width,\n            top: (currentMouseY - draggedElRect.top) / draggedElRect.height\n        };\n        draggedEl.style.height = `${newRect.height}px`;\n        draggedEl.style.width = `${newRect.width}px`;\n        draggedEl.style.left = `${parseFloat(draggedEl.style.left) - relativeDistanceOfMousePointerFromDraggedSides.left * widthChange}px`;\n        draggedEl.style.top = `${parseFloat(draggedEl.style.top) - relativeDistanceOfMousePointerFromDraggedSides.top * heightChange}px`;\n    }\n}\n\n/**\n * @param {HTMLElement} copyFromEl\n * @param {HTMLElement} copyToEl\n */\nfunction copyStylesFromTo(copyFromEl, copyToEl) {\n    const computedStyle = window.getComputedStyle(copyFromEl);\n    Array.from(computedStyle)\n        .filter(\n            s =>\n                s.startsWith(\"background\") ||\n                s.startsWith(\"padding\") ||\n                s.startsWith(\"font\") ||\n                s.startsWith(\"text\") ||\n                s.startsWith(\"align\") ||\n                s.startsWith(\"justify\") ||\n                s.startsWith(\"display\") ||\n                s.startsWith(\"flex\") ||\n                s.startsWith(\"border\") ||\n                s === \"opacity\" ||\n                s === \"color\" ||\n                s === \"list-style-type\"\n        )\n        .forEach(s => copyToEl.style.setProperty(s, computedStyle.getPropertyValue(s), computedStyle.getPropertyPriority(s)));\n}\n\n/**\n * makes the element compatible with being draggable\n * @param {HTMLElement} draggableEl\n * @param {boolean} dragDisabled\n */\nexport function styleDraggable(draggableEl, dragDisabled) {\n    draggableEl.draggable = false;\n    draggableEl.ondragstart = () => false;\n    if (!dragDisabled) {\n        draggableEl.style.userSelect = \"none\";\n        draggableEl.style.WebkitUserSelect = \"none\";\n        draggableEl.style.cursor = \"grab\";\n    } else {\n        draggableEl.style.userSelect = \"\";\n        draggableEl.style.WebkitUserSelect = \"\";\n        draggableEl.style.cursor = \"\";\n    }\n}\n\n/**\n * Hides the provided element so that it can stay in the dom without interrupting\n * @param {HTMLElement} dragTarget\n */\nexport function hideElement(dragTarget) {\n    dragTarget.style.display = \"none\";\n    dragTarget.style.position = \"fixed\";\n    dragTarget.style.zIndex = \"-5\";\n}\n\n/**\n * styles the shadow element\n * @param {HTMLElement} shadowEl\n */\nexport function decorateShadowEl(shadowEl) {\n    shadowEl.style.visibility = \"hidden\";\n    shadowEl.setAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME, \"true\");\n}\n\n/**\n * undo the styles the shadow element\n * @param {HTMLElement} shadowEl\n */\nexport function unDecorateShadowElement(shadowEl) {\n    shadowEl.style.visibility = \"\";\n    shadowEl.removeAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME);\n}\n\n/**\n * will mark the given dropzones as visually active\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object (so the styles can be removed)\n * @param {Function} getClasses - maps a dropzone to a classList\n */\nexport function styleActiveDropZones(dropZones, getStyles = () => {}, getClasses = () => []) {\n    dropZones.forEach(dz => {\n        const styles = getStyles(dz);\n        Object.keys(styles).forEach(style => {\n            dz.style[style] = styles[style];\n        });\n        getClasses(dz).forEach(c => dz.classList.add(c));\n    });\n}\n\n/**\n * will remove the 'active' styling from given dropzones\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object\n * @param {Function} getClasses - maps a dropzone to a classList\n */\nexport function styleInactiveDropZones(dropZones, getStyles = () => {}, getClasses = () => []) {\n    dropZones.forEach(dz => {\n        const styles = getStyles(dz);\n        Object.keys(styles).forEach(style => {\n            dz.style[style] = \"\";\n        });\n        getClasses(dz).forEach(c => dz.classList.contains(c) && dz.classList.remove(c));\n    });\n}\n\n/**\n * will prevent the provided element from shrinking by setting its minWidth and minHeight to the current width and height values\n * @param {HTMLElement} el\n * @return {function(): void} - run this function to undo the operation and restore the original values\n */\nexport function preventShrinking(el) {\n    const originalMinHeight = el.style.minHeight;\n    el.style.minHeight = window.getComputedStyle(el).getPropertyValue(\"height\");\n    const originalMinWidth = el.style.minWidth;\n    el.style.minWidth = window.getComputedStyle(el).getPropertyValue(\"width\");\n    return function undo() {\n        el.style.minHeight = originalMinHeight;\n        el.style.minWidth = originalMinWidth;\n    };\n}\n","import {\n    decrementActiveDropZoneCount,\n    incrementActiveDropZoneCount,\n    ITEM_ID_KEY,\n    printDebug,\n    SHADOW_ITEM_MARKER_PROPERTY_NAME,\n    SHADOW_PLACEHOLDER_ITEM_ID,\n    SOURCES,\n    TRIGGERS\n} from \"./constants\";\nimport {observe, unobserve} from \"./helpers/observer\";\nimport {armWindowScroller, disarmWindowScroller} from \"./helpers/windowScroller\";\nimport {\n    createDraggedElementFrom,\n    decorateShadowEl,\n    hideElement,\n    morphDraggedElementToBeLike,\n    moveDraggedElementToWasDroppedState,\n    preventShrinking,\n    styleActiveDropZones,\n    styleDraggable,\n    styleInactiveDropZones,\n    unDecorateShadowElement\n} from \"./helpers/styler\";\nimport {\n    dispatchConsiderEvent,\n    dispatchFinalizeEvent,\n    DRAGGED_ENTERED_EVENT_NAME,\n    DRAGGED_LEFT_DOCUMENT_EVENT_NAME,\n    DRAGGED_LEFT_EVENT_NAME,\n    DRAGGED_LEFT_TYPES,\n    DRAGGED_OVER_INDEX_EVENT_NAME\n} from \"./helpers/dispatcher\";\nimport {areArraysShallowEqualSameOrder, areObjectsShallowEqual, toString} from \"./helpers/util\";\nimport {getBoundingRectNoTransforms} from \"./helpers/intersection\";\n\nconst DEFAULT_DROP_ZONE_TYPE = \"--any--\";\nconst MIN_OBSERVATION_INTERVAL_MS = 100;\nconst MIN_MOVEMENT_BEFORE_DRAG_START_PX = 3;\nconst DEFAULT_DROP_TARGET_STYLE = {\n    outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\n\nlet originalDragTarget;\nlet draggedEl;\nlet draggedElData;\nlet draggedElType;\nlet originDropZone;\nlet originIndex;\nlet shadowElData;\nlet shadowElDropZone;\nlet dragStartMousePosition;\nlet currentMousePosition;\nlet isWorkingOnPreviousDrag = false;\nlet finalizingPreviousDrag = false;\nlet unlockOriginDzMinDimensions;\nlet isDraggedOutsideOfAnyDz = false;\nlet scheduledForRemovalAfterDrop = [];\n\n// a map from type to a set of drop-zones\nconst typeToDropZones = new Map();\n// important - this is needed because otherwise the config that would be used for everyone is the config of the element that created the event listeners\nconst dzToConfig = new Map();\n// this is needed in order to be able to cleanup old listeners and avoid stale closures issues (as the listener is defined within each zone)\nconst elToMouseDownListener = new WeakMap();\n\n/* drop-zones registration management */\nfunction registerDropZone(dropZoneEl, type) {\n    printDebug(() => \"registering drop-zone if absent\");\n    if (!typeToDropZones.has(type)) {\n        typeToDropZones.set(type, new Set());\n    }\n    if (!typeToDropZones.get(type).has(dropZoneEl)) {\n        typeToDropZones.get(type).add(dropZoneEl);\n        incrementActiveDropZoneCount();\n    }\n}\nfunction unregisterDropZone(dropZoneEl, type) {\n    typeToDropZones.get(type).delete(dropZoneEl);\n    decrementActiveDropZoneCount();\n    if (typeToDropZones.get(type).size === 0) {\n        typeToDropZones.delete(type);\n    }\n}\n\n/* functions to manage observing the dragged element and trigger custom drag-events */\nfunction watchDraggedElement() {\n    printDebug(() => \"watching dragged element\");\n    armWindowScroller();\n    const dropZones = typeToDropZones.get(draggedElType);\n    for (const dz of dropZones) {\n        dz.addEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n        dz.addEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n        dz.addEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n    window.addEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop);\n    // it is important that we don't have an interval that is faster than the flip duration because it can cause elements to jump bach and forth\n    const observationIntervalMs = Math.max(\n        MIN_OBSERVATION_INTERVAL_MS,\n        ...Array.from(dropZones.keys()).map(dz => dzToConfig.get(dz).dropAnimationDurationMs)\n    );\n    observe(draggedEl, dropZones, observationIntervalMs * 1.07);\n}\nfunction unWatchDraggedElement() {\n    printDebug(() => \"unwatching dragged element\");\n    disarmWindowScroller();\n    const dropZones = typeToDropZones.get(draggedElType);\n    for (const dz of dropZones) {\n        dz.removeEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n        dz.removeEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n        dz.removeEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n    window.removeEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop);\n    unobserve();\n}\n\n// finds the initial placeholder that is placed there on drag start\nfunction findShadowPlaceHolderIdx(items) {\n    return items.findIndex(item => item[ITEM_ID_KEY] === SHADOW_PLACEHOLDER_ITEM_ID);\n}\nfunction findShadowElementIdx(items) {\n    // checking that the id is not the placeholder's for Dragula like usecases\n    return items.findIndex(item => !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME] && item[ITEM_ID_KEY] !== SHADOW_PLACEHOLDER_ITEM_ID);\n}\n\n/* custom drag-events handlers */\nfunction handleDraggedEntered(e) {\n    printDebug(() => [\"dragged entered\", e.currentTarget, e.detail]);\n    let {items, dropFromOthersDisabled} = dzToConfig.get(e.currentTarget);\n    if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n        printDebug(() => \"ignoring dragged entered because drop is currently disabled\");\n        return;\n    }\n    isDraggedOutsideOfAnyDz = false;\n    // this deals with another race condition. in rare occasions (super rapid operations) the list hasn't updated yet\n    items = items.filter(item => item[ITEM_ID_KEY] !== shadowElData[ITEM_ID_KEY]);\n    printDebug(() => `dragged entered items ${toString(items)}`);\n\n    if (originDropZone !== e.currentTarget) {\n        const originZoneItems = dzToConfig.get(originDropZone).items;\n        const newOriginZoneItems = originZoneItems.filter(item => !item[SHADOW_ITEM_MARKER_PROPERTY_NAME]);\n        dispatchConsiderEvent(originDropZone, newOriginZoneItems, {\n            trigger: TRIGGERS.DRAGGED_ENTERED_ANOTHER,\n            id: draggedElData[ITEM_ID_KEY],\n            source: SOURCES.POINTER\n        });\n    } else {\n        const shadowPlaceHolderIdx = findShadowPlaceHolderIdx(items);\n        if (shadowPlaceHolderIdx !== -1) {\n            // only happens right after drag start, on the first drag entered event\n            printDebug(() => \"removing placeholder item from origin dz\");\n            items.splice(shadowPlaceHolderIdx, 1);\n        }\n    }\n\n    const {index, isProximityBased} = e.detail.indexObj;\n    const shadowElIdx = isProximityBased && index === e.currentTarget.children.length - 1 ? index + 1 : index;\n    shadowElDropZone = e.currentTarget;\n    items.splice(shadowElIdx, 0, shadowElData);\n    dispatchConsiderEvent(e.currentTarget, items, {trigger: TRIGGERS.DRAGGED_ENTERED, id: draggedElData[ITEM_ID_KEY], source: SOURCES.POINTER});\n}\n\nfunction handleDraggedLeft(e) {\n    // dealing with a rare race condition on extremely rapid clicking and dropping\n    if (!isWorkingOnPreviousDrag) return;\n    printDebug(() => [\"dragged left\", e.currentTarget, e.detail]);\n    const {items, dropFromOthersDisabled} = dzToConfig.get(e.currentTarget);\n    if (dropFromOthersDisabled && e.currentTarget !== originDropZone && e.currentTarget !== shadowElDropZone) {\n        printDebug(() => \"drop is currently disabled\");\n        return;\n    }\n    const shadowElIdx = findShadowElementIdx(items);\n    const shadowItem = items.splice(shadowElIdx, 1)[0];\n    shadowElDropZone = undefined;\n    const {type, theOtherDz} = e.detail;\n    if (\n        type === DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY ||\n        (type === DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER && theOtherDz !== originDropZone && dzToConfig.get(theOtherDz).dropFromOthersDisabled)\n    ) {\n        printDebug(() => \"dragged left all, putting shadow element back in the origin dz\");\n        isDraggedOutsideOfAnyDz = true;\n        shadowElDropZone = originDropZone;\n        const originZoneItems = dzToConfig.get(originDropZone).items;\n        originZoneItems.splice(originIndex, 0, shadowItem);\n        dispatchConsiderEvent(originDropZone, originZoneItems, {\n            trigger: TRIGGERS.DRAGGED_LEFT_ALL,\n            id: draggedElData[ITEM_ID_KEY],\n            source: SOURCES.POINTER\n        });\n    }\n    // for the origin dz, when the dragged is outside of any, this will be fired in addition to the previous. this is for simplicity\n    dispatchConsiderEvent(e.currentTarget, items, {\n        trigger: TRIGGERS.DRAGGED_LEFT,\n        id: draggedElData[ITEM_ID_KEY],\n        source: SOURCES.POINTER\n    });\n}\nfunction handleDraggedIsOverIndex(e) {\n    printDebug(() => [\"dragged is over index\", e.currentTarget, e.detail]);\n    const {items, dropFromOthersDisabled} = dzToConfig.get(e.currentTarget);\n    if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n        printDebug(() => \"drop is currently disabled\");\n        return;\n    }\n    isDraggedOutsideOfAnyDz = false;\n    const {index} = e.detail.indexObj;\n    const shadowElIdx = findShadowElementIdx(items);\n    items.splice(shadowElIdx, 1);\n    items.splice(index, 0, shadowElData);\n    dispatchConsiderEvent(e.currentTarget, items, {trigger: TRIGGERS.DRAGGED_OVER_INDEX, id: draggedElData[ITEM_ID_KEY], source: SOURCES.POINTER});\n}\n\n// Global mouse/touch-events handlers\nfunction handleMouseMove(e) {\n    e.preventDefault();\n    const c = e.touches ? e.touches[0] : e;\n    currentMousePosition = {x: c.clientX, y: c.clientY};\n    draggedEl.style.transform = `translate3d(${currentMousePosition.x - dragStartMousePosition.x}px, ${\n        currentMousePosition.y - dragStartMousePosition.y\n    }px, 0)`;\n}\n\nfunction handleDrop() {\n    printDebug(() => \"dropped\");\n    finalizingPreviousDrag = true;\n    // cleanup\n    window.removeEventListener(\"mousemove\", handleMouseMove);\n    window.removeEventListener(\"touchmove\", handleMouseMove);\n    window.removeEventListener(\"mouseup\", handleDrop);\n    window.removeEventListener(\"touchend\", handleDrop);\n    unWatchDraggedElement();\n    moveDraggedElementToWasDroppedState(draggedEl);\n\n    if (!shadowElDropZone) {\n        printDebug(() => \"element was dropped right after it left origin but before entering somewhere else\");\n        shadowElDropZone = originDropZone;\n    }\n    printDebug(() => [\"dropped in dz\", shadowElDropZone]);\n    let {items, type} = dzToConfig.get(shadowElDropZone);\n    styleInactiveDropZones(\n        typeToDropZones.get(type),\n        dz => dzToConfig.get(dz).dropTargetStyle,\n        dz => dzToConfig.get(dz).dropTargetClasses\n    );\n    let shadowElIdx = findShadowElementIdx(items);\n    // the handler might remove the shadow element, ex: dragula like copy on drag\n    if (shadowElIdx === -1) shadowElIdx = originIndex;\n    items = items.map(item => (item[SHADOW_ITEM_MARKER_PROPERTY_NAME] ? draggedElData : item));\n    function finalizeWithinZone() {\n        unlockOriginDzMinDimensions();\n        dispatchFinalizeEvent(shadowElDropZone, items, {\n            trigger: isDraggedOutsideOfAnyDz ? TRIGGERS.DROPPED_OUTSIDE_OF_ANY : TRIGGERS.DROPPED_INTO_ZONE,\n            id: draggedElData[ITEM_ID_KEY],\n            source: SOURCES.POINTER\n        });\n        if (shadowElDropZone !== originDropZone) {\n            // letting the origin drop zone know the element was permanently taken away\n            dispatchFinalizeEvent(originDropZone, dzToConfig.get(originDropZone).items, {\n                trigger: TRIGGERS.DROPPED_INTO_ANOTHER,\n                id: draggedElData[ITEM_ID_KEY],\n                source: SOURCES.POINTER\n            });\n        }\n        unDecorateShadowElement(shadowElDropZone.children[shadowElIdx]);\n        cleanupPostDrop();\n    }\n    animateDraggedToFinalPosition(shadowElIdx, finalizeWithinZone);\n}\n\n// helper function for handleDrop\nfunction animateDraggedToFinalPosition(shadowElIdx, callback) {\n    const shadowElRect = getBoundingRectNoTransforms(shadowElDropZone.children[shadowElIdx]);\n    const newTransform = {\n        x: shadowElRect.left - parseFloat(draggedEl.style.left),\n        y: shadowElRect.top - parseFloat(draggedEl.style.top)\n    };\n    const {dropAnimationDurationMs} = dzToConfig.get(shadowElDropZone);\n    const transition = `transform ${dropAnimationDurationMs}ms ease`;\n    draggedEl.style.transition = draggedEl.style.transition ? draggedEl.style.transition + \",\" + transition : transition;\n    draggedEl.style.transform = `translate3d(${newTransform.x}px, ${newTransform.y}px, 0)`;\n    window.setTimeout(callback, dropAnimationDurationMs);\n}\n\nfunction scheduleDZForRemovalAfterDrop(dz, destroy) {\n    scheduledForRemovalAfterDrop.push({dz, destroy});\n    window.requestAnimationFrame(() => {\n        hideElement(dz);\n        document.body.appendChild(dz);\n    });\n}\n/* cleanup */\nfunction cleanupPostDrop() {\n    draggedEl.remove();\n    originalDragTarget.remove();\n    if (scheduledForRemovalAfterDrop.length) {\n        printDebug(() => [\"will destroy zones that were removed during drag\", scheduledForRemovalAfterDrop]);\n        scheduledForRemovalAfterDrop.forEach(({dz, destroy}) => {\n            destroy();\n            dz.remove();\n        });\n        scheduledForRemovalAfterDrop = [];\n    }\n    draggedEl = undefined;\n    originalDragTarget = undefined;\n    draggedElData = undefined;\n    draggedElType = undefined;\n    originDropZone = undefined;\n    originIndex = undefined;\n    shadowElData = undefined;\n    shadowElDropZone = undefined;\n    dragStartMousePosition = undefined;\n    currentMousePosition = undefined;\n    isWorkingOnPreviousDrag = false;\n    finalizingPreviousDrag = false;\n    unlockOriginDzMinDimensions = undefined;\n    isDraggedOutsideOfAnyDz = false;\n}\n\nexport function dndzone(node, options) {\n    let initialized = false;\n    const config = {\n        items: undefined,\n        type: undefined,\n        flipDurationMs: 0,\n        dragDisabled: false,\n        morphDisabled: false,\n        dropFromOthersDisabled: false,\n        dropTargetStyle: DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses: [],\n        transformDraggedElement: () => {},\n        centreDraggedOnCursor: false\n    };\n    printDebug(() => [`dndzone good to go options: ${toString(options)}, config: ${toString(config)}`, {node}]);\n    let elToIdx = new Map();\n\n    function addMaybeListeners() {\n        window.addEventListener(\"mousemove\", handleMouseMoveMaybeDragStart, {passive: false});\n        window.addEventListener(\"touchmove\", handleMouseMoveMaybeDragStart, {passive: false, capture: false});\n        window.addEventListener(\"mouseup\", handleFalseAlarm, {passive: false});\n        window.addEventListener(\"touchend\", handleFalseAlarm, {passive: false});\n    }\n    function removeMaybeListeners() {\n        window.removeEventListener(\"mousemove\", handleMouseMoveMaybeDragStart);\n        window.removeEventListener(\"touchmove\", handleMouseMoveMaybeDragStart);\n        window.removeEventListener(\"mouseup\", handleFalseAlarm);\n        window.removeEventListener(\"touchend\", handleFalseAlarm);\n    }\n    function handleFalseAlarm() {\n        removeMaybeListeners();\n        originalDragTarget = undefined;\n        dragStartMousePosition = undefined;\n        currentMousePosition = undefined;\n    }\n\n    function handleMouseMoveMaybeDragStart(e) {\n        e.preventDefault();\n        const c = e.touches ? e.touches[0] : e;\n        currentMousePosition = {x: c.clientX, y: c.clientY};\n        if (\n            Math.abs(currentMousePosition.x - dragStartMousePosition.x) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX ||\n            Math.abs(currentMousePosition.y - dragStartMousePosition.y) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX\n        ) {\n            removeMaybeListeners();\n            handleDragStart();\n        }\n    }\n    function handleMouseDown(e) {\n        // on safari clicking on a select element doesn't fire mouseup at the end of the click and in general this makes more sense\n        if (e.target !== e.currentTarget && (e.target.value !== undefined || e.target.isContentEditable)) {\n            printDebug(() => \"won't initiate drag on a nested input element\");\n            return;\n        }\n        // prevents responding to any button but left click which equals 0 (which is falsy)\n        if (e.button) {\n            printDebug(() => `ignoring none left click button: ${e.button}`);\n            return;\n        }\n        if (isWorkingOnPreviousDrag) {\n            printDebug(() => \"cannot start a new drag before finalizing previous one\");\n            return;\n        }\n        e.stopPropagation();\n        const c = e.touches ? e.touches[0] : e;\n        dragStartMousePosition = {x: c.clientX, y: c.clientY};\n        currentMousePosition = {...dragStartMousePosition};\n        originalDragTarget = e.currentTarget;\n        addMaybeListeners();\n    }\n\n    function handleDragStart() {\n        printDebug(() => [`drag start config: ${toString(config)}`, originalDragTarget]);\n        isWorkingOnPreviousDrag = true;\n\n        // initialising globals\n        const currentIdx = elToIdx.get(originalDragTarget);\n        originIndex = currentIdx;\n        originDropZone = originalDragTarget.parentElement;\n        /** @type {ShadowRoot | HTMLDocument} */\n        const rootNode = originDropZone.getRootNode();\n        const originDropZoneRoot = rootNode.body || rootNode;\n        const {items, type, centreDraggedOnCursor} = config;\n        draggedElData = {...items[currentIdx]};\n        draggedElType = type;\n        shadowElData = {...draggedElData, [SHADOW_ITEM_MARKER_PROPERTY_NAME]: true};\n        // The initial shadow element. We need a different id at first in order to avoid conflicts and timing issues\n        const placeHolderElData = {...shadowElData, [ITEM_ID_KEY]: SHADOW_PLACEHOLDER_ITEM_ID};\n\n        // creating the draggable element\n        draggedEl = createDraggedElementFrom(originalDragTarget, centreDraggedOnCursor && currentMousePosition);\n        // We will keep the original dom node in the dom because touch events keep firing on it, we want to re-add it after the framework removes it\n        function keepOriginalElementInDom() {\n            if (!draggedEl.parentElement) {\n                originDropZoneRoot.appendChild(draggedEl);\n                // to prevent the outline from disappearing\n                draggedEl.focus();\n                watchDraggedElement();\n                hideElement(originalDragTarget);\n                originDropZoneRoot.appendChild(originalDragTarget);\n            } else {\n                window.requestAnimationFrame(keepOriginalElementInDom);\n            }\n        }\n        window.requestAnimationFrame(keepOriginalElementInDom);\n\n        styleActiveDropZones(\n            Array.from(typeToDropZones.get(config.type)).filter(dz => dz === originDropZone || !dzToConfig.get(dz).dropFromOthersDisabled),\n            dz => dzToConfig.get(dz).dropTargetStyle,\n            dz => dzToConfig.get(dz).dropTargetClasses\n        );\n\n        // removing the original element by removing its data entry\n        items.splice(currentIdx, 1, placeHolderElData);\n        unlockOriginDzMinDimensions = preventShrinking(originDropZone);\n\n        dispatchConsiderEvent(originDropZone, items, {trigger: TRIGGERS.DRAG_STARTED, id: draggedElData[ITEM_ID_KEY], source: SOURCES.POINTER});\n\n        // handing over to global handlers - starting to watch the element\n        window.addEventListener(\"mousemove\", handleMouseMove, {passive: false});\n        window.addEventListener(\"touchmove\", handleMouseMove, {passive: false, capture: false});\n        window.addEventListener(\"mouseup\", handleDrop, {passive: false});\n        window.addEventListener(\"touchend\", handleDrop, {passive: false});\n    }\n\n    function configure({\n        items = undefined,\n        flipDurationMs: dropAnimationDurationMs = 0,\n        type: newType = DEFAULT_DROP_ZONE_TYPE,\n        dragDisabled = false,\n        morphDisabled = false,\n        dropFromOthersDisabled = false,\n        dropTargetStyle = DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses = [],\n        transformDraggedElement = () => {},\n        centreDraggedOnCursor = false\n    }) {\n        config.dropAnimationDurationMs = dropAnimationDurationMs;\n        if (config.type && newType !== config.type) {\n            unregisterDropZone(node, config.type);\n        }\n        config.type = newType;\n        registerDropZone(node, newType);\n        config.items = [...items];\n        config.dragDisabled = dragDisabled;\n        config.morphDisabled = morphDisabled;\n        config.transformDraggedElement = transformDraggedElement;\n        config.centreDraggedOnCursor = centreDraggedOnCursor;\n\n        // realtime update for dropTargetStyle\n        if (\n            initialized &&\n            isWorkingOnPreviousDrag &&\n            !finalizingPreviousDrag &&\n            (!areObjectsShallowEqual(dropTargetStyle, config.dropTargetStyle) ||\n                !areArraysShallowEqualSameOrder(dropTargetClasses, config.dropTargetClasses))\n        ) {\n            styleInactiveDropZones(\n                [node],\n                () => config.dropTargetStyle,\n                () => dropTargetClasses\n            );\n            styleActiveDropZones(\n                [node],\n                () => dropTargetStyle,\n                () => dropTargetClasses\n            );\n        }\n        config.dropTargetStyle = dropTargetStyle;\n        config.dropTargetClasses = [...dropTargetClasses];\n\n        // realtime update for dropFromOthersDisabled\n        function getConfigProp(dz, propName) {\n            return dzToConfig.get(dz) ? dzToConfig.get(dz)[propName] : config[propName];\n        }\n        if (initialized && isWorkingOnPreviousDrag && config.dropFromOthersDisabled !== dropFromOthersDisabled) {\n            if (dropFromOthersDisabled) {\n                styleInactiveDropZones(\n                    [node],\n                    dz => getConfigProp(dz, \"dropTargetStyle\"),\n                    dz => getConfigProp(dz, \"dropTargetClasses\")\n                );\n            } else {\n                styleActiveDropZones(\n                    [node],\n                    dz => getConfigProp(dz, \"dropTargetStyle\"),\n                    dz => getConfigProp(dz, \"dropTargetClasses\")\n                );\n            }\n        }\n        config.dropFromOthersDisabled = dropFromOthersDisabled;\n\n        dzToConfig.set(node, config);\n        const shadowElIdx = findShadowElementIdx(config.items);\n        for (let idx = 0; idx < node.children.length; idx++) {\n            const draggableEl = node.children[idx];\n            styleDraggable(draggableEl, dragDisabled);\n            if (idx === shadowElIdx) {\n                config.transformDraggedElement(draggedEl, draggedElData, idx);\n                if (!morphDisabled) {\n                    morphDraggedElementToBeLike(draggedEl, draggableEl, currentMousePosition.x, currentMousePosition.y);\n                }\n                decorateShadowEl(draggableEl);\n                continue;\n            }\n            draggableEl.removeEventListener(\"mousedown\", elToMouseDownListener.get(draggableEl));\n            draggableEl.removeEventListener(\"touchstart\", elToMouseDownListener.get(draggableEl));\n            if (!dragDisabled) {\n                draggableEl.addEventListener(\"mousedown\", handleMouseDown);\n                draggableEl.addEventListener(\"touchstart\", handleMouseDown);\n                elToMouseDownListener.set(draggableEl, handleMouseDown);\n            }\n            // updating the idx\n            elToIdx.set(draggableEl, idx);\n\n            if (!initialized) {\n                initialized = true;\n            }\n        }\n    }\n    configure(options);\n\n    return {\n        update: newOptions => {\n            printDebug(() => `pointer dndzone will update newOptions: ${toString(newOptions)}`);\n            configure(newOptions);\n        },\n        destroy: () => {\n            function destroyDz() {\n                printDebug(() => \"pointer dndzone will destroy\");\n                unregisterDropZone(node, dzToConfig.get(node).type);\n                dzToConfig.delete(node);\n            }\n            if (isWorkingOnPreviousDrag) {\n                printDebug(() => \"pointer dndzone will be scheduled for destruction\");\n                scheduleDZForRemovalAfterDrop(node, destroyDz);\n            } else {\n                destroyDz();\n            }\n        }\n    };\n}\n","import {isOnServer} from \"../constants\";\n\nconst INSTRUCTION_IDs = {\n    DND_ZONE_ACTIVE: \"dnd-zone-active\",\n    DND_ZONE_DRAG_DISABLED: \"dnd-zone-drag-disabled\"\n};\nconst ID_TO_INSTRUCTION = {\n    [INSTRUCTION_IDs.DND_ZONE_ACTIVE]: \"Tab to one the items and press space-bar or enter to start dragging it\",\n    [INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED]: \"This is a disabled drag and drop list\"\n};\n\nconst ALERT_DIV_ID = \"dnd-action-aria-alert\";\nlet alertsDiv;\n\nfunction initAriaOnBrowser() {\n    if (alertsDiv) {\n        // it is already initialized\n        return;\n    }\n    // setting the dynamic alerts\n    alertsDiv = document.createElement(\"div\");\n    (function initAlertsDiv() {\n        alertsDiv.id = ALERT_DIV_ID;\n        // tab index -1 makes the alert be read twice on chrome for some reason\n        //alertsDiv.tabIndex = -1;\n        alertsDiv.style.position = \"fixed\";\n        alertsDiv.style.bottom = \"0\";\n        alertsDiv.style.left = \"0\";\n        alertsDiv.style.zIndex = \"-5\";\n        alertsDiv.style.opacity = \"0\";\n        alertsDiv.style.height = \"0\";\n        alertsDiv.style.width = \"0\";\n        alertsDiv.setAttribute(\"role\", \"alert\");\n    })();\n    document.body.prepend(alertsDiv);\n\n    // setting the instructions\n    Object.entries(ID_TO_INSTRUCTION).forEach(([id, txt]) => document.body.prepend(instructionToHiddenDiv(id, txt)));\n}\n\n/**\n * Initializes the static aria instructions so they can be attached to zones\n * @return {{DND_ZONE_ACTIVE: string, DND_ZONE_DRAG_DISABLED: string} | null} - the IDs for static aria instruction (to be used via aria-describedby) or null on the server\n */\nexport function initAria() {\n    if (isOnServer) return null;\n    if (document.readyState === \"complete\") {\n        initAriaOnBrowser();\n    } else {\n        window.addEventListener(\"DOMContentLoaded\", initAriaOnBrowser);\n    }\n    return {...INSTRUCTION_IDs};\n}\n\n/**\n * Removes all the artifacts (dom elements) added by this module\n */\nexport function destroyAria() {\n    if (isOnServer || !alertsDiv) return;\n    Object.keys(ID_TO_INSTRUCTION).forEach(id => document.getElementById(id)?.remove());\n    alertsDiv.remove();\n    alertsDiv = undefined;\n}\n\nfunction instructionToHiddenDiv(id, txt) {\n    const div = document.createElement(\"div\");\n    div.id = id;\n    div.innerHTML = `<p>${txt}</p>`;\n    div.style.display = \"none\";\n    div.style.position = \"fixed\";\n    div.style.zIndex = \"-5\";\n    return div;\n}\n\n/**\n * Will make the screen reader alert the provided text to the user\n * @param {string} txt\n */\nexport function alertToScreenReader(txt) {\n    if (isOnServer) return;\n    if (!alertsDiv) {\n        initAriaOnBrowser();\n    }\n    alertsDiv.innerHTML = \"\";\n    const alertText = document.createTextNode(txt);\n    alertsDiv.appendChild(alertText);\n    // this is needed for Safari\n    alertsDiv.style.display = \"none\";\n    alertsDiv.style.display = \"inline\";\n}\n","import {decrementActiveDropZoneCount, incrementActiveDropZoneCount, ITEM_ID_KEY, SOURCES, TRIGGERS} from \"./constants\";\nimport {styleActiveDropZones, styleInactiveDropZones} from \"./helpers/styler\";\nimport {dispatchConsiderEvent, dispatchFinalizeEvent} from \"./helpers/dispatcher\";\nimport {initAria, alertToScreenReader, destroyAria} from \"./helpers/aria\";\nimport {toString} from \"./helpers/util\";\nimport {printDebug} from \"./constants\";\n\nconst DEFAULT_DROP_ZONE_TYPE = \"--any--\";\nconst DEFAULT_DROP_TARGET_STYLE = {\n    outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\n\nlet isDragging = false;\nlet draggedItemType;\nlet focusedDz;\nlet focusedDzLabel = \"\";\nlet focusedItem;\nlet focusedItemId;\nlet focusedItemLabel = \"\";\nconst allDragTargets = new WeakSet();\nconst elToKeyDownListeners = new WeakMap();\nconst elToFocusListeners = new WeakMap();\nconst dzToHandles = new Map();\nconst dzToConfig = new Map();\nconst typeToDropZones = new Map();\n\n/* TODO (potentially)\n * what's the deal with the black border of voice-reader not following focus?\n * maybe keep focus on the last dragged item upon drop?\n */\n\nlet INSTRUCTION_IDs;\n\n/* drop-zones registration management */\nfunction registerDropZone(dropZoneEl, type) {\n    printDebug(() => \"registering drop-zone if absent\");\n    if (typeToDropZones.size === 0) {\n        printDebug(() => \"adding global keydown and click handlers\");\n        INSTRUCTION_IDs = initAria();\n        window.addEventListener(\"keydown\", globalKeyDownHandler);\n        window.addEventListener(\"click\", globalClickHandler);\n    }\n    if (!typeToDropZones.has(type)) {\n        typeToDropZones.set(type, new Set());\n    }\n    if (!typeToDropZones.get(type).has(dropZoneEl)) {\n        typeToDropZones.get(type).add(dropZoneEl);\n        incrementActiveDropZoneCount();\n    }\n}\nfunction unregisterDropZone(dropZoneEl, type) {\n    printDebug(() => \"unregistering drop-zone\");\n    if (focusedDz === dropZoneEl) {\n        handleDrop();\n    }\n    typeToDropZones.get(type).delete(dropZoneEl);\n    decrementActiveDropZoneCount();\n    if (typeToDropZones.get(type).size === 0) {\n        typeToDropZones.delete(type);\n    }\n    if (typeToDropZones.size === 0) {\n        printDebug(() => \"removing global keydown and click handlers\");\n        window.removeEventListener(\"keydown\", globalKeyDownHandler);\n        window.removeEventListener(\"click\", globalClickHandler);\n        INSTRUCTION_IDs = undefined;\n        destroyAria();\n    }\n}\n\nfunction globalKeyDownHandler(e) {\n    if (!isDragging) return;\n    switch (e.key) {\n        case \"Escape\": {\n            handleDrop();\n            break;\n        }\n    }\n}\n\nfunction globalClickHandler() {\n    if (!isDragging) return;\n    if (!allDragTargets.has(document.activeElement)) {\n        printDebug(() => \"clicked outside of any draggable\");\n        handleDrop();\n    }\n}\n\nfunction handleZoneFocus(e) {\n    printDebug(() => \"zone focus\");\n    if (!isDragging) return;\n    const newlyFocusedDz = e.currentTarget;\n    if (newlyFocusedDz === focusedDz) return;\n\n    focusedDzLabel = newlyFocusedDz.getAttribute(\"aria-label\") || \"\";\n    const {items: originItems} = dzToConfig.get(focusedDz);\n    const originItem = originItems.find(item => item[ITEM_ID_KEY] === focusedItemId);\n    const originIdx = originItems.indexOf(originItem);\n    const itemToMove = originItems.splice(originIdx, 1)[0];\n    const {items: targetItems, autoAriaDisabled} = dzToConfig.get(newlyFocusedDz);\n    if (\n        newlyFocusedDz.getBoundingClientRect().top < focusedDz.getBoundingClientRect().top ||\n        newlyFocusedDz.getBoundingClientRect().left < focusedDz.getBoundingClientRect().left\n    ) {\n        targetItems.push(itemToMove);\n        if (!autoAriaDisabled) {\n            alertToScreenReader(`Moved item ${focusedItemLabel} to the end of the list ${focusedDzLabel}`);\n        }\n    } else {\n        targetItems.unshift(itemToMove);\n        if (!autoAriaDisabled) {\n            alertToScreenReader(`Moved item ${focusedItemLabel} to the beginning of the list ${focusedDzLabel}`);\n        }\n    }\n    const dzFrom = focusedDz;\n    dispatchFinalizeEvent(dzFrom, originItems, {trigger: TRIGGERS.DROPPED_INTO_ANOTHER, id: focusedItemId, source: SOURCES.KEYBOARD});\n    dispatchFinalizeEvent(newlyFocusedDz, targetItems, {trigger: TRIGGERS.DROPPED_INTO_ZONE, id: focusedItemId, source: SOURCES.KEYBOARD});\n    focusedDz = newlyFocusedDz;\n}\n\nfunction triggerAllDzsUpdate() {\n    dzToHandles.forEach(({update}, dz) => update(dzToConfig.get(dz)));\n}\n\nfunction handleDrop(dispatchConsider = true) {\n    printDebug(() => \"drop\");\n    if (!dzToConfig.get(focusedDz).autoAriaDisabled) {\n        alertToScreenReader(`Stopped dragging item ${focusedItemLabel}`);\n    }\n    if (allDragTargets.has(document.activeElement)) {\n        document.activeElement.blur();\n    }\n    if (dispatchConsider) {\n        dispatchConsiderEvent(focusedDz, dzToConfig.get(focusedDz).items, {\n            trigger: TRIGGERS.DRAG_STOPPED,\n            id: focusedItemId,\n            source: SOURCES.KEYBOARD\n        });\n    }\n    styleInactiveDropZones(\n        typeToDropZones.get(draggedItemType),\n        dz => dzToConfig.get(dz).dropTargetStyle,\n        dz => dzToConfig.get(dz).dropTargetClasses\n    );\n    focusedItem = null;\n    focusedItemId = null;\n    focusedItemLabel = \"\";\n    draggedItemType = null;\n    focusedDz = null;\n    focusedDzLabel = \"\";\n    isDragging = false;\n    triggerAllDzsUpdate();\n}\n//////\nexport function dndzone(node, options) {\n    const config = {\n        items: undefined,\n        type: undefined,\n        dragDisabled: false,\n        zoneTabIndex: 0,\n        dropFromOthersDisabled: false,\n        dropTargetStyle: DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses: [],\n        autoAriaDisabled: false\n    };\n\n    function swap(arr, i, j) {\n        if (arr.length <= 1) return;\n        arr.splice(j, 1, arr.splice(i, 1, arr[j])[0]);\n    }\n\n    function handleKeyDown(e) {\n        printDebug(() => [\"handling key down\", e.key]);\n        switch (e.key) {\n            case \"Enter\":\n            case \" \": {\n                // we don't want to affect nested input elements or clickable elements\n                if ((e.target.disabled !== undefined || e.target.href || e.target.isContentEditable) && !allDragTargets.has(e.target)) {\n                    return;\n                }\n                e.preventDefault(); // preventing scrolling on spacebar\n                e.stopPropagation();\n                if (isDragging) {\n                    // TODO - should this trigger a drop? only here or in general (as in when hitting space or enter outside of any zone)?\n                    handleDrop();\n                } else {\n                    // drag start\n                    handleDragStart(e);\n                }\n                break;\n            }\n            case \"ArrowDown\":\n            case \"ArrowRight\": {\n                if (!isDragging) return;\n                e.preventDefault(); // prevent scrolling\n                e.stopPropagation();\n                const {items} = dzToConfig.get(node);\n                const children = Array.from(node.children);\n                const idx = children.indexOf(e.currentTarget);\n                printDebug(() => [\"arrow down\", idx]);\n                if (idx < children.length - 1) {\n                    if (!config.autoAriaDisabled) {\n                        alertToScreenReader(`Moved item ${focusedItemLabel} to position ${idx + 2} in the list ${focusedDzLabel}`);\n                    }\n                    swap(items, idx, idx + 1);\n                    dispatchFinalizeEvent(node, items, {trigger: TRIGGERS.DROPPED_INTO_ZONE, id: focusedItemId, source: SOURCES.KEYBOARD});\n                }\n                break;\n            }\n            case \"ArrowUp\":\n            case \"ArrowLeft\": {\n                if (!isDragging) return;\n                e.preventDefault(); // prevent scrolling\n                e.stopPropagation();\n                const {items} = dzToConfig.get(node);\n                const children = Array.from(node.children);\n                const idx = children.indexOf(e.currentTarget);\n                printDebug(() => [\"arrow up\", idx]);\n                if (idx > 0) {\n                    if (!config.autoAriaDisabled) {\n                        alertToScreenReader(`Moved item ${focusedItemLabel} to position ${idx} in the list ${focusedDzLabel}`);\n                    }\n                    swap(items, idx, idx - 1);\n                    dispatchFinalizeEvent(node, items, {trigger: TRIGGERS.DROPPED_INTO_ZONE, id: focusedItemId, source: SOURCES.KEYBOARD});\n                }\n                break;\n            }\n        }\n    }\n    function handleDragStart(e) {\n        printDebug(() => \"drag start\");\n        setCurrentFocusedItem(e.currentTarget);\n        focusedDz = node;\n        draggedItemType = config.type;\n        isDragging = true;\n        const dropTargets = Array.from(typeToDropZones.get(config.type)).filter(dz => dz === focusedDz || !dzToConfig.get(dz).dropFromOthersDisabled);\n        styleActiveDropZones(\n            dropTargets,\n            dz => dzToConfig.get(dz).dropTargetStyle,\n            dz => dzToConfig.get(dz).dropTargetClasses\n        );\n        if (!config.autoAriaDisabled) {\n            let msg = `Started dragging item ${focusedItemLabel}. Use the arrow keys to move it within its list ${focusedDzLabel}`;\n            if (dropTargets.length > 1) {\n                msg += `, or tab to another list in order to move the item into it`;\n            }\n            alertToScreenReader(msg);\n        }\n        dispatchConsiderEvent(node, dzToConfig.get(node).items, {trigger: TRIGGERS.DRAG_STARTED, id: focusedItemId, source: SOURCES.KEYBOARD});\n        triggerAllDzsUpdate();\n    }\n\n    function handleClick(e) {\n        if (!isDragging) return;\n        if (e.currentTarget === focusedItem) return;\n        e.stopPropagation();\n        handleDrop(false);\n        handleDragStart(e);\n    }\n    function setCurrentFocusedItem(draggableEl) {\n        const {items} = dzToConfig.get(node);\n        const children = Array.from(node.children);\n        const focusedItemIdx = children.indexOf(draggableEl);\n        focusedItem = draggableEl;\n        focusedItem.tabIndex = 0;\n        focusedItemId = items[focusedItemIdx][ITEM_ID_KEY];\n        focusedItemLabel = children[focusedItemIdx].getAttribute(\"aria-label\") || \"\";\n    }\n\n    function configure({\n        items = [],\n        type: newType = DEFAULT_DROP_ZONE_TYPE,\n        dragDisabled = false,\n        zoneTabIndex = 0,\n        dropFromOthersDisabled = false,\n        dropTargetStyle = DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses = [],\n        autoAriaDisabled = false\n    }) {\n        config.items = [...items];\n        config.dragDisabled = dragDisabled;\n        config.dropFromOthersDisabled = dropFromOthersDisabled;\n        config.zoneTabIndex = zoneTabIndex;\n        config.dropTargetStyle = dropTargetStyle;\n        config.dropTargetClasses = dropTargetClasses;\n        config.autoAriaDisabled = autoAriaDisabled;\n        if (config.type && newType !== config.type) {\n            unregisterDropZone(node, config.type);\n        }\n        config.type = newType;\n        registerDropZone(node, newType);\n        if (!autoAriaDisabled) {\n            node.setAttribute(\"aria-disabled\", dragDisabled);\n            node.setAttribute(\"role\", \"list\");\n            node.setAttribute(\"aria-describedby\", dragDisabled ? INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED : INSTRUCTION_IDs.DND_ZONE_ACTIVE);\n        }\n        dzToConfig.set(node, config);\n\n        if (isDragging) {\n            node.tabIndex =\n                node === focusedDz ||\n                focusedItem.contains(node) ||\n                config.dropFromOthersDisabled ||\n                (focusedDz && config.type !== dzToConfig.get(focusedDz).type)\n                    ? -1\n                    : 0;\n        } else {\n            node.tabIndex = config.zoneTabIndex;\n        }\n\n        node.addEventListener(\"focus\", handleZoneFocus);\n\n        for (let i = 0; i < node.children.length; i++) {\n            const draggableEl = node.children[i];\n            allDragTargets.add(draggableEl);\n            draggableEl.tabIndex = isDragging ? -1 : 0;\n            if (!autoAriaDisabled) {\n                draggableEl.setAttribute(\"role\", \"listitem\");\n            }\n            draggableEl.removeEventListener(\"keydown\", elToKeyDownListeners.get(draggableEl));\n            draggableEl.removeEventListener(\"click\", elToFocusListeners.get(draggableEl));\n            if (!dragDisabled) {\n                draggableEl.addEventListener(\"keydown\", handleKeyDown);\n                elToKeyDownListeners.set(draggableEl, handleKeyDown);\n                draggableEl.addEventListener(\"click\", handleClick);\n                elToFocusListeners.set(draggableEl, handleClick);\n            }\n            if (isDragging && config.items[i][ITEM_ID_KEY] === focusedItemId) {\n                printDebug(() => [\"focusing on\", {i, focusedItemId}]);\n                // if it is a nested dropzone, it was re-rendered and we need to refresh our pointer\n                focusedItem = draggableEl;\n                focusedItem.tabIndex = 0;\n                // without this the element loses focus if it moves backwards in the list\n                draggableEl.focus();\n            }\n        }\n    }\n    configure(options);\n\n    const handles = {\n        update: newOptions => {\n            printDebug(() => `keyboard dndzone will update newOptions: ${toString(newOptions)}`);\n            configure(newOptions);\n        },\n        destroy: () => {\n            printDebug(() => \"keyboard dndzone will destroy\");\n            unregisterDropZone(node, config.type);\n            dzToConfig.delete(node);\n            dzToHandles.delete(node);\n        }\n    };\n    dzToHandles.set(node, handles);\n    return handles;\n}\n","import {dndzone as pointerDndZone} from \"./pointerAction\";\nimport {dndzone as keyboardDndZone} from \"./keyboardAction\";\nimport {ITEM_ID_KEY} from \"./constants\";\nimport {toString} from \"./helpers/util\";\n\n/**\n * A custom action to turn any container to a dnd zone and all of its direct children to draggables\n * Supports mouse, touch and keyboard interactions.\n * Dispatches two events that the container is expected to react to by modifying its list of items,\n * which will then feed back in to this action via the update function\n *\n * @typedef {object} Options\n * @property {array} items - the list of items that was used to generate the children of the given node (the list used in the #each block\n * @property {string} [type] - the type of the dnd zone. children dragged from here can only be dropped in other zones of the same type, default to a base type\n * @property {number} [flipDurationMs] - if the list animated using flip (recommended), specifies the flip duration such that everything syncs with it without conflict, defaults to zero\n * @property {boolean} [dragDisabled]\n * @property {boolean} [morphDisabled] - whether dragged element should morph to zone dimensions\n * @property {boolean} [dropFromOthersDisabled]\n * @property {number} [zoneTabIndex] - set the tabindex of the list container when not dragging\n * @property {object} [dropTargetStyle]\n * @property {string[]} [dropTargetClasses]\n * @property {function} [transformDraggedElement]\n * @param {HTMLElement} node - the element to enhance\n * @param {Options} options\n * @return {{update: function, destroy: function}}\n */\nexport function dndzone(node, options) {\n    validateOptions(options);\n    const pointerZone = pointerDndZone(node, options);\n    const keyboardZone = keyboardDndZone(node, options);\n    return {\n        update: newOptions => {\n            validateOptions(newOptions);\n            pointerZone.update(newOptions);\n            keyboardZone.update(newOptions);\n        },\n        destroy: () => {\n            pointerZone.destroy();\n            keyboardZone.destroy();\n        }\n    };\n}\n\nfunction validateOptions(options) {\n    /*eslint-disable*/\n    const {\n        items,\n        flipDurationMs,\n        type,\n        dragDisabled,\n        morphDisabled,\n        dropFromOthersDisabled,\n        zoneTabIndex,\n        dropTargetStyle,\n        dropTargetClasses,\n        transformDraggedElement,\n        autoAriaDisabled,\n        centreDraggedOnCursor,\n        ...rest\n    } = options;\n    /*eslint-enable*/\n    if (Object.keys(rest).length > 0) {\n        console.warn(`dndzone will ignore unknown options`, rest);\n    }\n    if (!items) {\n        throw new Error(\"no 'items' key provided to dndzone\");\n    }\n    const itemWithMissingId = items.find(item => !{}.hasOwnProperty.call(item, ITEM_ID_KEY));\n    if (itemWithMissingId) {\n        throw new Error(`missing '${ITEM_ID_KEY}' property for item ${toString(itemWithMissingId)}`);\n    }\n    if (dropTargetClasses && !Array.isArray(dropTargetClasses)) {\n        throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof dropTargetClasses}, ${toString(dropTargetClasses)}`);\n    }\n    if (zoneTabIndex && !isInt(zoneTabIndex)) {\n        throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof zoneTabIndex}, ${toString(zoneTabIndex)}`);\n    }\n}\n\nfunction isInt(value) {\n    return !isNaN(value) && (function(x) { return (x | 0) === x; })(parseFloat(value));\n}\n","import CONSTANTS from \"../constants/constants.js\";\r\nimport * as Utilities from \"./utilities.js\"\r\nimport * as PileUtilities from \"./pile-utilities.js\"\r\n\r\nexport function getActivePlayers(onlyActive = false) {\r\n  return Array.from(game.users).filter(u => (u.active || !onlyActive) && u.character);\r\n}\r\n\r\n/**\r\n * Gets the players that can interact with this item pile\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @returns {Array<User>}\r\n */\r\nexport function getPlayersForItemPile(target) {\r\n  const targetActor = Utilities.getActor(target);\r\n  if (!PileUtilities.isValidItemPile(targetActor)) return [];\r\n  const pileData = PileUtilities.getActorFlagData(targetActor);\r\n  return getActivePlayers(pileData.activePlayers);\r\n}\r\n\r\n/**\r\n * Determines whether a pile can be split\r\n *\r\n * @param target\r\n * @returns {boolean}\r\n */\r\nexport function canItemPileBeSplit(target) {\r\n  const pileData = PileUtilities.getActorFlagData(target);\r\n  const shareData = getItemPileSharingData(target);\r\n  const playerActors = getPlayersForItemPile(target).map(player => Utilities.getUserCharacter(player));\r\n  const items = pileData.shareItemsEnabled ? PileUtilities.getActorItems(target) : [];\r\n  const currencies = pileData.shareCurrenciesEnabled || pileData.splitAllEnabled ? PileUtilities.getActorCurrencies(target) : [];\r\n  for (const item of items) {\r\n    if (playerActors.every(character => getItemSharesLeftForActor(target, item, character, {\r\n      shareData,\r\n      floor: true,\r\n      players: playerActors.length\r\n    }))) {\r\n      return true;\r\n    }\r\n  }\r\n  for (const currency of currencies) {\r\n    if (currency.type === \"item\") {\r\n      if (playerActors.every(character => getItemSharesLeftForActor(target, currency.item, character, {\r\n        shareData,\r\n        floor: true,\r\n        players: playerActors.length\r\n      }))) {\r\n        return true;\r\n      }\r\n    } else {\r\n      if (playerActors.every(character => getAttributeSharesLeftForActor(target, currency.path, character, {\r\n        shareData,\r\n        floor: true,\r\n        players: playerActors.length\r\n      }))) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * Retrieves an item pile's sharing data\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @returns {Object}\r\n */\r\nexport function getItemPileSharingData(target) {\r\n  const targetActor = Utilities.getActor(target);\r\n  return foundry.utils.duplicate(getProperty(targetActor, CONSTANTS.FLAGS.SHARING) ?? {});\r\n}\r\n\r\n/**\r\n * Updates an item pile's sharing data\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @param {Object} incomingSharingData\r\n * @returns {Promise}\r\n */\r\nexport function updateItemPileSharingData(target, incomingSharingData) {\r\n  const targetActor = Utilities.getActor(target);\r\n  const currentSharingData = getItemPileSharingData(targetActor);\r\n  const newSharingData = foundry.utils.mergeObject(currentSharingData, incomingSharingData);\r\n  return targetActor.update({\r\n    [CONSTANTS.FLAGS.SHARING]: newSharingData\r\n  });\r\n}\r\n\r\n/**\r\n * Clears an item pile's sharing data\r\n *\r\n * @param {Actor|TokenDocument|foundry.abstract.Document|String} target\r\n * @returns {Promise}\r\n */\r\nexport function clearItemPileSharingData(target) {\r\n  const targetActor = Utilities.getActor(target);\r\n  return targetActor.update({\r\n    [CONSTANTS.FLAGS.SHARING]: null\r\n  });\r\n}\r\n\r\n/**\r\n * Merges and resolves existing sharing data on a given item pile\r\n *\r\n * @param {String} sourceUuid\r\n * @param {String} targetUuid\r\n * @param {Array<Object>} [items]\r\n * @param {Array<Object>} [attributes]\r\n */\r\nexport async function setItemPileSharingData(sourceUuid, targetUuid, { items = [], attributes = [] } = {}) {\r\n\r\n  const sourceActor = Utilities.getActor(sourceUuid);\r\n  const targetActor = Utilities.getActor(targetUuid);\r\n\r\n  const sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n  const targetIsItemPile = PileUtilities.isValidItemPile(targetActor);\r\n\r\n  // If both the source and target are item piles, we want to ignore this execution\r\n  if (sourceIsItemPile && targetIsItemPile) return;\r\n\r\n  if (items.length) {\r\n    items = items.map(itemData => {\r\n      Utilities.setItemQuantity(itemData.item, Math.abs(itemData.quantity));\r\n      return itemData.item;\r\n    })\r\n  }\r\n\r\n  if (!Array.isArray(attributes) && typeof attributes === \"object\") {\r\n    attributes = Object.entries(attributes).map(entry => {\r\n      return {\r\n        path: entry[0],\r\n        quantity: Math.abs(entry[1])\r\n      }\r\n    })\r\n  }\r\n\r\n  if (sourceIsItemPile) {\r\n\r\n    if (PileUtilities.isItemPileEmpty(sourceIsItemPile)) {\r\n      return clearItemPileSharingData(sourceIsItemPile);\r\n    }\r\n\r\n    const sharingData = addToItemPileSharingData(sourceActor, targetActor.uuid, { items, attributes });\r\n    return updateItemPileSharingData(sourceActor, sharingData);\r\n\r\n  }\r\n\r\n  const sharingData = removeFromItemPileSharingData(targetActor, sourceActor.uuid, { items, attributes });\r\n  return updateItemPileSharingData(targetActor, sharingData);\r\n\r\n}\r\n\r\nexport function addToItemPileSharingData(itemPile, actorUuid, {\r\n  sharingData = false,\r\n  items = [],\r\n  attributes = []\r\n} = {}) {\r\n\r\n  const pileData = PileUtilities.getActorFlagData(itemPile);\r\n\r\n  const pileCurrencies = PileUtilities.getActorCurrencies(itemPile, { getAll: true });\r\n\r\n  const filteredItems = items.filter(item => !pileCurrencies.some(currency => item.id !== currency.id));\r\n  const currencies = items.filter(item => !pileCurrencies.some(currency => item.id === currency.id));\r\n\r\n  let pileSharingData = {};\r\n  if (!sharingData && ((pileData.shareItemsEnabled && filteredItems.length) || (pileData.shareCurrenciesEnabled && (attributes.length || currencies.length)))) {\r\n    pileSharingData = getItemPileSharingData(itemPile);\r\n  }\r\n\r\n  if ((pileData.shareItemsEnabled && filteredItems.length) || (pileData.shareCurrenciesEnabled && currencies.length)) {\r\n\r\n    if (!pileSharingData.items) {\r\n      pileSharingData.items = [];\r\n    }\r\n\r\n    for (const item of filteredItems.concat(currencies)) {\r\n\r\n      let existingItem = Utilities.findSimilarItem(pileSharingData.items, item);\r\n\r\n      if (!existingItem) {\r\n        let itemIndex = pileSharingData.items.push(Utilities.setSimilarityProperties({\r\n          actors: [{ uuid: actorUuid, quantity: 0 }]\r\n        }, item))\r\n        existingItem = pileSharingData.items[itemIndex - 1];\r\n      } else if (!existingItem.actors) {\r\n        existingItem.actors = [];\r\n        existingItem._id = item.id;\r\n      }\r\n\r\n      let actorData = existingItem.actors.find(data => data.uuid === actorUuid);\r\n\r\n      const itemQuantity = Utilities.getItemQuantity(item);\r\n      if (!actorData) {\r\n        if (itemQuantity > 0) {\r\n          existingItem.actors.push({ uuid: actorUuid, quantity: itemQuantity })\r\n        }\r\n      } else {\r\n        actorData.quantity += itemQuantity;\r\n        if (actorData.quantity <= 0) {\r\n          existingItem.actors.splice(existingItem.actors.indexOf(actorData), 1);\r\n        }\r\n        if (existingItem.actors.length === 0) {\r\n          pileSharingData.items.splice(pileSharingData.items.indexOf(existingItem), 1)\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if (pileData.shareCurrenciesEnabled && attributes.length) {\r\n\r\n    if (!pileSharingData.attributes) {\r\n      pileSharingData.attributes = [];\r\n    }\r\n\r\n    for (const attribute of attributes) {\r\n\r\n      let existingCurrency = pileSharingData.attributes.find(sharingCurrency => sharingCurrency.path === attribute.path);\r\n\r\n      if (!existingCurrency) {\r\n        let itemIndex = pileSharingData.attributes.push({\r\n          path: attribute.path,\r\n          actors: [{ uuid: actorUuid, quantity: 0 }]\r\n        })\r\n        existingCurrency = pileSharingData.attributes[itemIndex - 1];\r\n      } else {\r\n        if (!existingCurrency.actors) {\r\n          existingCurrency.actors = [];\r\n        }\r\n      }\r\n\r\n      let actorData = existingCurrency.actors.find(data => data.uuid === actorUuid);\r\n\r\n      if (!actorData) {\r\n        if (attribute.quantity > 0) {\r\n          existingCurrency.actors.push({ uuid: actorUuid, quantity: attribute.quantity })\r\n        }\r\n      } else {\r\n        actorData.quantity += attribute.quantity;\r\n        if (actorData.quantity <= 0) {\r\n          existingCurrency.actors.splice(existingCurrency.actors.indexOf(actorData), 1);\r\n        }\r\n        if (existingCurrency.actors.length === 0) {\r\n          pileSharingData.attributes.splice(pileSharingData.attributes.indexOf(existingCurrency), 1)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  return pileSharingData;\r\n\r\n}\r\n\r\nexport function removeFromItemPileSharingData(itemPile, actorUuid, { items = [], attributes = [] } = {}) {\r\n\r\n  items = items.map(item => {\r\n    Utilities.setItemQuantity(item, Utilities.getItemQuantity(item) * -1)\r\n    return item;\r\n  });\r\n\r\n  attributes = attributes.map(attribute => {\r\n    attribute.quantity = attribute.quantity * -1;\r\n    return attribute;\r\n  });\r\n\r\n  return addToItemPileSharingData(itemPile, actorUuid, { items, attributes });\r\n\r\n}\r\n\r\nexport function getItemSharesLeftForActor(pile, item, recipient, {\r\n  currentQuantity = null,\r\n  floor = null,\r\n  players = null,\r\n  shareData = null\r\n} = {}) {\r\n\r\n  if (item instanceof String) {\r\n    item = pile.items.get(item);\r\n  }\r\n  let previouslyTaken = 0;\r\n  let recipientUuid = Utilities.getUuid(recipient);\r\n  currentQuantity = currentQuantity ?? Math.abs(Utilities.getItemQuantity(item));\r\n  let totalShares = currentQuantity;\r\n\r\n  shareData = shareData ?? getItemPileSharingData(pile);\r\n  if (shareData?.items?.length) {\r\n    const foundItem = Utilities.findSimilarItem(shareData.items, item);\r\n    if (foundItem) {\r\n      totalShares = foundItem.actors.reduce((acc, actor) => acc + actor.quantity, currentQuantity);\r\n      const quantityTakenBefore = foundItem.actors.find(actor => actor.uuid === recipientUuid);\r\n      previouslyTaken = quantityTakenBefore ? quantityTakenBefore.quantity : 0;\r\n    }\r\n  }\r\n\r\n  players = players ?? getPlayersForItemPile(pile).length;\r\n  let totalActorShare = totalShares / players;\r\n  if (!Number.isInteger(totalActorShare) && !floor) {\r\n    totalActorShare += 1;\r\n  }\r\n\r\n  return Math.max(0, Math.min(currentQuantity, Math.floor(totalActorShare - previouslyTaken)));\r\n\r\n}\r\n\r\nexport function getAttributeSharesLeftForActor(pile, path, recipient, {\r\n  currentQuantity = null,\r\n  floor = null,\r\n  players = null,\r\n  shareData = null\r\n} = {}) {\r\n\r\n  let previouslyTaken = 0;\r\n  let recipientUuid = Utilities.getUuid(recipient);\r\n  currentQuantity = currentQuantity ?? Number(getProperty(pile, path) ?? 0);\r\n  let totalShares = currentQuantity;\r\n\r\n  shareData = shareData ?? getItemPileSharingData(pile);\r\n  if (shareData?.attributes?.length) {\r\n    const existingCurrency = shareData.attributes.find(storedCurrency => storedCurrency.path === path);\r\n    if (existingCurrency) {\r\n      totalShares = existingCurrency.actors.reduce((acc, actor) => acc + actor.quantity, currentQuantity);\r\n\r\n      const quantityTakenBefore = existingCurrency?.actors?.find(actor => actor.uuid === recipientUuid);\r\n      previouslyTaken = quantityTakenBefore ? quantityTakenBefore.quantity : 0;\r\n    }\r\n  }\r\n\r\n  players = players ?? getPlayersForItemPile(pile).length;\r\n  let totalActorShare = totalShares / players;\r\n  if (!Number.isInteger(totalActorShare) && !floor) {\r\n    totalActorShare += 1;\r\n  }\r\n\r\n  return Math.max(0, Math.min(currentQuantity, Math.floor(totalActorShare - previouslyTaken)));\r\n\r\n}\r\n","<script>\n  import { getContext } from \"svelte\";\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\n  import * as Utilities from \"../../../helpers/utilities.js\";\n  import * as PileUtilities from \"../../../helpers/pile-utilities.js\";\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\n  import SliderInput from \"../../components/SliderInput.svelte\";\n\n  const { application } = getContext('#external');\n\n  export let item;\n  export let elementRoot;\n  export let target = false;\n\n  const unlimitedQuantity = application.options?.unlimitedQuantity ?? false;\n\n  let form;\n  let quantity = 1;\n\n  const itemQuantity = Utilities.getItemQuantity(item);\n  const sliderQuantity = itemQuantity + (application.options?.quantityAdjustment ?? 0);\n  const canItemStack = PileUtilities.canItemStack(item, target);\n\n  function requestSubmit() {\n    form.requestSubmit();\n  }\n\n  function submit() {\n    application.options.resolve(quantity);\n    application.close();\n  }\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\t<form autocomplete=\"off\" bind:this={form} class=\"item-piles-flexcol\" on:submit|once|preventDefault={submit}\n\t\t\t\tstyle=\"padding:0.5rem;\">\n\n\t\t<h3 style=\"text-align: center;\">\n\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.Header`, {\n        item_name: item.name\n      })}\n\t\t</h3>\n\n\t\t{#if target}\n\n\t\t\t<p class=\"item-piles-text-center\">\n\t\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.Content`, {\n          target_name: target.name\n        })}\n\t\t\t</p>\n\n\t\t{/if}\n\n\t\t{#if (itemQuantity > 1 || unlimitedQuantity) && canItemStack}\n\n\t\t\t<div class=\"form-group item-piles-text-center\">\n\t\t\t\t<label>{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.${unlimitedQuantity ? \"ContentInfiniteQuantity\" : \"ContentMultipleQuantity\"}`, {\n          target_name: target?.name ?? \"\",\n          quantity: itemQuantity,\n          itemName: item.name\n        })}</label>\n\t\t\t</div>\n\t\t\t{#if unlimitedQuantity}\n\t\t\t\t<input type=\"number\" min=\"1\" bind:value={quantity}/>\n\t\t\t{:else}\n\t\t\t\t<SliderInput min={1} max={sliderQuantity} maxInput={sliderQuantity} divideBy={1} bind:value={quantity}/>\n\t\t\t{/if}\n\t\t{/if}\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem;\">\n\t\t\t{#if target}\n\t\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t\t<i class=\"fas fa-download\"></i>\n\t\t\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.Submit`)}\n\t\t\t\t</button>\n\t\t\t{:else}\n\t\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t\t<i class=\"fas fa-box\"></i>\n\t\t\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.SubmitNoTarget`)}\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t\t<button on:click={() => { application.close() }} type=\"button\">\n\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t{localize(\"Cancel\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</form>\n</ApplicationShell>\n","import DropItemDialogShell from \"./drop-item-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class DropItemDialog extends SvelteApplication {\r\n\r\n  /**\r\n   *\r\n   * @param item\r\n   * @param target\r\n   * @param options\r\n   */\r\n  constructor(item, target, options = {\r\n    localizationTitle: \"DropItem\"\r\n  }) {\r\n    super({\r\n      title: game.i18n.localize(`ITEM-PILES.Applications.${options.localizationTitle}.Title`),\r\n      id: `item-pile-drop-item-${item.id}${target ? \"-\" + target.id : \"\"}-${randomID()}`,\r\n      svelte: {\r\n        class: DropItemDialogShell,\r\n        target: document.body,\r\n        props: {\r\n          item,\r\n          target\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    });\r\n    this.item = item;\r\n    this.target = target;\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 430,\r\n      height: \"auto\",\r\n      classes: [\"item-piles-app\"]\r\n    })\r\n  }\r\n\r\n  static getActiveApps(id) {\r\n    return getActiveApps(`item-pile-drop-item-${id}`);\r\n  }\r\n\r\n  static async show(item, target, options = {}) {\r\n    if (!options?.localizationTitle) {\r\n      options.localizationTitle = \"DropItem\";\r\n    }\r\n    const apps = this.getActiveApps(item.id + (target ? \"-\" + target.id : \"\"));\r\n    if (apps.length) {\r\n      for (let app of apps) {\r\n        app.render(false, { focus: true });\r\n      }\r\n      return;\r\n    }\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(item, target, options).render(true, { focus: true });\r\n    })\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import { fade } from 'svelte/transition';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { get } from \"svelte/store\";\r\n\r\n  export let store;\r\n  export let entry;\r\n  export let currency = false;\r\n\r\n  const name = entry.name;\r\n  const img = entry.img;\r\n  const rarityColor = entry.rarityColor;\r\n  const quantityLeft = entry.quantityLeft;\r\n  const quantity = entry.quantity;\r\n  const currentQuantity = entry.currentQuantity;\r\n  const pileData = store.pileData;\r\n\r\n  $: canInspectItems = entry.id && $pileData.canInspectItems;\r\n\r\n  const editQuantities = store.editQuantities;\r\n\r\n  function dragStart(event) {\r\n    event.dataTransfer.setData('text/plain', JSON.stringify({\r\n      type: \"Item\",\r\n      uuid: entry.item.uuid\r\n    }));\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow item-piles-item-row item-piles-even-color\"\r\n     transition:fade={{duration: 250}}\r\n     draggable={!!entry.id}\r\n     on:dragstart={(event) => { dragStart(event) }}\r\n     class:item-piles-disabled={!$editQuantities && (!$quantityLeft || !$quantity)}>\r\n\r\n  <div class=\"item-piles-img-container\">\r\n    <img class=\"item-piles-img\" src=\"{$img}\"/>\r\n  </div>\r\n\r\n  <div class=\"item-piles-name\">\r\n    <div class=\"item-piles-name-container\">\r\n      <p class:item-piles-clickable-link=\"{canInspectItems}\"\r\n\t\t\t\t on:click={() => { entry.preview() }}\r\n\t\t\t\t style=\"color: {$rarityColor || 'inherit'};\"\r\n\t\t\t>\r\n\t\t\t\t{$name}\r\n\t\t\t</p>\r\n      {#if !$editQuantities && entry.canStack && !currency}\r\n        <span class=\"item-piles-small-text\">(x{$quantity})</span>\r\n      {/if}\r\n    </div>\r\n  </div>\r\n\r\n  {#if entry.canStack || !entry.id}\r\n\r\n    <div class=\"item-piles-quantity-container\" style=\"flex:2.5;\">\r\n\r\n      {#if $editQuantities}\r\n\r\n        <div class=\"item-piles-quantity-input-container\">\r\n          <input class=\"item-piles-quantity\" type=\"number\" min=\"0\" bind:value=\"{$quantity}\"\r\n                 draggable=\"true\" on:dragstart|stopPropagation|preventDefault/>\r\n        </div>\r\n\r\n      {:else}\r\n\r\n        {#if $quantityLeft && $quantity}\r\n          <div class=\"item-piles-quantity-input-container\">\r\n            <input class=\"item-piles-quantity\" type=\"number\" min=\"1\" bind:value=\"{$currentQuantity}\"\r\n                   max=\"{$quantity}\" disabled=\"{!$quantity}\"/>\r\n\r\n            <span class=\"item-piles-input-divider\" class:item-piles-text-right={!store.recipient}>\r\n               / {$quantityLeft}\r\n            </span>\r\n          </div>\r\n        {:else}\r\n          <span>\r\n            {localize(`ITEM-PILES.Inspect.${entry.toShare && $quantity ? \"NoShareLeft\" : \"NoneLeft\"}`)}\r\n          </span>\r\n        {/if}\r\n      {/if}\r\n\r\n    </div>\r\n\r\n  {/if}\r\n\r\n  {#if !$editQuantities}\r\n\r\n    <button\r\n      on:click={() => { entry.take() }}\r\n      class=\"item-piles-item-take-button\"\r\n      type=\"button\"\r\n      disabled={!$quantityLeft || !$quantity}>\r\n      {localize(\"ITEM-PILES.Inspect.Take\")}\r\n    </button>\r\n\r\n  {:else if !entry.canStack && !entry.isCurrency}\r\n\r\n    <button\r\n      on:click={() => { entry.remove() }}\r\n      class=\"item-piles-item-take-button\"\r\n      type=\"button\"\r\n      disabled={!$quantityLeft}>\r\n      {localize(\"Remove\")}\r\n    </button>\r\n\r\n  {/if}\r\n\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { fade } from 'svelte/transition';\r\n  import ListEntry from \"./ListEntry.svelte\";\r\n\r\n  export let store;\r\n  const items = store.items;\r\n  const numItems = store.numItems;\r\n  \r\n</script>\r\n\r\n\r\n{#if $numItems > 0}\r\n\t<div in:fade|local={{duration: 150}}>\r\n\r\n\t\t<div class=\"item-piles-flexrow\"><h3>{localize(\"ITEM-PILES.Items\")}</h3></div>\r\n\r\n\t\t{#each $items as item (item.identifier)}\r\n\t\t\t<ListEntry {store} bind:entry={item}/>\r\n\t\t{/each}\r\n\r\n\t</div>\r\n\r\n{/if}\r\n","<script>\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\n  import { getContext } from \"svelte\";\n  import * as PileUtilities from \"../../../helpers/pile-utilities.js\";\n  import { abbreviateNumbers } from \"../../../helpers/helpers.js\";\n\n  const { application } = getContext('#external');\n\n  export let sourceActor;\n  export let targetActor;\n  export let localization;\n  export let settings;\n  export let elementRoot;\n\n  const targetCurrencyData = PileUtilities.getCurrencyList(targetActor);\n\n  const currencies = PileUtilities.getActorCurrencies(sourceActor, {\n    currencyList: targetActor ? targetCurrencyData.currencies : false,\n    getAll: settings?.unlimitedCurrencies\n  });\n\n  let attributes = currencies.filter(entry => entry.type === \"attribute\")\n    .map(currency => {\n      currency.currentQuantity = 0;\n      return currency;\n    });\n\n  if (settings?.existingCurrencies) {\n    attributes.forEach(currency => {\n      const existingCurrency = settings?.existingCurrencies.find(existingCurrency => existingCurrency.id === currency.id);\n      if (existingCurrency) {\n        currency.currentQuantity = existingCurrency.quantity;\n      }\n    });\n  }\n\n  let items = currencies.filter(entry => entry.type !== \"attribute\")\n    .map(currency => {\n      currency.create = !currency.id;\n      currency.id = currency.id ?? randomID();\n      currency.currentQuantity = 0;\n      return currency;\n    });\n\n  if (settings?.existingCurrencies) {\n    items.forEach(currency => {\n      const existingCurrency = settings?.existingCurrencies.find(existingCurrency => existingCurrency.id === currency.id);\n      if (existingCurrency) {\n        currency.currentQuantity = existingCurrency.quantity;\n      }\n    });\n  }\n\n  let form;\n\n  function requestSubmit() {\n    form.requestSubmit();\n  }\n\n  function submit() {\n\n    const itemsToUpdate = items\n      .filter(item => (settings.unlimitedCurrencies || item.currentQuantity) && !item.create)\n      .map(item => {\n        return {\n          _id: item.id,\n          quantity: settings.getUpdates ? item.currentQuantity - item.quantity : item.currentQuantity\n        }\n      })\n\n    const itemsToCreate = items\n      .filter(item => item.currentQuantity && item.create)\n      .map(item => ({ item: item.data.item, quantity: item.currentQuantity }))\n\n    application.options.resolve({\n      attributes: Object.fromEntries(attributes\n        .filter(attribute => settings.unlimitedCurrencies || attribute.currentQuantity)\n        .map(attribute => [attribute.path, attribute.currentQuantity])\n      ),\n      items: itemsToUpdate.concat(itemsToCreate)\n    });\n    application.close();\n  }\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\n\t<form class=\"item-piles-flexcol\" bind:this={form} on:submit|once|preventDefault={submit} style=\"padding:0.5rem;\"\n\t\t\t\tautocomplete=\"off\">\n\n\t\t{#if attributes.length || items.length}\n\n\t\t\t<p style=\"text-align: center; margin: 0;\" class=\"item-piles-bottom-divider\">\n\t\t\t\t{settings?.content ?? localize(`ITEM-PILES.Applications.${localization}.Content`)}\n\t\t\t</p>\n\n\t\t\t{#each attributes.filter(currency => !currency.secondary) as attribute, index (attribute.path)}\n\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{attribute.img}\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t<div>{attribute.name}</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{attribute.quantity}\"\n\t\t\t\t\t\t\t\t\t bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t bind:value={attribute.currentQuantity}\n\t\t\t\t\t\t\t\t\t on:click={() => {\n                        attribute.currentQuantity = Math.max(0, Math.min(attribute.quantity, attribute.currentQuantity));\n                   }}/>\n\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(attribute.quantity)}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/each}\n\n\t\t\t{#each items.filter(currency => !currency.secondary) as item, index (item.id)}\n\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{item.img}\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t<div>{item.name}</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t bind:value={item.currentQuantity}/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{item.quantity}\"\n\t\t\t\t\t\t\t\t\t bind:value={item.currentQuantity}/>\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 1.5; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t bind:value={item.currentQuantity}\n\t\t\t\t\t\t\t\t\t on:click={() => {\n                        item.currentQuantity = Math.max(0, Math.min(item.quantity, item.currentQuantity));\n                   }}/>\n\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(item.quantity)}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/each}\n\n\t\t\t{#if attributes.filter(currency => currency.secondary).length || items.filter(currency => currency.secondary).length}\n\n\t\t\t\t<div class=\"item-piles-top-divider\"></div>\n\n\t\t\t\t{#each attributes.filter(currency => currency.secondary) as attribute, index (attribute.path)}\n\t\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{attribute.img}\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t\t<div>{attribute.name}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t\t bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{attribute.quantity}\"\n\t\t\t\t\t\t\t\t\t\t bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t\t bind:value={attribute.currentQuantity}\n\t\t\t\t\t\t\t\t\t\t on:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tattribute.currentQuantity = Math.max(0, Math.min(attribute.quantity, attribute.currentQuantity));\n\t\t\t\t\t\t\t\t\t\t }}/>\n\t\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(attribute.quantity)}</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\n\t\t\t\t{#each items.filter(currency => currency.secondary) as item, index (item.id)}\n\t\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{item.img}\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t\t<div>{item.name}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t\t bind:value={item.currentQuantity}/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{item.quantity}\"\n\t\t\t\t\t\t\t\t\t\t bind:value={item.currentQuantity}/>\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 1.5; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t\t\t\t bind:value={item.currentQuantity}\n\t\t\t\t\t\t\t\t\t\t on:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\titem.currentQuantity = Math.max(0, Math.min(item.quantity, item.currentQuantity));\n\t\t\t\t\t\t\t\t\t\t }}/>\n\t\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(item.quantity)}</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\n\t\t\t{/if}\n\n\t\t{:else}\n\n\t\t\t<p style=\"text-align: center;\">\n\t\t\t\t{localize(`ITEM-PILES.Applications.${localization}.NoCurrency`, { actor_name: sourceActor.name })}\n\t\t\t</p>\n\n\t\t{/if}\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem;\">\n\t\t\t{#if attributes.length || items.length}\n\t\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t\t<i class=\"fas fa-download\"></i>\n\t\t\t\t\t{localize(settings?.button ?? `ITEM-PILES.Applications.${localization}.Submit`)}\n\t\t\t\t</button>\n\t\t\t{/if}\n\n\t\t\t<button type=\"button\" on:click|once={() => { application.close() }}>\n\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t{localize(\"Cancel\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</form>\n\n</ApplicationShell>\n","import DropCurrencyDialogShell from \"./drop-currency-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class DropCurrencyDialog extends SvelteApplication {\r\n\r\n  /**\r\n   *\r\n   * @param sourceActor\r\n   * @param targetActor\r\n   * @param settings\r\n   * @param options\r\n   */\r\n  constructor(sourceActor, targetActor, settings = {}, options = {}) {\r\n    const localization = settings.localization || \"DropCurrencies\";\r\n    super({\r\n      id: `item-pile-drop-currency-${sourceActor ? (sourceActor.id + (targetActor ? \"-\" + targetActor.id : \"\")) : \"\"}-${randomID()}`,\r\n      title: settings.title ?? game.i18n.localize(`ITEM-PILES.Applications.${localization}.Title`),\r\n      svelte: {\r\n        class: DropCurrencyDialogShell,\r\n        target: document.body,\r\n        props: {\r\n          sourceActor,\r\n          targetActor,\r\n          localization,\r\n          settings\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 430,\r\n      height: \"auto\",\r\n      classes: [\"item-piles-app\"]\r\n    })\r\n  }\r\n\r\n  static getActiveApps(id) {\r\n    return getActiveApps(`item-pile-drop-currency-${id}`);\r\n  }\r\n\r\n  static async show(sourceActor, targetActor, settings = {}, options = {}) {\r\n    if (sourceActor) {\r\n      const apps = this.getActiveApps(targetActor ? sourceActor.id + \"-\" + targetActor.id : sourceActor.id);\r\n      if (apps.length) {\r\n        for (let app of apps) {\r\n          app.render(false, { focus: true });\r\n        }\r\n        return;\r\n      }\r\n    }\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(sourceActor, targetActor, settings, options).render(true, { focus: true });\r\n    })\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import DropCurrencyDialog from \"../dialogs/drop-currency-dialog/drop-currency-dialog.js\";\r\n  import ListEntry from \"./ListEntry.svelte\";\r\n\r\n  export let store;\r\n  const currencies = store.currencies;\r\n  const numItems = store.numItems;\r\n  const numCurrencies = store.numCurrencies;\r\n  const editQuantities = store.editQuantities;\r\n\r\n</script>\r\n\r\n<div>\r\n\r\n\t<div class=\"item-piles-flexrow\">\r\n\t\t{#if $numCurrencies > 0}\r\n\t\t\t<h3>{localize(\"ITEM-PILES.Currencies\")}:</h3>\r\n\t\t{/if}\r\n\t\t<a class=\"item-piles-clickable item-piles-text-right item-piles-small-text item-piles-middle\"\r\n\t\t\t on:click={() => store.addCurrency(store.recipient)}>\r\n\t\t\t<i class=\"fas fa-plus\"></i> {localize(\"ITEM-PILES.Inspect.AddCurrency\")}\r\n\t\t</a>\r\n\t</div>\r\n\t{#if $numCurrencies > 0}\r\n\t\t<div>\r\n\t\t\t{#each $currencies as currency, index (currency.identifier)}\r\n\t\t\t\t<ListEntry {store} bind:entry={currency} currency/>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t{/if}\r\n\r\n</div>\r\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import * as Utilities from \"../../helpers/utilities.js\";\r\n\r\n  export let store;\r\n  export let localization = \"ITEM-PILES.Inspect.AsActor\";\r\n  export let style = \"text-align: center; flex: 0 1 auto; height: 27px;\";\r\n\r\n  let editQuantities = store.editQuantities;\r\n\r\n  let changingActor = false;\r\n  let playerActors = game.actors.filter(actor => actor.isOwner && actor !== store.pileActor && actor.prototypeToken.actorLink);\r\n  let recipientUuid = Utilities.getUuid(store.recipient);\r\n  const recipientDoc = store.recipientDocument;\r\n\r\n  $: {\r\n    $recipientDoc;\r\n    recipientUuid = store.recipient ? Utilities.getUuid(store.recipient) : false;\r\n  }\r\n\r\n  function changeRecipientActor() {\r\n    store.recipient = playerActors.find(actor => Utilities.getUuid(actor) === recipientUuid);\r\n    store.update();\r\n    changingActor = false;\r\n  }\r\n\r\n</script>\r\n\r\n{#if $editQuantities}\r\n\t<div {style}>{localize(\"ITEM-PILES.Inspect.Owner\")}</div>\r\n{:else}\r\n\t<div {style}>\r\n\t\t{#if !changingActor}\r\n\t\t\t{localize(localization, { actorName: $recipientDoc.name })}\r\n\t\t{/if}\r\n\t\t{#if playerActors.length > 1}\r\n\t\t\t{#if !changingActor}\r\n\t\t\t\t<a class='item-piles-highlight' on:click={() => { changingActor = true }} class:active={!changingActor}>\r\n\t\t\t\t\tChange.\r\n\t\t\t\t</a>\r\n\t\t\t{:else}\r\n\t\t\t\t<select\r\n\t\t\t\t\tclass=\"item-piles-change-actor-select\"\r\n\t\t\t\t\tbind:value={recipientUuid}\r\n\t\t\t\t\ton:change={changeRecipientActor}\r\n\t\t\t\t\tclass:active={changingActor}\r\n\t\t\t\t\tstyle=\"height:auto;\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{#each playerActors as actor, index (index)}\r\n\t\t\t\t\t\t<option value=\"{Utilities.getUuid(actor.uuid)}\">{actor.name}</option>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t{/if}\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","import * as Helpers from \"../helpers/helpers.js\";\r\n\r\nexport default class BasePlugin {\r\n\r\n  constructor(pluginName, minVersion, invalidVersion) {\r\n    this.pluginName = pluginName;\r\n    this.minVersion = minVersion;\r\n    this.invalidVersion = invalidVersion;\r\n    this.initialized = false;\r\n    this.initialize();\r\n  }\r\n\r\n  invalidVersionError = \"\"\r\n  minVersionError = \"\"\r\n\r\n  initialize() {\r\n\r\n    if (!game.modules.get(this.pluginName)?.active) {\r\n      return;\r\n    }\r\n\r\n    if (game.modules.get(this.pluginName).version === this.invalidVersion) {\r\n      if (this.invalidVersionError) {\r\n        throw Helpers.custom_error(this.invalidVersionError);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (isNewerVersion(this.minVersion, game.modules.get(this.pluginName).version)) {\r\n      if (this.minVersionError) {\r\n        throw Helpers.custom_error(this.minVersionError);\r\n      }\r\n      return;\r\n    }\r\n\r\n    this.registerHooks();\r\n\r\n    this.initialized = true;\r\n\r\n  }\r\n\r\n  registerHooks() {\r\n\r\n  }\r\n\r\n}\r\n","import * as Utilities from \"./utilities.js\";\r\nimport * as PileUtilities from \"./pile-utilities.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport PrivateAPI from \"../API/private-api.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport { getItemFlagData } from \"./pile-utilities.js\";\r\n\r\nexport default class Transaction {\r\n\r\n  constructor(actor) {\r\n    this.actor = actor;\r\n    this.itemsToCreate = [];\r\n    this.itemsToUpdate = [];\r\n    this.itemsToDelete = [];\r\n    this.itemsToForceDelete = new Set();\r\n    this.itemsToNotDelete = new Set();\r\n    this.actorUpdates = {};\r\n    this.attributeDeltas = new Map();\r\n    this.attributeTypeMap = new Map();\r\n    this.itemDeltas = new Map();\r\n    this.itemTypeMap = new Map();\r\n    this.itemFlagMap = new Map();\r\n    this.preCommitted = false;\r\n  }\r\n\r\n  async appendItemChanges(items, {\r\n    remove = false,\r\n    type = \"item\",\r\n    keepIfZero = false,\r\n    onlyDelta = false,\r\n  } = {}) {\r\n\r\n    for (let data of items) {\r\n\r\n      let item = data.item ?? data;\r\n\r\n      type = PileUtilities.isItemCurrency(item, { target: this.actor })\r\n        ? \"currency\" : type;\r\n\r\n      let flags = data.flags ?? false;\r\n      let itemData = item instanceof Item ? item.toObject() : foundry.utils.duplicate(item);\r\n      if (SYSTEMS.DATA.ITEM_TRANSFORMER && !remove) {\r\n        itemData = await SYSTEMS.DATA.ITEM_TRANSFORMER(itemData);\r\n      }\r\n      const incomingQuantity = Math.abs(data.quantity ?? Utilities.getItemQuantity(itemData)) * (remove ? -1 : 1);\r\n      let itemId = itemData._id ?? itemData.id;\r\n      const actorHasItem = this.actor.items.get(itemId);\r\n      const actorExistingItem = actorHasItem || Utilities.findSimilarItem(this.actor.items, itemData, PileUtilities.getActorFlagData(this.actor), type === \"currency\");\r\n      const canItemStack = PileUtilities.canItemStack(actorExistingItem || itemData, this.actor);\r\n\r\n      if (!canItemStack) {\r\n\r\n        if (remove && actorExistingItem) {\r\n          this.itemTypeMap.set(actorExistingItem.id, type);\r\n          if (!onlyDelta) {\r\n            this.itemsToForceDelete.add(actorExistingItem.id);\r\n          }\r\n          this.itemDeltas.set(actorExistingItem.id, -1);\r\n        } else {\r\n          if (!itemId) {\r\n            itemId = randomID();\r\n          }\r\n          this.itemTypeMap.set(itemId, type)\r\n          this.itemsToCreate.push(itemData);\r\n        }\r\n\r\n      } else if (actorExistingItem) {\r\n\r\n        const existingItemUpdate = remove ? this.itemsToUpdate.find(item => item._id === itemId) : Utilities.findSimilarItem(this.itemsToUpdate, itemData);\r\n        if (keepIfZero || type === \"currency\") {\r\n          this.itemsToNotDelete.add(item.id);\r\n        }\r\n        if (!onlyDelta) {\r\n          if (existingItemUpdate) {\r\n            const newQuantity = Utilities.getItemQuantity(existingItemUpdate) + incomingQuantity;\r\n            Utilities.setItemQuantity(existingItemUpdate, newQuantity);\r\n            if (keepIfZero && type !== \"currency\") {\r\n              setProperty(existingItemUpdate, CONSTANTS.FLAGS.ITEM + \".notForSale\", newQuantity === 0);\r\n            }\r\n          } else {\r\n            const newQuantity = Utilities.getItemQuantity(actorExistingItem) + incomingQuantity;\r\n            const update = Utilities.setItemQuantity(actorExistingItem.toObject(), newQuantity);\r\n            if (keepIfZero && type !== \"currency\") {\r\n              setProperty(update, CONSTANTS.FLAGS.ITEM + \".notForSale\", newQuantity === 0);\r\n            }\r\n            this.itemTypeMap.set(actorExistingItem.id, type)\r\n            this.itemsToUpdate.push(update);\r\n          }\r\n        }\r\n        this.itemDeltas.set(actorExistingItem.id,\r\n          (this.itemDeltas.has(actorExistingItem.id) ? this.itemDeltas.get(actorExistingItem.id) : 0) + incomingQuantity\r\n        );\r\n      } else {\r\n        if (!itemData._id) {\r\n          itemData._id = randomID();\r\n        }\r\n\r\n        const existingItemCreation = Utilities.findSimilarItem(this.itemsToCreate, itemData);\r\n        if (existingItemCreation) {\r\n          const newQuantity = Utilities.getItemQuantity(existingItemCreation) + incomingQuantity;\r\n          Utilities.setItemQuantity(existingItemCreation, newQuantity);\r\n        } else {\r\n          Utilities.setItemQuantity(itemData, incomingQuantity);\r\n          this.itemsToCreate.push(itemData);\r\n          this.itemTypeMap.set(itemData._id, type)\r\n        }\r\n      }\r\n\r\n      if (flags) {\r\n        this.itemFlagMap.set(itemData._id, flags);\r\n      }\r\n    }\r\n  }\r\n\r\n  async appendActorChanges(attributes, { set = false, remove = false, type = \"attribute\", onlyDelta = false } = {}) {\r\n    if (!Array.isArray(attributes)) {\r\n      attributes = Object.entries(attributes).map(entry => ({ path: entry[0], quantity: entry[1] }));\r\n    }\r\n    this.actorUpdates = attributes.reduce((acc, attribute) => {\r\n      const incomingQuantity = Math.abs(attribute.quantity) * (remove ? -1 : 1);\r\n      acc[attribute.path] = acc[attribute.path] ?? Number(getProperty(this.actor, attribute.path));\r\n      if (set) {\r\n        if (!onlyDelta) {\r\n          acc[attribute.path] = incomingQuantity\r\n        }\r\n        this.attributeDeltas.set(attribute.path,\r\n          (this.attributeDeltas.has(attribute.path) ? this.attributeDeltas.get(attribute.path) : acc[attribute.path]) + incomingQuantity\r\n        );\r\n      } else {\r\n        if (!onlyDelta) {\r\n          acc[attribute.path] += incomingQuantity\r\n        }\r\n        this.attributeDeltas.set(attribute.path,\r\n          (this.attributeDeltas.has(attribute.path) ? this.attributeDeltas.get(attribute.path) : 0) + incomingQuantity\r\n        );\r\n      }\r\n      this.attributeTypeMap.set(attribute.path, type)\r\n      return acc;\r\n    }, this.actorUpdates);\r\n  }\r\n\r\n  prepare() {\r\n\r\n    this.actorUpdates = Object.fromEntries(Object.entries(this.actorUpdates).filter(entry => {\r\n      if (this.attributeDeltas.get(entry[0]) === 0) {\r\n        this.attributeDeltas.delete(entry[0]);\r\n      }\r\n      return Number(getProperty(this.actor, entry[0])) !== entry[1];\r\n    }))\r\n    this.itemsToCreate = this.itemsToCreate.filter(item => {\r\n      return !PileUtilities.canItemStack(item, this.actor) || Utilities.getItemQuantity(item) > 0 || this.itemTypeMap.get(item._id) === \"currency\"\r\n    });\r\n    this.itemsToDelete = this.itemsToUpdate.filter(item => {\r\n      return Utilities.getItemQuantity(item) <= 0 && this.itemTypeMap.get(item._id) !== \"currency\";\r\n    }).map(item => item._id).concat(Array.from(this.itemsToForceDelete));\r\n\r\n    for (const itemId of this.itemsToDelete) {\r\n      if (this.itemsToNotDelete.has(itemId)) {\r\n        this.itemsToDelete.splice(this.itemsToDelete.indexOf(itemId), 1);\r\n      }\r\n    }\r\n\r\n    this.itemDeltas = Array.from(this.itemDeltas).map(([id, quantity]) => {\r\n      const item = this.actor.items.get(id).toObject();\r\n      const existingFlags = getItemFlagData(item);\r\n      setProperty(item, CONSTANTS.FLAGS.ITEM, foundry.utils.mergeObject(\r\n        existingFlags,\r\n        this.itemFlagMap.get(id) ?? {}\r\n      ));\r\n      const type = this.itemTypeMap.get(id);\r\n      Utilities.setItemQuantity(item, quantity, true);\r\n      return { item, quantity, type };\r\n    }).filter(delta => delta.quantity);\r\n\r\n    this.itemsToUpdate = this.itemsToUpdate\r\n      .filter(item => Utilities.getItemQuantity(item) > 0 || this.itemsToNotDelete.has(item._id) || this.itemTypeMap.get(item._id) === \"currency\")\r\n      .filter(itemData => {\r\n        const item = this.actor.items.get(itemData._id)\r\n        return Utilities.getItemQuantity(item) !== Utilities.getItemQuantity(itemData);\r\n      });\r\n    this.attributeDeltas = Object.fromEntries(this.attributeDeltas);\r\n    this.preCommitted = true;\r\n    return {\r\n      actorUpdates: this.actorUpdates,\r\n      itemsToCreate: this.itemsToCreate,\r\n      itemsToDelete: this.itemsToDelete,\r\n      itemsToUpdate: this.itemsToUpdate,\r\n      attributeDeltas: this.attributeDeltas,\r\n      itemDeltas: this.itemDeltas,\r\n    }\r\n  }\r\n\r\n  async commit() {\r\n\r\n    if (!this.preCommitted) {\r\n      this.prepare();\r\n    }\r\n\r\n    let itemsCreated;\r\n    const actorUuid = Utilities.getUuid(this.actor);\r\n    if (this.actor.isOwner) {\r\n      itemsCreated = await PrivateAPI._commitActorChanges(actorUuid, {\r\n        actorUpdates: this.actorUpdates,\r\n        itemsToUpdate: this.itemsToUpdate,\r\n        itemsToDelete: this.itemsToDelete,\r\n        itemsToCreate: this.itemsToCreate\r\n      })\r\n    } else {\r\n      itemsCreated = await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.COMMIT_ACTOR_CHANGES, actorUuid, {\r\n        actorUpdates: this.actorUpdates,\r\n        itemsToUpdate: this.itemsToUpdate,\r\n        itemsToDelete: this.itemsToDelete,\r\n        itemsToCreate: this.itemsToCreate\r\n      });\r\n    }\r\n\r\n    return {\r\n      attributeDeltas: this.attributeDeltas,\r\n      itemDeltas: this.itemDeltas.concat(itemsCreated.map(item => {\r\n        return {\r\n          item,\r\n          quantity: PileUtilities.canItemStack(item) ? Utilities.getItemQuantity(item) : 1\r\n        }\r\n      }))\r\n    }\r\n  }\r\n}\r\n","import BasePlugin from \"./base-plugin.js\";\r\nimport ItemPileStore from \"../stores/item-pile-store.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport Transaction from \"../helpers/transaction.js\";\r\n\r\nlet previousState;\r\n\r\nexport default class SimpleCalendarPlugin extends BasePlugin {\r\n\r\n  invalidVersionError = \"Simple Calendar version 1.3.75 is installed, but Item Piles requires version 2.0.0 or above. The author made a mistake, and you will need to reinstall the Simple Calendar module.\";\r\n  minVersionError = \"Simple Calendar is out of date to be compatible with Item Piles, please update as soon as possible.\";\r\n\r\n  registerHooks() {\r\n    previousState = {\r\n      dateTime: window.SimpleCalendar.api.currentDateTime(),\r\n      weekday: window.SimpleCalendar.api.getCurrentWeekday(),\r\n      timestamp: window.SimpleCalendar.api.dateToTimestamp({})\r\n    }\r\n    console.log(previousState)\r\n    Hooks.on(window.SimpleCalendar.Hooks.DateTimeChange, () => {\r\n      ItemPileStore.notifyAllOfChanges(\"updateOpenCloseStatus\");\r\n      this.handleTimePassed();\r\n    });\r\n  }\r\n\r\n  async handleTimePassed() {\r\n\r\n    const newState = {\r\n      dateTime: window.SimpleCalendar.api.currentDateTime(),\r\n      weekday: window.SimpleCalendar.api.getCurrentWeekday(),\r\n      timestamp: window.SimpleCalendar.api.dateToTimestamp({})\r\n    }\r\n\r\n    const currentCalendar = window.SimpleCalendar.api.getCurrentCalendar();\r\n    const numWeekdays = currentCalendar.weekdays.length;\r\n\r\n    const notes = window.SimpleCalendar.api.getNotes()\r\n      .filter(note => getProperty(note, \"flags.foundryvtt-simple-calendar.noteData.categories\")?.length)\r\n      .map(note => {\r\n        const flags = getProperty(note, \"flags.foundryvtt-simple-calendar.noteData\");\r\n        let timestampData = {\r\n          year: flags.startDate.year,\r\n          month: flags.startDate.month,\r\n          day: flags.startDate.day,\r\n          hour: flags.allDay ? 0 : flags.startDate.hour,\r\n          minute: flags.allDay ? 0 : flags.startDate.minute,\r\n          seconds: flags.allDay ? 0 : flags.startDate.seconds,\r\n        };\r\n        switch (flags?.repeats) {\r\n          case window.SimpleCalendar.api.NoteRepeat.Weekly:\r\n            const noteWeekDay = window.SimpleCalendar.api.timestampToDate(window.SimpleCalendar.api.dateToTimestamp(timestampData)).dayOfTheWeek - 1;\r\n            const currentWeekDay = window.SimpleCalendar.api.timestampToDate(newState.timestamp).dayOfTheWeek - 1;\r\n            let weekdayCountDifference = currentWeekDay - noteWeekDay;\r\n            if (weekdayCountDifference < 0) {\r\n              weekdayCountDifference += numWeekdays\r\n            }\r\n            timestampData.year = newState.dateTime.year;\r\n            timestampData.month = newState.dateTime.month;\r\n            timestampData.day = newState.dateTime.day;\r\n            const weekInSeconds = SimpleCalendar.api.timestampPlusInterval(0, { day: 1 }) * weekdayCountDifference;\r\n            const timestamp = window.SimpleCalendar.api.dateToTimestamp(timestampData) - weekInSeconds;\r\n            timestampData.day = window.SimpleCalendar.api.timestampToDate(timestamp).day;\r\n            break;\r\n\r\n          case window.SimpleCalendar.api.NoteRepeat.Monthly:\r\n            timestampData.year = newState.dateTime.year;\r\n            timestampData.month = newState.dateTime.month;\r\n            break;\r\n\r\n          case window.SimpleCalendar.api.NoteRepeat.Yearly:\r\n            timestampData.year = newState.dateTime.year;\r\n            break;\r\n        }\r\n        return {\r\n          document: note,\r\n          flags,\r\n          dateTime: timestampData,\r\n          timestamp: window.SimpleCalendar.api.dateToTimestamp(timestampData)\r\n        }\r\n      })\r\n      .filter(note => {\r\n        return note.timestamp > previousState.timestamp && note.timestamp <= newState.timestamp;\r\n      });\r\n\r\n    const categories = new Set(notes.map(note => note.flags?.categories ?? []).deepFlatten());\r\n\r\n    const actors = PileUtilities.getItemPileActors((actor) => {\r\n      const flags = PileUtilities.getActorFlagData(actor, getProperty(actor, CONSTANTS.FLAGS.PILE));\r\n      if (flags.type !== CONSTANTS.PILE_TYPES.MERCHANT) return false;\r\n      return merchantRefreshFilter(flags, newState, previousState, categories);\r\n    });\r\n\r\n    const { validTokensOnScenes } = PileUtilities.getItemPileTokens((token) => {\r\n      const flags = PileUtilities.getActorFlagData(token, getProperty(token, CONSTANTS.FLAGS.PILE));\r\n      if (flags.type !== CONSTANTS.PILE_TYPES.MERCHANT) return false;\r\n      return merchantRefreshFilter(flags, newState, previousState, categories);\r\n    });\r\n\r\n    previousState = newState;\r\n\r\n    for (const actor of actors) {\r\n      await this.refreshActorItems(actor);\r\n    }\r\n\r\n    for (const [_, tokens] of validTokensOnScenes) {\r\n      for (const token of tokens) {\r\n        await this.refreshActorItems(token.actor);\r\n      }\r\n    }\r\n  }\r\n\r\n  async refreshActorItems(actor) {\r\n\r\n    const actorTransaction = new Transaction(actor);\r\n\r\n    const actorItems = game.itempiles.API.getActorItems(actor);\r\n    const newActorItems = await PileUtilities.rollMerchantTables({ actor });\r\n\r\n    await actorTransaction.appendItemChanges(actorItems.filter(item => {\r\n      const itemFlags = PileUtilities.getItemFlagData(item);\r\n      return !itemFlags.isService && !itemFlags.keepOnMerchant && !itemFlags.keepIfZero;\r\n    }), { remove: true });\r\n\r\n    await actorTransaction.appendItemChanges(actorItems.filter(item => {\r\n      const itemFlags = PileUtilities.getItemFlagData(item);\r\n      return !itemFlags.isService && !itemFlags.keepOnMerchant && itemFlags.keepIfZero;\r\n    }), { remove: true, keepIfZero: true });\r\n\r\n    await actorTransaction.appendItemChanges(newActorItems.map(entry => ({\r\n      item: entry.item, quantity: entry.quantity, flags: entry.flags\r\n    })));\r\n\r\n    await actorTransaction.commit();\r\n\r\n  }\r\n}\r\n\r\nfunction merchantRefreshFilter(flags, newState, previousState, categories) {\r\n\r\n  const openTimesEnabled = flags.openTimes.enabled;\r\n\r\n  if (!openTimesEnabled) return false;\r\n\r\n  const openTimes = flags.openTimes.open;\r\n  const closeTimes = flags.openTimes.close;\r\n\r\n  const openHour = openTimesEnabled ? openTimes.hour : 0;\r\n  const openMinute = openTimesEnabled ? openTimes.minute : 0;\r\n  const closeHour = openTimesEnabled ? closeTimes.hour : 0;\r\n  const closeMinute = openTimesEnabled ? closeTimes.minute : 0;\r\n\r\n  const openingTime = Number(openHour.toString() + \".\" + openMinute.toString());\r\n  const closingTime = Number(closeHour.toString() + \".\" + closeMinute.toString());\r\n  const previousTime = Number(previousState.dateTime.hour.toString() + \".\" + previousState.dateTime.minute.toString());\r\n  const currentTime = Number(newState.dateTime.hour.toString() + \".\" + newState.dateTime.minute.toString());\r\n\r\n  const wasOpen = openingTime > closingTime\r\n    ? (previousTime >= openingTime || previousTime <= closingTime)\r\n    : (previousTime >= openingTime && previousTime <= closingTime);\r\n\r\n  const isOpen = openingTime > closingTime\r\n    ? (currentTime >= openingTime || currentTime <= closingTime)\r\n    : (currentTime >= openingTime && currentTime <= closingTime);\r\n\r\n  const allWeekdays = window.SimpleCalendar.api.getAllWeekdays();\r\n  const dayLength = SimpleCalendar.api.timestampPlusInterval(0, { day: 1 });\r\n\r\n  const daysPassed = Math.floor((newState.timestamp - previousState.timestamp) / dayLength);\r\n\r\n  const currentWeekday = newState.weekday;\r\n\r\n  const shouldRefreshOnCurrentWeekday = flags.refreshItemsDays.includes(currentWeekday.name);\r\n  const shouldRefreshPastWeekday = flags.refreshItemsDays.length > 0 && daysPassed >= allWeekdays.length;\r\n\r\n  const shouldRefresh = (\r\n    flags.refreshItemsOnOpen ||\r\n    shouldRefreshOnCurrentWeekday ||\r\n    shouldRefreshPastWeekday ||\r\n    categories.intersection(new Set(flags.refreshItemsHolidays)).size > 0\r\n  );\r\n\r\n  return (!wasOpen && isOpen) && shouldRefresh;\r\n\r\n}\r\n","import BasePlugin from \"./base-plugin.js\";\r\nimport PrivateAPI from \"../API/private-api.js\";\r\n\r\nexport default class Levels3dPreview extends BasePlugin {\r\n\r\n  registerHooks() {\r\n\r\n    Hooks.on(\"3DCanvasConfig\", (config) => {\r\n      config.INTERACTIONS.dropFunctions.Item = async function (event, data) {\r\n        canvas.tokens.activate();\r\n        return PrivateAPI._dropData(canvas, data);\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import BasePlugin from \"./base-plugin.js\";\r\n\r\nexport default class RarityColors extends BasePlugin {\r\n\r\n  getItemColor(item) {\r\n\r\n    if (game.system.id !== \"dnd5e\") return false;\r\n\r\n    const itemType = item.type;\r\n    const rarity = item.system.rarity ? item.system.rarity.replaceAll(/\\s/g, \"\").toLowerCase().trim() : itemType;\r\n\r\n    const isSpell = itemType === \"spell\";\r\n    const spellFlag = game.settings.get(this.pluginName, \"spellFlag\");\r\n\r\n    const isFeat = itemType === \"feat\";\r\n    const featFlag = game.settings.get(this.pluginName, \"featFlag\");\r\n\r\n    let doColor = false;\r\n    if (item.system.rarity && item.system.rarity !== \"common\") {\r\n      doColor = true;\r\n    } else if (isSpell && spellFlag) {\r\n      doColor = true;\r\n    } else if (isFeat && featFlag) {\r\n      doColor = true;\r\n    }\r\n\r\n    if (!doColor) return false;\r\n\r\n    try {\r\n      return game.settings.get(this.pluginName, rarity);\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n\r\n  }\r\n\r\n}\r\n","import SimpleCalendarPlugin from \"./simple-calendar.js\";\r\nimport Levels3dPreview from \"./levels-3d-preview.js\";\r\nimport RarityColors from \"./rarity-colors.js\";\r\n\r\nexport const Plugins = {\r\n  \"foundryvtt-simple-calendar\": {\r\n    on: \"ready\",\r\n    data: null,\r\n    class: SimpleCalendarPlugin,\r\n    minVersion: \"2.0.0\",\r\n    invalidVersion: \"v1.3.75\"\r\n  },\r\n  \"levels-3d-preview\": {\r\n    on: \"init\",\r\n    data: null,\r\n    class: Levels3dPreview,\r\n    minVersion: \"4.9.6\"\r\n  },\r\n  \"rarity-colors\": {\r\n    on: \"init\",\r\n    data: null,\r\n    class: RarityColors,\r\n    minVersion: \"0.2.4\"\r\n  }\r\n}\r\n\r\nexport function setupPlugins(hook) {\r\n  for (const [plugin, pluginData] of Object.entries(Plugins).filter(e => e[1].on === hook)) {\r\n    if (!game.modules.get(plugin)?.active) {\r\n      continue;\r\n    }\r\n    pluginData.data = new pluginData.class(plugin, pluginData.minVersion, pluginData?.invalidVersion);\r\n  }\r\n}\r\n","import { get, writable } from \"svelte/store\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport { TJSDocument } from '@typhonjs-fvtt/runtime/svelte/store';\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\nimport { Plugins } from \"../plugins/main.js\";\n\nclass PileBaseItem {\n\n  constructor(store, data, isCurrency = false, isSecondaryCurrency = false) {\n    this.store = store;\n    this.subscriptions = [];\n    this.isCurrency = isCurrency;\n    this.isSecondaryCurrency = isSecondaryCurrency;\n    this.setup(data);\n  }\n\n  setupStores() {\n    this.category = writable({ service: false, type: \"\", label: \"\" });\n    this.quantity = writable(1);\n    this.currentQuantity = writable(1);\n    this.quantityLeft = writable(1);\n    this.filtered = writable(true);\n    this.presentFromTheStart = writable(false);\n    this.rarityColor = writable(false);\n  }\n\n  setupSubscriptions() {\n    // Higher order implementation\n  }\n\n  setup(data) {\n    this.unsubscribe();\n    this.setupStores(data);\n    this.setupSubscriptions(data);\n  }\n\n  subscribeTo(target, callback) {\n    this.subscriptions.push(target.subscribe(callback));\n  }\n\n  unsubscribe() {\n    this.subscriptions.forEach(unsubscribe => unsubscribe());\n    this.subscriptions = [];\n  }\n\n  preview() {\n  }\n}\n\nexport class PileItem extends PileBaseItem {\n\n  setupStores(item) {\n    super.setupStores();\n    this.item = item;\n    this.itemDocument = new TJSDocument(this.item);\n    this.canStack = PileUtilities.canItemStack(this.item, this.actor);\n    this.presentFromTheStart.set(Utilities.getItemQuantity(this.item) > 0 || !this.canStack);\n    this.quantity.set(this.canStack ? Utilities.getItemQuantity(this.item) : 1);\n    this.currentQuantity.set(Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity)));\n    this.id = this.item.id;\n    this.type = this.item.type;\n    this.name = writable(this.item.name);\n    this.img = writable(this.item.img);\n    this.abbreviation = writable(\"\");\n    this.identifier = randomID();\n    this.itemFlagData = writable(PileUtilities.getItemFlagData(this.item));\n  }\n\n  setupSubscriptions() {\n    super.setupSubscriptions()\n\n    this.subscribeTo(this.store.pileData, () => {\n      this.setupProperties();\n    });\n    this.subscribeTo(this.store.pileCurrencies, () => {\n      this.setupProperties();\n    });\n\n    this.subscribeTo(this.store.shareData, () => {\n      if (!this.toShare) {\n        this.quantityLeft.set(get(this.quantity));\n        return;\n      }\n      const quantityLeft = SharingUtilities.getItemSharesLeftForActor(this.store.actor, this.item, this.store.recipient);\n      this.quantityLeft.set(quantityLeft);\n    });\n\n    this.subscribeTo(this.itemDocument, () => {\n      const { data } = this.itemDocument.updateOptions;\n      this.name.set(this.item.name);\n      this.img.set(this.item.img);\n      this.similarities = Utilities.setSimilarityProperties({}, this.item);\n      if (PileUtilities.canItemStack(this.item, this.store.actor) && Utilities.hasItemQuantity(data)) {\n        this.quantity.set(Utilities.getItemQuantity(data));\n        const quantity = Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity));\n        this.currentQuantity.set(quantity);\n      }\n      if (hasProperty(data, CONSTANTS.FLAGS.ITEM)) {\n        this.itemFlagData.set(PileUtilities.getItemFlagData(this.item));\n        this.updateCategory();\n        this.store.refreshItems();\n      }\n      if (Plugins[\"rarity-colors\"].data) {\n        this.rarityColor.set(Plugins[\"rarity-colors\"].data.getItemColor(this.item));\n      }\n    });\n\n    this.updateCategory();\n\n    this.subscribeTo(this.quantity, this.filter.bind(this));\n    this.subscribeTo(this.store.search, this.filter.bind(this));\n    this.subscribeTo(this.category, this.filter.bind(this));\n  }\n\n  setupProperties() {\n    const actorIsItemPile = PileUtilities.isValidItemPile(this.store.actor, get(this.store.pileData));\n    const pileActor = actorIsItemPile ? this.store.actor : this.store.recipient;\n    const pileActorData = actorIsItemPile ? this.store.pileData : this.store.recipientPileData;\n    const pileCurrencies = actorIsItemPile ? get(this.store.pileCurrencies) : get(this.store.recipientCurrencies);\n    this.isCurrency = PileUtilities.isItemCurrency(this.item, {\n      target: pileActor,\n      actorCurrencies: pileCurrencies\n    });\n    const currency = this.isCurrency ? PileUtilities.getItemCurrencyData(this.item, {\n      target: pileActor,\n      actorCurrencies: pileCurrencies\n    }) : {};\n    this.isSecondaryCurrency = !!currency?.secondary;\n    this.abbreviation.set(currency?.abbreviation ?? \"\");\n    this.similarities = Utilities.setSimilarityProperties({}, this.item);\n    this.name.set(this.isCurrency ? currency.name : this.item.name);\n    this.img.set(this.isCurrency ? currency.img : this.item.img);\n    this.toShare = this.isCurrency\n      ? get(pileActorData).shareCurrenciesEnabled && !!this.store.recipient\n      : get(pileActorData).shareItemsEnabled && !!this.store.recipient;\n  }\n\n  updateCategory() {\n    const pileData = get(this.store.pileData);\n    const itemFlagData = get(this.itemFlagData);\n    this.category.update(cat => {\n      cat.service = itemFlagData?.isService;\n      if (itemFlagData.customCategory) {\n        cat.type = itemFlagData.customCategory.toLowerCase();\n        cat.label = itemFlagData.customCategory;\n      } else if (cat.service && pileData.enabled && pileData.type === CONSTANTS.PILE_TYPES.MERCHANT) {\n        cat.type = \"item-piles-service\";\n        cat.label = \"ITEM-PILES.Merchant.Service\";\n      } else {\n        cat.type = this.type;\n        cat.label = CONFIG.Item.typeLabels[this.type];\n      }\n      return cat;\n    });\n  }\n\n  filter() {\n    const name = get(this.name).trim();\n    const search = get(this.store.search).trim();\n    const presentFromTheStart = get(this.presentFromTheStart);\n    const quantity = get(this.quantity);\n    if (quantity === 0 && !presentFromTheStart) {\n      this.filtered.set(true);\n    } else if (search) {\n      this.filtered.set(!name.toLowerCase().includes(search.toLowerCase()));\n    } else {\n      this.filtered.set(!presentFromTheStart && quantity === 0);\n    }\n  }\n\n  take() {\n    const quantity = Math.min(get(this.currentQuantity), get(this.quantityLeft));\n    if (!quantity) return;\n    return game.itempiles.API.transferItems(\n      this.store.actor,\n      this.store.recipient,\n      [{ _id: this.id, quantity }],\n      { interactionId: this.store.interactionId }\n    );\n  }\n\n  async remove() {\n    return game.itempiles.API.removeItems(this.store.actor, [this.id]);\n  }\n\n  updateQuantity(quantity, add = false) {\n    let total = typeof quantity === \"string\" ? (new Roll(quantity).evaluate({ async: false })).total : quantity;\n    if (add) {\n      total += get(this.quantity);\n    }\n    this.quantity.set(total);\n    return this.item.update(Utilities.setItemQuantity({}, total));\n  }\n\n  async updateFlags() {\n    await this.item.update({\n      [CONSTANTS.FLAGS.ITEM]: get(this.itemFlagData),\n      [CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion()\n    })\n  }\n\n  preview() {\n    const pileData = get(this.store.pileData);\n    if (!pileData.canInspectItems && !game.user.isGM) return;\n    if (game.user.isGM || this.item.permission[game.user.id] === 3) {\n      return this.item.sheet.render(true);\n    }\n    const cls = this.item._getSheetClass();\n    const sheet = new cls(this.item, { editable: false });\n    return sheet._render(true);\n  }\n}\n\nexport class PileAttribute extends PileBaseItem {\n\n  setupStores(attribute) {\n    super.setupStores();\n    this.attribute = attribute;\n    this.path = this.attribute.path;\n    this.name = writable(this.attribute.name);\n    this.img = writable(this.attribute.img);\n    this.abbreviation = writable(this.attribute.abbreviation);\n    this.identifier = randomID()\n    const startingQuantity = Number(getProperty(this.store.actor, this.path) ?? 0);\n    this.presentFromTheStart.set(startingQuantity > 0);\n    this.quantity.set(startingQuantity);\n    this.currentQuantity.set(Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity)));\n    this.category.set({ type: \"currency\", label: \"ITEM-PILES.Currency\" });\n  }\n\n  setupSubscriptions() {\n    super.setupSubscriptions();\n\n    this.subscribeTo(this.store.pileData, this.setupProperties.bind(this));\n\n    this.subscribeTo(this.store.shareData, (val) => {\n      if (!this.toShare) {\n        this.quantityLeft.set(get(this.quantity));\n        return;\n      }\n      const quantityLeft = SharingUtilities.getAttributeSharesLeftForActor(this.store.actor, this.path, this.store.recipient);\n      this.quantityLeft.set(quantityLeft);\n    });\n\n    this.subscribeTo(this.store.document, () => {\n      const { data } = this.store.document.updateOptions;\n      this.path = this.attribute.path;\n      this.name.set(this.attribute.name);\n      this.img.set(this.attribute.img);\n      if (hasProperty(data, this.path)) {\n        this.quantity.set(Number(getProperty(data, this.path) ?? 0));\n        this.currentQuantity.set(Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity)));\n        this.store.refreshItems();\n      }\n    });\n\n    this.subscribeTo(this.quantity, this.filter.bind(this));\n    this.subscribeTo(this.store.search, this.filter.bind(this));\n  }\n\n  setupProperties() {\n    this.toShare = get(this.store.pileData).shareCurrenciesEnabled && !!this.store.recipient;\n  }\n\n  filter() {\n    const name = get(this.name);\n    const search = get(this.store.search);\n    const presentFromTheStart = get(this.presentFromTheStart);\n    const quantity = get(this.quantity);\n    if (quantity === 0 && !presentFromTheStart) {\n      this.filtered.set(true);\n    } else if (search) {\n      this.filtered.set(!name.toLowerCase().includes(search.toLowerCase()));\n    } else {\n      this.filtered.set(!presentFromTheStart && quantity === 0);\n    }\n  }\n\n  take() {\n    const quantity = Math.min(get(this.currentQuantity), get(this.quantityLeft));\n    return game.itempiles.API.transferAttributes(\n      this.store.actor,\n      this.store.recipient,\n      { [this.path]: quantity },\n      { interactionId: this.store.interactionId }\n    );\n  }\n\n  updateQuantity() {\n    return this.store.actor.update({\n      [this.path]: get(this.quantity)\n    });\n  }\n\n}\n","import { get, writable } from \"svelte/store\";\nimport { TJSDocument } from '@typhonjs-fvtt/runtime/svelte/store';\nimport CONSTANTS from \"../constants/constants.js\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\nimport { InterfaceTracker } from \"../socket.js\";\nimport { PileAttribute, PileItem } from \"./pile-item.js\";\nimport DropCurrencyDialog from \"../applications/dialogs/drop-currency-dialog/drop-currency-dialog.js\";\n\nconst __STORES__ = new Map();\n\nexport default class ItemPileStore {\n\n  constructor(application, source, recipient = false, { recipientPileData = false } = {}) {\n\n    this.subscriptions = [];\n\n    this.interactionId = randomID();\n    this.application = application;\n\n    this.uuid = Utilities.getUuid(source);\n    this.actor = Utilities.getActor(source);\n    this.document = new TJSDocument(this.actor);\n\n    this.recipient = recipient ? Utilities.getActor(recipient) : false;\n    this.recipientDocument = recipient ? new TJSDocument(this.recipient) : new TJSDocument();\n    this.recipientPileData = writable(recipientPileData);\n\n    this.pileData = writable({});\n    this.shareData = writable({});\n\n    this.recipientPileData = writable({})\n    this.recipientShareData = writable({});\n\n    this.deleted = writable(false);\n\n    this.search = writable(\"\");\n    this.editQuantities = writable(true);\n\n    this.allItems = writable([]);\n    this.attributes = writable([]);\n\n    this.items = writable([]);\n    this.visibleItems = writable([]);\n\n    this.pileCurrencies = writable([]);\n    this.recipientCurrencies = writable([]);\n\n    this.currencies = writable([]);\n    this.allCurrencies = writable([]);\n\n    this.itemsPerCategory = writable({});\n    this.categories = writable([]);\n    this.itemCategories = writable([]);\n\n    this.numItems = writable(0);\n    this.numCurrencies = writable(0);\n\n    this.name = writable(\"\");\n    this.img = writable(\"\");\n\n    __STORES__.set(this.uuid, this);\n\n  }\n\n  get ItemClass() {\n    return PileItem;\n  };\n\n  get AttributeClass() {\n    return PileAttribute;\n  };\n\n  get searchDelay() {\n    return 200;\n  }\n\n  static make(...args) {\n    const store = new this(...args)\n    store.setupStores();\n    store.setupSubscriptions();\n    return store;\n  }\n\n  setupStores() {\n\n    this.pileData.set(PileUtilities.getActorFlagData(this.actor));\n    this.shareData.set(SharingUtilities.getItemPileSharingData(this.actor));\n\n    this.recipientPileData.set(this.recipient ? PileUtilities.getActorFlagData(this.recipient) : {});\n    this.recipientShareData.set(this.recipient ? SharingUtilities.getItemPileSharingData(this.recipient) : {});\n\n    this.deleted.set(false);\n\n    this.search.set(\"\");\n    this.editQuantities.set(!this.recipient);\n\n    this.allItems.set([]);\n    this.attributes.set([]);\n\n    this.items.set([]);\n    this.visibleItems.set([]);\n\n    this.pileCurrencies.set(PileUtilities.getActorCurrencies(this.actor, { getAll: true }));\n    this.recipientCurrencies.set(this.recipient ? PileUtilities.getActorCurrencies(this.recipient, { getAll: true }) : []);\n\n    this.currencies.set([]);\n    this.allCurrencies.set([]);\n\n    this.itemsPerCategory.set({});\n    this.categories.set([]);\n    this.itemCategories.set([]);\n\n    this.numItems.set(0);\n    this.numCurrencies.set(0);\n\n    this.name.set(\"\");\n    this.img.set(\"\");\n\n  }\n\n  getActorImage() {\n    return this.actor.img;\n  }\n\n  setupSubscriptions() {\n\n    this.subscribeTo(this.document, () => {\n      const { data } = this.document.updateOptions;\n      if (hasProperty(data, CONSTANTS.FLAGS.SHARING)) {\n        this.shareData.set(SharingUtilities.getItemPileSharingData(this.actor));\n        this.refreshItems();\n      }\n      if (hasProperty(data, CONSTANTS.FLAGS.PILE)) {\n        this.pileData.set(PileUtilities.getActorFlagData(this.actor));\n        this.pileCurrencies.set(PileUtilities.getActorCurrencies(this.actor, { getAll: true }));\n        this.refreshItems();\n      }\n      this.name.set(this.actor.name);\n      this.img.set(this.getActorImage());\n    });\n\n    if (this.recipientDocument) {\n      this.subscribeTo(this.recipientDocument, () => {\n        const { data } = this.document.updateOptions;\n        if (hasProperty(data, CONSTANTS.FLAGS.SHARING)) {\n          this.recipientShareData.set(SharingUtilities.getItemPileSharingData(this.recipient));\n          this.refreshItems();\n        }\n        if (hasProperty(data, CONSTANTS.FLAGS.PILE)) {\n          this.recipientPileData.set(PileUtilities.getActorFlagData(this.recipient));\n          this.recipientCurrencies.set(PileUtilities.getActorCurrencies(this.recipient, { getAll: true }));\n          this.refreshItems();\n        }\n      });\n    }\n\n    const items = [];\n    const attributes = [];\n\n    PileUtilities.getActorItems(this.actor).map(item => {\n      items.push(new this.ItemClass(this, item));\n    });\n\n    PileUtilities.getActorCurrencies(this.actor, { forActor: this.recipient, getAll: true }).forEach(currency => {\n      if (currency.type === \"item\") {\n        if (!currency.item) return\n        items.push(new this.ItemClass(this, currency.item, true, !!currency?.secondary));\n      } else {\n        attributes.push(new this.AttributeClass(this, currency, true, !!currency?.secondary));\n      }\n    });\n\n    this.allItems.set(items);\n    this.attributes.set(attributes);\n\n    this.subscribeTo(this.allItems, () => {\n      this.refreshItems();\n    });\n    this.subscribeTo(this.attributes, () => {\n      this.refreshItems();\n    });\n\n    const filterDebounce = foundry.utils.debounce(() => {\n      this.refreshItems();\n    }, this.searchDelay);\n    this.subscribeTo(this.search, (val) => {\n      filterDebounce()\n    });\n\n  }\n\n  static getStore(actor) {\n    const uuid = Utilities.getUuid(actor);\n    return __STORES__.get(uuid);\n  }\n\n  static notifyChanges(event, actor, ...args) {\n    const store = this.getStore(actor);\n    if (store) {\n      store[event](...args);\n    }\n  }\n\n  static notifyAllOfChanges(event, ...args) {\n    for (const store of __STORES__.values()) {\n      if (store[event]) {\n        store[event](...args);\n      }\n    }\n  }\n\n  updateSource(newSource) {\n    this.uuid = Utilities.getUuid(newSource);\n    this.actor = Utilities.getActor(newSource);\n    this.document.set(this.actor);\n    __STORES__.set(this.uuid, this);\n    this.unsubscribe();\n    this.setupStores();\n    this.setupSubscriptions();\n  }\n\n  updateRecipient(newRecipient) {\n    this.recipient = newRecipient;\n    this.recipientDocument.set(this.recipient);\n    this.unsubscribe();\n    this.setupStores();\n    this.setupSubscriptions();\n  }\n\n  visibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData) {\n    const itemFlagData = entry.itemFlagData ? get(entry.itemFlagData) : {};\n    return !entry.isCurrency\n      && (game.user.isGM || !actorIsMerchant || !itemFlagData?.hidden);\n  }\n\n  itemSortFunction(a, b, inverse) {\n    return (b.item.name > a.item.name ? -1 : 1) * (inverse ? -1 : 1);\n  }\n\n  refreshItems() {\n    const allItems = get(this.allItems);\n    const pileData = get(this.pileData);\n    const recipientPileData = this.recipient ? PileUtilities.isItemPileMerchant(this.recipient) : {}\n    const actorIsMerchant = PileUtilities.isItemPileMerchant(this.actor, pileData);\n\n    const visibleItems = allItems.filter(entry => this.visibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData));\n    const itemCurrencies = allItems.filter(entry => entry.isCurrency && !entry.isSecondaryCurrency);\n    const secondaryItemCurrencies = allItems.filter(entry => entry.isSecondaryCurrency);\n\n    this.visibleItems.set(visibleItems);\n\n    const items = visibleItems.filter(entry => !get(entry.filtered));\n\n    this.numItems.set(items.filter(entry => get(entry.quantity) > 0).length);\n    this.items.set(items.sort((a, b) => this.itemSortFunction(a, b)));\n\n    const currencies = get(this.attributes).filter(entry => !entry.isSecondaryCurrency).concat(itemCurrencies);\n    const secondaryCurrencies = get(this.attributes).filter(entry => entry.isSecondaryCurrency).concat(secondaryItemCurrencies);\n\n    this.numCurrencies.set(currencies.concat(secondaryCurrencies).filter(entry => get(entry.quantity) > 0).length);\n\n    this.currencies.set(currencies.concat(secondaryCurrencies).filter(entry => !get(entry.filtered)));\n    this.allCurrencies.set(currencies.concat(secondaryCurrencies));\n\n    this.itemCategories.set(Object.values(visibleItems.reduce((acc, item) => {\n      const category = get(item.category);\n      if (!acc[category.type]) {\n        acc[category.type] = { ...category };\n      }\n      return acc;\n    }, {})).sort((a, b) => a.label < b.label ? -1 : 1));\n\n    const itemsPerCategory = items\n      .reduce((acc, item) => {\n        const category = get(item.category);\n        if (!acc[category.type]) {\n          acc[category.type] = {\n            service: category.service,\n            type: category.type,\n            label: category.label,\n            items: []\n          };\n        }\n        acc[category.type].items.push(item);\n        return acc;\n      }, {})\n\n    Object.values(itemsPerCategory).forEach(category => category.items.sort((a, b) => {\n      return a.item.name < b.item.name ? -1 : 1;\n    }));\n\n    this.itemsPerCategory.set(itemsPerCategory);\n\n    this.categories.set(Object.values(itemsPerCategory).map(category => {\n      return {\n        service: category.service,\n        label: category.label,\n        type: category.type\n      }\n    }).sort((a, b) => a.label < b.label ? -1 : 1));\n  }\n\n  createItem(item) {\n    if (PileUtilities.isItemInvalid(this.actor, item)) return;\n    const items = get(this.allItems);\n    const deletedItems = items\n      .filter(item => item.id === null)\n      .map(item => ({\n        pileItem: item,\n        ...item.similarities\n      }));\n    const previouslyDeletedItem = Utilities.findSimilarItem(deletedItems, item);\n    if (previouslyDeletedItem) {\n      previouslyDeletedItem.pileItem.setup(item);\n    } else {\n      items.push(new this.ItemClass(this, item));\n    }\n    this.allItems.set(items);\n  }\n\n  deleteItem(item) {\n    if (PileUtilities.isItemInvalid(this.actor, item)) return;\n    const items = get(this.allItems);\n    const pileItem = items.find(pileItem => pileItem.id === item.id);\n    if (!pileItem) return;\n    if (get(this.editQuantities) || !InterfaceTracker.isOpened(this.application.id)) {\n      items.splice(items.indexOf(pileItem), 1);\n      this.allItems.set(items);\n    } else {\n      pileItem.id = null;\n      pileItem.quantity.set(0);\n      pileItem.quantityLeft.set(0);\n    }\n    pileItem.unsubscribe();\n  }\n\n  hasSimilarItem(item) {\n    const items = get(this.allItems).map(item => item.item);\n    return !!Utilities.findSimilarItem(items, item, get(this.pileData));\n  }\n\n  delete() {\n    this.deleted.set(true);\n  }\n\n  async update() {\n\n    const itemsToUpdate = [];\n    const itemsToDelete = [];\n    const attributesToUpdate = {};\n\n    const items = get(this.allItems).filter(item => item.id);\n    for (let item of items) {\n      const itemQuantity = get(item.quantity);\n      if (itemQuantity === 0) {\n        itemsToDelete.push(item.id);\n      } else {\n        if (PileUtilities.canItemStack(item.item, this.actor)) {\n          itemsToUpdate.push(Utilities.setItemQuantity({ _id: item.id }, itemQuantity));\n        }\n      }\n    }\n\n    const attributes = get(this.attributes);\n    for (let attribute of attributes) {\n      attributesToUpdate[attribute.path] = get(attribute.quantity);\n    }\n\n    const pileSharingData = SharingUtilities.getItemPileSharingData(this.actor);\n\n    await this.actor.update(attributesToUpdate);\n    if (pileSharingData?.currencies) {\n      pileSharingData.currencies = pileSharingData.currencies.map(currency => {\n        if (attributesToUpdate[currency.path] !== undefined) {\n          currency.actors = currency.actors.map(actor => {\n            actor.quantity = Math.max(0, Math.min(actor.quantity, attributesToUpdate[currency.path]));\n            return actor;\n          })\n        }\n        return currency;\n      })\n    }\n\n    await this.actor.updateEmbeddedDocuments(\"Item\", itemsToUpdate);\n    await this.actor.deleteEmbeddedDocuments(\"Item\", itemsToDelete);\n    if (pileSharingData?.items) {\n      pileSharingData.items = pileSharingData.items.map(item => {\n        const sharingItem = itemsToUpdate.find(item => item._id === item.id);\n        if (sharingItem) {\n          item.actors = item.actors.map(actor => {\n            actor.quantity = Math.max(0, Math.min(actor.quantity, sharingItem.quantity));\n            return actor;\n          })\n        }\n        return item;\n      })\n    }\n\n    await SharingUtilities.updateItemPileSharingData(this.actor, pileSharingData);\n\n    this.refreshItems();\n\n    Helpers.custom_notify(game.i18n.localize(\"ITEM-PILES.Notifications.UpdateItemPileSuccess\"));\n\n  }\n\n  async depositCurrency() {\n    const result = await DropCurrencyDialog.show(this.recipient, this.actor, { localization: \"DepositCurrencies\" });\n    return this._addCurrency(result, this.recipient, this.actor);\n  }\n\n  async withdrawCurrency() {\n    const result = await DropCurrencyDialog.show(this.actor, this.recipient, { localization: \"WithdrawCurrencies\" });\n    return this._addCurrency(result, this.actor, this.recipient);\n  }\n\n  async addCurrency(recipient = false) {\n    const source = recipient || this.actor;\n    const target = recipient ? this.actor : false;\n    const result = await DropCurrencyDialog.show(source, target, {\n      localization: !target ? \"EditCurrencies\" : false,\n      unlimitedCurrencies: !target && game.user.isGM,\n      existingCurrencies: PileUtilities.getActorCurrencies(source, { combine: true }),\n      getUpdates: !target\n    });\n    return this._addCurrency(result, source, target);\n  }\n\n  async _addCurrency(currencies, source, target = false) {\n\n    if (!currencies) return;\n\n    if (!target) {\n\n      if (!game.user.isGM) return;\n\n      if (!foundry.utils.isEmpty(currencies.attributes)) {\n        await game.itempiles.API.setAttributes(source, currencies.attributes, { interactionId: this.interactionId })\n      }\n      if (currencies.items.length) {\n        const itemsToAdd = currencies.items.filter(currency => currency.quantity > 0);\n        const itemsToRemove = currencies.items.filter(currency => currency.quantity < 0);\n        await game.itempiles.API.addItems(source, itemsToAdd, { interactionId: this.interactionId })\n        await game.itempiles.API.removeItems(source, itemsToRemove, { interactionId: this.interactionId })\n      }\n\n    } else {\n\n      if (!foundry.utils.isEmpty(currencies.attributes)) {\n        await game.itempiles.API.transferAttributes(source, target, currencies.attributes, { interactionId: this.interactionId })\n      }\n      if (currencies.items.length) {\n        await game.itempiles.API.transferItems(source, target, currencies.items, { interactionId: this.interactionId })\n      }\n    }\n\n  }\n\n  takeAll() {\n    game.itempiles.API.transferEverything(\n      this.actor,\n      this.recipient,\n      { interactionId: this.interactionId }\n    );\n  }\n\n  splitAll() {\n    return game.itempiles.API.splitItemPileContents(this.actor, { instigator: this.recipient });\n  }\n\n  closeContainer() {\n    if (!InterfaceTracker.isOpened(this.application.id)) {\n      return game.itempiles.API.closeItemPile(this.actor, this.recipient);\n    }\n  }\n\n  subscribeTo(target, callback) {\n    this.subscriptions.push(target.subscribe(callback));\n  }\n\n  unsubscribe() {\n    this.subscriptions.forEach(unsubscribe => unsubscribe());\n    this.subscriptions = [];\n  }\n\n  onDestroy() {\n    this.unsubscribe();\n    __STORES__.delete(this.uuid);\n  }\n}\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { fade } from 'svelte/transition';\r\n  import ListEntry from \"./ListEntry.svelte\";\r\n\r\n  export let store;\r\n  const numItems = store.numItems;\r\n  const categories = store.categories;\r\n  const itemsPerCategory = store.itemsPerCategory;\r\n\r\n</script>\r\n\r\n\r\n{#if $numItems > 0}\r\n\r\n  <div in:fade|local={{duration: 150}}>\r\n\r\n    {#each $categories as category, index (category.type)}\r\n      <div class=\"item-group-type item-piles-flexrow\">\r\n        <h3>{localize(category.label)}</h3>\r\n      </div>\r\n\r\n      <div class=\"item-piles-items-list\">\r\n        {#each $itemsPerCategory[category.type].items as item (item.id)}\r\n          <ListEntry {store} bind:entry={item}/>\r\n        {/each}\r\n      </div>\r\n    {/each}\r\n\r\n  </div>\r\n\r\n{/if}\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-group-type {\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n    margin: 0.5rem 0 0.25rem 0;\r\n    padding-right: 10px;\r\n    height: 1.5rem;\r\n    align-items: center;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { getContext, onDestroy } from 'svelte';\r\n  import { fade } from 'svelte/transition';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { ApplicationShell } from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n\r\n  import ItemList from \"./ItemList.svelte\";\r\n  import CurrencyList from \"./CurrencyList.svelte\";\r\n  import ActorPicker from \"../components/ActorPicker.svelte\";\r\n\r\n  import * as SharingUtilities from \"../../helpers/sharing-utilities.js\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n  import PrivateAPI from \"../../API/private-api.js\";\r\n  import ItemPileStore from \"../../stores/item-pile-store.js\";\r\n  import CategorizedItemList from \"./CategorizedItemList.svelte\";\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import { getSourceActorFromDropData } from \"../../helpers/utilities.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  export let actor;\r\n  export let recipient;\r\n\r\n  export let store = ItemPileStore.make(application, actor, recipient);\r\n\r\n  // Stores\r\n  let canBeSplit = false;\r\n  let searchStore = store.search;\r\n  let editQuantities = store.editQuantities;\r\n  let pileData = store.pileData;\r\n  let deleted = store.deleted;\r\n\r\n  const items = store.allItems;\r\n  const currencies = store.currencies;\r\n  const numItems = store.numItems;\r\n  const shareData = store.shareData;\r\n  const numCurrencies = store.numCurrencies;\r\n\r\n  $: isPileEmpty = $numItems === 0 && $numCurrencies === 0;\r\n  $: hasItems = $numItems > 0;\r\n  $: showSearchBar = $numItems >= 8;\r\n  $: isContainer = PileUtilities.isItemPileContainer(actor, $pileData)\r\n  $: {\r\n    $shareData;\r\n    $items;\r\n    $currencies;\r\n    canBeSplit = SharingUtilities.canItemPileBeSplit(actor);\r\n  }\r\n\r\n  let num_players = SharingUtilities.getPlayersForItemPile(actor).length;\r\n\r\n  async function dropData(event) {\r\n\r\n    event.preventDefault();\r\n\r\n    let data;\r\n    try {\r\n      data = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n\r\n    if (data.type === \"Actor\" && game.user.isGM) {\r\n      const newRecipient = data.uuid ? (await fromUuid(data.uuid)) : game.actors.get(data.id);\r\n      return store.updateRecipient(newRecipient)\r\n    }\r\n\r\n    if (data.type !== \"Item\") {\r\n      Helpers.custom_warning(`You can't drop documents of type \"${data.type}\" into this Item Piles vault!`, true)\r\n      return false;\r\n    }\r\n\r\n    const item = await Item.implementation.fromDropData(data);\r\n    const itemData = item.toObject();\r\n\r\n    if (!itemData) {\r\n      console.error(data);\r\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n    }\r\n\r\n    const source = getSourceActorFromDropData(data);\r\n\r\n    return PrivateAPI._dropItem({\r\n      source: source,\r\n      target: store.actor,\r\n      itemData: {\r\n        item: itemData, quantity: 1\r\n      },\r\n      skipCheck: true\r\n    });\r\n\r\n  }\r\n\r\n  function preventDefaultGM(event) {\r\n    if (game.user.isGM) return;\r\n    event.preventDefault();\r\n  }\r\n\r\n  function preventDefault(event) {\r\n    event.preventDefault();\r\n  }\r\n\r\n  let itemListElement;\r\n  let scrolled = false;\r\n\r\n  function evaluateShadow() {\r\n    scrolled = itemListElement.scrollTop > 20;\r\n  }\r\n\r\n  onDestroy(() => {\r\n    store.onDestroy();\r\n  });\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<main in:fade={{duration: 500}}>\r\n\r\n\t\t<div class=\"item-piles-item-drop-container\" on:dragstart={preventDefaultGM} on:drop={dropData}\r\n\t\t\t\t on:dragover={preventDefault}>\r\n\r\n\t\t\t{#if $deleted}\r\n\t\t\t\t<p style=\"text-align: center; flex: 0 1 auto;\">\r\n\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.Destroyed\")}\r\n\t\t\t\t</p>\r\n\t\t\t{:else}\r\n\r\n\t\t\t\t<ActorPicker {store}/>\r\n\r\n\t\t\t\t{#if showSearchBar}\r\n\t\t\t\t\t<div class=\"form-group item-piles-flexrow item-piles-top-divider item-piles-bottom-divider\"\r\n\t\t\t\t\t\t\t style=\"margin-bottom: 0.5rem; align-items: center;\" transition:fade={{duration: 250}}>\r\n\t\t\t\t\t\t<label style=\"flex:0 1 auto; margin-right: 5px;\">Search:</label>\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={$searchStore}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if isPileEmpty}\r\n\t\t\t\t\t<p class=\"item-piles-top-divider\" style=\"text-align: center; flex: 0 1 auto;\">\r\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.Empty\")}\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"item-piles-items-list\" bind:this={itemListElement} on:scroll={evaluateShadow}>\r\n\r\n\t\t\t\t\t{#if scrolled}\r\n\t\t\t\t\t\t<div class=\"item-pile-shadow scroll-shadow-top\" transition:fade={{duration:300}}></div>\r\n\t\t\t\t\t\t<div></div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if $pileData.displayItemTypes}\r\n\t\t\t\t\t\t<CategorizedItemList {store}/>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<ItemList {store}/>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if hasItems}\r\n\t\t\t\t\t\t<hr>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<CurrencyList {store}/>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\r\n\t\t\t{/if}\r\n\r\n\t\t\t<footer class=\"sheet-footer item-piles-flexrow item-piles-top-divider\">\r\n\t\t\t\t{#if editQuantities}\r\n\t\t\t\t\t<button type=\"button\" on:click={() => { store.update() }}>\r\n\t\t\t\t\t\t<i class=\"fas fa-save\"></i> {localize(\"ITEM-PILES.Applications.ItemPileConfig.Update\")}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if $pileData.splitAllEnabled}\r\n\t\t\t\t\t<button type=\"button\" on:click={() => { store.splitAll() }} disabled=\"{isPileEmpty || !canBeSplit}\">\r\n\t\t\t\t\t\t<i class=\"fas fa-handshake\"></i>\r\n\t\t\t\t\t\t{#if $pileData.shareItemsEnabled}\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.SplitAll\", { num_players })}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.SplitCurrencies\", { num_players })}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if store.recipient && $pileData.takeAllEnabled}\r\n\t\t\t\t\t<button type=\"submit\" on:click={() => { store.takeAll() }} disabled=\"{isPileEmpty}\">\r\n\t\t\t\t\t\t<i class=\"fas fa-fist-raised\"></i> {localize(\"ITEM-PILES.Inspect.TakeAll\")}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if isContainer && !application.options.remote}\r\n\t\t\t\t\t<button type=\"submit\" on:click={() => { store.closeContainer(); application.close(); }}>\r\n\t\t\t\t\t\t<i class=\"fas fa-box\"></i> {localize(\"ITEM-PILES.Inspect.Close\")}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<button type=\"submit\" on:click={() => { application.close() }}>\r\n\t\t\t\t\t<i class=\"fas fa-sign-out-alt\"></i> {localize(\"ITEM-PILES.Inspect.Leave\")}\r\n\t\t\t\t</button>\r\n\t\t\t</footer>\r\n\r\n\t\t</div>\r\n\r\n\t</main>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-items-list {\r\n    max-height: 500px;\r\n    overflow-y: scroll;\r\n    display: block;\r\n    padding-right: 5px;\r\n\r\n    .item-pile-shadow {\r\n\r\n      position: absolute;\r\n      width: calc(100% - 1rem);\r\n      height: 50px;\r\n      z-index: 25;\r\n      pointer-events: none;\r\n      border-radius: 5px;\r\n\r\n      &.scroll-shadow-top {\r\n        box-shadow: inset 0px 22px 15px -14px rgba(0, 0, 0, 0.5);\r\n      }\r\n\r\n    }\r\n\r\n    .item-piles-add-currency {\r\n      margin-right: 5px;\r\n      flex: 0 1 auto;\r\n      vertical-align: middle;\r\n    }\r\n\r\n  }\r\n\r\n  #item-piles-preview-container {\r\n\r\n    position: absolute;\r\n    display: inline-block;\r\n\r\n    #item-piles-preview-image {\r\n      border: 0;\r\n      width: 300px;\r\n      border-radius: 1rem;\r\n      box-shadow: rgba(0, 0, 0, 0.25) 0px 54px 55px, rgba(0, 0, 0, 0.12) 0px -12px 30px, rgba(0, 0, 0, 0.12) 0px 4px 6px, rgba(0, 0, 0, 0.17) 0px 12px 13px, rgba(0, 0, 0, 0.09) 0px -3px 5px;\r\n    }\r\n  }\r\n\r\n  .hidden {\r\n    display: none;\r\n  }\r\n\r\n  .item-piles-img-container {\r\n    min-height: 25px;\r\n    max-width: 25px;\r\n    max-height: 25px;\r\n    margin: 2px;\r\n  }\r\n</style>\r\n","<script>\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n\r\n  export let activeTab;\r\n  export let tabs;\r\n  export let underscore = false;\r\n  export let separateElements = false;\r\n\r\n</script>\r\n\r\n<nav class=\"tabs\" data-group=\"primary\" style={$$props.style}>\r\n  {#each tabs.filter(tab => !tab.hidden) as tab, index (tab.value)}\r\n    {#if separateElements && index > 0}\r\n      <div style=\"border-right: 1px solid rgba(0,0,0,0.5); margin: 0 10px;\"></div>\r\n    {/if}\r\n    <div on:click={() => { activeTab = tab.value}}\r\n         class=\"item item-piles-flexrow item-piles-clickable-link\"\r\n         class:underscore={underscore}\r\n         class:active={activeTab === tab.value}\r\n         data-tab=\"rest\">\r\n      {#if tab.icon} <i class=\"icon {tab.icon}\"></i> {/if}\r\n      {localize(tab.label)}\r\n      {#if tab.highlight}\r\n        <div class=\"blob\"><i class=\"fas fa-exclamation\"></i></div>\r\n      {/if}\r\n    </div>\r\n  {/each}\r\n</nav>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .tabs {\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n  }\r\n\r\n  .item {\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    border-bottom: 2px solid transparent;\r\n\r\n    &.active {\r\n      text-shadow: 0 0 10px var(--item-piles-shadow-primary);\r\n\r\n      &.underscore {\r\n        text-shadow: none;\r\n        border-bottom: 2px solid rgba(125, 0, 0, 0.5);\r\n      }\r\n    }\r\n  }\r\n\r\n  .icon {\r\n    margin-right: 0.25rem;\r\n  }\r\n\r\n</style>\r\n","/**\n * Provides a helper class to determine the version of the Foundry platform starting a version `9`.\n *\n * Note: You must use any of these utility methods after the Foundry `init` hook.\n */\nclass FVTTVersion\n{\n   static #regexMajorVersion = /(\\d+)\\./;\n\n   /**\n    * Returns true when Foundry is at least the specific major version number provided.\n    *\n    * @param {number}   version - Major version to check against.\n    *\n    * @returns {boolean} Foundry version is at least the major version specified.\n    */\n   static isAtLeast(version)\n   {\n      if (!Number.isInteger(version) && version < 9)\n      {\n         throw new TypeError(`'version' is not a positive integer greater than '9'.`);\n      }\n\n      return !globalThis.foundry.utils.isNewerVersion(version, globalThis.game.version ??\n       globalThis.game?.data?.version);\n   }\n\n   /**\n    * Returns true when Foundry is between the min / max major version numbers provided.\n    *\n    * @param {number}   min - Major minimum version to check against.\n    *\n    * @param {number}   max - Major maximum version to check against.\n    *\n    * @returns {boolean} Foundry version is at least the major version specified.\n    */\n   static isBetween(min, max)\n   {\n      if (!Number.isInteger(min) && min < 9)\n      {\n         throw new TypeError(`FVTTVersion.isBetween error: 'min' is not a positive integer greater than '9'.`);\n      }\n\n      if (!Number.isInteger(max) && max < 9)\n      {\n         throw new TypeError(`FVTTVersion.isBetween error: 'max' is not a positive integer greater than '9'.`);\n      }\n\n      if (min > max)\n      {\n         throw new TypeError(`FVTTVersion.isBetween error: 'min' is greater than 'max'.`);\n      }\n\n      const match = this.#regexMajorVersion.exec(globalThis.game.version ?? globalThis.game?.data?.version);\n      if (!match)\n      {\n         throw new Error(`FVTTVersion.isBetween error: Could not parse 'globalThis.game.version'.`);\n      }\n\n      const version = parseInt(match[1], 10);\n\n      return version >= min && version <= max;\n   }\n}\n\n/**\n * Loads FVTT core fonts supporting `FontConfig` on Foundry v10+.\n *\n * Note: This class contains code modified from Foundry VTT core client code. There are only so many ways to process\n * core Foundry data structures correctly.\n */\nclass FontManager\n{\n   /**\n    * Collect all the font definitions and combine them.\n    *\n    * @returns {Object<FontFamilyDefinition>[]} Core font definitions.\n    */\n   static getCoreDefinitions()\n   {\n      const fonts = [];\n\n      if (FVTTVersion.isAtLeast(10))\n      {\n         let legacyFamilies;\n\n         /**\n          * @deprecated since v10, so check that it exists.\n          */\n         if (Array.isArray(globalThis.CONFIG?._fontFamilies))\n         {\n            legacyFamilies = globalThis.CONFIG._fontFamilies.reduce((obj, f) =>\n            {\n               obj[f] = { editor: true, fonts: [] };\n               return obj;\n            }, {});\n         }\n\n         if (Array.isArray(globalThis.CONFIG?.fontDefinitions))\n         {\n            fonts.push(globalThis.foundry.utils.duplicate(globalThis.CONFIG.fontDefinitions));\n         }\n\n         const coreFonts = globalThis.game?.settings.get('core', 'fonts');\n         if (Array.isArray(coreFonts))\n         {\n            fonts.push(globalThis.foundry.utils.duplicate(coreFonts));\n         }\n\n         if (legacyFamilies) { fonts.push(legacyFamilies); }\n      }\n      else\n      {\n         if (Array.isArray(globalThis.CONFIG?.fontFamilies))\n         {\n            // Handle v9 and below legacy font families.\n            const legacyFamilies = globalThis.CONFIG.fontFamilies.reduce((obj, f) =>\n            {\n               obj[f] = { editor: true, fonts: [] };\n               return obj;\n            }, {});\n\n            fonts.push(legacyFamilies);\n         }\n      }\n\n      FontManager.removeDuplicateDefinitions(fonts);\n\n      return fonts;\n   }\n\n   /**\n    * Load a font definition.\n    *\n    * @param {string}               fontSpecification - The font specification.\n    *\n    * @param {string}               family - The font family name (case-sensitive).\n    *\n    * @param {FontFamilyDefinition} definition - The font family definition.\n    *\n    * @param {Document}             document - Target Document to load font into.\n    *\n    * @returns {Promise<boolean>} Returns true if the font was successfully loaded.\n    */\n   static async #loadFont(fontSpecification, family, definition, document)\n   {\n      try\n      {\n         for (const fontEntry of definition.fonts)\n         {\n            // Collect URLs from FontDefinition.\n            const urls = fontEntry.urls.map((url) => `url(\"${url}\")`).join(', ');\n\n            // Note: 'font' contains 'FontFaceDescriptors' data.\n            const fontFace = new FontFace(family, urls, fontEntry);\n            await fontFace.load();\n\n            document.fonts.add(fontFace);\n         }\n\n         await document.fonts.load(fontSpecification);\n      }\n      catch (err)\n      {\n         console.warn(`Font family \"${family}\" failed to load: `, err);\n         return false;\n      }\n\n      if (!document.fonts.check(fontSpecification))\n      {\n         console.warn(`Font family \"${family}\" failed to load.`);\n         return false;\n      }\n\n      return true;\n   }\n\n   /**\n    * Ensure that fonts have loaded and are ready for use.\n    * Enforce a maximum timeout in milliseconds.\n    * Proceed after that point even if fonts are not yet available.\n    *\n    * @param {object} [opts] - Optional parameters.\n    *\n    * @param {number} [opts.ms=4500] - The maximum time to spend loading fonts before proceeding.\n    *\n    * @param {Document} [opts.document] - The target document to load the fonts into.\n    *\n    * @param {boolean} [opts.editor=true] - When true verifies the `editor` field of {@link FontFamilyDefinition}.\n    *\n    * @param {Object<FontFamilyDefinition>[]|Object<FontFamilyDefinition>} [opts.fonts] - A custom set of font family\n    *        definitions to load. If not defined the core font family definitions are loaded.\n    *\n    * @returns {Promise<void>}\n    */\n   static async loadFonts({ ms = 4500, document = globalThis.document, editor = true, fonts } = {})\n   {\n      // TODO sanity checks\n\n      const allFonts = fonts ? Array.isArray(fonts) ? fonts : [fonts] : this.getCoreDefinitions();\n\n      const promises = [];\n\n      for (const definitions of allFonts)\n      {\n         if (typeof definitions === 'object')\n         {\n            for (const [family, definition] of Object.entries(definitions))\n            {\n               // Don't load a font that is not marked to be used in the editor.\n               if (editor && (typeof definition.editor !== 'boolean' || !definition.editor)) { continue; }\n\n               const fontSpecification = `1rem \"${family}\"`;\n\n               // Early out if the font is already loaded.\n               if (document.fonts.check(fontSpecification)) { continue; }\n\n               promises.push(this.#loadFont(fontSpecification, family, definition, document));\n            }\n         }\n      }\n\n      const timeout = new Promise((resolve) => setTimeout(resolve, ms));\n      const ready = Promise.all(promises).then(() => document.fonts.ready);\n\n      return Promise.race([ready, timeout]);\n   }\n\n   /**\n    * Removes duplicate font definitions.\n    *\n    * @param {Object<FontFamilyDefinition>[]}   fonts - An array of FontFamilyDefinition objects to process.\n    *\n    * @returns {Object<FontFamilyDefinition>[]} Filtered font definitions.\n    */\n   static removeDuplicateDefinitions(fonts)\n   {\n      if (!Array.isArray(fonts))\n      {\n         throw new TypeError(`FontManager.removeDuplicateDefinitions error: 'fonts' is not an array.`);\n      }\n\n      const familySet = new Set();\n\n      for (const definitions of fonts)\n      {\n         if (typeof definitions !== 'object' || definitions === null)\n         {\n            throw new TypeError(`FontManager.removeDuplicateDefinitions error: 'definitions' is not an object.`);\n         }\n\n         for (const family of Object.keys(definitions))\n         {\n            // Remove duplicate from current definitions set.\n            if (familySet.has(family))\n            {\n               delete definitions[family];\n            }\n            else\n            {\n               familySet.add(family);\n            }\n         }\n      }\n\n      return fonts;\n   }\n}\n\n/**\n * Parses the core Foundry style sheet creating an indexed object of properties by selector.\n */\nclass FoundryStyles\n{\n   static #sheet = void 0;\n\n   static #sheetMap = new Map();\n\n   static #initialized = false;\n\n   /**\n    * Called once on initialization / first usage. Parses the core foundry style sheet.\n    */\n   static #initialize()\n   {\n      this.#initialized = true;\n\n      const styleSheets = Array.from(document.styleSheets).filter((entry) => entry.href !== null);\n\n      let sheet;\n\n      const foundryStyleSheet = globalThis.foundry.utils.getRoute('/css/style.css');\n\n      // Find the core Foundry stylesheet.\n      for (const styleSheet of styleSheets)\n      {\n         let url;\n\n         try\n         {\n            url = new URL(styleSheet.href);\n         }\n         catch (err) { continue; }\n\n         if (typeof url.pathname === 'string' && url.pathname === foundryStyleSheet)\n         {\n            this.#sheet = sheet = styleSheet;\n            break;\n         }\n      }\n\n      // Quit now if the Foundry style sheet was not found.\n      if (!sheet) { return; }\n\n      // Parse each CSSStyleRule and build the map of selectors to parsed properties.\n      for (const rule of sheet.cssRules)\n      {\n         if (!(rule instanceof CSSStyleRule)) { continue; }\n\n         const obj = {};\n\n         // Parse `cssText` into an object of properties & values.\n         for (const entry of rule.style.cssText.split(';'))\n         {\n            const parts = entry.split(':');\n\n            // Sanity check.\n            if (parts.length < 2) { continue; }\n\n            obj[parts[0].trim()] = parts[1].trim();\n         }\n\n         this.#sheetMap.set(rule.selectorText, obj);\n      }\n   }\n\n   /**\n    * Gets the properties object associated with the selector. Try and use a direct match otherwise all keys\n    * are iterated to find a selector string that includes the `selector`.\n    *\n    * @param {string}   selector - Selector to find.\n    *\n    * @returns {Object<string, string>} Properties object.\n    */\n   static getProperties(selector)\n   {\n      if (!this.#initialized) { this.#initialize(); }\n\n      // If there is a direct selector match then return a value immediately.\n      if (this.#sheetMap.has(selector))\n      {\n         return this.#sheetMap.get(selector);\n      }\n\n      for (const key of this.#sheetMap.keys())\n      {\n         if (key.includes(selector)) { return this.#sheetMap.get(key); }\n      }\n\n      return void 0;\n   }\n\n   /**\n    * Gets a specific property value from the given `selector` and `property` key. Try and use a direct selector\n    * match otherwise all keys are iterated to find a selector string that includes `selector`.\n    *\n    * @param {string}   selector - Selector to find.\n    *\n    * @param {string}   property - Specific property to locate.\n    *\n    * @returns {string|undefined} Property value.\n    */\n   static getProperty(selector, property)\n   {\n      if (!this.#initialized) { this.#initialize(); }\n\n      // If there is a direct selector match then return a value immediately.\n      if (this.#sheetMap.has(selector))\n      {\n         const data = this.#sheetMap.get(selector);\n         return typeof data === 'object' && property in data ? data[property] : void 0;\n      }\n\n      for (const key of this.#sheetMap.keys())\n      {\n         if (key.includes(selector))\n         {\n            const data = this.#sheetMap.get(key);\n            if (typeof data === 'object' && property in data) { return data[property]; }\n         }\n      }\n\n      return void 0;\n   }\n}\n\nexport { FVTTVersion, FontManager, FoundryStyles };\n//# sourceMappingURL=index.js.map\n","import { StyleManager } from '@typhonjs-fvtt/runtime/svelte/util';\n\nconst s_STYLE_KEY = '#__tjs-root-styles';\n\nconst cssVariables = new StyleManager({ docKey: s_STYLE_KEY, version: 1 });\n\nexport { cssVariables };\n","/**\n * Provides helper utilities to manipulate the PM editor view for various options from TJSProseMirror component.\n */\nclass PMImpl\n{\n   /**\n    * Clamps a value between min / max values.\n    *\n    * @param {number}   value - Value to clamp.\n    *\n    * @param {number}   min - Minimum value.\n    *\n    * @param {number}   max - Maximum value.\n    *\n    * @returns {number} Clamped value.\n    * TODO: Move Math utility function to @typhonjs-svelte/lib\n    */\n   static #clamp(value = 0, min = 0, max = 0)\n   {\n      return Math.min(Math.max(value, min), max);\n   }\n\n   /**\n    * Handles `options.initialSelection`: Sets the initial cursor / selection range to the start, end, or selects\n    * all text.\n    *\n    * @param {EditorView}  view - PM editor view.\n    *\n    * @param {object}  options - TJSProseMirror options.\n    */\n   static setInitialSelection(view, options)\n   {\n      const tr = view.state.tr;\n      const doc = tr.doc;\n\n      const initialSelection = options.initialSelection;\n\n      const type = initialSelection === 'all' || initialSelection === 'end' || initialSelection === 'start' ?\n       initialSelection : 'start';\n\n      const minPos = globalThis.ProseMirror.TextSelection.atStart(doc).from;\n      const maxPos = globalThis.ProseMirror.TextSelection.atEnd(doc).to;\n\n      let transaction;\n\n      switch (type)\n      {\n         case 'all':\n         {\n            const resolvedFrom = this.#clamp(0, minPos, maxPos);\n            const resolvedEnd = this.#clamp(doc.content.size, minPos, maxPos);\n            transaction = tr.setSelection(globalThis.ProseMirror.TextSelection.create(doc, resolvedFrom, resolvedEnd));\n            break;\n         }\n\n         case 'end':\n         {\n            const resolvedFrom = this.#clamp(doc.content.size, minPos, maxPos);\n            const resolvedEnd = this.#clamp(doc.content.size, minPos, maxPos);\n            transaction = tr.setSelection(globalThis.ProseMirror.TextSelection.create(doc, resolvedFrom, resolvedEnd));\n            break;\n         }\n\n         case 'start':\n         {\n            const resolvedFrom = this.#clamp(0, minPos, maxPos);\n            const resolvedEnd = this.#clamp(0, minPos, maxPos);\n            transaction = tr.setSelection(globalThis.ProseMirror.TextSelection.create(doc, resolvedFrom, resolvedEnd));\n            break;\n         }\n      }\n\n      if (transaction)\n      {\n         transaction.scrollIntoView();\n\n         view.dispatch(transaction);\n      }\n   }\n}\n\n// Protect for absent global `ProseMirror` on Foundry v9.\nconst ProseMirrorKeyMaps = globalThis.ProseMirror ? globalThis.ProseMirror.ProseMirrorKeyMaps : class {};\n\n/**\n * Provides an additional key mapping to `Escape` to destroy / cancel the active editor.\n */\nclass TJSKeyMaps extends ProseMirrorKeyMaps\n{\n   #onQuit;\n\n   /**\n    * @param {Schema}   schema - The ProseMirror schema to build keymaps for.\n    *\n    * @param {object}   [options] - Additional options to configure the plugin's behaviour.\n    *\n    * @param {Function} [options.onSave] - A function to call when Ctrl+S is pressed.\n    *\n    * @param {Function} [options.onQuit] - A function to call when Ctrl+Q is pressed.\n    */\n   constructor(schema, options)\n   {\n      super(schema, options);\n\n      if (typeof options.onQuit === 'function') { this.#onQuit = options.onQuit; }\n   }\n\n   /**\n    * Swaps the Foundry default `Escape` / selectParentNode to `Mod-p` and enables `onQuit` function for `Escape`.\n    *\n    * @returns {Object<ProseMirrorCommand>} ProseMirror keymap data.\n    */\n   buildMapping()\n   {\n      const mapping = super.buildMapping();\n\n      // Add onQuit callback if defined.\n      if (this.#onQuit)\n      {\n         // Swap Foundry core mapping for `Escape` / selectParentNode to `Mod-p`.\n         if (mapping['Escape']) { mapping['Mod-p'] = mapping['Escape']; }\n\n         mapping['Escape'] = () => this.#onQuit();\n      }\n\n      return mapping;\n   }\n}\n\n// Protect for absent global `ProseMirror` on Foundry v9.\nconst Plugin = globalThis.ProseMirror ? globalThis.ProseMirror.Plugin : class {};\n\n/**\n * A ProseMirror plugin to transform pasted text that is a raw document UUID into a document link suitable for\n * `TextEditor.enrichHTML`.\n */\nclass TJSPasteUUID\n{\n   /**\n    * Defines a regex to check for the shape of a raw Foundry document UUID.\n    *\n    * @type {RegExp}\n    */\n   static #s_UUID_REGEX = /(\\.).*([a-zA-Z0-9]{16})/;\n\n   /**\n    * @returns {Plugin<any>} PM Plugin.\n    */\n   static build()\n   {\n      const instance = new this();\n      return new Plugin({\n         // key: new PluginKey('tjsPasteRawUUID'), // TODO: Add back when exported by Foundry / ProseMirror bundle.\n         props: {\n            transformPastedText: (text) => instance.#transformUUID(text)\n         }\n      });\n   }\n\n   /**\n    * Transforms pasted text. Check if pasted test matches the shape of a raw UUID. If so do a lookup and if a\n    * document is retrieved transform it to a document link.\n    *\n    * @param {string}   text - pasted text to transform.\n    *\n    * @returns {string} Potentially transformed pasted text.\n    */\n   #transformUUID(text)\n   {\n      if (typeof text === 'string')\n      {\n         if (TJSPasteUUID.#s_UUID_REGEX.test(text))\n         {\n            const uuidDoc = globalThis.fromUuidSync(text);\n            if (uuidDoc)\n            {\n               text = `@UUID[${text}]{${typeof uuidDoc.name === 'string' ? uuidDoc.name : 'Unknown'}}`;\n            }\n         }\n      }\n\n      return text;\n   }\n}\n\nconst index = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   TJSKeyMaps: TJSKeyMaps,\n   TJSPasteUUID: TJSPasteUUID\n});\n\nexport { PMImpl, index as Plugins };\n//# sourceMappingURL=index.js.map\n","<script>\n   /**\n    * Provides a reactive wrapper for Foundry ProseMirror editor support. Allows editing Foundry document data or\n    * directly from content prop. Automatic HTML enrichment occurs for the content when saved.\n    *\n    * There are no required props, but the following are available to set.\n    * `content` - Provides an initial content string; you can bind to `content` from a parent component to get reactive\n    *             updates when `content` changes. Two-way binding.\n    *\n    * `enrichedContent` - Provides the enriched content via {@link TextEditor.enrichHTML} when `content` changes.\n    *             You can bind to `enrichedContent` from a parent component to get reactive updates though it is not\n    *             recommended to change `enrichedContent` externally. One-way binding.\n    *\n    * `options` - Defines the options object for this component and passed on to the Foundry TinyMCE support.\n    *             Please review all the options defined below {@link TJSProseMirrorOptions}.\n    *\n    *\n    * Notable options passed onto Foundry ProseMirror support.\n    * ---------------------------------\n    *\n    * `options.collaborate` - [boolean: false] When a `document` and `fieldName` is provided set this to true to enable\n    *                         collaborative editing.\n    *\n    * `options.plugins` - [object] An additional set of ProseMirror plugins to load.\n    *\n    *\n    * Events: There are three events fired when the editor is canceled, saved, and started.\n    * ---------------------------------\n    * `editor:cancel` - Fired when editing is canceled by a user action or reactive response to document changes.\n    *\n    * `editor:document:deleted` - Fired when the edited document is deleted. Access the document from\n    *                             `event.detail.document`.\n    *\n    * `editor:enrichedContent` - Fired when content is enriched. Access enriched content from\n    *                            `event.detail.enrichedContent`.\n    *\n    * `editor:save` - Fired when editing is saved. Access the content from `event.detail.content`.\n    *\n    * `editor:start` - Fired when editing is started.\n    *\n    * The following CSS variables control the associated styles with the default values.\n    *\n    * `.editor` HTMLDivElement:\n    * ---------------------------------\n    * --tjs-editor-background - none\n    * --tjs-editor-border - none\n    * --tjs-editor-border-radius - 0\n    * --tjs-editor-height - 100%\n    * --tjs-editor-margin - 0\n    * --tjs-editor-overflow - auto\n    * --tjs-editor-transition\n    * --tjs-editor-width - 100%\n    *\n    * `.editor` HTMLDivElement; properties available when activated:\n    * ---------------------------------\n    * --tjs-editor-active-box-shadow, unset; Foundry default: 0 0 5px var(--color-shadow-primary)\n    * --tjs-editor-active-outline - unset\n    * --tjs-editor-active-overflow - unset; When inactive the editor overflow is auto; when active overflow is unset.\n    *\n    * `.editor` HTMLDivElement; properties available when inactive, but manually focused:\n    * ---------------------------------\n    * --tjs-editor-inactive-box-shadow-focus-visible - fallback: --tjs-default-box-shadow-focus-visible\n    * --tjs-editor-inactive-outline-focus-visible - fallback: --tjs-default-outline-focus-visible; default: revert\n    * --tjs-editor-inactive-transition-focus-visible - fallback: --tjs-default-transition-focus-visible\n    *\n    * `.editor` HTMLDivElement; properties available when inactive, but hovered:\n    * ---------------------------------\n    * --tjs-editor-inactive-cursor-hover - text\n    * --tjs-editor-inactive-box-shadow-hover - unset\n    * --tjs-editor-inactive-outline-hover - unset\n    * --tjs-editor-inactive-user-select-hover - text\n    *\n    * `.editor-content` HTMLDivElement; when editing - the content overflow is set to auto:\n    * ---------------------------------\n    * --tjs-editor-content-overflow - auto\n    * --tjs-editor-content-padding - 0 0 0 0.25em\n    *\n    * `.editor-container` HTMLDivElement; when editing - removes default margins.\n    * ---------------------------------\n    * --tjs-editor-container-margin - 0\n    *\n    * .editor-edit; Defines the position of the edit button from top / right absolute positioning:\n    * ---------------------------------\n    * --tjs-editor-edit-button-right - 5px\n    * --tjs-editor-edit-button-top - 0\n    *\n    * .editor-menu; Defines the toolbar / menu.\n    * ---------------------------------\n    * --tjs-editor-toolbar-background - rgba(0, 0, 0, 0.1)\n    * --tjs-editor-toolbar-border-radius - 6px\n    * --tjs-editor-toolbar-box-shadow - 0 2px 2px -2px rgb(34 47 62 / 10%), 0 8px 8px -4px rgb(34 47 62 / 7%)\n    * --tjs-editor-toolbar-padding - 2px 0\n    * --tjs-editor-toolbar-width - 100%\n    */\n\n   /**\n    * @typedef {object} TJSProseMirrorOptions\n    *\n    * @property {boolean}   [button=true] - Provides an edit button to start editing. When button is false editing is\n    *           always enabled.\n    *\n    * @property {string[]}  [classes] - An array of strings to add to the `.editor` element classes. This allows easier\n    *           setting of CSS variables across a range of various editor components.\n    *\n    * @property {boolean}   [clickToEdit=false] - When true the edit button is not shown and a click on the editor\n    *           content initializes the editor.\n    *\n    * @property {boolean}   [collaborate=false] - Enables ProseMirror collaboration; requires a document to be set.\n    *\n    * @property {foundry.abstract.Document}   [document] - Set to a Foundry document to load and save content from it.\n    *           Requires `fieldName` to be set.\n    *\n    * @property {{ sanitizeWithVideo: function }}   [DOMPurify] - The DOMPurify export from\n    *           `@typhonjs-fvtt/runtime/dompurify`. Sanitizes content client side. Note: TinyMCE already does essential\n    *           `<script>` sanitization, so this is just an extra option that is available as an extra precaution.\n    *\n    * @property {boolean}   [editable=true] - Prevents editing and hides button. When set to false any active editor\n    *           is cancelled.\n    *\n    * @property {boolean}   [enrichContent=true] - When set to false content won't be enriched by\n    *           `TextEditor.enrichHTML`.\n    *\n    * @property {string}    [fieldName] - A field name to load and save to / from associated document. IE `a.b.c`.\n    *\n    * @property {'all'|'end'|'start'}   [initialSelection='start'] - Initial selection range; 'all', 'end' or 'start'.\n    *\n    * @property {string}    [keyCode='Enter'] - Defines the key event code to activate the editor when focused.\n    *\n    * @property {Object<string, string>}   [styles] - Additional CSS property names and values to set as inline styles.\n    *           This is useful for dynamically overriding any built in styles and in particular setting CSS variables\n    *           supported.\n    */\n\n   /**\n    * The following options that both {@link TJSTinyMCE} and {@link TJSContentEdit} support likely won't be implemented\n    * for the ProseMirror component as they involve significant effort in modifying ProseMirror which is not trivial at\n    * all without potentially weeks of work or entirely replacing the built-in Foundry ProseMirror toolbar / support.\n    *\n    * // @property {Object<FontFamilyDefinition>}    [fonts] - An additional object defining module / custom fonts to\n    * //         load specific to this editor.\n    *\n    * // @property {number}    [maxCharacterLength] - When defined as an integer greater than 0 this limits the max\n    * //          characters that can be entered.\n    *\n    * // @property {boolean}   [preventEnterKey=false] - When true this prevents enter key from creating a new line /\n    * //          paragraph.\n    *\n    * // @property {boolean}   [preventPaste=false] - Prevents pasting content into the editor.\n    *\n    * // @property {boolean}   [saveOnBlur=false] - When true any loss of focus / blur from the editor saves the editor\n    * //          state.\n    *\n    * // @property {boolean}   [saveOnEnterKey=false] - When true saves the editor state when the enter key is pressed.\n    * //          This is useful when configuring the editor for single line entry.\n    */\n\n   /**\n    * @typedef {object} PMEditorExtra - Defines extra data passed to TJSEditorOptions ProseMirror plugin.\n    *\n    * @property {string} initialSelectionDefault - The default value if `options.initialSelection is not defined.\n    */\n\n   import {\n      createEventDispatcher,\n      onDestroy,\n      onMount,\n      tick\n   }                        from 'svelte';\n\n   import { applyStyles }   from '@typhonjs-fvtt/runtime/svelte/action';\n\n   import { TJSDocument }   from '@typhonjs-fvtt/runtime/svelte/store';\n\n   import {\n      Plugins,\n      PMImpl }              from '@typhonjs-fvtt/svelte-standard/prosemirror';\n\n   /** @type {string} */\n   export let content = '';\n\n   /** @type {string} */\n   export let enrichedContent = '';\n\n   /**\n    * Provides the options object that can be reactively updated. See documentation above.\n    *\n    * @type {TJSProseMirrorOptions}\n    */\n   export let options = {};\n\n   const dispatch = createEventDispatcher();\n\n   // Provides reactive updates for any associated Foundry document.\n   const doc = new TJSDocument({ delete: onDocumentDeleted });\n\n   /** @type {boolean} */\n   let clickToEdit;\n\n   /** @type {boolean} */\n   let editable = true;\n\n   /** @type {HTMLDivElement} */\n   let editorContentEl;\n\n   /** @type {ProseMirrorEditor} */\n   let editor;\n\n   /** @type {boolean} */\n   let editorActive = false;\n\n   /** @type {boolean} */\n   let editorButton;\n\n   /** @type {HTMLDivElement} */\n   let editorEl;\n\n   /** @type {string} */\n   let keyCode;\n\n   /** @type {boolean} */\n   let keyFocused = false;\n\n   /**\n    * Respond to changes in `options.editable`.\n    */\n   $:\n   {\n      editable = typeof options.editable === 'boolean' ? options.editable : true;\n      if (!editable) { destroyEditor(); }\n   }\n\n   /**\n    * When `options.editable` & `options.clickToEdit` is true and the editor is not active enable clickToEdit.\n    */\n   $: clickToEdit = !editorActive && editable &&\n    (typeof options.clickToEdit === 'boolean' ? options.clickToEdit : false);\n\n   /**\n    * When `options.button` & `options.editable` is true and the editor is not active and `clickToEdit` is false\n    * enable the edit button.\n    */\n   $: editorButton = !editorActive && editable && (typeof options.button === 'boolean' ? options.button : true) &&\n    !clickToEdit;\n\n   /**\n    * Allows another KeyboardEvent.code to be used to activate the editor.\n    */\n   $: keyCode = typeof options.keyCode === 'string' ? options.keyCode : 'Enter';\n\n   /**\n    * Respond to changes in `options.document`\n    */\n   $: if (options.document !== void 0)\n   {\n      if (!(options.document instanceof globalThis.foundry.abstract.Document))\n      {\n         throw new TypeError(`TJSProseMirror error: 'options.document' is not a Foundry document.`);\n      }\n\n      if (typeof options.fieldName !== 'string')\n      {\n         throw new TypeError(\n          `TJSProseMirror error: 'options.document' is defined, but 'options.fieldName' is not a string.`);\n      }\n\n      // Remove any existing editor if document changes.\n      if (options.document !== $doc)\n      {\n         enrichedContent = '';\n         content = '';\n         destroyEditor();\n      }\n\n      doc.set(options.document);\n   }\n   else\n   {\n      // Remove any existing editor if there was a document set, but now it is removed.\n      if ($doc)\n      {\n         enrichedContent = '';\n         content = '';\n\n         destroyEditor();\n\n         doc.set(void 0);\n      }\n   }\n\n   // If there is a valid document then retrieve content from `fieldName` otherwise use `content` string.\n   $:\n   {\n      content = $doc !== void 0 ? globalThis.foundry.utils.getProperty($doc, options.fieldName) :\n       typeof content === 'string' ? content : '';\n\n      // Avoid double trigger of reactive statement as enriching content is async.\n      onContentChanged(content, typeof options.enrichContent === 'boolean' ? options.enrichContent : true);\n   }\n\n   onDestroy(() =>\n   {\n      // Handle the case when the component is destroyed / IE application closed, but the editor isn't saved.\n      if (editorActive)\n      {\n         saveEditor({ remove: typeof options.button === 'boolean' ? options.button : true });\n      }\n      else\n      {\n         destroyEditor();\n      }\n   });\n\n   /**\n    * If `options.editable` is true and `options.button` && `options.clickToEdit` is false then start the editor on\n    * mount.\n    */\n   onMount(() => { if (editable && !editorButton && !clickToEdit) { initEditor(); } });\n\n   /**\n    * Destroys any active editor.\n    */\n   function destroyEditor(fireCancel = true)\n   {\n      if (editor)\n      {\n         editor.destroy();\n         editor = void 0;\n\n         // Post on next micro-task to allow any event propagation for `Escape` key to trigger first.\n         setTimeout(() => { editorActive = false; }, 0);\n\n         // If the editor was initialized by keyboard action then focus it after a short delay to allow the template\n         // to update.\n         if (keyFocused)\n         {\n            keyFocused = false;\n\n            setTimeout(() =>\n            {\n               if (editorEl instanceof HTMLElement && editorEl?.isConnected) { editorEl.focus(); }\n            }, 100);\n         }\n\n         if (fireCancel) { dispatch('editor:cancel'); }\n      }\n   }\n\n   /**\n    * Initializes editor.\n    *\n    * @returns {Promise<void>}\n    */\n   async function initEditor()\n   {\n      // If editor button is enabled then remove the menu / editing interface on save.\n      const remove = typeof options.button === 'boolean' ? options.button : true;\n\n      const editorOptions = {\n         ...options,\n\n         plugins: {\n            ...ProseMirror.defaultPlugins,\n\n            menu: ProseMirror.ProseMirrorMenu.build(ProseMirror.defaultSchema, {\n               destroyOnSave: remove,\n               onSave: () => saveEditor({ remove })\n            }),\n\n            keyMaps: Plugins.TJSKeyMaps.build(ProseMirror.defaultSchema, {\n               onSave: () => saveEditor({ remove }),\n               onQuit: () => destroyEditor()\n            }),\n\n            tjsPasteRawUUID: Plugins.TJSPasteUUID.build(),\n\n            ...(typeof options.plugins === 'object' ? options.plugins : {})\n         }\n      };\n\n      editorActive = true;\n\n      // Editor is now active; wait until the template updates w/ new bound `editorContentEl`.\n      await tick();\n\n      editor = await ProseMirrorEditor.create(editorContentEl, content, editorOptions);\n\n      // `.editor-container` div is added automatically; add inline style to set margin to 0.\n      const containerEl = editorEl.querySelector('.editor-container');\n      if (containerEl) { containerEl.style = 'margin: var(--tjs-editor-container-margin, 0)'; }\n\n      editor.view.focus();\n\n      PMImpl.setInitialSelection(editor.view, options);\n\n      dispatch('editor:start');\n   }\n\n   /**\n    * Potentially handles initializing the editor when it is not active and `options.clickToEdit` is true.\n    *\n    * @param {MouseEvent}   event -\n    */\n   function onClick(event)\n   {\n      if (!editorActive && clickToEdit) { initEditor(); }\n   }\n\n   /**\n    * Separated into a standalone method so applying async value to enriched content doesn't double trigger a reactive\n    * statement twice.\n    *\n    * @param {string}   content - Content prop.\n    *\n    * @param {boolean}  enrichContent - `options.enrichContent` or default of `true.\n    *\n    * @returns {Promise<void>}\n    */\n   async function onContentChanged(content, enrichContent)\n   {\n      if (typeof content === 'string')\n      {\n         if (enrichContent)\n         {\n            enrichedContent = await TextEditor.enrichHTML(content, { async: true, secrets: globalThis.game.user.isGM });\n         }\n         else\n         {\n            enrichedContent = content;\n         }\n      }\n      else\n      {\n         enrichedContent = '';\n      }\n\n      dispatch('editor:enrichedContent', { enrichedContent });\n   }\n\n   /**\n    * Handles cleaning up the editor state after any associated document has been deleted.\n    *\n    * @param {foundry.abstract.Document} document - The deleted document.\n    */\n   function onDocumentDeleted(document)\n   {\n      options.document = void 0;\n\n      destroyEditor();\n\n      dispatch('editor:document:deleted', { document });\n\n      content = '';\n      enrichedContent = '';\n   }\n\n   /**\n    * Prevents `Escape` key or `Ctrl-s` from propagating when the editor is active preventing the app from being closed.\n    * The `Escape` key is used to close the active editor first. Foundry by default when `Ctrl-s` is pressed as of v10\n    * scrolls the canvas down which is undesired when saving an editor as well.\n    *\n    * @param {KeyboardEvent}    event - A keyboard event from `.editor`.\n    */\n   function onKeydown(event)\n   {\n      if (editorActive)\n      {\n         if (event.code === 'Escape' || (event.code === 'KeyS' && (event.ctrlKey || event.metaKey)))\n         {\n            event.preventDefault();\n            event.stopPropagation();\n         }\n      }\n      else\n      {\n         if (event.code === keyCode)\n         {\n            event.preventDefault();\n            event.stopPropagation();\n         }\n      }\n   }\n\n   /**\n    * Handle activating the editor if key codes match.\n    *\n    * @param {KeyboardEvent}    event - A KeyboardEvent.\n    */\n   function onKeyup(event)\n   {\n      if (event.code === keyCode)\n      {\n         if (!editorActive)\n         {\n            keyFocused = true;\n            initEditor();\n         }\n\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Saves the editor contents to the associated document or updates content directly.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.remove=true] - Removes the editor.\n    */\n   function saveEditor({ remove = true } = {})\n   {\n      if (editor)\n      {\n         if (editor.isDirty())\n         {\n            let data = ProseMirror.dom.serializeString(editor.view.state.doc);\n\n            // Perform client side sanitization if DOMPurify is available in options.\n            // ProseMirror does essential `<script>` based sanitization, so this is just an extra option to provide\n            // specific sanitization.\n            if (options?.DOMPurify && typeof options?.DOMPurify?.sanitizeWithVideo === 'function')\n            {\n               data = options.DOMPurify.sanitizeWithVideo(data);\n            }\n\n            // Save to document if available\n            if ($doc && options.fieldName)\n            {\n               $doc.update({ [options.fieldName]: data })\n            }\n            else // Otherwise save to content.\n            {\n               content = data;\n            }\n\n            dispatch('editor:save', { content: data });\n         }\n\n         // Remove the editor\n         if (remove) { destroyEditor(false); }\n      }\n   }\n</script>\n\n<div bind:this={editorEl}\n     class=\"editor prosemirror tjs-editor {Array.isArray(options.classes) ? options.classes.join(' ') : ''}\"\n     class:click-to-edit={clickToEdit}\n     class:editor-active={editorActive}\n     use:applyStyles={options.styles}\n     on:click={onClick}\n     on:keydown={onKeydown}\n     on:keyup={onKeyup}\n     role=textbox\n     tabindex=0>\n    {#if editorButton}\n        <!-- svelte-ignore a11y-missing-attribute a11y-click-events-have-key-events -->\n        <a class=editor-edit on:click={() => initEditor()} role=button><i class=\"fas fa-edit\"></i></a>\n    {/if}\n    {#if editorActive}\n        <div bind:this={editorContentEl} class=editor-content />\n    {:else}\n        <div class=editor-enriched>\n            {@html enrichedContent}\n        </div>\n    {/if}\n</div>\n\n<style>\n    .editor {\n        background: var(--tjs-editor-background, none);\n        border: var(--tjs-editor-border, none);\n        border-radius: var(--tjs-editor-border-radius, 0);\n        height: var(--tjs-editor-height, 100%);\n        margin: var(--tjs-editor-margin, 0);\n        outline-offset: var(--tjs-editor-outline-offset, 0.25em);\n        overflow: var(--tjs-editor-overflow, auto);\n        transition: var(--tjs-editor-transition);\n        width: var(--tjs-editor-width, 100%);\n\n        /* For Firefox. */\n        scrollbar-width: thin;\n    }\n\n    /**\n     * This class is added to editor when `editorActive` is true and unsets overflow allowing content to be scrollable\n     * keeping the menu bar always visible at the top of the component.\n     */\n    .editor-active {\n        box-shadow: var(--tjs-editor-active-box-shadow);\n        outline: var(--tjs-editor-active-outline);\n        overflow: var(--tjs-editor-active-overflow, unset);\n    }\n\n    /**\n     * Defines cursor and box-shadow / outline when the editor is inactive and hovered.\n     */\n    .tjs-editor:not(.editor-active):focus-visible {\n        box-shadow: var(--tjs-editor-inactive-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\n        outline: var(--tjs-editor-inactive-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\n        transition: var(--tjs-editor-inactive-transition-focus-visible, var(--tjs-default-transition-focus-visible));\n    }\n\n    /**\n     * Defines cursor and box-shadow / outline when the editor is inactive and hovered, but not manually focused.\n     */\n    .tjs-editor:not(.editor-active):not(:focus-visible):hover {\n        box-shadow: var(--tjs-editor-inactive-box-shadow-hover);\n        outline: var(--tjs-editor-inactive-outline-hover);\n    }\n\n    /**\n     * Defines user-select when the editor is inactive and hovered.\n     */\n    .tjs-editor:not(.editor-active):hover {\n        user-select: var(--tjs-editor-inactive-user-select-hover, text);\n    }\n\n    /**\n     * Defines cursor when the editor is not active, but configured for click to edit. Give the user some indication\n     * via showing the text cursor across the whole editor element.\n     */\n    .tjs-editor.click-to-edit:not(.editor-active):hover {\n        cursor: var(--tjs-editor-inactive-cursor-hover, text);\n    }\n\n    .editor-content {\n        overflow: var(--tjs-editor-content-overflow, auto);\n        padding: var(--tjs-editor-content-padding, 0 0 0 0.25em);\n\n        /* For Firefox. */\n        scrollbar-width: thin;\n    }\n\n    .editor-edit {\n        right: var(--tjs-editor-edit-button-right, 5px);\n        top: var(--tjs-editor-edit-button-top, 0);\n    }\n\n    .editor-enriched {\n        padding: var(--tjs-editor-content-padding, 0 0 0 0.25em);\n    }\n\n    /* Controls whether the editor content text is selectable when the editor is inactive. */\n    .tjs-editor:not(.editor-active) .editor-enriched {\n        user-select: var(--tjs-editor-inactive-user-select-hover, text);\n    }\n\n    /* Don't add an initial margin top to first paragraph element in `.editor-content`. */\n    .tjs-editor .editor-container .editor-content :global(p:first-of-type) {\n        margin-top: 0;\n    }\n\n    .tjs-editor .editor-enriched :global(p:first-of-type) {\n        margin-top: 0;\n    }\n\n    /* Provides global styles scoped to `.tjs-editor` for dynamic `.editor-menu` element */\n    .tjs-editor :global(.editor-menu) {\n        background: var(--tjs-editor-toolbar-background, rgba(0, 0, 0, 0.1));\n        border-radius: var(--tjs-editor-toolbar-border-radius, 6px);\n        box-shadow: var(--tjs-editor-toolbar-box-shadow, 0 2px 2px -2px rgb(34 47 62 / 10%), 0 8px 8px -4px rgb(34 47 62 / 7%));\n        margin-bottom: 0.25em;\n        padding: var(--tjs-editor-toolbar-padding, 2px 0);\n        width: var(--tjs-editor-toolbar-width, 100%);\n\n        transition: box-shadow 500ms ease-in-out;\n    }\n\n    /* Removes the awkward 1rem padding from core */\n    .tjs-editor.prosemirror.editing-source :global(textarea) {\n        padding: 0;\n    }\n</style>\n","<script>\n   /**\n    * --tjs-toggle-label-background\n    * --tjs-toggle-label-background-focus-visible\n    * --tjs-toggle-label-background-hover\n    * --tjs-toggle-label-background-selected\n    * --tjs-toggle-label-border\n    * --tjs-toggle-label-border-radius\n    * --tjs-toggle-label-box-shadow-focus-visible - fallback: --tjs-default-box-shadow-focus-visible\n    * --tjs-toggle-label-font-size - inherit\n    * --tjs-toggle-label-font-weight - inherit\n    * --tjs-toggle-label-font-family - inherit\n    * --tjs-toggle-label-overflow - hidden\n    * --tjs-toggle-label-padding - 0\n    * --tjs-toggle-label-text-shadow-focus - undefined; default: --tjs-default-text-shadow-focus-hover\n    * --tjs-toggle-label-text-shadow-hover - undefined; default: --tjs-default-text-shadow-focus-hover\n    * --tjs-toggle-label-text-shadow-selected - undefined; default: --tjs-default-text-shadow-focus-hover\n    * --tjs-toggle-label-transition - global default: 'background 0.2s ease-in-out'\n    * --tjs-toggle-label-transition-focus-visible - fallback: --tjs-default-transition-focus-visible\n    */\n   import { createEventDispatcher } from 'svelte';\n\n   import { applyStyles }     from '@typhonjs-fvtt/runtime/svelte/action';\n   import { localize }        from '@typhonjs-fvtt/runtime/svelte/helper';\n   import { isWritableStore } from '@typhonjs-fvtt/runtime/svelte/store';\n   import {\n      isObject,\n      isSvelteComponent }     from '@typhonjs-fvtt/runtime/svelte/util';\n\n   export let label = void 0;\n   export let text = void 0;\n   export let comp = void 0;\n   export let title = void 0;\n   export let titleSelected = void 0;\n   export let store = void 0;\n   export let styles = void 0;\n   export let efx = void 0;\n   export let keyCode = void 0;\n   export let onPress = void 0;\n   export let onClose = void 0;\n   export let onContextMenu = void 0;\n   export let onClickPropagate = void 0;\n\n   const dispatch = createEventDispatcher();\n\n   $: text = isObject(label) && typeof label.text === 'string' ? label.text :\n    typeof text === 'string' ? text : void 0;\n   $: comp = isObject(label) && isSvelteComponent(label.comp) ? label.comp :\n    isSvelteComponent(comp) ? comp : void 0;\n   $: title = isObject(label) && typeof label.title === 'string' ? label.title :\n    typeof title === 'string' ? title : '';\n   $: titleSelected = isObject(label) && typeof label.titleSelected === 'string' ? label.titleSelected :\n    typeof titleSelected === 'string' ? titleSelected : '';\n   $: store = isObject(label) && isWritableStore(label.store) ? label.store : isWritableStore(store) ?\n    store : void 0;\n   $: styles = isObject(label) && typeof label.styles === 'object' ? label.styles :\n    typeof styles === 'object' ? styles : void 0;\n   $: efx = isObject(label) && typeof label.efx === 'function' ? label.efx :\n    typeof efx === 'function' ? efx : () => {};\n   $: keyCode = isObject(label) && typeof label.keyCode === 'string' ? label.keyCode :\n    typeof keyCode === 'string' ? keyCode : 'Enter';\n\n   $: onPress = isObject(label) && typeof label.onPress === 'function' ? label.onPress :\n    typeof onPress === 'function' ? onPress : void 0;\n   $: onClose = isObject(label) && typeof label.onClose === 'function' ? label.onClose :\n    typeof onClose === 'function' ? onClose : void 0;\n   $: onContextMenu = isObject(label) && typeof label.onContextMenu === 'function' ? label.onContextMenu :\n    typeof onContextMenu === 'function' ? onContextMenu : void 0;\n\n   $: onClickPropagate = isObject(label) && typeof label.onClickPropagate === 'boolean' ? label.onClickPropagate :\n    typeof onClickPropagate === 'boolean' ? onClickPropagate : false;\n\n   let spanEl;\n   let selected = false;\n\n   $: if (store) { selected = $store; }\n\n   // Chose the current title when `selected` changes; if there is no `titleSelected` fallback to `title`.\n   $: titleCurrent = selected && titleSelected !== '' ? titleSelected : title\n\n   /**\n    * Handle click event.\n    *\n    * @param {MouseEvent}    event -\n    */\n   function onClick(event)\n   {\n      selected = !selected;\n      if (store) { store.set(selected); }\n\n      if (typeof onPress === 'function') { onPress(selected); }\n\n      dispatch('press', { selected });\n\n      if (!onClickPropagate)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * In this case we can't set pointer-events: none for the div due to the slotted component, so process clicks on the\n    * div in respect to onClickPropagate.\n    *\n    * @param {MouseEvent} event -\n    */\n   function onClickDiv(event)\n   {\n      if (!onClickPropagate)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Handles `close:popup` event from any children components like TJSMenu.\n    */\n   function onClosePopup(event)\n   {\n      selected = false;\n      if (store) { store.set(false); }\n\n      if (typeof onClose === 'function') { onClose(selected); }\n\n      // The close event was triggered from a key press, so focus the anchor element / button.\n      if (typeof event?.detail?.keyboardFocus === 'boolean' && event.detail.keyboardFocus && spanEl?.isConnected)\n      {\n         spanEl.focus();\n\n         event.stopPropagation();\n         event.preventDefault();\n      }\n   }\n\n   /**\n    * @param {MouseEvent}   event -\n    */\n   function onContextMenuPress(event)\n   {\n      if (typeof onContextMenu === 'function') { onContextMenu(); }\n\n      if (!onClickPropagate)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Consume / stop propagation of key down when key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeydown(event)\n   {\n      if (event.code === keyCode)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Handle press event if key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeyup(event)\n   {\n      if (event.code === keyCode)\n      {\n         selected = !selected;\n         if (store) { store.set(selected); }\n\n         if (typeof onPress === 'function') { onPress(selected); }\n\n         dispatch('press', { selected });\n\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<div class=tjs-toggle-label\n     on:click={onClickDiv}\n     on:close:popup={onClosePopup}\n     title={localize(titleCurrent)}\n     use:applyStyles={styles}>\n   <slot name=outer />\n   <span bind:this={spanEl}\n         class:selected\n         on:click={onClick}\n         on:contextmenu={onContextMenuPress}\n         on:keydown={onKeydown}\n         on:keyup={onKeyup}\n         on:click\n         on:contextmenu\n         role=button\n         tabindex=0\n         use:efx>\n      <slot name=left />\n      {#if comp}\n         <svelte:component this={comp}/>\n      {:else if typeof text === 'string'}\n         <!-- svelte-ignore a11y-missing-attribute -->\n         <a role=presentation>{localize(text)}</a>\n      {/if}\n      <slot name=right />\n   </span>\n   {#if selected}\n      <slot/>\n   {/if}\n</div>\n\n<style>\n   div {\n      display: block;\n      position: relative;\n   }\n\n   span {\n      position: relative;\n\n      display: flex;\n      justify-content: var(--tjs-toggle-label-justify-content, center);\n      align-items: var(--tjs-toggle-label-align-items, center);\n\n      pointer-events: initial;\n\n      width: 100%;\n      height: 100%;\n\n      background: var(--tjs-toggle-label-background);\n      border: var(--tjs-toggle-label-border, none);\n      border-radius: var(--tjs-toggle-label-border-radius);\n      font-size: var(--tjs-toggle-label-font-size, inherit);\n      font-weight: var(--tjs-toggle-label-font-weight, inherit);\n      font-family: var(--tjs-toggle-label-font-family, inherit);\n      overflow: var(--tjs-toggle-label-overflow, hidden);\n      padding: var(--tjs-toggle-label-padding, 0 0.25em);\n      transform-style: preserve-3d;\n      transition: var(--tjs-toggle-label-transition, background 0.2s ease-in-out);\n   }\n\n   span:focus {\n      background: var(--tjs-toggle-label-background-focus);\n      text-shadow: var(--tjs-toggle-label-text-shadow-focus, var(--tjs-default-text-shadow-focus-hover));\n   }\n\n   span:focus-visible {\n      background: var(--tjs-toggle-label-background-focus-visible);\n      box-shadow: var(--tjs-toggle-label-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\n      outline: var(--tjs-toggle-label-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\n      transition: var(--tjs-toggle-label-transition-focus-visible, var(--tjs-default-transition-focus-visible));\n   }\n\n   span:hover {\n      background: var(--tjs-toggle-label-background-hover);\n      text-shadow: var(--tjs-toggle-label-text-shadow-hover, var(--tjs-default-text-shadow-focus-hover));\n   }\n\n   span.selected {\n      background: var(--tjs-toggle-label-background-selected);\n      text-shadow: var(--tjs-toggle-label-text-shadow-selected, var(--tjs-default-text-shadow-focus-hover));\n   }\n</style>\n","<script>\n   /**\n    * TJSMenu provides a menu component that can be slotted into toggle components like TJSToggleIconButton and\n    * TJSToggleLabel.\n    *\n    * TJSMenu supports a flexible data driven way to construct the menu items. Depending on the item data that is passed\n    * into the menu you can define 4 types of items: 'icon / label', 'image / label', 'class / Svelte component', and\n    * 'separator / hr'. TJSMenu also accepts a main slot allowing the entire menu contents to be replaced with a custom\n    * component as well as named slots `before` and `after` which place named components before or after the main menu\n    * data driven items.\n    *\n    * ----------------------------------------------------------------------------------------------------------------\n    * Exported props include:\n    * `menu` ({@link TJSMenuData}): An object defining all properties of a menu including potentially data driven\n    * minimal Svelte configuration objects (`slotAfter`, `slotBefore`, and `slotDefault`) providing default\n    * component implementations.\n    *\n    * Or in lieu of passing the folder object you can assign these props directly:\n    * `items`: An iterable list of {@link TJSMenuItemData}; defines data driven menu items.\n    * `offset`: Optional X / Y offsets for the menu display.\n    * `styles`: Styles to be applied inline via `applyStyles` action.\n    * `efx`: Currently unused; for any future action effects.\n    * `keyCode`: The key code to activate menu items.\n    * `transitionOptions`: Custom transition options for duration and easing function.\n    *\n    * ----------------------------------------------------------------------------------------------------------------\n    * Events: There is a single that is fired and bubbled up through parent elements:\n    *\n    * `close:popup` - A CustomEvent fired when the menu closes allowing any parent components to update state. The\n    *                 `detail` data may have two optional fields of data including `keyboardFocus` / boolean if the\n    *                 close action originated from keyboard navigation and the other is `target` / HTMLElement that is\n    *                 the original event target for the close action.\n    *\n    * ----------------------------------------------------------------------------------------------------------------\n    * Styling: To style this component use `.tjs-menu` as the base selector.\n    *\n    * There are several local CSS variables that you can use to change the appearance dynamically. Either use\n    * CSS props or pass in a `styles` object w/ key / value props to set to the details. The default fallback variables\n    * target both TJSMenu and TJSContextMenu. The few `popup` defaults target first level overlaid components inside an\n    * application.\n    *\n    * The following CSS variables are supported, but not defined by default.\n    * --tjs-menu-background - fallback: --tjs-default-menu-background; fallback: --tjs-default-popup-background; default: #23221d\n    * --tjs-menu-border - fallback: --tjs-default-popup-border; default: 1px solid #000\n    * --tjs-menu-border-radius - fallback: --tjs-default-popup-border-radius; default: 5px\n    * --tjs-menu-box-shadow - fallback: --tjs-default-popup-box-shadow; default: 0 0 2px #000\n    * --tjs-menu-primary-color - fallback: --tjs-default-menu-primary-color; fallback: --tjs-default-popup-primary-color; default: #b5b3a4\n    * --tjs-menu-max-width - fallback: --tjs-default-menu-max-width; default: 360px\n    * --tjs-menu-min-width - fallback: --tjs-default-menu-min-width; default: 20px\n    * --tjs-menu-z-index - fallback: --tjs-default-popup-z-index; default: 100\n    *\n    * The following CSS variables define attributes for the data driven menu items.\n    *\n    * All menu items:\n    * --tjs-menu-item-line-height - fallback: --tjs-default-menu-item-line-height; default: 2em\n    * --tjs-menu-item-padding - fallback: --tjs-default-menu-item-padding; default: 0 0.5em 0 0\n    *\n    * Icon / Image menu items (considered a button item):\n    * --tjs-menu-item-button-gap - fallback: --tjs-default-menu-item-button-gap; default: 0.25em\n    * --tjs-menu-item-highlight-color - fallback: --tjs-default-menu-highlight-color; fallback: --tjs-default-popup-highlight-color; default: #f0f0e0\n    * --tjs-menu-item-text-shadow-focus-hover - fallback: --tjs-default-text-shadow-focus-hover; default: 0 0 8px red\n    *\n    * Specific targeting for the label of button items (allows control of wrapping / set `white-space` to `nowrap`):\n    * --tjs-menu-item-label-overflow - fallback: --tjs-default-menu-item-label-overflow; default: hidden\n    * --tjs-menu-item-label-text-overflow - fallback: --tjs-default-menu-item-label-text-overflow; default: ellipsis\n    * --tjs-menu-item-label-white-space - fallback: --tjs-default-menu-item-label-white-space; default: undefined\n    *\n    * Icon menu item:\n    * --tjs-menu-item-icon-width - fallback: --tjs-default-menu-item-icon-width; default: 1.25em\n    *\n    * Image menu item:\n    * --tjs-menu-item-image-width - fallback: --tjs-default-menu-item-image-width; default: 1.25em\n    * --tjs-menu-item-image-height - fallback: --tjs-default-menu-item-image-height; default: 1.25em\n    *\n    * Separator / HR:\n    * --tjs-menu-hr-margin - fallback: --tjs-default-hr-margin; default: 0 0.25em\n    * --tjs-menu-hr-border-top - fallback: --tjs-default-hr-border-top; default: 1px solid #555\n    * --tjs-menu-hr-border-bottom - fallback: --tjs-default-hr-border-bottom; default: 1px solid #444\n    *\n    * The following CSS variables define the keyboard / a11y focus indicator for menu items:\n    * --tjs-menu-focus-indicator-align-self - fallback: --tjs-default-focus-indicator-align-self; default: stretch\n    * --tjs-menu-focus-indicator-background - fallback: --tjs-default-focus-indicator-background; default: white\n    * --tjs-menu-focus-indicator-border - fallback: --tjs-default-focus-indicator-border; default: undefined\n    * --tjs-menu-focus-indicator-border-radius - fallback: --tjs-default-focus-indicator-border-radius; default: 0.1em\n    * --tjs-menu-focus-indicator-height - fallback: --tjs-default-focus-indicator-height; default: undefined\n    * --tjs-menu-focus-indicator-width - fallback: --tjs-default-focus-indicator-width; default: 0.25em\n    * --tjs-menu-focus-indicator-transition - fallback: --tjs-default-focus-indicator-transition\n    */\n\n   import { onMount }      from 'svelte';\n\n   import { quintOut }     from 'svelte/easing';\n\n   import { applyStyles }  from '@typhonjs-fvtt/runtime/svelte/action';\n   import { localize }     from '@typhonjs-fvtt/runtime/svelte/helper';\n   import { slideFade }    from '@typhonjs-fvtt/runtime/svelte/transition';\n   import {\n      A11yHelper,\n      getStackingContext,\n      isIterable,\n      isObject,\n      isSvelteComponent }  from '@typhonjs-fvtt/runtime/svelte/util';\n\n   import { TJSFocusWrap } from '@typhonjs-fvtt/runtime/svelte/component/core';\n\n   /** @type {TJSMenuData} */\n   export let menu = void 0;\n\n   /** @type {Iterable<TJSMenuItemData>} */\n   export let items = void 0;\n\n   /** @type {HTMLElement|string} */\n   export let focusEl = void 0;\n\n   /** @type {{ x?: number, y?: number }} */\n   export let offset = void 0;\n\n   /** @type {Record<string, string>} */\n   export let styles = void 0;\n\n   /** @type {Function} */\n   export let efx = void 0;\n\n   /** @type {string} */\n   export let keyCode = void 0;\n\n   /** @type {{ duration: number, easing: Function }} */\n   export let transitionOptions = void 0;\n\n   const s_DEFAULT_OFFSET = { x: 0, y: 0 };\n\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\n\n   /** @type {Iterable<TJSMenuItemData>} */\n   let allItems;\n\n   $: {\n      const tempList = isObject(menu) && isIterable(menu.items) ? menu.items :\n       isIterable(items) ? items : [];\n\n      const tempItems = [];\n\n      let cntr = -1;\n\n      for (const item of tempList)\n      {\n         cntr++;\n         if (!isObject(item)) { throw new TypeError(`TJSMenu error: 'item[${cntr}]' is not an object.`); }\n\n         // Filter items for any condition that prevents display.\n         if (typeof item.condition === 'function' && !item.condition()) { continue; }\n         if (typeof item.condition === 'boolean' && !item.condition) { continue; }\n\n         let type;\n\n         if (isSvelteComponent(item.class)) { type = 'class'; }\n         else if (typeof item.icon === 'string') { type = 'icon'; }\n         else if (typeof item.image === 'string') { type = 'image'; }\n         else if (typeof item.separator === 'string')\n         {\n            if (item.separator !== 'hr')\n            {\n               throw new Error (\n                `TJSMenu error: 'item[${cntr}]' has unknown separator type; only 'hr' is currently supported.`)\n            }\n\n            type = 'separator-hr';\n         }\n\n         if (type === void 0) { throw new TypeError(`TJSMenu error: Unknown type for 'item[${cntr}]'.`); }\n\n         tempItems.push({ ...item, '#type': type });\n      }\n\n      allItems = tempItems;\n   }\n\n   $: focusEl = isObject(menu) && A11yHelper.isFocusSource(menu.focusEl) ? menu.focusEl :\n    A11yHelper.isFocusSource(focusEl) ? focusEl : void 0;\n\n   $: offset = isObject(menu) && isObject(menu.offset) ? menu.offset :\n    isObject(offset) ? offset : s_DEFAULT_OFFSET;\n\n   $: styles = isObject(menu) && isObject(menu.styles) ? menu.styles :\n    isObject(styles) ? styles : void 0;\n\n   $: efx = isObject(menu) && typeof menu.efx === 'function' ? menu.efx :\n    typeof efx === 'function' ? efx : () => {};\n\n   $: keyCode = isObject(menu) && typeof menu.keyCode === 'string' ? menu.keyCode :\n    typeof keyCode === 'string' ? keyCode : 'Enter';\n\n   $: transitionOptions = isObject(menu) && isObject(menu.transitionOptions) ? menu.transitionOptions :\n     isObject(transitionOptions) ? transitionOptions : { duration: 200, easing: quintOut };\n\n   // Bound to the nav element / menu.\n   let menuEl;\n\n   // Stores if this context menu is closed.\n   let closed = false;\n\n   // Stores any associated `focusSource` options to pass to menu callbacks when menu was activated by keys.\n   let focusOptions = void 0;\n\n   // Stores if menu has keyboard focus; detected on mount, when tab navigation occurs, and used to set `keyboardFocus`\n   // for close event.\n   let hasKeyboardFocus = false;\n\n   // ----------------------------------------------------------------------------------------------------------------\n\n   onMount(() =>\n   {\n      const activeEl = document.activeElement;\n      const parentEl = menuEl.parentElement;\n\n      // Determine if the parent element to the menu contains the active element and that it is explicitly focused\n      // via `:focus-visible` / keyboard navigation. If so then explicitly focus the first menu item possible.\n      if (parentEl instanceof HTMLElement && activeEl instanceof HTMLElement && parentEl.contains(activeEl) &&\n        activeEl.matches(':focus-visible'))\n      {\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(menuEl);\n\n         if (firstFocusEl instanceof HTMLElement && !firstFocusEl.classList.contains('tjs-focus-wrap'))\n         {\n            firstFocusEl.focus();\n            hasKeyboardFocus = true;\n         }\n         else\n         {\n            // Silently focus the menu element so that keyboard handling functions.\n            menuEl.focus();\n         }\n\n         // Menu opened by keyboard navigation; set focus source to activeEl and pass to menu item callbacks.\n         focusOptions = {\n            focusSource: {\n               focusEl: [activeEl]\n            }\n         };\n\n         // Append any optional focus source from `focusEl` prop.\n         if (focusEl) { focusOptions.focusSource.focusEl.push(focusEl); }\n      }\n      else\n      {\n         // Silently focus the menu element so that keyboard handling functions.\n         menuEl.focus();\n\n         // Create focus source from optional `focusEl` prop.\n         if (focusEl)\n         {\n            focusOptions = {\n               focusSource: {\n                  focusEl: [focusEl]\n               }\n            };\n         }\n      }\n   });\n\n   // ----------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a custom transform allowing inspection of the element to change positioning styles based on the\n    * height / width of the element and the containing stacking context element. This allows the menu to expand left or\n    * right when the menu exceeds the bounds of the containing stacking context element.\n    *\n    * @param {HTMLElement} node - nav element.\n    *\n    * @returns {object} Transition object.\n    */\n   function animate(node)\n   {\n      const result = getStackingContext(node.parentElement);\n\n      if (!(result?.node instanceof HTMLElement))\n      {\n         console.warn(`'TJSMenu.animate warning: Could not locate parent stacking context element.`);\n         return;\n      }\n\n      const stackingContextRect = result?.node.getBoundingClientRect();\n      const stackingContextRight = stackingContextRect.x + stackingContextRect.width;\n\n      const nodeRect = node.getBoundingClientRect();\n      const parentRect = node.parentElement.getBoundingClientRect();\n\n      const adjustedOffset = {...s_DEFAULT_OFFSET, ...offset};\n\n      node.style.top = `${adjustedOffset.y + parentRect.height}px`;\n\n      // Check to make sure that the menu width does not exceed the right side of the stacking context element.\n      // If not open to the right.\n      if (parentRect.x + nodeRect.width < stackingContextRight)\n      {\n         node.style.left = `${adjustedOffset.x}px`;\n         node.style.removeProperty('right');\n      }\n      else // Open left.\n      {\n         node.style.right = `${adjustedOffset.x}px`;\n         node.style.removeProperty('left');\n      }\n\n      return slideFade(node, transitionOptions);\n   }\n\n   /**\n    * Invokes a function on click of a menu item then fires the `close` event and automatically runs the outro\n    * transition and destroys the component.\n    *\n    * @param {TJSMenuItemData} [item] - Menu item data.\n    */\n   function onClick(item)\n   {\n      const callback = item?.onPress;\n\n      if (typeof callback === 'function') { callback(item, focusOptions); }\n\n      if (!closed)\n      {\n         closed = true;\n         menuEl.dispatchEvent(new CustomEvent('close:popup', { bubbles: true, cancelable: true }));\n      }\n   }\n\n   /**\n    * Determines if a pointer event is pressed outside the menu which closes the menu. Use a bubbling custom event\n    * `close:popup` and attach the original target. The TRL application shells will respond to this event to handle\n    * any additional automatic focus management.\n    *\n    * @param {PointerEvent}   event - Pointer event from document body click.\n    */\n   async function onClose(event)\n   {\n      // Early out if the pointer down is inside the menu element.\n      if (event.target === menuEl || menuEl.contains(event.target)) { return; }\n\n      if (event.target === menuEl.parentElement || menuEl.parentElement.contains(event.target)) { return; }\n\n      if (!closed)\n      {\n         closed = true;\n\n         menuEl.dispatchEvent(new CustomEvent('close:popup', {\n            bubbles: true,\n            cancelable: true,\n            detail: { target: event.target }\n         }));\n      }\n   }\n\n   /**\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\n    * for the key code assigned for menu item selection ('Enter').\n    *\n    * @param {KeyboardEvent}  event - KeyboardEvent.\n    */\n   function onKeydownMenu(event)\n   {\n      // Handle menu item keyCode selection.\n      if (event.code === keyCode)\n      {\n         event.stopPropagation();\n         return;\n      }\n\n      switch(event.code)\n      {\n         case 'Tab':\n            event.stopPropagation();\n\n            // Handle reverse focus cycling with `<Shift-Tab>`.\n            if (event.shiftKey)\n            {\n               // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\n               const allFocusable = A11yHelper.getFocusableElements(menuEl, s_IGNORE_CLASSES);\n\n               // Find first and last focusable elements.\n               const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\n               const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\n\n               // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable\n               // element is the active element.\n               if (menuEl === document.activeElement || firstFocusEl === document.activeElement)\n               {\n                  if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\n\n                  event.preventDefault();\n               }\n            }\n\n            break;\n\n         default:\n            // Any other key stop propagation preventing any global key handlers from responding.\n            event.stopPropagation();\n            break;\n      }\n   }\n\n   /**\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\n    * for the key code assigned for menu item selection ('Enter').\n    *\n    * @param {KeyboardEvent}  event - KeyboardEvent.\n    */\n   function onKeyupMenu(event)\n   {\n      switch (event.code)\n      {\n         case 'Escape':\n            if (!closed)\n            {\n               closed = true;\n               menuEl.dispatchEvent(new CustomEvent('close:popup',\n                { bubbles: true, cancelable: true, detail: { keyboardFocus: hasKeyboardFocus } }));\n            }\n\n            event.preventDefault();\n            event.stopPropagation();\n            break;\n      }\n   }\n\n   /**\n    * Handle key presses on menu items.\n    *\n    * @param {KeyboardEvent}     event - KeyboardEvent.\n    *\n    * @param {TJSMenuItemData}   [item] - Menu item data.\n    */\n   function onKeyupItem(event, item)\n   {\n      if (event.code === keyCode)\n      {\n         const callback = item?.onPress;\n\n         if (typeof callback === 'function') { callback(item, focusOptions); }\n\n         if (!closed)\n         {\n            closed = true;\n\n            event.preventDefault();\n            event.stopPropagation();\n\n            menuEl.dispatchEvent(new CustomEvent('close:popup',\n             { bubbles: true, cancelable: true, detail: { keyboardFocus: hasKeyboardFocus } }));\n         }\n      }\n   }\n\n   /**\n    * Closes menu when browser window is blurred.\n    */\n   function onWindowBlur()\n   {\n      if (!closed)\n      {\n         closed = true;\n         menuEl.dispatchEvent(new CustomEvent('close:popup', { bubbles: true, cancelable: true }));\n      }\n   }\n</script>\n\n<!-- bind to `document.body` to receive pointer down & scroll wheel events to close the menu. -->\n<svelte:body on:pointerdown={onClose} on:wheel={onClose}/>\n\n<!-- bind to 'window' to close menu when browser window is blurred. -->\n<svelte:window on:blur={onWindowBlur}/>\n\n<nav class=tjs-menu\n     bind:this={menuEl}\n     on:click|preventDefault|stopPropagation={() => null}\n     on:keydown|stopPropagation={onKeydownMenu}\n     on:keyup|preventDefault|stopPropagation={onKeyupMenu}\n     on:pointerdown|stopPropagation={() => null}\n     on:pointerup|stopPropagation={() => null}\n     transition:animate\n     use:applyStyles={styles}\n     use:efx\n     tabindex=-1\n   >\n\n   <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n   <ol class=tjs-menu-items role=menu>\n      <!-- TJSMenu supports hosting a slot for menu content -->\n      <slot>\n         {#if isSvelteComponent(menu?.slotDefault?.class)}\n            <svelte:component this={menu.slotDefault.class} {...(isObject(menu?.slotDefault?.props) ? menu.slotDefault.props : {})} />\n         {/if}\n      </slot>\n\n      {#if $$slots.before}\n         <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n         <li class=tjs-menu-item\n             on:click={() => onClick()}\n             on:keyup={(event) => onKeyupItem(event)}\n             role=menuitem\n             tabindex=0>\n            <span class=tjs-menu-focus-indicator />\n            <slot name=before />\n         </li>\n      {/if}\n      {#each allItems as item}\n         {#if item['#type'] === 'class'}\n            <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n            <li class=tjs-menu-item\n                on:click={() => onClick(item)}\n                on:keyup={(event) => onKeyupItem(event, item)}\n                role=menuitem\n                tabindex=0>\n               <span class=tjs-menu-focus-indicator />\n               <svelte:component this={item.class} {...(isObject(item.props) ? item.props : {})} />\n            </li>\n         {:else if item['#type'] === 'icon'}\n            <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n            <li class=\"tjs-menu-item tjs-menu-item-button\"\n                 on:click={() => onClick(item)}\n                 on:keyup={(event) => onKeyupItem(event, item)}\n                 role=menuitem\n                 tabindex=0>\n               <span class=tjs-menu-focus-indicator />\n               <i class={item.icon}></i>\n               <span class=tjs-menu-item-label>{localize(item.label)}</span>\n            </li>\n         {:else if item['#type'] === 'image'}\n            <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n            <li class=\"tjs-menu-item tjs-menu-item-button\"\n                 on:click={() => onClick(item)}\n                 on:keyup={(event) => onKeyupItem(event, item)}\n                 role=menuitem\n                 tabindex=0>\n               <span class=tjs-menu-focus-indicator />\n               <img src={item.image} alt={item.imageAlt}>\n               <span class=tjs-menu-item-label>{localize(item.label)}</span>\n            </li>\n         {:else if item['#type'] === 'separator-hr'}\n            <hr>\n         {/if}\n      {/each}\n      {#if $$slots.after}\n         <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n         <li class=tjs-menu-item\n             on:click={() => onClick()}\n             on:keyup={(event) => onKeyupItem(event)}\n             role=menuitem\n             tabindex=0>\n            <span class=tjs-menu-focus-indicator />\n            <slot name=after />\n         </li>\n      {/if}\n   </ol>\n   <TJSFocusWrap elementRoot={menuEl} />\n</nav>\n\n<style>\n   .tjs-menu {\n      position: absolute;\n      width: max-content;\n      height: max-content;\n      overflow: hidden;\n\n      background: var(--tjs-menu-background, var(--tjs-default-menu-background, var(--tjs-default-popup-background, #23221d)));\n      border: var(--tjs-menu-border, var(--tjs-default-popup-border, 1px solid #000));\n      border-radius: var(--tjs-menu-border-radius, var(--tjs-default-popup-border-radius, 5px));\n      box-shadow: var(--tjs-menu-box-shadow, var(--tjs-default-popup-box-shadow, 0 0 2px #000));\n      color: var(--tjs-menu-primary-color, var(--tjs-default-menu-primary-color, var(--tjs-default-popup-primary-color, #b5b3a4)));\n      max-width: var(--tjs-menu-max-width, var(--tjs-default-menu-max-width, 360px));\n      min-width: var(--tjs-menu-min-width, var(--tjs-default-menu-min-width, 20px));\n\n      text-align: start;\n\n      /* Defines z-index in local stacking context */\n      z-index: var(--tjs-menu-z-index, var(--tjs-default-popup-z-index, 100));\n   }\n\n   .tjs-menu:focus-visible {\n      outline: var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent);\n   }\n\n   .tjs-menu-items {\n      margin: 0;\n      padding: 0;\n   }\n\n   .tjs-menu-items hr {\n      margin-block-start: 0;\n      margin-block-end: 0;\n      margin: var(--tjs-menu-hr-margin, var(--tjs-default-hr-margin, 0 0.25em));\n      border-top: var(--tjs-menu-hr-border-top, var(--tjs-default-hr-border-top, 1px solid #555));\n      border-bottom: var(--tjs-menu-hr-border-bottom, var(--tjs-default-hr-border-bottom, 1px solid #444));\n   }\n\n   .tjs-menu-item {\n      display: flex;\n      align-items: center;\n      line-height: var(--tjs-menu-item-line-height, var(--tjs-default-menu-item-line-height, 2em));\n      padding: var(--tjs-menu-item-padding, var(--tjs-default-menu-item-padding, 0 0.5em 0 0));\n   }\n\n   /* Disable default outline for focus visible / within */\n   .tjs-menu-item:focus-within, .tjs-menu-item:focus-visible {\n      outline: none;\n   }\n\n   .tjs-menu-item i {\n      text-align: center;\n      width: var(--tjs-menu-item-icon-width, var(--tjs-default-menu-item-icon-width, 1.25em));\n   }\n\n   .tjs-menu-item img {\n      width: var(--tjs-menu-item-image-width, var(--tjs-default-menu-item-image-width, 1.25em));\n      height: var(--tjs-menu-item-image-height, var(--tjs-default-menu-item-image-height, 1.25em));\n   }\n\n   .tjs-menu-item-button {\n      gap: var(--tjs-menu-item-button-gap, var(--tjs-default-menu-item-button-gap, 0.25em));\n   }\n\n   .tjs-menu-item-button:hover {\n      color: var(--tjs-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\n      text-shadow: var(--tjs-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\n   }\n\n   .tjs-menu-item-button:focus-visible {\n      color: var(--tjs-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\n      text-shadow: var(--tjs-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\n   }\n\n   .tjs-menu-focus-indicator {\n      align-self: var(--tjs-menu-focus-indicator-align-self, var(--tjs-default-focus-indicator-align-self, stretch));\n      border: var(--tjs-menu-focus-indicator-border, var(--tjs-default-focus-indicator-border));\n      border-radius: var(--tjs-menu-focus-indicator-border-radius, var(--tjs-default-focus-indicator-border-radius, 0.1em));\n      height: var(--tjs-menu-focus-indicator-height, var(--tjs-default-focus-indicator-height));\n      width: var(--tjs-menu-focus-indicator-width, var(--tjs-default-focus-indicator-width, 0.25em));\n      transition: var(--tjs-menu-focus-indicator-transition, var(--tjs-default-focus-indicator-transition));\n   }\n\n   /* Enable focus indicator for focus-within */\n   /* Note: the use of `has` pseudo-selector that requires a child with :focus-visible */\n   .tjs-menu-item:focus-within:has(:focus-visible) .tjs-menu-focus-indicator {\n      background: var(--tjs-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\n   }\n\n   /* Fallback for browsers that don't support 'has'; any user interaction including mouse will trigger */\n   @supports not (selector(:has(*))) {\n      .tjs-menu-item:focus-within .tjs-menu-focus-indicator {\n         background: var(--tjs-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\n      }\n   }\n\n   /* Enable focus indicator for focus visible */\n   .tjs-menu-item:focus-visible .tjs-menu-focus-indicator {\n      background: var(--tjs-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\n   }\n\n   .tjs-menu-item-label {\n      overflow: var(--tjs-menu-item-label-overflow, var(--tjs-default-menu-item-label-overflow, hidden));\n      text-overflow: var(--tjs-menu-item-label-text-overflow, var(--tjs-default-menu-item-label-text-overflow, ellipsis));\n      white-space: var(--tjs-menu-item-label-white-space, var(--tjs-default-menu-item-label-white-space));\n   }\n</style>\n","<script>\n   /**\n    * TJSContextMenuImpl provides a context menu implementation component that is not meant to be directly used as it is\n    * controlled as a single browser wide context menu from {@link TJSContextMenu} that is imported via:\n    * `import { TJSContextMenu } from '@typhonjs-fvtt/svelte-standard/application';` The front end for\n    * TJSContextMenuImpl processes data and invokes / manages a single context menu.\n    *\n    * TJSContextMenuImpl supports a flexible data driven way to construct the menu items with the same format as\n    * {@link TJSMenu}. Depending on the item data that is passed into the menu you can define 4 types of items:\n    * 'icon / label', 'image / label', 'class / Svelte component', and 'separator / hr'. The main difference is that\n    * TJSContextMenu does not support default or named slots.\n    *\n    * ----------------------------------------------------------------------------------------------------------------\n    * Exported props include:\n    * `menu` ({@link TJSMenuData}): An object defining all properties of a menu.\n    *\n    * Or in lieu of passing the folder object you can assign these props directly:\n    * `items`: An iterable list of {@link TJSContextMenuItemData}; defines data driven menu items.\n    * `styles`: Styles to be applied inline via `applyStyles` action.\n    * `efx`: Currently unused; for any future action effects.\n    * `keyCode`: The key code to activate menu items.\n    * `focusSource`: A `A11yFocusSource` object containing the target element to return focus to on close.\n    * `transitionOptions`: Custom transition options for duration and easing function.\n    *\n    * ----------------------------------------------------------------------------------------------------------------\n    * Events: There is a single that is fired and _not_ bubbled up through parent elements:\n    * `close`- Fired when the menu closes allowing {@link TJSContextMenu} to clean up resources.\n    *\n    * ----------------------------------------------------------------------------------------------------------------\n    * Styling: To style this component use `.tjs-context-menu` as the base selector.\n    *\n    * There are several local CSS variables that you can use to change the appearance dynamically. Either use\n    * CSS props or pass in a `styles` object w/ key / value props to set to the details. The default fallback variables\n    * target both TJSMenu and TJSContextMenu. The few `popover` defaults target components that independently pop over\n    * other elements browser wide.\n    *\n    * The following CSS variables are supported, but not defined by default.\n    * --tjs-context-menu-background - fallback: --tjs-default-menu-background; fallback: --tjs-default-popup-background; default: #23221d\n    * --tjs-context-menu-border - fallback: --tjs-default-popup-border; default: 1px solid #000\n    * --tjs-context-menu-border-radius - fallback: --tjs-default-popup-border-radius; default: 5px\n    * --tjs-context-menu-box-shadow - fallback: --tjs-default-popup-box-shadow; default: 0 0 2px #000\n    * --tjs-context-menu-primary-color - fallback: --tjs-default-menu-primary-color; fallback: --tjs-default-popup-primary-color; default: #b5b3a4\n    * --tjs-context-menu-max-width - fallback: --tjs-default-menu-max-width; default: 360px\n    * --tjs-context-menu-min-width - fallback: --tjs-default-menu-min-width; default: 20px\n    *\n    * The following CSS variables define attributes for the data driven menu items.\n    *\n    * All menu items:\n    * --tjs-context-menu-item-line-height - fallback: --tjs-default-menu-item-line-height; default: 2em\n    * --tjs-context-menu-item-padding - fallback: --tjs-default-menu-item-padding; default: 0 0.5em 0 0\n    *\n    * Icon / Image menu items (considered a button item):\n    * --tjs-context-menu-item-button-gap - fallback: --tjs-default-menu-item-button-gap; default: 0.25em\n    * --tjs-context-menu-item-highlight-color - fallback: --tjs-default-menu-highlight-color; fallback: --tjs-default-popup-highlight-color; default: #f0f0e0\n    * --tjs-context-menu-item-text-shadow-focus-hover - fallback: --tjs-default-text-shadow-focus-hover; default: 0 0 8px red\n    *\n    * Specific targeting for the label of button items (allows control of wrapping / set `white-space` to `nowrap`):\n    * --tjs-context-menu-item-label-overflow - fallback: --tjs-default-menu-item-label-overflow; default: hidden\n    * --tjs-context-menu-item-label-text-overflow - fallback: --tjs-default-menu-item-label-text-overflow; default: ellipsis\n    * --tjs-context-menu-item-label-white-space - fallback: --tjs-default-menu-item-label-white-space; default: undefined\n    *\n    * Icon menu item:\n    * --tjs-context-menu-item-icon-width - fallback: --tjs-default-menu-item-icon-width; default: 1.25em\n    *\n    * Image menu item:\n    * --tjs-context-menu-item-image-width - fallback: --tjs-default-menu-item-image-width; default: 1.25em\n    * --tjs-context-menu-item-image-height - fallback: --tjs-default-menu-item-image-height; default: 1.25em\n    *\n    * Separator / HR:\n    * --tjs-context-menu-hr-margin - fallback: --tjs-default-hr-margin; default: 0 0.25em\n    * --tjs-context-menu-hr-border-top - fallback: --tjs-default-hr-border-top; default: 1px solid #555\n    * --tjs-context-menu-hr-border-bottom - fallback: --tjs-default-hr-border-bottom; default: 1px solid #444\n    *\n    * The following CSS variables define the keyboard / a11y focus indicator for menu items:\n    * --tjs-context-menu-focus-indicator-align-self - fallback: --tjs-default-focus-indicator-align-self; default: stretch\n    * --tjs-context-menu-focus-indicator-background - fallback: --tjs-default-focus-indicator-background; default: white\n    * --tjs-context-menu-focus-indicator-border - fallback: --tjs-default-focus-indicator-border; default: undefined\n    * --tjs-context-menu-focus-indicator-border-radius - fallback: --tjs-default-focus-indicator-border-radius; default: 0.1em\n    * --tjs-context-menu-focus-indicator-height - fallback: --tjs-default-focus-indicator-height; default: undefined\n    * --tjs-context-menu-focus-indicator-width - fallback: --tjs-default-focus-indicator-width; default: 0.25em\n    * --tjs-menu-focus-indicator-transition - fallback: --tjs-default-focus-indicator-transition\n    */\n\n   import {\n      createEventDispatcher,\n      onMount }                     from 'svelte';\n\n   import { current_component }     from 'svelte/internal';\n\n   import { applyStyles }           from '@typhonjs-fvtt/runtime/svelte/action';\n   import { localize }              from '@typhonjs-fvtt/runtime/svelte/helper';\n   import { slideFade }             from '@typhonjs-fvtt/runtime/svelte/transition';\n\n   import {\n      A11yHelper,\n      isObject,\n      outroAndDestroy }             from '@typhonjs-fvtt/runtime/svelte/util';\n\n   import { TJSFocusWrap }          from '@typhonjs-fvtt/runtime/svelte/component/core';\n\n   export let menu = void 0;\n\n   export let id = '';\n\n   export let x = 0;\n\n   export let y = 0;\n\n   export let items = [];\n\n   export let zIndex = Number.MAX_SAFE_INTEGER - 100;\n\n   /** @type {Record<string, string>} */\n   export let styles = void 0;\n\n   /** @type {string} */\n   export let keyCode = void 0;\n\n   export let focusSource = void 0;\n\n   /** @type {{ duration: number, easing: Function }} */\n   export let transitionOptions = void 0;\n\n   $: styles = isObject(menu) && isObject(menu.styles) ? menu.styles :\n    isObject(styles) ? styles : void 0;\n\n   $: keyCode = isObject(menu) && typeof menu.keyCode === 'string' ? menu.keyCode :\n    typeof keyCode === 'string' ? keyCode : 'Enter';\n\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\n\n   // Store this component reference.\n   const local = current_component;\n\n   // Dispatches `close` event.\n   const dispatch = createEventDispatcher();\n\n   // Bound to the nav element / menu.\n   let menuEl;\n\n   // Stores if this context menu is closed.\n   let closed = false;\n\n   // Stores if menu has keyboard focus; detected on mount, when tab navigation occurs, and used to set `keypress` for\n   // close event.\n   // let hasKeyboardFocus = false;\n\n   // ----------------------------------------------------------------------------------------------------------------\n\n   onMount(() =>\n   {\n      const keyboardFocus = focusSource?.source === 'keyboard';\n\n      // If the focus options designate that the source of the context menu came from the keyboard then focus the first\n      // menu item on mount.\n      if (keyboardFocus)\n      {\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(menuEl);\n         if (firstFocusEl instanceof HTMLElement && !firstFocusEl.classList.contains('tjs-focus-wrap'))\n         {\n            firstFocusEl.focus();\n         }\n         else\n         {\n            // Silently focus the menu element so that keyboard handling functions.\n            menuEl.focus();\n         }\n      }\n      else\n      {\n         // Silently focus the menu element so that keyboard handling functions.\n         menuEl.focus();\n      }\n   });\n\n   // ----------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a custom animate callback allowing inspection of the element to change positioning styles based on the\n    * height / width of the element and `document.body`. This allows the context menu to expand up when the menu\n    * is outside the height bound of `document.body` and expand to the left if width is greater than `document.body`.\n    *\n    * @param {HTMLElement} node - nav element.\n    *\n    * @returns {object} Transition object.\n    */\n   function animate(node)\n   {\n      const expandUp = y + node.clientHeight > document.body.clientHeight\n      const expandLeft = x + node.clientWidth > document.body.clientWidth\n\n      node.style.top = expandUp ? null : `${y}px`;\n      node.style.bottom = expandUp ? `${document.body.clientHeight - y}px` : null;\n\n      node.style.left = expandLeft ? null : `${x}px`;\n      node.style.right = expandLeft ? `${document.body.clientWidth - x}px` : null;\n\n      return slideFade(node, transitionOptions);\n   }\n\n   /**\n    * Invokes a function on click of a menu item then fires the `close` event and automatically runs the outro\n    * transition and destroys the component.\n    *\n    * @param {object} item - Function to invoke on click.\n    */\n   function onClick(item)\n   {\n      const callback = item?.onPress;\n\n      if (typeof callback === 'function')\n      {\n         callback(item, { focusSource });\n      }\n      else\n      {\n         A11yHelper.applyFocusSource(focusSource)\n         focusSource = void 0;\n      }\n\n      if (!closed)\n      {\n         dispatch('close');\n         closed = true;\n         outroAndDestroy(local);\n      }\n   }\n\n   /**\n    * Determines if a pointer pressed to the document body closes the context menu. If the click occurs outside the\n    * context menu then fire the `close` event and run the outro transition then destroy the component.\n    *\n    * @param {PointerEvent|MouseEvent}  event - Pointer or mouse event from document body click / scroll wheel.\n    *\n    * @param {boolean}                  [isWheel=false] - True when scroll wheel; do not perform 2nd early out test.\n    */\n   function onClose(event, isWheel = false)\n   {\n      // Early out if the pointer down is inside the menu element.\n      if (event.target === menuEl || menuEl.contains(event.target)) { return; }\n\n      // Early out if the event page X / Y is the same as this context menu.\n      if (!isWheel && Math.floor(event.pageX) === x && Math.floor(event.pageY) === y) { return; }\n\n      if (!closed)\n      {\n         dispatch('close');\n         closed = true;\n         outroAndDestroy(local);\n      }\n   }\n\n   /**\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\n    * for the key code assigned for menu item selection ('Enter').\n    *\n    * @param {KeyboardEvent}  event - KeyboardEvent.\n    */\n   function onKeydownMenu(event)\n   {\n      // Handle menu item keyCode selection.\n      if (event.code === keyCode)\n      {\n         event.stopPropagation();\n         return;\n      }\n\n      switch (event.code)\n      {\n         case 'Tab':\n            event.stopPropagation();\n\n            // Handle reverse focus cycling with `<Shift-Tab>`.\n            if (event.shiftKey)\n            {\n               // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\n               const allFocusable = A11yHelper.getFocusableElements(menuEl, s_IGNORE_CLASSES);\n\n               // Find first and last focusable elements.\n               const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\n               const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\n\n               // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable\n               // element is the active element.\n               if (menuEl === document.activeElement || firstFocusEl === document.activeElement)\n               {\n                  if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\n\n                  event.preventDefault();\n               }\n            }\n\n            break;\n\n         default:\n            // Any other key stop propagation preventing any global key handlers from responding.\n            event.stopPropagation();\n            break;\n      }\n   }\n\n   /**\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\n    * for the key code assigned for menu item selection ('Enter').\n    *\n    * @param {KeyboardEvent}  event - KeyboardEvent.\n    */\n   function onKeyupMenu(event)\n   {\n      switch (event.code)\n      {\n         case 'ContextMenu':\n         case 'Escape':\n            event.preventDefault();\n            event.stopPropagation();\n\n            if (!closed)\n            {\n               closed = true;\n               dispatch('close');\n               outroAndDestroy(local);\n\n               A11yHelper.applyFocusSource(focusSource)\n               focusSource = void 0;\n            }\n            break;\n      }\n   }\n\n   /**\n    * Handle key presses on menu items.\n    *\n    * @param {KeyboardEvent}     event - KeyboardEvent.\n    *\n    * @param {TJSMenuItemData}   item - Menu item data.\n    */\n   function onKeyupItem(event, item)\n   {\n      if (event.code === keyCode)\n      {\n         if (!closed)\n         {\n            closed = true;\n            dispatch('close');\n            outroAndDestroy(local);\n\n            event.preventDefault();\n            event.stopPropagation();\n         }\n\n         const callback = item?.onPress;\n         if (typeof callback === 'function')\n         {\n            callback(item, { focusSource });\n         }\n         else\n         {\n            A11yHelper.applyFocusSource(focusSource)\n            focusSource = void 0;\n         }\n      }\n   }\n\n   /**\n    * Closes context menu when browser window is blurred.\n    */\n   function onWindowBlur()\n   {\n      if (!closed)\n      {\n         dispatch('close');\n         closed = true;\n         outroAndDestroy(local);\n\n         A11yHelper.applyFocusSource(focusSource)\n         focusSource = void 0;\n      }\n   }\n</script>\n\n<!-- bind to `document.body` to receive pointer down & scroll wheel events to close the context menu. -->\n<svelte:body on:pointerdown={onClose} on:wheel={(event) => onClose(event, true)}/>\n\n<!-- bind to 'window' to close context menu when browser window is blurred. -->\n<svelte:window on:blur={onWindowBlur}/>\n\n<nav id={id}\n     class=tjs-context-menu\n     bind:this={menuEl}\n     on:click|preventDefault|stopPropagation={() => null}\n     on:keydown|stopPropagation={onKeydownMenu}\n     on:keyup|preventDefault|stopPropagation={onKeyupMenu}\n     style:z-index={zIndex}\n     transition:animate\n     use:applyStyles={styles}\n     tabindex=-1>\n\n    <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n    <ol class=tjs-context-menu-items role=menu>\n        {#each items as item}\n            {#if item['#type'] === 'class'}\n                <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n                <li class=tjs-context-menu-item\n                    on:click={() => onClick(item)}\n                    on:keyup={(event) => onKeyupItem(event, item)}\n                    role=menuitem\n                    tabindex=0>\n                    <span class=tjs-context-menu-focus-indicator />\n                    <svelte:component this={item.class} {...(isObject(item.props) ? item.props : {})} />\n                </li>\n            {:else if item['#type'] === 'icon'}\n                <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n                <li class=\"tjs-context-menu-item tjs-context-menu-item-button\"\n                    on:click={() => onClick(item)}\n                    on:keyup={(event) => onKeyupItem(event, item)}\n                    role=menuitem\n                    tabindex=0>\n                    <span class=tjs-context-menu-focus-indicator />\n                    <i class={item.icon}></i>\n                    <span class=tjs-context-menu-item-label>{localize(item.label)}</span>\n                </li>\n            {:else if item['#type'] === 'image'}\n                <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\n                <li class=\"tjs-context-menu-item tjs-context-menu-item-button\"\n                    on:click={() => onClick(item)}\n                    on:keyup={(event) => onKeyupItem(event, item)}\n                    role=menuitem\n                    tabindex=0>\n                    <span class=tjs-context-menu-focus-indicator />\n                    <img src={item.image} alt={item.imageAlt}>\n                    <span class=tjs-context-menu-item-label>{localize(item.label)}</span>\n                </li>\n            {:else if item['#type'] === 'separator-hr'}\n                <hr>\n            {/if}\n        {/each}\n    </ol>\n    <TJSFocusWrap elementRoot={menuEl} />\n</nav>\n\n<style>\n    .tjs-context-menu {\n        position: fixed;\n        width: fit-content;\n        height: max-content;\n        overflow: hidden;\n\n        background: var(--tjs-context-menu-background, var(--tjs-default-menu-background, var(--tjs-default-popup-background, #23221d)));\n        border: var(--tjs-context-menu-border, var(--tjs-default-popover-border, 1px solid #000));\n        border-radius: var(--tjs-context-menu-border-radius, var(--tjs-default-popover-border-radius, 5px));\n        box-shadow: var(--tjs-context-menu-box-shadow, var(--tjs-default-popover-box-shadow, 0 0 10px #000));\n        color: var(--tjs-context-menu-primary-color, var(--tjs-default-menu-primary-color, var(--tjs-default-popup-primary-color, #b5b3a4)));\n        max-width: var(--tjs-context-menu-max-width, var(--tjs-default-menu-max-width, 360px));\n        min-width: var(--tjs-context-menu-min-width, var(--tjs-default-menu-min-width, 20px));\n\n        text-align: start;\n    }\n\n    .tjs-context-menu:focus-visible {\n        outline: var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent);\n    }\n\n    .tjs-context-menu-items {\n        list-style: none;\n        margin: 0;\n        padding: 0;\n    }\n\n    .tjs-context-menu-items hr {\n        margin-block-start: 0;\n        margin-block-end: 0;\n        margin: var(--tjs-context-menu-hr-margin, var(--tjs-default-hr-margin, 0 0.25em));\n        border-top: var(--tjs-context-menu-hr-border-top, var(--tjs-default-hr-border-top, 1px solid #555));\n        border-bottom: var(--tjs-context-menu-hr-border-bottom, var(--tjs-default-hr-border-bottom, 1px solid #444));\n    }\n\n    .tjs-context-menu-item {\n        display: flex;\n        align-items: center;\n        line-height: var(--tjs-context-menu-item-line-height, var(--tjs-default-menu-item-line-height, 2em));\n        padding: var(--tjs-context-menu-item-padding, var(--tjs-default-menu-item-padding, 0 0.5em 0 0));\n    }\n\n    /* Disable default outline for focus visible / within */\n    .tjs-context-menu-item:focus-within, .tjs-context-menu-item:focus-visible {\n        outline: var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent);\n    }\n\n    .tjs-context-menu-item i {\n        text-align: center;\n        width: var(--tjs-context-menu-item-icon-width, var(--tjs-default-menu-item-icon-width, 1.25em));\n    }\n\n    .tjs-context-menu-item img {\n        width: var(--tjs-context-menu-item-image-width, var(--tjs-default-menu-item-image-width, 1.25em));\n        height: var(--tjs-context-menu-item-image-height, var(--tjs-default-menu-item-image-height, 1.25em));\n    }\n\n    .tjs-context-menu-item-button {\n        gap: var(--tjs-context-menu-item-button-gap, var(--tjs-default-menu-item-button-gap, 0.25em));\n    }\n\n    .tjs-context-menu-item-button:hover {\n        color: var(--tjs-context-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\n        text-shadow: var(--tjs-context-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\n    }\n\n    .tjs-context-menu-item-button:focus-visible {\n        color: var(--tjs-context-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\n        text-shadow: var(--tjs-context-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\n    }\n\n    .tjs-context-menu-focus-indicator {\n        align-self: var(--tjs-context-menu-focus-indicator-align-self, var(--tjs-default-focus-indicator-align-self, stretch));\n        border: var(--tjs-context-menu-focus-indicator-border, var(--tjs-default-focus-indicator-border));\n        border-radius: var(--tjs-context-menu-focus-indicator-border-radius, var(--tjs-default-focus-indicator-border-radius, 0.1em));\n        height: var(--tjs-context-menu-focus-indicator-height, var(--tjs-default-focus-indicator-height));\n        width: var(--tjs-context-menu-focus-indicator-width, var(--tjs-default-focus-indicator-width, 0.25em));\n        transition: var(--tjs-context-menu-focus-indicator-transition, var(--tjs-default-focus-indicator-transition));\n    }\n\n    .tjs-context-menu-item:focus-visible .tjs-context-menu-focus-indicator {\n        background: var(--tjs-context-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\n    }\n\n    /* Enable focus indicator for focus-within */\n    /* Note: the use of `has` pseudo-selector that requires a child with :focus-visible */\n    .tjs-context-menu-item:focus-within:has(:focus-visible) .tjs-context-menu-focus-indicator {\n        background: var(--tjs-context-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\n    }\n\n    /* Fallback for browsers that don't support 'has'; any user interaction including mouse will trigger */\n    @supports not (selector(:has(*))) {\n        .tjs-context-menu-item:focus-within .tjs-context-menu-focus-indicator {\n            background: var(--tjs-context-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\n        }\n    }\n\n    .tjs-context-menu-item-label {\n        overflow: var(--tjs-context-menu-item-label-overflow, var(--tjs-default-menu-item-label-overflow, hidden));\n        text-overflow: var(--tjs-context-menu-item-label-text-overflow, var(--tjs-default-menu-item-label-text-overflow, ellipsis));\n        white-space: var(--tjs-context-menu-item-label-white-space, var(--tjs-default-menu-item-label-white-space));\n    }\n</style>\n","import { SvelteApplication }  from '@typhonjs-fvtt/runtime/svelte/application';\n\nimport { FoundryStyles }      from '@typhonjs-fvtt/svelte-standard/fvtt';\n\nimport { cssVariables }       from '../internal/index.js';     // TODO: Figure out better build to use #internal again.\n\nexport * from './button/index.js';\nexport * from './color/index.js';\nexport * from './container/index.js';\nexport * from './editor/index.js';\nexport * from './folder/index.js';\nexport * from './form/index.js';\nexport * from './label/index.js';\nexport * from './layers/index.js';\nexport * from './menu/index.js';\nexport * from './settings/index.js';\n\n// -------------------------------------------------------------------------------------------------------------------\n\n/**\n * Assign all TyphonJS thematic CSS variables.\n */\n\ncssVariables.setProperties({\n   // For components w/ transparent background checkered pattern.\n   '--tjs-checkerboard-background-dark': 'rgb(205, 205, 205)',\n   '--tjs-checkerboard-background-10': `url('data:image/svg+xml;utf8,<svg preserveAspectRatio=\"none\"  viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\"><rect x=\"0\" y=\"0\" width=\"5\" height=\"5\" fill=\"transparent\" /><rect x=\"5\" y=\"5\" width=\"5\" height=\"5\" fill=\"transparent\" /><rect x=\"5\" y=\"0\" width=\"5\" height=\"5\" fill=\"white\" /><rect x=\"0\" y=\"5\" width=\"5\" height=\"5\" fill=\"white\" /></svg>') 0 0 / 10px 10px, var(--tjs-checkerboard-background-dark, rgb(205, 205, 205))`\n}, false);\n\n// -------------------------------------------------------------------------------------------------------------------\n\n/**\n * Assign all TyphonJS CSS variables to Foundry defaults.\n */\n\ncssVariables.setProperties({\n   '--tjs-action-ripple-background': 'rgba(0, 0, 0, 0.35)'\n}, false);\n\n// -------------------------------------------------------------------------------------------------------------------\n\ncssVariables.setProperties({\n   '--tjs-icon-button-background-hover': 'rgba(0, 0, 0, 0.10)',\n   '--tjs-icon-button-background-selected': 'rgba(0, 0, 0, 0.20)',\n}, false);\n\n{\n   /**\n    * All input related components including: TJSSelect,\n    */\n   const props = FoundryStyles.getProperties('input[type=\"text\"], input[type=\"number\"]');\n\n   if (typeof props === 'object')\n   {\n      cssVariables.setProperties({\n         '--tjs-input-background': 'background' in props ? props.background : 'rgba(0, 0, 0, 0.05)',\n         '--tjs-input-border': 'border' in props ? props.border : '1px solid var(--color-border-light-tertiary)',\n         '--tjs-input-border-radius': 'border-radius' in props ? props['border-radius'] : '3px',\n         '--tjs-input-height': 'height' in props ? props.height : 'var(--form-field-height)',\n         '--tjs-input-min-width': 'min-width' in props ? props['min-width'] : '20px',\n         '--tjs-input-padding': 'padding' in props ? props['padding'] : '1px 3px',\n         '--tjs-input-width': 'width' in props ? props.width : 'calc(100% - 2px)',\n\n         // Set default values that are only to be referenced and not set.\n         '--_tjs-default-input-height': 'height' in props ? props.height : 'var(--form-field-height)',\n\n         // Set directly / no lookup:\n         '--tjs-input-border-color': 'var(--color-border-light-tertiary)',\n      }, false);\n   }\n}\n\ncssVariables.setProperties({\n   // `popup` is for components that are slightly elevated, but connected to an application;\n   // see: TJSMenu / TJSContextMenu / TJSColordPicker\n   '--tjs-default-popup-background': 'var(--color-text-dark-header, #23221d)',\n   '--tjs-default-popup-border': '1px solid var(--color-border-dark, #000)',\n   '--tjs-default-popup-box-shadow': '0 0 2px var(--color-shadow-dark, #000)',\n   '--tjs-default-popup-primary-color': 'var(--color-text-light-primary, #b5b3a4)',\n   '--tjs-default-popup-highlight-color': 'var(--color-text-light-highlight, #f0f0e0)',\n\n   // `popover` is for components that are elevated and independent; see: TJSContextMenu\n   '--tjs-default-popover-border': '1px solid var(--color-border-dark, #000)',\n   '--tjs-default-popover-box-shadow': '0 0 10px var(--color-shadow-dark, #000)',\n}, false);\n\n// Handle `PopOut!` module hooks to allow applications to popout to their own browser window -------------------------\n\nHooks.on('PopOut:loading', (app, popout) =>\n{\n   if (app instanceof SvelteApplication)\n   {\n      // Clone and load `svelte-standard` CSS variables into new window document.\n      popout.document.addEventListener('DOMContentLoaded', () => cssVariables.clone(popout.document));\n   }\n});\n","<script>\r\n\r\n  import { writable } from \"svelte/store\";\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { TJSMenu, TJSToggleLabel } from '@typhonjs-fvtt/svelte-standard/component';\r\n\r\n  export let item;\r\n  export let standalone = false;\r\n\r\n  let labelText = \"\";\r\n\r\n  const prices = item.prices;\r\n  const itemFlagData = item.itemFlagData;\r\n  const selectedPriceGroup = item.selectedPriceGroup;\r\n  const priceSelector = standalone ? writable(\"\") : item.store.priceSelector;\r\n\r\n  $: cantAfford = $prices.length > 0 && !$prices[$selectedPriceGroup]?.maxQuantity && item.store.recipient && !standalone;\r\n  $: cantAffordMultiplePrices = cantAfford && !$prices.filter(group => group.maxQuantity).length;\r\n  $: labelText = (standalone && $prices.length > 1 ? \"<i class=\\\"fas fa-edit\\\"></i> \" : \"\")\r\n    + ($prices[$selectedPriceGroup]?.free\r\n        ? localize(\"ITEM-PILES.Merchant.ItemFree\")\r\n        : $prices[$selectedPriceGroup]?.basePriceString\r\n    );\r\n\r\n</script>\r\n\r\n<div class=\"price-container\">\r\n\t{#if $prices.length > 1}\r\n\t\t<TJSToggleLabel>\r\n\t\t\t<div slot=left\r\n\t\t\t\t\t class:multiple-prices={$prices.length > 1 && !standalone}\r\n\t\t\t\t\t class:cant-afford={cantAfford}\r\n\t\t\t\t\t class:cant-afford-multiple-prices={cantAffordMultiplePrices}\r\n\t\t\t\t\t class:item-piles-clickable-link={$prices.length > 1}>\r\n\t\t\t\t<small>{@html labelText}</small>\r\n\t\t\t</div>\r\n\t\t\t<TJSMenu offset={{y: 4}}>\r\n\t\t\t\t<div class=\"price-list\">\r\n\t\t\t\t\t{#each $prices as priceGroup, index (index)}\r\n\t\t\t\t\t\t<div class=\"price-group\" class:selected={$selectedPriceGroup === index}>\r\n\t\t\t\t\t\t\t{#each priceGroup.prices.filter(price => price.cost) as price (price.id)}\r\n\t\t\t\t\t\t\t\t<div class=\"price-group-container\"\r\n\t\t\t\t\t\t\t\t\t\t on:click={() => {\r\n                         $selectedPriceGroup = index;\r\n                         $priceSelector = \"\";\r\n                       }}\r\n\t\t\t\t\t\t\t\t\t\t class:cant-afford={!priceGroup.maxQuantity && item.store.recipient}>\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-img-container\"\r\n\t\t\t\t\t\t\t\t\t\t\t class:not-for-sale={!price.maxQuantity && item.store.recipient}>\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{price.img}\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t\t\t\t\t\t\t\t\t<small>{price.baseCost + (priceGroup.prices.length === 0 && price.percent ? \"%\" : \"\")} {price.name}</small>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t</TJSMenu>\r\n\t\t</TJSToggleLabel>\r\n\t{:else}\r\n\t\t<small class:cant-afford={cantAfford}>{@html labelText}</small>\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .price-container {\r\n    align-items: center;\r\n    position: relative;\r\n    --tjs-label-justify-content: flex-start;\r\n    --tjs-label-overflow: visible;\r\n    --tjs-menu-primary-color: black;\r\n    --tjs-menu-color: black;\r\n    --tjs-menu-border: 1px solid #444;\r\n    --tjs-menu-box-shadow: 0 6px 9px -1px rgba(0, 0, 0, 0.5);\r\n    display: flex;\r\n    justify-content: center;\r\n    height: 100%;\r\n\r\n    small {\r\n      padding-left: 2px;\r\n    }\r\n\r\n    span {\r\n      justify-content: flex-start;\r\n    }\r\n\r\n    .cant-afford {\r\n      opacity: 0.5;\r\n    }\r\n\r\n    .multiple-prices {\r\n      overflow: visible;\r\n    }\r\n\r\n    .multiple-prices::before,\r\n    .multiple-prices::after {\r\n      content: '';\r\n      position: absolute;\r\n      top: -0.2rem;\r\n      left: -0.2rem;\r\n      border-color: transparent;\r\n      border-style: solid;\r\n    }\r\n\r\n    .multiple-prices::after {\r\n      border-width: 0.3rem;\r\n      border-right-color: #3ead2c;\r\n      transform: rotate(45deg);\r\n    }\r\n\r\n    .cant-afford-multiple-prices::after {\r\n      border-right-color: #cf5234;\r\n    }\r\n\r\n  }\r\n</style>\r\n","<script>\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\n  import { getContext } from \"svelte\";\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\n  import { get } from \"svelte/store\";\n  import * as PileUtilities from \"../../../helpers/pile-utilities.js\";\n  import PriceSelector from \"../../components/PriceSelector.svelte\";\n\n  const { application } = getContext('#external');\n\n  export let item;\n  export let seller;\n  export let buyer;\n  export let settings;\n  export let elementRoot;\n  export let store = item.store;\n\n  const itemNameStore = item.name;\n  const itemImg = item.img;\n  const itemInfiniteQuantity = item.infiniteQuantity;\n  const itemRarityColor = item.rarityColor;\n  const itemFlagData = item.itemFlagData;\n  const quantityToBuy = item.quantityToBuy;\n  const itemMaxQuantityStore = item.quantity;\n  const itemQuantityForPriceStore = item.quantityForPrice;\n  const prices = item.prices;\n\n  const sellerPileData = store.pileData;\n  const buyerPileData = store.recipientPileData;\n\n  let maxItemPurchaseQuantity;\n  let currentQuantityToBuy;\n\n  const selectedPriceGroup = item.selectedPriceGroup;\n  $: {\n    $selectedPriceGroup;\n    currentQuantityToBuy = 1;\n    $quantityToBuy = 1;\n  }\n\n  let paymentData = {};\n  $: {\n    paymentData = PileUtilities.getPaymentData({\n      purchaseData: [{\n        item: item.item,\n        quantity: $quantityToBuy,\n        paymentIndex: $selectedPriceGroup\n      }],\n      seller,\n      buyer,\n      sellerFlagData: $sellerPileData,\n      buyerFlagData: $buyerPileData,\n    });\n  }\n\n  $: maxSellerItemQuantity = $itemInfiniteQuantity ? Infinity : Math.floor($itemMaxQuantityStore / $itemQuantityForPriceStore);\n  $: maxItemQuantity = $prices[$selectedPriceGroup]?.maxQuantity ?? Infinity;\n  $: maxItemPurchaseQuantity = Math.min(maxItemQuantity, maxSellerItemQuantity);\n  $: itemName = localize($itemNameStore) + ($itemQuantityForPriceStore > 1 ? ` (${$itemQuantityForPriceStore})` : \"\");\n\n  function submit() {\n    game.itempiles.API.tradeItems(seller, buyer, [{\n      item: item.item,\n      paymentIndex: get(selectedPriceGroup),\n      quantity: get(quantityToBuy),\n    }], {\n      interactionId: store.interactionId\n    });\n    application.options.resolve();\n    application.close();\n  }\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\t<div>\n\n\t\t<div style=\"display: grid; grid-template-columns: 1fr 0.75fr; margin-bottom: 0.5rem;\">\n\t\t\t<div style=\"display:flex; align-items: center; font-size:1rem; grid-row: 1;\">\n\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-right: 0.25rem;\">\n\t\t\t\t\t<img class=\"item-piles-img\" src={$itemImg}/>\n\t\t\t\t</div>\n\t\t\t\t<span style=\"color: {$itemRarityColor || 'inherit'};\">{itemName}</span>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tstyle=\"display:flex; justify-content:flex-end; align-items: center; text-align: right;\">\n\t\t\t\t{#if paymentData.canBuy}\n\t\t\t\t\t<div style=\"display: flex; flex-direction: column; align-items: flex-end; margin-right: 0.5rem;\">\n\t\t\t\t\t\t<small>{localize(\"ITEM-PILES.Applications.TradeMerchantItem.Quantity\")}</small>\n\t\t\t\t\t\t<small style=\"font-style:italic;\">\n\t\t\t\t\t\t\t({localize(\"ITEM-PILES.Applications.TradeMerchantItem.MaxQuantity\", {\n              quantity: maxItemPurchaseQuantity\n            })})\n\t\t\t\t\t\t</small>\n\t\t\t\t\t</div>\n\t\t\t\t\t<input style=\"max-width: 40px; max-height: 24px;\" type=\"number\" bind:value={currentQuantityToBuy} on:change={(evt) => {\n            $quantityToBuy = Math.max(1, Math.min(currentQuantityToBuy, maxItemPurchaseQuantity));\n            currentQuantityToBuy = $quantityToBuy;\n          }}/>\n\t\t\t\t{:else}\n\t\t\t\t\t<small>\n\t\t\t\t\t\t{localize(...paymentData.reason)}\n\t\t\t\t\t</small>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div style=\"margin-top: 0.25rem; display: flex; align-items: flex-start;\">\n\t\t\t\t<PriceSelector {item} standalone/>\n\t\t\t</div>\n\t\t\t<div style=\"margin-right: 0.25rem; text-align: right;\">\n\t\t\t\t{#if paymentData.canBuy && $quantityToBuy > 1 && paymentData.primary}\n\t\t\t\t\t<small>{paymentData.basePriceString}</small>\n\t\t\t\t\t<!-- `ITEM-PILES.Applications.TradeMerchantItem.${settings.selling ? \"They\" : \"You\"}CantAfford` -->\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"item-piles-bottom-divider\" style=\"display: grid; grid-template-columns: auto auto;\">\n\n\t\t\t<strong class=\"item-piles-bottom-divider\" style=\"margin-bottom:0.25rem; padding-bottom:0.25rem;\">\n\t\t\t\t{localize(\"ITEM-PILES.Applications.TradeMerchantItem.\" + (settings.selling ? \"YouReceive\" : \"YouPay\"))}:\n\t\t\t</strong>\n\n\t\t\t<strong class=\"item-piles-bottom-divider item-piles-text-right\"\n\t\t\t\t\t\t\tstyle=\"margin-bottom:0.25rem; padding-bottom:0.25rem;\">\n\t\t\t\t{localize(\"ITEM-PILES.Applications.TradeMerchantItem.\" + (settings.selling ? \"TheyReceive\" : \"YouReceive\"))}:\n\t\t\t</strong>\n\n\t\t\t<div>\n\t\t\t\t{#each paymentData.finalPrices as price}\n\t\t\t\t\t{#if price.quantity}\n\t\t\t\t\t\t<div style=\"display:flex; align-items: center;\">\n\t\t\t\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-right: 0.25rem;\">\n\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={price.img}/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span>{price.quantity} {localize(price.name)}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{/each}\n\t\t\t</div>\n\n\t\t\t<div style=\"display:flex; flex-direction: column; align-items: flex-end;\">\n\t\t\t\t{#each paymentData.buyerReceive as price}\n\t\t\t\t\t<div style=\"display:flex; align-items: center;\">\n\t\t\t\t\t\t<span>{price.quantity > 1 ? price.quantity + \" \" : \"\"}{price.name}</span>\n\t\t\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-left: 0.25rem;\">\n\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={price.img}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t\t{#if paymentData.buyerChange.length}\n          <span class=\"item-piles-small-text item-piles-text-right\" style=\"margin-right: 0.25rem; margin-top: 0.5rem;\">\n            {localize(\"ITEM-PILES.Applications.TradeMerchantItem.Change\")}:\n          </span>\n\t\t\t\t\t{#each paymentData.buyerChange as change}\n\t\t\t\t\t\t{#if change.quantity}\n\t\t\t\t\t\t\t<div style=\"display:flex; align-items: center;\">\n\t\t\t\t\t\t\t\t<span>{change.quantity} {localize(change.name)}</span>\n\t\t\t\t\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-left: 0.25rem;\">\n\t\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={change.img}/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/each}\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\">\n\t\t\t<button disabled={!paymentData.canBuy} on:click|once={ () => { submit() } } type=\"button\">\n\t\t\t\t{#if settings.selling}\n\t\t\t\t\t<i class=\"fas fa-hand-holding-usd\"></i> {localize(\"ITEM-PILES.Applications.TradeMerchantItem.SellItem\")}\n\t\t\t\t{:else}\n\t\t\t\t\t<i class=\"fas fa-shopping-cart\"></i> {localize(\"ITEM-PILES.Applications.TradeMerchantItem.BuyItem\")}\n\t\t\t\t{/if}\n\t\t\t</button>\n\n\t\t\t<button on:click|once={() => { application.close() }} type=\"button\">\n\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t{localize(\"Cancel\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</div>\n\n</ApplicationShell>\n\n<style lang=\"scss\">\n\n  .highlight {\n    box-shadow: inset 0 0 13px 5px rgba(255, 117, 0, 0.73);\n  }\n\n</style>\n","import TradeMerchantItemDialogShell from \"./trade-merchant-item-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { get } from \"svelte/store\";\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class TradeMerchantItemDialog extends SvelteApplication {\r\n  \r\n  /**\r\n   *\r\n   * @param item\r\n   * @param seller\r\n   * @param buyer\r\n   * @param settings\r\n   * @param options\r\n   */\r\n  constructor(item, seller, buyer, settings = {}, options = {}) {\r\n    super({\r\n      id: `item-pile-buy-item-dialog-${item.id}-${seller.id}-${buyer.id}-${randomID()}`,\r\n      title: game.i18n.format(\"ITEM-PILES.Applications.TradeMerchantItem.Title\", { item_name: get(item.name) }),\r\n      svelte: {\r\n        class: TradeMerchantItemDialogShell,\r\n        target: document.body,\r\n        props: {\r\n          item,\r\n          seller,\r\n          buyer,\r\n          settings\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    });\r\n  }\r\n  \r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 330,\r\n      height: \"auto\",\r\n      classes: [\"item-piles-app\"]\r\n    })\r\n  }\r\n  \r\n  static getActiveApps(id) {\r\n    return getActiveApps(`item-pile-buy-item-dialog-${id}`);\r\n  }\r\n  \r\n  static async show(item, seller, buyer, settings = {}, options = {}) {\r\n    const apps = this.getActiveApps(item.id + \"-\" + seller.id + \"-\" + buyer.id);\r\n    if (apps.length) {\r\n      for (let app of apps) {\r\n        app.render(false, { focus: true });\r\n      }\r\n      return;\r\n    }\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(item, seller, buyer, settings, options).render(true, { focus: true });\r\n    })\r\n  }\r\n  \r\n}","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let item;\r\n  export let data;\r\n\r\n  const doc = item.itemDocument;\r\n\r\n  let text;\r\n\r\n  $: value = data.path ? getProperty($doc, data.path) ?? \"\" : \"\";\r\n  $: {\r\n    let localized = localize(`${data.mapping?.[value] ?? value}`);\r\n    text = data.formatting ? data.formatting.replace(\"{#}\", localized) : localized;\r\n  }\r\n\r\n</script>\r\n\r\n<div>\r\n\t<span>{text}</span>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n    padding: 0 10px;\r\n    text-align: center;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex: 1;\r\n    font-size: smaller;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  export let item;\r\n\r\n  const itemNameStore = item.name;\r\n  const itemImage = item.img;\r\n  const itemRarityColor = item.rarityColor;\r\n  const itemQuantityForPrice = item.quantityForPrice;\r\n\r\n  const store = item.store;\r\n  const pileData = store.pileData;\r\n  const displayQuantityStore = item.displayQuantity;\r\n  const infiniteQuantityStore = item.infiniteQuantity;\r\n  const quantityStore = item.quantity;\r\n  const itemFlagDataStore = item.itemFlagData;\r\n\r\n  $: itemFlagData = $itemFlagDataStore;\r\n  $: displayQuantity = $displayQuantityStore;\r\n  $: infiniteQuantity = $infiniteQuantityStore;\r\n\r\n  $: quantity = $quantityStore;\r\n  $: editQuantity = $quantityStore;\r\n  $: itemName = $itemNameStore + ($itemQuantityForPrice > 1 ? ` (${$itemQuantityForPrice})` : \"\");\r\n  let showEditQuantity = false;\r\n\r\n  const displayControlButtons = store.actor.isOwner;\r\n  const displayBuyButton = !!store.recipient;\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-merchant-item-container\"\r\n\t\t class:merchant-item-hidden={itemFlagData.hidden}>\r\n\r\n\t<div\r\n\t\tclass=\"item-piles-img-container\"\r\n\t\tclass:not-for-sale={itemFlagData.notForSale || !quantity}\r\n\t\tdata-tooltip={itemFlagData.notForSale ? \"Not for sale\" : \"\"}\r\n\t>\r\n\t\t<img class=\"item-piles-img\" src={$itemImage}/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t<span style=\"color: {$itemRarityColor || 'inherit'};\">\r\n\t\t\t{#if $pileData.canInspectItems || game.user.isGM}\r\n\t\t\t\t<a class=\"item-piles-clickable\" on:click={() => { item.preview() }}>\r\n\t\t\t\t\t{itemName}\r\n\t\t\t\t</a>\r\n\t\t\t{:else}\r\n\t\t\t\t{itemName}\r\n\t\t\t{/if}\r\n\t\t</span>\r\n\t\t\t{#if showEditQuantity}\r\n\t\t\t\t<div class=\"item-piles-quantity-container\" style=\"flex:0 1 50px;\">\r\n\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tbind:value={editQuantity}\r\n\t\t\t\t\t\t\tautofocus\r\n\t\t\t\t\t\t\ton:change={() => {\r\n              showEditQuantity = false;\r\n              item.updateQuantity(editQuantity);\r\n            }}\r\n\t\t\t\t\t\t\ton:keydown={(evt) => {\r\n              if (evt.key === \"Enter\") showEditQuantity = false;\r\n            }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<slot name=\"right\"/>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-merchant-item-container {\r\n    display: flex;\r\n    border-top-left-radius: 5px;\r\n    border-bottom-left-radius: 5px;\r\n  }\r\n\r\n\t.merchant-item-hidden > * {\r\n\t\tfont-style: italic;\r\n\t\topacity: 0.5;\r\n\t}\r\n\r\n</style>\r\n","<script>\r\n\r\n  export let item;\r\n\r\n  const store = item.store;\r\n  const displayQuantityStore = item.displayQuantity;\r\n  const infiniteQuantityStore = item.infiniteQuantity;\r\n  const quantityStore = item.quantity;\r\n\r\n  let showEditQuantity = false;\r\n  $: editQuantity = $quantityStore;\r\n\r\n</script>\r\n\r\n<div>\r\n\t{#if $displayQuantityStore && item.canStack}\r\n\t\t{#if $infiniteQuantityStore}\r\n\t\t\t<span>∞</span>\r\n\t\t{:else if showEditQuantity}\r\n\t\t\t<input\r\n\t\t\t\tstyle=\"height: 18px; max-width: 35px;\"\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tbind:value={editQuantity}\r\n\t\t\t\tautofocus\r\n\t\t\t\ton:change={() => {\r\n              showEditQuantity = false;\r\n              item.updateQuantity(editQuantity);\r\n            }}\r\n\t\t\t\ton:keydown={(evt) => {\r\n              if (evt.key === \"Enter\") showEditQuantity = false;\r\n            }}\r\n\t\t\t/>\r\n\t\t{:else if !showEditQuantity}\r\n        <span\r\n\t\t\t\t\tclass:item-piles-clickable-link={game.user.isGM}\r\n\t\t\t\t\ton:click={() => {\r\n            if (game.user.isGM) showEditQuantity = true;\r\n          }}>{$quantityStore}</span\r\n\t\t\t\t>\r\n\t\t{/if}\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  div {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 0 10px;\r\n    text-align: center;\r\n    min-height: 28px;\r\n  }\r\n</style>\r\n","import { TJSDocument } from \"@typhonjs-fvtt/runtime/svelte/store\";\nimport { writable, get } from \"svelte/store\";\nimport CONSTANTS from \"../../constants/constants.js\";\nimport * as PileUtilities from \"../../helpers/pile-utilities.js\";\nimport { getItemCost } from \"../../helpers/utilities.js\";\n\nconst existingStores = new Map();\n\nexport default class ItemPriceStore {\n\n  static make(item) {\n    if (existingStores.has(item.id)) {\n      return existingStores.get(item.id);\n    }\n    return new this(item);\n  }\n\n  constructor(item) {\n\n    this.item = item;\n    this.itemDoc = new TJSDocument(this.item);\n\n    const quantityForPriceProp = game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE;\n\n    this.price = writable(0);\n    this.quantityForPrice = writable(getProperty(item, quantityForPriceProp) ?? 1);\n\n    const data = PileUtilities.getItemFlagData(this.item);\n\n    data.prices.forEach(group => {\n      group.forEach(price => {\n        if (!price.id) {\n          price.id = randomID();\n        }\n      });\n    });\n\n    this.data = writable(data);\n\n    this.itemDoc.subscribe((item, changes) => {\n      const { data } = changes;\n      if (hasProperty(data, CONSTANTS.FLAGS.ITEM)) {\n        const newData = getProperty(data, CONSTANTS.FLAGS.ITEM);\n        const oldData = get(this.data);\n        this.data.set(foundry.utils.mergeObject(oldData, newData));\n      }\n      this.price.set(getItemCost(this.item));\n      const quantityForPriceProp = game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE;\n      if (quantityForPriceProp && hasProperty(data, quantityForPriceProp)) {\n        this.quantityForPrice.set(getProperty(item, quantityForPriceProp))\n      }\n    });\n\n  }\n\n  removeGroup(groupIndex) {\n    const data = get(this.data);\n    data.prices.splice(groupIndex, 1);\n    this.data.set(data);\n  }\n\n  export() {\n    const data = {\n      data: {\n        [game.itempiles.API.ITEM_PRICE_ATTRIBUTE]: get(this.price),\n      },\n      flags: get(this.data)\n    };\n    if (game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE) {\n      data[\"data\"][game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE] = get(this.quantityForPrice);\n    }\n    return data;\n  }\n\n}\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import { custom_notify } from \"../../helpers/helpers.js\";\r\n  import { writable } from \"svelte/store\";\r\n\r\n  export let macro;\r\n\r\n  let macros = writable([]);\r\n\r\n  const id = randomID() + \"-list\";\r\n\r\n  function filterMacros() {\r\n\r\n    let allResults = Array.from(game.macros)\r\n      .map(m => ({\r\n        id: m.id,\r\n        name: m.name\r\n      }));\r\n\r\n    const compendiums = Array.from(game.packs)\r\n      .filter(pack => pack.documentName === \"Macro\")\r\n      .map(pack => ({\r\n        id: pack.metadata.id,\r\n        name: \"Compendium.\" + pack.metadata.id\r\n      }))\r\n\r\n    allResults = allResults.concat(compendiums);\r\n\r\n    allResults = allResults.filter(m => {\r\n      return m.name.toLowerCase().includes(macro.toLowerCase()) || !macro\r\n    })\r\n\r\n    if (macro.startsWith(\"Compendium.\") && allResults.length === 1) {\r\n      allResults = Array.from(game.packs.get(allResults[0].id).index).map(m => {\r\n        return {\r\n          id: allResults[0].id + \".\" + m._id,\r\n          name: allResults[0].name + \".\" + m.name\r\n        }\r\n      });\r\n    }\r\n\r\n    macros.set(allResults);\r\n\r\n  }\r\n\r\n  async function openMacro() {\r\n\r\n    // Credit to Otigon, Zhell, Gazkhan and MrVauxs for the code in this section\r\n    if (macro.startsWith(\"Compendium\")) {\r\n      let packArray = macro.split(\".\");\r\n      let pack = game.packs.get(`${packArray[1]}.${packArray[2]}`);\r\n      if (!pack) {\r\n        custom_notify(`Compendium ${packArray[1]}.${packArray[2]} was not found`);\r\n        return;\r\n      }\r\n      let macroFilter = pack.index.filter((m) => m.name === packArray[3]);\r\n      if (!macroFilter.length) {\r\n        custom_notify(`A macro named ${packArray[3]} was not found in Compendium ${packArray[1]}.${packArray[2]}`);\r\n        return;\r\n      }\r\n      let macroDocument = await pack.getDocument(macroFilter[0]._id);\r\n      macroDocument.sheet.render(true);\r\n    } else {\r\n      if (!macro) {\r\n        return;\r\n      }\r\n      let getTest = game.macros.getName(macro);\r\n      if (!getTest) {\r\n        custom_notify(`Could not find the macro named ${macro}`);\r\n        return;\r\n      }\r\n      game.macros.getName(macro).sheet.render(true);\r\n    }\r\n\r\n  }\r\n\r\n  filterMacros();\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow\">\r\n  <input type=\"text\"\r\n         list={id}\r\n         bind:value={macro}\r\n         style=\"flex:1; margin-right:5px;\"\r\n         placeholder={localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.MacroPlaceholder\")}\r\n         on:keyup={() => { filterMacros() }}\r\n         on:change={() => { filterMacros() }}\r\n  />\r\n  <datalist id={id}>\r\n    {#each $macros as m (m.id)}\r\n      <option value={m.name}>{m.text ?? \"\"}</option>\r\n    {/each}\r\n  </datalist>\r\n  <i\r\n    data-tooltip=\"Open Macro\"\r\n    style=\"margin-top: 5px; font-size: 1rem; flex:0;\"\r\n    class=\"fas fa-edit item-piles-clickable-link\"\r\n    on:click={() => openMacro()}\r\n  ></i>\r\n</div>\r\n","<script>\r\n\r\n  import { writable } from \"svelte/store\";\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import { openEditor } from \"../../helpers/helpers.js\";\r\n  import SETTINGS from \"../../constants/settings.js\";\r\n\r\n  export let value;\r\n  export let placeholder = \"\";\r\n\r\n  async function showCustomItemCategoryEditor() {\r\n    openEditor(SETTINGS.CUSTOM_ITEM_CATEGORIES).then((result) => {\r\n      Helpers.setSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES, Array.from(new Set(result)));\r\n      currentCustomCategories.set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES));\r\n    })\r\n  }\r\n\r\n  let currentCustomCategories = writable(Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES))));\r\n\r\n  const id = randomID();\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow\" style=\"align-items: center;\">\r\n\t<input bind:value list={\"item-editor-list-\"+id} placeholder={placeholder} type=\"text\"/>\r\n\t<a on:click={() => showCustomItemCategoryEditor()} style=\"flex: 0; margin: 0 0.5rem;\"><i\r\n\t\tclass=\"fas fa-cog\"></i></a>\r\n\t{#if $currentCustomCategories.length}\r\n\t\t<datalist id={\"item-editor-list-\"+id}>\r\n\t\t\t{#each $currentCustomCategories as category}\r\n\t\t\t\t<option>{category}</option>\r\n\t\t\t{/each}\r\n\t\t</datalist>\r\n\t{/if}\r\n</div>\r\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import { openEditor } from \"../../helpers/helpers.js\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n  import ItemPriceStore from \"./ItemPriceStore.js\";\r\n  import Tabs from \"../components/Tabs.svelte\";\r\n  import PriceList from \"../components/PriceList.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import MacroSelector from \"../components/MacroSelector.svelte\";\r\n  import { get, writable } from \"svelte/store\";\r\n  import SETTINGS from \"../../constants/settings.js\";\r\n  import CustomCategoryInput from \"../components/CustomCategoryInput.svelte\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let item;\r\n  export let elementRoot;\r\n\r\n  let store = ItemPriceStore.make(item);\r\n\r\n  let currentCustomCategories = writable(Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES))));\r\n\r\n  const flagDataStore = store.data;\r\n  let price = store.price;\r\n  let quantityForPrice = store.quantityForPrice;\r\n  let oldPrice = get(price);\r\n\r\n  $: itemFlagData = $flagDataStore;\r\n\r\n  let form;\r\n\r\n  async function updateSettings() {\r\n    const flagData = store.export();\r\n    if (flagData.flags.customCategory) {\r\n      let customCategories = get(currentCustomCategories);\r\n      customCategories.push(flagData.flags.customCategory)\r\n      await Helpers.setSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES, Array.from(new Set(customCategories)));\r\n    }\r\n    await PileUtilities.updateItemData(item, flagData);\r\n    application.options.resolve();\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  function addGroup() {\r\n    itemFlagData.prices = [\r\n      ...itemFlagData.prices,\r\n      []\r\n    ]\r\n  }\r\n\r\n  let activeTab = \"general\";\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} class=\"item-piles-config-container\" on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<Tabs bind:activeTab tabs={[\r\n    { value: \"general\", label: localize(\"ITEM-PILES.Applications.ItemEditor.General\") },\r\n    { value: \"price\", label: localize(\"ITEM-PILES.Applications.ItemEditor.Price\") },\r\n    { value: \"vault\", label: localize(\"ITEM-PILES.Applications.ItemEditor.Vault\") },\r\n  ]}/>\r\n\r\n\t\t<section class=\"tab-body\">\r\n\r\n\t\t\t<div class=\"tab flex\">\r\n\r\n\t\t\t\t{#if activeTab === 'general'}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.CustomCategory\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.CustomCategoryExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div style=\"flex: 4;\">\r\n\t\t\t\t\t\t\t<CustomCategoryInput bind:value={itemFlagData.customCategory} placeholder={item.type}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.Hidden\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.HiddenExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.hidden}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.NotForSale\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.NotForSaleExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.notForSale}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.CantBeSoldToMerchants\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.CantBeSoldToMerchantsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.cantBeSoldToMerchants}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.InfiniteQuantity\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.InfiniteQuantityExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex: 0 1 auto;\" bind:value={itemFlagData.infiniteQuantity}>\r\n\t\t\t\t\t\t\t<option value=\"default\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.InfiniteQuantityDefault\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"yes\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.InfiniteQuantityYes\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"no\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.InfiniteQuantityNo\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.KeepZero\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.KeepZeroExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.keepZeroQuantity}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.KeepOnMerchant\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.KeepOnMerchantExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.keepOnMerchant}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.DisplayQuantity\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.DisplayQuantityExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex: 0 1 auto;\" bind:value={itemFlagData.displayQuantity}>\r\n\t\t\t\t\t\t\t<option value=\"default\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.DisplayQuantityDefault\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"yes\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.DisplayQuantityYes\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"no\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.DisplayQuantityNo\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.Service\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.ServiceExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.isService}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.PurchaseMacro\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PurchaseMacroExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<MacroSelector bind:macro={itemFlagData.macro}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if activeTab === 'price'}\r\n\r\n\t\t\t\t\t{#if game.system.id !== \"pf2e\"}\r\n\t\t\t\t\t\t{#if game.system.id !== \"wfrp4e\"}\r\n\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.BasePrice\")}<br>\r\n\t\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.BasePriceExplanation\")}</p>\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<input type=\"text\" bind:value={$price} on:change={() => {\r\n                const forceNumber = game.system.id === \"dnd5e\";\r\n\t\t\t\t\t\t\t\tconst isPriceNumber = !isNaN(Number($price));\r\n                $price = isPriceNumber || forceNumber\r\n                \t? Math.max(0, isPriceNumber ? Number($price) : oldPrice)\r\n                \t: $price;\r\n                oldPrice = $price;\r\n              }}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.QuantityForPrice\")}<br>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.QuantityForPriceExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"number\" bind:value={$quantityForPrice}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.Free\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.FreeExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.free}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.DisableNormalCost\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.DisableNormalCostExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.disableNormalCost}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PurchaseOptions\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PurchaseOptionsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => { addGroup() }}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.AddPurchaseOption\")}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if itemFlagData.prices.length}\r\n\t\t\t\t\t\t{#each itemFlagData.prices as prices, groupIndex (groupIndex)}\r\n\t\t\t\t\t\t\t<PriceList {item} bind:prices={prices} remove={() => { store.removeGroup(groupIndex) }}/>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t{/if}\r\n\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if activeTab === 'vault'}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.CanStack\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.CanStackExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex: 0 1 auto;\" bind:value={itemFlagData.canStack}>\r\n\t\t\t\t\t\t\t<option value=\"default\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.CanStackDefault\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"yes\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.CanStackYes\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"no\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.CanStackNo\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.VaultExpander\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultExpanderExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.vaultExpander}/>\r\n\t\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:6;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.ExpandColumnsRows\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.ExpandColumnsRowsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t\t\t\t\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Columns\")}</i>\r\n\t\t\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Rows\")}</i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div style=\"align-items: center;\">\r\n\t\t\t\t\t\t\t\t<input style=\"text-align: right;\" type=\"number\" placeholder=\"Enter a number...\"\r\n\t\t\t\t\t\t\t\t\t\t\t bind:value={itemFlagData.addsCols}/>\r\n\t\t\t\t\t\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t\t\t\t\t\t<input type=\"number\" placeholder=\"Enter a number...\" bind:value={itemFlagData.addsRows}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</section>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"ITEM-PILES.Applications.ItemEditor.Update\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .tab {\r\n    max-height: 500px;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n  }\r\n\r\n  table {\r\n\r\n    td {\r\n      vertical-align: middle;\r\n    }\r\n\r\n    tr {\r\n\r\n      &.is-active {\r\n        background-color: #3273dc;\r\n        color: #fff;\r\n      }\r\n\r\n      &.is-dragging {\r\n        background-color: rgba(50, 220, 132, 0.55);\r\n        color: #fff;\r\n      }\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-grid-columns {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    & > div {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n\r\n      & > * {\r\n        flex: 1;\r\n        margin: 0 0.25rem;\r\n      }\r\n\r\n      & > span {\r\n        flex: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import ItemEditorShell from './item-editor-shell.svelte';\r\nimport { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { getActiveApps } from '../../helpers/helpers';\r\n\r\nexport default class ItemEditor extends SvelteApplication {\r\n\r\n  constructor(item = false, options) {\r\n    super({\r\n      id: `item-pile-item-editor-${item.id}-${randomID()}`,\r\n      title: game.i18n.format(\"ITEM-PILES.Applications.ItemEditor.Title\", { item_name: item.name }),\r\n      svelte: {\r\n        class: ItemEditorShell,\r\n        target: document.body,\r\n        props: {\r\n          item\r\n        }\r\n      },\r\n      close: () => this.options.resolve(null),\r\n      ...options\r\n    });\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 500,\r\n      height: \"auto\",\r\n      classes: [\"item-piles-app\"]\r\n    })\r\n  }\r\n\r\n  static getActiveApp(id) {\r\n    return getActiveApps(`item-pile-item-editor-${id}`, true);\r\n  }\r\n\r\n  static async show(item = false, options = {}, dialogData = {}) {\r\n    const app = this.getActiveApp(item.id);\r\n    if (app) return app.render(false, { focus: true });\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(item, options, dialogData).render(true, { focus: true });\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  import ItemEditor from \"../item-editor/item-editor.js\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let item;\r\n\r\n  const itemName = item.name;\r\n  const itemImage = item.img;\r\n  const quantity = item.quantity;\r\n  const store = item.store;\r\n  const isMerchant = store.isMerchant;\r\n\r\n  const itemFlagDataStore = item.itemFlagData;\r\n\r\n  const displayControlButtons = item.store.actor.isOwner;\r\n  const displayBuyButton = !!item.store.recipient;\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow sidebar-buttons\">\r\n\t{#if displayControlButtons && isMerchant}\r\n\t\t{#if game.user.isGM}\r\n        <span class=\"item-piles-clickable-link\" on:click={() => { ItemEditor.show(item.item); }}>\r\n          <i class=\"fas fa-cog\"></i>\r\n        </span>\r\n\t\t{/if}\r\n\t\t<span class=\"item-piles-clickable-link\"\r\n\t\t\t\t\ton:click={() => { $itemFlagDataStore.hidden = !$itemFlagDataStore.hidden; item.updateItemFlagData(); }}>\r\n        <i class=\"fas\" class:fa-eye={!$itemFlagDataStore.hidden} class:fa-eye-slash={$itemFlagDataStore.hidden}></i>\r\n      </span>\r\n\t\t<span class=\"item-piles-clickable-link\"\r\n\t\t\t\t\ton:click={() => { $itemFlagDataStore.notForSale = !$itemFlagDataStore.notForSale; item.updateItemFlagData(); }}>\r\n        <i class=\"fas\" class:fa-store={!$itemFlagDataStore.notForSale}\r\n\t\t\t\t\t class:fa-store-slash={$itemFlagDataStore.notForSale}></i>\r\n      </span>\r\n\t{/if}\r\n\t{#if displayBuyButton}\r\n\t\t{#if isMerchant}\r\n      <span\r\n\t\t\t\tclass:item-piles-clickable-link={!$itemFlagDataStore.notForSale || game.user.isGM}\r\n\t\t\t\tclass:item-piles-clickable-link-disabled={$quantity <= 0 || ($itemFlagDataStore.notForSale && !game.user.isGM)}\r\n\t\t\t\tclass:buy-button={displayControlButtons}\r\n\t\t\t\ton:click={() => {\r\n              if($quantity <= 0 || ($itemFlagDataStore.notForSale && !game.user.isGM)) return;\r\n              store.tradeItem(item)\r\n            }}>\r\n        <i class=\"fas fa-shopping-cart\"></i>\r\n\t\t\t\t{#if !displayControlButtons} {localize(\"ITEM-PILES.Merchant.Buy\")}{/if}\r\n      </span>\r\n\t\t{:else}\r\n      <span\r\n\t\t\t\tstyle=\"margin-left: 0.25rem;\"\r\n\t\t\t\tclass:item-piles-clickable-link={$quantity > 0 && !$itemFlagDataStore.cantBeSoldToMerchants}\r\n\t\t\t\tclass:item-piles-clickable-link-disabled={$quantity <= 0 || $itemFlagDataStore.cantBeSoldToMerchants}\r\n\t\t\t\ton:click={() => {\r\n              if(($quantity <= 0 || $itemFlagDataStore.cantBeSoldToMerchants)) return;\r\n              store.tradeItem(item, true)\r\n            }}>\r\n        <i class=\"fas fa-hand-holding-usd\"></i> {localize(\"ITEM-PILES.Merchant.Sell\")}\r\n      </span>\r\n\t\t{/if}\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n\r\n  .sidebar-buttons {\r\n    flex: 0 1 auto;\r\n    align-items: center;\r\n    justify-content: flex-end;\r\n    text-align: right;\r\n    height: 100%;\r\n    border-top-right-radius: 5px;\r\n    border-bottom-right-radius: 5px;\r\n\r\n    & > span {\r\n      flex: 0 1 auto;\r\n      margin-right: 0.25rem;\r\n      min-width: 17.5px;\r\n    }\r\n\r\n    .buy-button {\r\n      padding-left: 0.25rem;\r\n      border-left: 1px solid rgba(0, 0, 0, 0.5)\r\n    }\r\n  }\r\n\r\n</style>\r\n","import { get, writable } from \"svelte/store\";\nimport { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\nimport { PileItem } from \"./pile-item.js\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\nimport { isResponsibleGM } from \"../helpers/helpers.js\";\nimport TradeMerchantItemDialog from \"../applications/dialogs/trade-merchant-item-dialog/trade-merchant-item-dialog.js\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport ItemPileStore from \"./item-pile-store.js\";\nimport CustomColumn from \"../applications/merchant-app/CustomColumn.svelte\";\nimport ItemEntry from \"../applications/merchant-app/ItemEntry.svelte\";\nimport QuantityColumn from \"../applications/merchant-app/QuantityColumn.svelte\";\nimport PriceSelector from \"../applications/components/PriceSelector.svelte\";\nimport EntryButtons from \"../applications/merchant-app/EntryButtons.svelte\";\n\nexport default class MerchantStore extends ItemPileStore {\n\n  constructor(...args) {\n    super(...args);\n    this.services = writable({});\n    this.editPrices = writable(false);\n    this.typeFilter = writable(\"all\");\n    this.sortType = writable(0);\n    this.priceModifiersPerType = writable({});\n    this.priceModifiersForActor = writable({});\n    this.priceSelector = writable(\"\");\n    this.closed = writable(false);\n    this.itemColumns = writable([]);\n    this.sortTypes = writable([]);\n    this.inverseSort = writable(false);\n    this.isMerchant = false;\n  }\n\n  setupStores() {\n    super.setupStores();\n    this.services.set({});\n    this.editPrices.set(false);\n    this.typeFilter.set(\"all\");\n    this.sortType.set(0);\n    this.priceModifiersPerType.set({});\n    this.priceModifiersForActor.set({});\n    this.priceSelector.set(\"\");\n    this.closed.set(false);\n    this.itemColumns.set([]);\n    this.sortTypes.set([]);\n    this.inverseSort.set(false);\n    this.isMerchant = false;\n  }\n\n  get ItemClass() {\n    return PileMerchantItem;\n  }\n\n  getActorImage() {\n    const pileData = get(this.pileData);\n    return pileData?.merchantImage || this.actor.img;\n  }\n\n  setupSubscriptions() {\n\n    let setup = false;\n    super.setupSubscriptions();\n    this.subscribeTo(this.pileData, (pileData) => {\n\n      this.isMerchant = PileUtilities.isItemPileMerchant(this.actor, pileData);\n\n      const customColumns = foundry.utils.deepClone(pileData.merchantColumns)\n        .map(column => ({\n          label: localize(column.label),\n          component: CustomColumn,\n          data: column,\n          sortMethod: (a, b, inverse) => {\n            const path = column.path;\n            const AProp = getProperty(b.item, path);\n            const BProp = getProperty(a.item, path);\n            if (!column?.mapping?.[AProp] || !column?.mapping?.[BProp]) {\n              return (AProp > BProp ? 1 : -1) * (inverse ? -1 : 1);\n            }\n            const keys = Object.keys(column.mapping);\n            return (keys.indexOf(AProp) - keys.indexOf(BProp)) * (inverse ? -1 : 1);\n          }\n        }));\n\n      const columns = [];\n\n      columns.push({\n        label: \"Type\",\n        component: ItemEntry\n      });\n\n      if (pileData.displayQuantity !== \"alwaysno\") {\n        columns.push({\n          label: \"Quantity\",\n          component: QuantityColumn,\n          sortMethod: (a, b, inverse) => {\n            return (get(b.quantity) - get(a.quantity)) * (inverse ? -1 : 1);\n          }\n        })\n      }\n\n      columns.push(...customColumns)\n      columns.push({\n        label: \"Price\",\n        component: PriceSelector,\n        sortMethod: (a, b, inverse) => {\n          const APrice = get(a.prices).find(price => price.primary);\n          const BPrice = get(b.prices).find(price => price.primary);\n          if (!APrice) return 1;\n          if (!BPrice) return -1;\n          return (BPrice.totalCost - APrice.totalCost) * (inverse ? -1 : 1);\n        }\n      })\n      columns.push({\n        label: false,\n        component: EntryButtons\n      });\n\n      this.itemColumns.set(columns);\n\n      const sortTypes = columns.filter(col => col.label);\n\n      sortTypes.splice(1, 0, { label: \"Name\" });\n\n      this.sortTypes.set(sortTypes)\n\n      if (!setup) return;\n      this.updatePriceModifiers();\n      this.updateOpenCloseStatus();\n\n    });\n    if (this.recipientDocument) {\n      this.subscribeTo(this.recipientPileData, () => {\n        if (!setup) return;\n        this.updatePriceModifiers();\n      });\n      this.subscribeTo(this.recipientDocument, () => {\n        if (!setup) return;\n        this.refreshItemPrices();\n      })\n    }\n    this.subscribeTo(this.typeFilter, (val) => {\n      if (!setup) return;\n      this.refreshItems()\n    });\n    this.subscribeTo(this.sortType, (val) => {\n      if (!setup) return;\n      this.refreshItems();\n    })\n    this.subscribeTo(this.inverseSort, (val) => {\n      if (!setup) return;\n      this.refreshItems();\n    })\n    setup = true;\n    this.updatePriceModifiers();\n    this.updateOpenCloseStatus();\n    this.refreshItems();\n  }\n\n  refreshItemPrices() {\n    const pileData = get(this.pileData);\n    const recipientPileData = get(this.recipientPileData);\n    get(this.allItems).forEach(item => {\n      item.refreshPriceData(pileData, recipientPileData);\n    });\n  }\n\n  visibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData) {\n    const itemIsFree = get(entry.prices)?.free ?? false;\n    return super.visibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData)\n      && (\n        actorIsMerchant\n          ? !(pileData?.hideItemsWithZeroCost && itemIsFree)\n          : !(recipientPileData?.hideItemsWithZeroCost && itemIsFree)\n      );\n  }\n\n  itemSortFunction(a, b) {\n    const sortType = get(this.sortType);\n    const inverse = get(this.inverseSort);\n    if (sortType <= 1) {\n      return super.itemSortFunction(a, b, inverse);\n    }\n    const selectedSortType = get(this.sortTypes)[sortType];\n    return selectedSortType?.sortMethod(a, b, inverse, selectedSortType);\n  }\n\n  createItem(item) {\n    if (PileUtilities.isItemInvalid(this.actor, item)) return;\n    const items = get(this.allItems);\n    const itemClass = new this.ItemClass(this, item);\n    itemClass.refreshPriceData();\n    items.push(itemClass);\n    this.allItems.set(items);\n    this.refreshItems();\n  }\n\n  deleteItem(item) {\n    if (PileUtilities.isItemInvalid(this.actor, item)) return;\n    const items = get(this.allItems);\n    const pileItem = items.find(pileItem => pileItem.id === item.id);\n    if (!pileItem) return;\n    pileItem.unsubscribe();\n    items.splice(items.indexOf(pileItem), 1);\n    this.allItems.set(items);\n    this.refreshItems();\n  }\n\n  updatePriceModifiers() {\n    let pileData = get(this.pileData);\n    let change = false;\n    if (pileData.itemTypePriceModifiers) {\n      change = true;\n      this.priceModifiersPerType.set((pileData.itemTypePriceModifiers ?? {}).reduce((acc, priceData) => {\n        acc[priceData.category.toLowerCase() || priceData.type] = priceData;\n        return acc;\n      }, {}));\n    }\n    if (this.recipient && pileData.actorPriceModifiers) {\n      change = true;\n      const actorSpecificModifiers = pileData.actorPriceModifiers?.find(data => data.actorUuid === this.recipientUuid);\n      if (actorSpecificModifiers) {\n        this.priceModifiersForActor.set(actorSpecificModifiers);\n      }\n    }\n    if (change) {\n      this.refreshItemPrices();\n    }\n  }\n\n  addOverrideTypePrice(type) {\n    const pileData = get(this.pileData);\n    const custom = Object.keys(CONFIG.Item.typeLabels).indexOf(type) === -1;\n    pileData.itemTypePriceModifiers.push({\n      category: custom ? type : \"\",\n      type: custom ? \"custom\" : type,\n      override: false,\n      buyPriceModifier: 1,\n      sellPriceModifier: 1\n    })\n    this.pileData.set(pileData);\n  }\n\n  removeOverrideTypePrice(type) {\n    const pileData = get(this.pileData);\n    const priceMods = pileData.itemTypePriceModifiers;\n    const typeEntry = priceMods.find(entry => entry.type === type);\n    priceMods.splice(priceMods.indexOf(typeEntry), 1);\n    this.pileData.set(pileData);\n  }\n\n  async update() {\n    const pileData = get(this.pileData);\n    const priceModPerType = get(this.priceModifiersPerType);\n    pileData.itemTypePriceModifiers = Object.values(priceModPerType);\n    await PileUtilities.updateItemPileData(this.actor, pileData);\n    Helpers.custom_notify(localize(\"ITEM-PILES.Notifications.UpdateMerchantSuccess\"));\n  }\n\n  tradeItem(pileItem, selling) {\n    if (get(pileItem.itemFlagData).notForSale && !game.user.isGM) return;\n    TradeMerchantItemDialog.show(\n      pileItem,\n      this.actor,\n      this.recipient,\n      { selling }\n    );\n  }\n\n  async updateOpenCloseStatus() {\n    const pileData = get(this.pileData);\n    if (pileData.openTimes.status === \"auto\") {\n      if (game.modules.get('foundryvtt-simple-calendar')?.active && pileData.openTimes.enabled) {\n        const openTimes = pileData.openTimes.open;\n        const closeTimes = pileData.openTimes.close;\n        const timestamp = window.SimpleCalendar.api.timestampToDate(window.SimpleCalendar.api.timestamp());\n\n        const openingTime = Number(openTimes.hour.toString() + \".\" + openTimes.minute.toString());\n        const closingTime = Number(closeTimes.hour.toString() + \".\" + closeTimes.minute.toString());\n        const currentTime = Number(timestamp.hour.toString() + \".\" + timestamp.minute.toString());\n\n        let isClosed = openingTime > closingTime\n          ? !(currentTime >= openingTime || currentTime <= closingTime)  // Is the store open over midnight?\n          : !(currentTime >= openingTime && currentTime <= closingTime); // or is the store open during normal daylight hours?\n\n        const currentWeekday = window.SimpleCalendar.api.getCurrentWeekday();\n\n        isClosed = isClosed || (pileData.closedDays ?? []).includes(currentWeekday.name);\n\n        const currentDate = window.SimpleCalendar.api.currentDateTime();\n        const notes = window.SimpleCalendar.api.getNotesForDay(currentDate.year, currentDate.month, currentDate.day);\n        const categories = new Set(notes.map(note => getProperty(note, \"flags.foundryvtt-simple-calendar.noteData.categories\") ?? []).deepFlatten());\n\n        isClosed = isClosed || categories.intersection(new Set(pileData.closedHolidays ?? [])).size > 0;\n\n        this.closed.set(isClosed);\n\n      } else if (isResponsibleGM()) {\n        pileData.openTimes.status = \"open\";\n        await PileUtilities.updateItemPileData(this.actor, pileData);\n      }\n\n    } else if (!pileData.openTimes.status.startsWith(\"auto\")) {\n\n      this.closed.set(pileData.openTimes.status === \"closed\");\n\n    }\n  }\n\n  async setOpenStatus(status) {\n    const pileData = get(this.pileData);\n    pileData.openTimes.status = status;\n    await PileUtilities.updateItemPileData(this.actor, pileData);\n  }\n\n}\n\nclass PileMerchantItem extends PileItem {\n\n  setupStores(...args) {\n    super.setupStores(...args);\n    this.prices = writable([]);\n    this.displayQuantity = writable(false);\n    this.selectedPriceGroup = writable(-1);\n    this.quantityToBuy = writable(1);\n    this.quantityForPrice = writable(1);\n    this.infiniteQuantity = writable(false);\n    this.isService = false;\n  }\n\n  setupSubscriptions() {\n    let setup = false;\n    super.setupSubscriptions();\n    this.subscribeTo(this.store.pileData, () => {\n      if (!setup) return;\n      this.refreshPriceData();\n      this.refreshDisplayQuantity();\n    });\n    if (this.store.recipient) {\n      this.subscribeTo(this.store.recipientPileData, () => {\n        if (!setup) return\n        this.refreshPriceData();\n        this.refreshDisplayQuantity();\n      });\n    }\n    this.subscribeTo(this.quantityToBuy, () => {\n      if (!setup) return;\n      this.refreshPriceData();\n    });\n    this.subscribeTo(this.itemDocument, () => {\n      if (!setup) return;\n      this.refreshPriceData();\n      this.store.refreshItems();\n    });\n    this.subscribeTo(this.store.typeFilter, () => {\n      if (!setup) return;\n      this.filter()\n    });\n    this.subscribeTo(this.itemFlagData, (flagData) => {\n      this.isService = flagData.isService;\n      if (!setup) return;\n      this.refreshPriceData();\n      this.refreshDisplayQuantity();\n    });\n    this.refreshDisplayQuantity();\n    setup = true;\n  }\n\n  refreshDisplayQuantity() {\n\n    const pileData = get(this.store.pileData);\n    const itemFlagData = get(this.itemFlagData);\n    const isMerchant = PileUtilities.isItemPileMerchant(this.store.actor, pileData)\n\n    const merchantDisplayQuantity = pileData.displayQuantity;\n    const itemFlagDataQuantity = itemFlagData.displayQuantity;\n\n    const itemInfiniteQuantity = {\n      \"default\": pileData.infiniteQuantity,\n      \"yes\": true,\n      \"no\": false\n    }[isMerchant ? (itemFlagData.infiniteQuantity ?? \"default\") : \"no\"];\n\n    this.infiniteQuantity.set(itemInfiniteQuantity)\n\n    if (itemFlagDataQuantity === \"always\") {\n      return this.displayQuantity.set(true);\n    }\n\n    const itemDisplayQuantity = {\n      \"default\": merchantDisplayQuantity === \"yes\",\n      \"yes\": true,\n      \"no\": false\n    }[itemFlagDataQuantity ?? \"default\"];\n\n    if (merchantDisplayQuantity.startsWith(\"always\")) {\n      return this.displayQuantity.set(merchantDisplayQuantity.endsWith(\"yes\"));\n    }\n\n    this.displayQuantity.set(itemDisplayQuantity);\n\n  }\n\n  refreshPriceData(sellerFlagData, buyerFlagData) {\n\n    const quantityToBuy = get(this.quantityToBuy);\n    const itemFlagData = get(this.itemFlagData);\n    sellerFlagData = sellerFlagData ?? get(this.store.pileData);\n    buyerFlagData = buyerFlagData ?? get(this.store.recipientPileData);\n    const priceData = PileUtilities.getPriceData({\n      item: this.item,\n      seller: this.store.actor,\n      buyer: this.store.recipient,\n      sellerFlagData,\n      buyerFlagData,\n      itemFlagData,\n      quantity: quantityToBuy\n    });\n\n    let selectedPriceGroup = get(this.selectedPriceGroup);\n    if (selectedPriceGroup === -1) {\n      selectedPriceGroup = Math.max(0, priceData.findIndex(price => price.maxQuantity));\n      this.selectedPriceGroup.set(selectedPriceGroup)\n    }\n\n    this.prices.set(priceData);\n\n    this.quantityForPrice.set(\n      game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE\n        ? getProperty(this.item, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE) ?? 1\n        : 1\n    );\n\n  }\n\n  filter() {\n    const name = get(this.name).trim();\n    const type = get(this.category).type;\n    const search = get(this.store.search).trim();\n    const typeFilter = get(this.store.typeFilter);\n    const searchFiltered = !name.toLowerCase().includes(search.toLowerCase());\n    const typeFiltered = typeFilter !== \"all\" && typeFilter.toLowerCase() !== type.toLowerCase();\n    this.filtered.set(searchFiltered || typeFiltered);\n  }\n\n  async updateItemFlagData() {\n    const itemFlagData = get(this.itemFlagData);\n    await PileUtilities.updateItemData(this.item, { flags: itemFlagData });\n  }\n\n  updateQuantity(quantity) {\n    const pileFlagData = get(this.store.pileData);\n    const itemFlagData = get(this.itemFlagData);\n    const roll = new Roll(quantity).evaluate({ async: false });\n    this.quantity.set(roll.total);\n    const baseData = {};\n    if (itemFlagData.isService || pileFlagData.keepZeroQuantity || itemFlagData.keepZeroQuantity) {\n      baseData[CONSTANTS.FLAGS.ITEM + \".notForSale\"] = roll.total <= 0;\n    }\n    return this.item.update(Utilities.setItemQuantity(baseData, roll.total));\n  }\n\n}\n","<script>\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { getContext } from \"svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { TJSProseMirror } from '@typhonjs-fvtt/svelte-standard/component';\r\n  import { get, writable } from \"svelte/store\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let text;\r\n  export let elementRoot;\r\n\r\n  const options = application.options;\r\n\r\n  const originalText = text;\r\n\r\n  let form;\r\n\r\n  function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  function submit() {\r\n    application.options.resolve(text);\r\n    application.close();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form class=\"item-piles-flexcol\" bind:this={form} on:submit|once|preventDefault={submit} style=\"padding:0.5rem;\"\r\n\t\t\t\tautocomplete=\"off\">\r\n\r\n\t\t<TJSProseMirror\r\n\t\t\tbind:content={text}\r\n\t\t/>\r\n\r\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem; flex: 0;\">\r\n\t\t\t<button type=\"button\" disabled={originalText === text} on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"fas fa-download\"></i>\r\n\t\t\t\t{localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click={() => { application.close() }}>\r\n\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t{localize(\"Cancel\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n","import { SvelteApplication } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\nimport TextEditorDialogShell from \"./text-editor-dialog-shell.svelte\";\r\n\r\nexport default class TextEditorDialog extends SvelteApplication {\r\n\r\n  constructor(text, options) {\r\n    super({\r\n      title: game.i18n.localize(\"ITEM-PILES.Dialogs.TextEditor.Title\"),\r\n      id: `item-piles-text-editor${options?.id ? \"-\" + options.id : \"\"}-${randomID()}`,\r\n      svelte: {\r\n        class: TextEditorDialogShell,\r\n        target: document.body,\r\n        props: {\r\n          text\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    });\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 550,\r\n      height: 450,\r\n      classes: [\"item-piles-app\"],\r\n      resizable: true\r\n    })\r\n  }\r\n\r\n  static getActiveApps(id) {\r\n    return getActiveApps(`item-pile-text-editor-${id}`);\r\n  }\r\n\r\n  static async show(text, options = {}) {\r\n    const apps = options.id ? this.getActiveApps(options.id) : [];\r\n    if (apps.length) {\r\n      for (let app of apps) {\r\n        app.render(false, { focus: true });\r\n      }\r\n      return;\r\n    }\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(text, options).render(true, { focus: true });\r\n    })\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import Tabs from \"../components/Tabs.svelte\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import SliderInput from \"../components/SliderInput.svelte\";\r\n  import TextEditorDialog from \"../dialogs/text-editor-dialog/text-editor-dialog.js\";\r\n  import { get } from \"svelte/store\";\r\n  import { TJSProseMirror } from \"@typhonjs-fvtt/svelte-standard/component\";\r\n\r\n  export let store;\r\n\r\n  const merchantImg = store.img;\r\n  const pileDataStore = store.pileData;\r\n  const editPrices = store.editPrices;\r\n\r\n  let tabs = [];\r\n  let description;\r\n  let activeSidebarTab = false;\r\n  $: {\r\n    description = $pileDataStore.description;\r\n  }\r\n  $: {\r\n    tabs = [\r\n      {\r\n        value: 'description',\r\n        label: `ITEM-PILES.Merchant.Description`,\r\n        hidden: !game.user.isGM && !description\r\n      },\r\n      {\r\n        value: 'settings',\r\n        label: `ITEM-PILES.Merchant.Settings`,\r\n        hidden: !game.user.isGM\r\n      },\r\n    ];\r\n    activeSidebarTab = activeSidebarTab || tabs.find(tab => !tab.hidden)?.value;\r\n  }\r\n\r\n  function showDescriptionEditor() {\r\n    return TextEditorDialog.show(description, { id: \"item-pile-text-editor-\" + store.actor.id }).then((result) => {\r\n      store.pileData.update((pileData) => {\r\n        pileData.description = result || \"\";\r\n        return pileData;\r\n      });\r\n      store.update();\r\n    });\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"merchant-left-pane item-piles-flexcol\">\r\n\r\n\t<div class=\"item-piles-bottom-divider\">\r\n\t\t<div class=\"merchant-img\">\r\n\t\t\t<img src=\"{ $merchantImg }\">\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if activeSidebarTab}\r\n\r\n\t\t<Tabs style=\"flex: 0 1 auto;\" {tabs} bind:activeTab={activeSidebarTab}/>\r\n\r\n\t\t<section class=\"tab-body item-piles-sections\" style=\"overflow-y:auto;\">\r\n\r\n\t\t\t{#if activeSidebarTab === 'description'}\r\n\t\t\t\t<div class=\"tab merchant-description\" style=\"padding:0;\">\r\n\t\t\t\t\t<TJSProseMirror\r\n\t\t\t\t\t\tcontent={description}\r\n\t\t\t\t\t\toptions={{ editable: false, secrets: game.user.isGM }}\r\n\t\t\t\t\t\tstyle={{\"display\": \"block\"}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{#if game.user.isGM && !description}\r\n\t\t\t\t\t\t<button type=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"flex:1;\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => { showDescriptionEditor() }}\r\n\t\t\t\t\t\t>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescription\")}</button>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#if activeSidebarTab === 'settings'}\r\n\t\t\t\t<div class=\"tab merchant-settings\">\r\n\r\n\t\t\t\t\t<div class=\"setting-container item-piles-config-container\">\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnly\")}</span>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnlyExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={$pileDataStore.purchaseOnly}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItems\")}</span>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItemsExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={$pileDataStore.hideNewItems}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Merchant.EditTypePrices\")}</span>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Merchant.EditTypePricesExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={$editPrices}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group slider-group item-piles-flexcol\">\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<SliderInput bind:value={$pileDataStore.buyPriceModifier}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group slider-group item-piles-flexcol\">\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<SliderInput style=\"flex:4;\" bind:value={$pileDataStore.sellPriceModifier}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<button type=\"button\" class=\"update-button\" on:click={() => { store.update(); }}>\r\n\t\t\t\t\t\t<i class=\"fas fa-download\"></i> Update\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t</section>\r\n\r\n\t{/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-left-pane {\r\n\r\n    flex: 0 1 35%;\r\n    padding-right: 0.25rem;\r\n    margin-right: 0.25rem;\r\n    border-right: 1px solid rgba(0, 0, 0, 0.5);\r\n    max-height: 100%;\r\n    max-width: 300px;\r\n    min-width: 250px;\r\n    overflow-y: hidden;\r\n\r\n    section {\r\n      padding: 0.25rem;\r\n    }\r\n\r\n    .merchant-img {\r\n      position: relative;\r\n      flex: 0 1 auto;\r\n      border-radius: 5px;\r\n\r\n      img {\r\n        width: 100%;\r\n        height: auto;\r\n        border: 0;\r\n        border-radius: 3px;\r\n        z-index: 1;\r\n      }\r\n\r\n    }\r\n\r\n    .merchant-description {\r\n      position: relative;\r\n      padding: 0.25rem;\r\n\r\n      .prosemirror {\r\n        display: block;\r\n      }\r\n    }\r\n\r\n    .merchant-settings {\r\n      position: relative;\r\n      height: calc(100% - 37px);\r\n\r\n\r\n      .setting-container {\r\n        overflow: hidden auto;\r\n        top: 0;\r\n        bottom: 0;\r\n        position: absolute;\r\n        padding: 0 0.25rem;\r\n\r\n        .form-group {\r\n          clear: both;\r\n          display: flex;\r\n          flex-wrap: wrap;\r\n          margin: 3px 0;\r\n\r\n          &.item-piles-flexcol {\r\n            align-items: flex-start;\r\n          }\r\n        }\r\n      }\r\n\r\n      .update-button {\r\n        position: absolute;\r\n        bottom: -37px;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\n  import { fade } from 'svelte/transition';\n\n  export let item;\n  export let index;\n  export let columns;\n\n  const itemName = item.name;\n  const itemImage = item.img;\n\n  const store = item.store;\n  const itemStore = item.itemDocument;\n  const pileData = store.pileData;\n  const displayQuantityStore = item.displayQuantity;\n  const quantityStore = item.quantity;\n  const itemFlagDataStore = item.itemFlagData;\n\n  $: itemFlagData = $itemFlagDataStore;\n  $: displayQuantity = $displayQuantityStore;\n  $: quantity = $quantityStore;\n  $: editQuantity = $quantityStore;\n  let showEditQuantity = false;\n\n  const displayControlButtons = store.actor.isOwner;\n  const displayBuyButton = !!store.recipient;\n\n</script>\n\n<div class=\"item-piles-flexrow item-piles-item-row\"\n\t\t class:item-piles-child-even-color={index%2===0}\n\t\t class:item-piles-child-odd-color={index%2===1}\n\t\t class:merchant-item-hidden={itemFlagData.hidden}\n\t\t style=\"flex: 1 0 auto;\"\n\t\t transition:fade|local={{duration: 250}}>\n\n\t{#each columns as column}\n\t\t{#if column?.data}\n\t\t\t<svelte:component this={column.component} {item} data={column.data}/>\n\t\t{:else}\n\t\t\t<svelte:component this={column.component} {item}/>\n\t\t{/if}\n\t{/each}\n\n</div>\n\n\n<style lang=\"scss\">\n\n\n  .item-piles-item-row:global(.item-piles-child-even-color > *) {\n    background-color: var(--item-piles-even-color);\n  }\n\n  .item-piles-item-row:global(.item-piles-child-odd-color > *) {\n    background-color: var(--item-piles-odd-color);\n  }\n\n  .item-piles-item-row {\n    margin: 0;\n    overflow: visible;\n    display: contents;\n\n    & > * {\n      padding: 0 10px;\n      text-align: center;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex: 1;\n    }\n\n    &.merchant-item-hidden > * {\n      font-style: italic;\n      opacity: 0.5;\n    }\n\n    .item-piles-text {\n      font-size: inherit;\n    }\n\n    .item-piles-img-container {\n      min-width: 20px;\n      max-height: 20px;\n      margin: 2px;\n      flex: 1 0 auto;\n\n      overflow: hidden;\n      border-radius: 4px;\n      border: 1px solid black;\n      align-self: center;\n    }\n\n    .item-piles-name-container {\n      line-height: 1.6;\n    }\n\n  }\n\n</style>\n","<script>\r\n\r\n  import SliderInput from \"../components/SliderInput.svelte\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let store;\r\n  export let category;\r\n\r\n  const pileData = store.pileData;\r\n  const searchStore = store.search;\r\n  const visibleItemsStore = store.visibleItems;\r\n  const itemsPerCategoryStore = store.itemsPerCategory;\r\n  const categoryStore = store.categories;\r\n  const priceModifiersPerType = store.priceModifiersPerType;\r\n  const itemCategoriesStore = store.itemCategories;\r\n  const typeFilterStore = store.typeFilter;\r\n  const editPrices = store.editPrices;\r\n  const columns = store.itemColumns;\r\n\r\n  $: colSpan = $editPrices ? $columns.length + 1 : 1;\r\n  $: type = category.type === \"custom\" ? category.label.toLowerCase() : category.type;\r\n\r\n</script>\r\n\r\n<div class=\"merchant-item-group-type item-piles-flexrow\" style=\"grid-column: 1/{colSpan};\">\r\n\t<h3>{localize(category.label)}</h3>\r\n\t{#if $editPrices}\r\n\t\t<div class=\"price-header\" style=\"font-size: 0.75rem;\">\r\n\t\t\t{#if $priceModifiersPerType[type]}\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.Override\")}:\r\n\t\t\t\t<input type=\"checkbox\" bind:checked={$priceModifiersPerType[type].override}>\r\n\t\t\t\t<SliderInput bind:value={$priceModifiersPerType[type].buyPriceModifier}/>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t\t<div style=\"flex: 0 1 auto\">\r\n\t\t\t{#if $priceModifiersPerType[type]}\r\n\t\t\t\t<i class=\"fas fa-times item-piles-clickable-red\"\r\n\t\t\t\t\t on:click={() => { store.removeOverrideTypePrice(type) }}></i>\r\n\t\t\t{:else}\r\n\t\t\t\t<i class=\"fas fa-plus item-piles-clickable-green\"\r\n\t\t\t\t\t on:click={() => { store.addOverrideTypePrice(type) }}></i>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-item-group-type {\r\n    align-items: center;\r\n    height: 1.5rem;\r\n    margin-top: 10px;\r\n    margin-bottom: 5px;\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n\r\n    h3 {\r\n      margin: 0;\r\n      flex: 1 0 auto;\r\n    }\r\n\r\n    .price-header {\r\n      flex: 0 1 calc(50% - 10px);\r\n      padding-right: 10px;\r\n      justify-content: center;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      input[type=\"checkbox\"] {\r\n        height: 15px;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import MerchantItemEntry from \"./MerchantItemEntry.svelte\";\r\n  import CategoryHeader from \"./CategoryHeader.svelte\";\r\n  import { get } from \"svelte/store\";\r\n\r\n  export let store;\r\n  export let noItemsLabel = \"ITEM-PILES.Merchant.NoItemsForSale\";\r\n  export let services = false;\r\n\r\n  const pileData = store.pileData;\r\n  const searchStore = store.search;\r\n  const visibleItemsStore = store.visibleItems;\r\n  const itemsStore = store.items;\r\n  const itemsPerCategoryStore = store.itemsPerCategory;\r\n  const categoryStore = store.categories;\r\n  const priceModifiersPerType = store.priceModifiersPerType;\r\n  const itemCategoriesStore = store.itemCategories;\r\n  const typeFilterStore = store.typeFilter;\r\n  const sortTypesStore = store.sortTypes;\r\n  const sortTypeStore = store.sortType;\r\n  const inverseSortStore = store.inverseSort;\r\n  const editPrices = store.editPrices;\r\n  const itemColumns = store.itemColumns;\r\n\r\n  $: categoryDropDown = $itemCategoriesStore.filter(category => category.service === services);\r\n  $: categories = $categoryStore.filter(category => category.service === services);\r\n\t$: items = $itemsStore.filter(item => Boolean(get(item.itemFlagData)?.isService) === services)\r\n\t$: visibleItems = $visibleItemsStore.filter(item => Boolean(get(item.itemFlagData)?.isService) === services)\r\n\r\n  let columns = [];\r\n  $: {\r\n    columns = [\r\n      {\r\n        label: \"Name\",\r\n        component: CategoryHeader\r\n      },\r\n      ...$itemColumns.slice(1)\r\n    ]\r\n  }\r\n\r\n</script>\r\n<div class=\"item-piles-flexrow\">\r\n\t<input bind:value={$searchStore} placeholder=\"Type to search...\" type=\"text\">\r\n\t{#if categoryDropDown.length > 1}\r\n\t\t<select style=\"flex:0 1 auto; margin-left: 0.4rem; height: 26px;\" bind:value={$typeFilterStore}>\r\n\t\t\t<option value=\"all\">{localize(\"ITEM-PILES.Merchant.AllTypes\")}</option>\r\n\t\t\t{#each categoryDropDown as category (category.type)}\r\n\t\t\t\t<option value={category.type}>{localize(category.label)}</option>\r\n\t\t\t{/each}\r\n\t\t</select>\r\n\t{/if}\r\n\t<select bind:value={$sortTypeStore} style=\"flex:0 1 auto; margin-left: 0.4rem; height: 26px;\">\r\n\t\t{#each $sortTypesStore as column, index}\r\n\t\t\t<option value={index}>Sort by: {localize(column.label)}</option>\r\n\t\t{/each}\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"item-piles-items-list\" style=\"grid-template-columns: auto repeat({columns.length-1}, max-content);\">\r\n\r\n\t{#if $sortTypeStore === 0 || $editPrices}\r\n\r\n\t\t{#each categories as category, index (category.type)}\r\n\r\n\t\t\t<div class=\"item-piles-item-list-header\">\r\n\t\t\t\t{#each columns as column, columnIndex}\r\n\t\t\t\t\t{#if columnIndex === 0}\r\n\t\t\t\t\t\t<CategoryHeader {store} {category}/>\r\n\t\t\t\t\t{:else if column.label && columnIndex > 0 && index === 0 && !$editPrices}\r\n\t\t\t\t\t\t<div class=\"item-piles-small-text\">\r\n\t\t\t\t\t\t\t<a on:click={() => {\r\n              $inverseSortStore = $sortTypeStore === columnIndex+1 ? !$inverseSortStore : false;\r\n              $sortTypeStore = columnIndex+1;\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t{column.label}\r\n\t\t\t\t\t\t\t\t<i class=\"fas\"\r\n\t\t\t\t\t\t\t\t\t class:fa-chevron-down={!$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t\t\t class:fa-chevron-up={$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else if !$editPrices}\r\n\t\t\t\t\t\t<div></div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t\t{#each $itemsPerCategoryStore[category.type].items as item, itemIndex (item.id)}\r\n\t\t\t\t<MerchantItemEntry {item} index={itemIndex} columns={$itemColumns}/>\r\n\t\t\t{/each}\r\n\r\n\t\t{/each}\r\n\r\n\t{:else}\r\n\r\n\t\t<div class=\"item-piles-item-list-header\">\r\n\t\t\t{#each columns as column, columnIndex}\r\n\t\t\t\t{#if column.label}\r\n\t\t\t\t\t<div class=\"item-piles-small-text\" class:item-piles-merchant-first-label={!columnIndex}>\r\n\t\t\t\t\t\t<a on:click={() => {\r\n              $inverseSortStore = $sortTypeStore === columnIndex + 1 ? !$inverseSortStore : false;\r\n              $sortTypeStore = columnIndex + 1;\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t{column.label}\r\n\t\t\t\t\t\t\t<i class=\"fas\"\r\n\t\t\t\t\t\t\t\t class:fa-chevron-down={!$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t\t class:fa-chevron-up={$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div></div>\r\n\t\t\t\t{/if}\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t\t{#each items as item, itemIndex (item.id)}\r\n\t\t\t<MerchantItemEntry {item} index={itemIndex} columns={$itemColumns}/>\r\n\t\t{/each}\r\n\r\n\t{/if}\r\n\r\n</div>\r\n\r\n{#if !$categoryStore.length}\r\n\r\n\t<div style=\"height: calc(100% - 51px);\" class=\"item-piles-flexcol align-center-col\">\r\n\r\n    <span class=\"align-center-row\" style=\"font-size:1.25rem; opacity: 0.8;\">\r\n      {#if visibleItems.length}\r\n        {localize(\"ITEM-PILES.Merchant.NoMatchFound\")}\r\n      {:else}\r\n        {localize(noItemsLabel)}\r\n      {/if}\r\n    </span>\r\n\r\n\t</div>\r\n\r\n{/if}\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-items-list {\r\n    display: grid;\r\n    overflow-y: scroll;\r\n    padding-right: 5px;\r\n    align-items: center;\r\n    height: calc(100% - 31px);\r\n\t\tmargin-top: 5px;\r\n    align-content: flex-start;\r\n  }\r\n\r\n  .item-piles-item-list-header {\r\n    display: contents;\r\n\r\n    & > * {\r\n      height: 1.5rem;\r\n      margin-top: 10px;\r\n      margin-bottom: 5px;\r\n      border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n      padding: 0 5px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-merchant-first-label {\r\n    justify-content: flex-start;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  export let icon = \"fas fa-exclamation-triangle\";\r\n  export let header = \"Item Piles\";\r\n  export let content;\r\n\r\n</script>\r\n\r\n\r\n<div>\r\n\r\n  {#if icon}\r\n    <p class=\"header-icon\"><i class=\"{icon}\"></i></p>\r\n  {/if}\r\n  {#if header}\r\n    <p class=\"header\"><strong>{header}</strong></p>\r\n  {/if}\r\n  {#if Array.isArray(content)}\r\n    {#each content as part}\r\n      <p>{@html part}</p>\r\n    {/each}\r\n  {:else}\r\n    <p>{@html content}</p>\r\n  {/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n\r\n    margin-bottom: 0.5rem;\r\n    font-size: 0.9rem;\r\n    text-align: center;\r\n\r\n    .header-icon {\r\n      font-size: 3rem;\r\n      margin: 0;\r\n    }\r\n\r\n    .header {\r\n      margin-bottom: 0.5rem;\r\n      font-size: 1.2rem;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import { get, writable } from \"svelte/store\";\r\n  import { onDestroy } from \"svelte\";\r\n  import { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\n  import CustomDialog from \"../components/CustomDialog.svelte\";\r\n  import ItemEntry from \"./ItemEntry.svelte\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n  import { getSetting } from \"../../helpers/helpers\";\r\n  import { slide } from \"svelte/transition\";\r\n  import { quintOut } from \"svelte/easing\";\r\n  import SETTINGS from \"../../constants/settings\";\r\n  import CustomCategoryInput from \"../components/CustomCategoryInput.svelte\";\r\n  import CONSTANTS from \"../../constants/constants.js\";\r\n  import { rollMerchantTables } from \"../../helpers/pile-utilities.js\";\r\n\r\n  export let store;\r\n\r\n  let tables = writable(getTables());\r\n\r\n  let populationTables = writable((get(store.pileData).tablesForPopulate ?? [])\r\n    .map(t => {\r\n      return {\r\n        id: t.id,\r\n        addAll: t.addAll ?? false,\r\n        open: false,\r\n        timesToRoll: t.timesToRoll ?? \"1d4\",\r\n        items: t.items ?? {},\r\n        customCategory: t.customCategory ?? \"\",\r\n      };\r\n    }));\r\n\r\n  let timesRolled = \"\";\r\n  let keepRolled = false;\r\n\r\n  let itemStore = store.items;\r\n\r\n  $: currentItems = $itemStore.sort((a, b) => {\r\n    return a.item.name < b.item.name ? -1 : 1;\r\n  }).filter(item => !item.isService);\r\n\r\n  $: {\r\n    debounceSave($populationTables, $tables)\r\n  }\r\n\r\n  const debounceSave = foundry.utils.debounce((popTables, actualTables) => {\r\n    const pileData = foundry.utils.deepClone(get(store.pileData));\r\n    pileData.tablesForPopulate = popTables\r\n      .filter((t) => actualTables[t.id])\r\n      .map((t) => ({\r\n        id: t.id, addAll: t.addAll, items: t.items, timesToRoll: t.timesToRoll, customCategory: t.customCategory\r\n      }));\r\n    PileUtilities.updateItemPileData(store.actor, pileData);\r\n  }, 200);\r\n\r\n  let selectableTables = [];\r\n  let selectedTable = \"\";\r\n  $: {\r\n    selectableTables = Object.entries($tables).filter(entry => !$populationTables.some(table => table.id === entry[0]));\r\n    const tableSet = new Set(selectableTables.map(e => e[0]));\r\n    selectedTable = tableSet.has(selectedTable) ? selectedTable : tableSet.first();\r\n  }\r\n\r\n  let itemsRolled = writable([]);\r\n\r\n  function getTables() {\r\n    let tables = Array.from(game.tables);\r\n    const folderId = getSetting(SETTINGS.POPULATION_TABLES_FOLDER);\r\n    if (\r\n      folderId !== \"root\" && game.folders.find((f) => f.type === \"RollTable\" && f.id === folderId)\r\n    ) {\r\n      tables = tables.filter((t) => t.folder?.id === folderId);\r\n    }\r\n\r\n    const mappedTables = {};\r\n    for (const table of tables) {\r\n      mappedTables[table.id] = {\r\n        name: table.name,\r\n        items: Array.from(table.collections.results)\r\n      }\r\n    }\r\n    return mappedTables;\r\n  }\r\n\r\n  async function rollAllTables() {\r\n    if (!keepRolled) {\r\n      itemsRolled.set([]);\r\n    }\r\n    for (const table of $populationTables) {\r\n      table.open = false;\r\n      await evaluateTable(table, true);\r\n    }\r\n    timesRolled = $itemsRolled.reduce((total, item) => {\r\n      return total + item.quantity;\r\n    }, 0);\r\n  }\r\n\r\n  async function evaluateTable(table, keepRolledItems) {\r\n\r\n    const rollableTable = game.tables.get(table.id);\r\n    if (!rollableTable) return;\r\n\r\n    if (!keepRolledItems) {\r\n      itemsRolled.set([]);\r\n    }\r\n\r\n    const newItems = await PileUtilities.rollMerchantTables({ tableData: [table] });\r\n\r\n    const processedItems = newItems.map(itemData => {\r\n      const prices = game.itempiles.API.getPricesForItem(itemData.item, {\r\n        seller: store.actor,\r\n      });\r\n      itemData.price = prices[0]?.free ? localize(\"ITEM-PILES.Merchant.ItemFree\") : prices[0]?.priceString;\r\n      return itemData;\r\n    });\r\n\r\n    itemsRolled.update((items) => {\r\n      processedItems.forEach((newItem) => {\r\n        const existingItem = items.find(\r\n          (item) => item.documentId === newItem.documentId\r\n        );\r\n        if (existingItem) {\r\n          existingItem.quantity++;\r\n        } else {\r\n          items.push({\r\n            ...newItem\r\n          });\r\n        }\r\n      });\r\n      items.sort((a, b) => {\r\n        return a.text < b.text ? -1 : 1;\r\n      });\r\n      return items;\r\n    });\r\n\r\n  }\r\n\r\n  async function addItem(itemToAdd) {\r\n    await game.itempiles.API.addItems(store.actor, [itemToAdd].map(entry => ({\r\n      item: entry.item,\r\n      quantity: entry.quantity,\r\n      flags: entry.flags\r\n    })));\r\n    removeItem(itemToAdd);\r\n  }\r\n\r\n  function removeItem(itemToRemove) {\r\n    itemsRolled.update((items) => {\r\n      const existingItemIndex = items.findIndex(\r\n        (item) => item.documentId === itemToRemove.documentId\r\n      );\r\n      items.splice(existingItemIndex, 1);\r\n      return items;\r\n    });\r\n  }\r\n\r\n  async function addAllItems() {\r\n    const itemsToAdd = get(itemsRolled).map(entry => ({\r\n      item: entry.item,\r\n      quantity: entry.quantity,\r\n      flags: entry.flags\r\n    }));\r\n    await game.itempiles.API.addItems(store.actor, itemsToAdd);\r\n    itemsRolled.set([]);\r\n  }\r\n\r\n  async function clearAllItems() {\r\n    const doContinue = await TJSDialog.confirm({\r\n      title: \"Item Piles - \" + localize(\"ITEM-PILES.Dialogs.ClearAllItems.Title\"),\r\n      content: {\r\n        class: CustomDialog,\r\n        props: {\r\n          icon: \"fas fa-exclamation-triangle\",\r\n          content: localize(\"ITEM-PILES.Dialogs.ClearAllItems.Content\"),\r\n        },\r\n      },\r\n      modal: true,\r\n      draggable: false,\r\n      options: {\r\n        height: \"auto\",\r\n        headerButtonNoClose: true,\r\n      },\r\n    });\r\n    if (!doContinue) return false;\r\n    await game.itempiles.API.removeItems(store.actor, game.itempiles.API.getActorItems(store.actor)\r\n      .filter(item => {\r\n        const itemFlags = PileUtilities.getItemFlagData(item);\r\n        return !itemFlags.isService && !itemFlags.keepOnMerchant && !itemFlags.keepIfZero;\r\n      }));\r\n  }\r\n\r\n  async function previewItem(itemData) {\r\n    itemData.item?.sheet?.render(true);\r\n  }\r\n\r\n  async function removeAddedItem(itemToRemove) {\r\n    await game.itempiles.API.removeItems(store.actor, [itemToRemove.item]);\r\n  }\r\n\r\n  function addTable() {\r\n    populationTables.update((tabs) => {\r\n      tabs.push({\r\n        id: selectedTable,\r\n        addAll: false,\r\n        open: false,\r\n        timesToRoll: \"1d4-1\",\r\n        customCategory: \"\",\r\n        items: {}\r\n      });\r\n      return tabs;\r\n    });\r\n  }\r\n\r\n  async function removeTable(tableId) {\r\n\r\n    const table = get(tables)[tableId];\r\n\r\n    const doContinue = await TJSDialog.confirm({\r\n      title: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.RemoveMerchantTable.Title\"),\r\n      content: {\r\n        class: CustomDialog,\r\n        props: {\r\n          header: game.i18n.localize(\"ITEM-PILES.Dialogs.RemoveMerchantTable.Title\"),\r\n          content: game.i18n.format(\"ITEM-PILES.Dialogs.RemoveMerchantTable.Content\", { table_name: table.name }),\r\n          icon: \"fas fa-exclamation-triangle\"\r\n        }\r\n      },\r\n      modal: true,\r\n      draggable: false,\r\n      rejectClose: false,\r\n      defaultYes: true,\r\n      options: {\r\n        height: \"auto\"\r\n      }\r\n    });\r\n\r\n    if (!doContinue) return;\r\n\r\n    populationTables.update((tabs) => {\r\n      return tabs.filter((t) => t.id !== tableId);\r\n    });\r\n  }\r\n\r\n  let createId = Hooks.on(\"createRollTable\", () => {\r\n    tables.set(getTables());\r\n  });\r\n  let deleteId = Hooks.on(\"deleteRollTable\", () => {\r\n    tables.update(() => {\r\n      const newTables = getTables();\r\n      populationTables.update(values => values.filter((t) => newTables[t.id]));\r\n      return newTables;\r\n    });\r\n  });\r\n\r\n  onDestroy(() => {\r\n    Hooks.off(\"createRollTable\", createId);\r\n    Hooks.off(\"deleteRollTable\", deleteId);\r\n  });\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow\" style=\"height:100%;\">\r\n\t<div style=\"margin-right:0.5rem; max-width: 50%; max-height:100%; overflow-y:scroll;\">\r\n\t\t<div class=\"item-piles-populate-header\">\r\n\t\t\t{localize(\r\n        currentItems.length\r\n          ? \"ITEM-PILES.Merchant.CurrentItems\"\r\n          : \"ITEM-PILES.Merchant.BuyNoItems\"\r\n      )}\r\n\t\t</div>\r\n\r\n\t\t{#each currentItems as item (item.id)}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"item-piles-flexrow item-piles-item-row item-piles-even-color\"\r\n\t\t\t>\r\n\t\t\t\t<ItemEntry {item}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tslot=\"right\"\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\tstyle=\"color:red;\"\r\n\t\t\t\t\t\ton:click={() => removeAddedItem(item)}\r\n\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.RemoveItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</ItemEntry>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\r\n\t\t{#if currentItems.length}\r\n\t\t\t<button class=\"item-piles-button\" style=\"margin:5px 0;\" on:click={() => clearAllItems()}>\r\n\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.ClearAllItems\")}\r\n\t\t\t</button>\r\n\t\t{/if}\r\n\t</div>\r\n\r\n\t<div style=\"padding-right:0.25rem; max-width: 50%; max-height:100%; overflow-y:scroll;\">\r\n\r\n\t\t<div class=\"item-piles-populate-header\">\r\n\t\t\t<span style=\"flex:1 0 auto;\">{localize(\"ITEM-PILES.Merchant.RollableTables\")}</span>\r\n\t\t\t<button on:click={() => { rollAllTables() }}\r\n\t\t\t\t\t\t\tstyle=\"height: 20px; line-height: inherit; font-size: 0.75rem; flex:1 0 auto; margin:0;\">\r\n\t\t\t\t<i class=\"fas fa-dice-d20\"></i> {localize(\"ITEM-PILES.Merchant.RollAllTables\")}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t{#each $populationTables as table}\r\n\t\t\t<div class=\"item-piles-item-row item-piles-even-color\"\r\n\t\t\t\t\t style=\"min-height: 28px; padding: 3px 3px 3px 5px;\">\r\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center;\">\r\n\t\t\t\t\t<div style=\"max-width: 100%; overflow: hidden; text-overflow: ellipsis;\">\r\n\t\t\t\t\t\t<strong style=\"max-width:100%; word-break: break-all;\">{$tables[table.id].name}</strong>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button class=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => { removeTable(table.id) }}\r\n\t\t\t\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.ToolTipRemoveTable\")}\r\n\t\t\t\t\t\t\t\t\tdata-tooltip-direction={TooltipManager.TOOLTIP_DIRECTIONS.UP}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\" style=\"color:#de0e0e;\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => { table.open = !table.open; }}\r\n\t\t\t\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.TooltipConfigureTable\")}\r\n\t\t\t\t\t\t\t\t\tdata-tooltip-direction={TooltipManager.TOOLTIP_DIRECTIONS.UP}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-cog\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => { table.open = false; evaluateTable(table, keepRolled); }}\r\n\t\t\t\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.TooltipRollTable\")}\r\n\t\t\t\t\t\t\t\t\tdata-tooltip-direction={TooltipManager.TOOLTIP_DIRECTIONS.UP}\r\n\t\t\t\t\t\t\t\t\tstyle=\"margin-right:0;\">\r\n\t\t\t\t\t\t<i class=\"fas fa-dice-d20\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t{#if table.open}\r\n\t\t\t\t\t<div class=\"item-piles-flexcol\" style=\"margin-top:5px;\"\r\n\t\t\t\t\t\t\t transition:slide={{ duration: 200, easing: quintOut }}>\r\n\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center; margin-bottom: 0.25rem;\">\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\tstyle=\"margin-right:5px;\">{localize(\"ITEM-PILES.Merchant.TableCustomCategory\")}</label>\r\n\t\t\t\t\t\t\t<CustomCategoryInput bind:value={table.customCategory}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center; flex:0 1 auto; min-height:26px;\">\r\n\t\t\t\t\t\t\t\t<label style=\"flex:0 1 auto; margin-right:5px;\"\r\n\t\t\t\t\t\t\t\t\t\t\t for={\"table-id-\"+table.id}>{localize(\"ITEM-PILES.Merchant.TableAddAllItems\")}</label>\r\n\t\t\t\t\t\t\t\t<input style=\"width:15px; height:15px; margin:0; flex:0;\" id={\"table-id-\"+table.id}\r\n\t\t\t\t\t\t\t\t\t\t\t bind:checked={table.addAll}\r\n\t\t\t\t\t\t\t\t\t\t\t on:change={() => {\r\n                           if(!table.addAll) return;\r\n                           table.items = Object.fromEntries($tables[table.id].items.map(item => [item.id, \"1d4\"]));\r\n                         }}\r\n\t\t\t\t\t\t\t\t\t\t\t type=\"checkbox\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{#if !table.addAll}\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow item-piles-item-row\" style=\"align-items: center; flex:1;\">\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"margin-right:5px; text-align: right;\">{localize(\"ITEM-PILES.Merchant.TableTimesToRoll\")}</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" placeholder=\"2d6+4\" bind:value={table.timesToRoll}\r\n\t\t\t\t\t\t\t\t\t\t\t\t style=\"height:20px; margin: 3px; max-width: 50px; font-size: 0.75rem;\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{#if table.addAll}\r\n\t\t\t\t\t\t\t{#each $tables[table.id].items as item (item.id)}\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow item-piles-item-row item-piles-odd-color\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-img-container\">\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={item.img}/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<a class=\"item-piles-clickable\" on:click={() => previewItem(item)}>{item.text}</a>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-quantity-container\" style=\"flex:0 1 75px;\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={(table?.items?.[item.id] ?? \"1d4\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:change={(event) => {\r\n                            table.items[item.id] = event.target.value;\r\n                          }}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\r\n\t\t<div class=\"item-piles-flexrow\" style=\"margin-top: 0.5rem; flex-wrap:nowrap;\">\r\n\r\n\t\t\t<select bind:value={selectedTable} style=\"max-width: calc(100% - 81px);\">\r\n\t\t\t\t{#each selectableTables as [tableId, table] (tableId)}\r\n\t\t\t\t\t<option value={tableId}>{table.name}</option>\r\n\t\t\t\t{/each}\r\n\t\t\t\t{#if foundry.utils.isEmpty($tables)}\r\n\t\t\t\t\t<option value=\"\">\r\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Merchant.NoRollTables\")}\r\n\t\t\t\t\t</option>\r\n\t\t\t\t{/if}\r\n\t\t\t</select>\r\n\r\n\t\t\t<button class=\"item-piles-button\" on:click={() => addTable()} style=\"max-width:80px; min-width:80px;\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.AddTable\")}\r\n\t\t\t</button>\r\n\r\n\t\t</div>\r\n\r\n\t\t<hr style=\"margin:5px 0;\"/>\r\n\r\n\t\t<div class=\"item-piles-flexrow item-piles-roll-header\">\r\n\t\t\t<label>\r\n\t\t\t\t{localize(\r\n          timesRolled && $itemsRolled.length\r\n            ? \"ITEM-PILES.Merchant.RolledTimes\"\r\n            : \"ITEM-PILES.Merchant.ClickRoll\",\r\n          { rolls: timesRolled }\r\n        )}\r\n\t\t\t</label>\r\n\r\n\t\t\t<div class=\"item-piles-flexrow item-piles-keep-rolled\">\r\n\t\t\t\t<label>{localize(\"ITEM-PILES.Merchant.KeepRolled\")}</label>\r\n\t\t\t\t<input bind:checked={keepRolled} type=\"checkbox\"/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if $itemsRolled.length}\r\n\t\t\t{#each $itemsRolled as item (item.documentId)}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"item-piles-flexrow item-piles-item-row item-piles-even-color\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\ton:click={() => addItem(item)}\r\n\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.AddItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-arrow-left\"/>\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-img-container\">\r\n\t\t\t\t\t\t<img class=\"item-piles-img\" src={item.img}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-name\">\r\n\t\t\t\t\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\tclass=\"item-piles-clickable\"\r\n\t\t\t\t\t\t\t\ton:click={(_) => previewItem(item)}>{item.text}</a\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-quantity-container\">\r\n\t\t\t\t\t\t{#if item.price}\r\n\t\t\t\t\t\t\t<small style=\"white-space: nowrap;\">{item.price}</small>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"fas fa-times\"\r\n\t\t\t\t\t\t\t\tstyle=\"color: #555; font-size: 0.75rem; opacity: 0.75;\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tbind:value={item.quantity}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\tstyle=\"color:red;\"\r\n\t\t\t\t\t\ton:click={() => removeItem(item)}\r\n\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.RemoveItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\r\n\t\t\t<div class=\"item-piles-flexrow\" style=\"margin:5px 0;\">\r\n\r\n\t\t\t\t<button class=\"item-piles-button\" on:click={() => addAllItems()}>\r\n\t\t\t\t\t{localize(\"ITEM-PILES.Merchant.AddAll\")}\r\n\t\t\t\t\t<i class=\"fas fa-arrow-left\"/>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button class=\"item-piles-button\"\r\n\t\t\t\t\t\t\t\tstyle=\"color:red; max-width:30px;\"\r\n\t\t\t\t\t\t\t\ton:click={() => { $itemsRolled = []; }}\r\n\t\t\t\t\t\t\t\tdata-tooltip={localize(\"ITEM-PILES.Merchant.ToolTipRemoveAllRolledItems\")}>\r\n\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t</div>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-populate {\r\n\r\n    &-header {\r\n      display: grid;\r\n      grid-template-columns: 1fr auto;\r\n      column-gap: 5px;\r\n      align-items: center;\r\n      min-height: 20px;\r\n      margin: 0.125rem 0 0.5rem 0;\r\n    }\r\n  }\r\n\r\n  .item-piles-roll-header {\r\n    margin-bottom: 0.5rem;\r\n    align-items: center;\r\n  }\r\n\r\n  .item-piles-keep-rolled {\r\n    align-items: center;\r\n    justify-content: flex-end;\r\n    font-size: 0.75rem;\r\n    text-align: right;\r\n    flex: 0 1 auto;\r\n\r\n    input {\r\n      height: 14px;\r\n    }\r\n  }\r\n\r\n  .item-piles-name {\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  .item-piles-quantity-container {\r\n    flex: 0 1 50px;\r\n    gap: 4px;\r\n  }\r\n\r\n  .item-piles-button {\r\n    height: 27px;\r\n    line-height: inherit;\r\n\r\n    /* alignt icons */\r\n    flex-direction: row;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 0.25rem;\r\n  }\r\n\r\n  .item-piles-rolled-item-button {\r\n    min-height: 22px;\r\n    min-width: 22px;\r\n    margin: 2px;\r\n    font-size: 0.65rem;\r\n    padding: 0.25rem;\r\n    flex: 0;\r\n    line-height: inherit;\r\n\r\n    i {\r\n      margin: 0;\r\n    }\r\n  }\r\n\r\n  .fix-height-checkbox {\r\n    height: 20px;\r\n  }\r\n\r\n  .item-piles-header-button {\r\n    min-width: 30px;\r\n    height: 30px;\r\n    text-align: center;\r\n    padding: 0;\r\n    margin: 0;\r\n  }\r\n\r\n  .item-piles-remove-button {\r\n    font-size: 0.75rem;\r\n    width: 30px;\r\n    height: 30px;\r\n    align-items: center;\r\n    display: flex;\r\n    justify-content: center;\r\n\r\n    color: red;\r\n\r\n    &[disabled] {\r\n      color: gray;\r\n    }\r\n  }\r\n\r\n  .item-piles-quantity-input-container {\r\n    min-width: 40px;\r\n  }\r\n</style>\r\n\r\n","<script>\n\n  import * as Helpers from \"../../helpers/helpers.js\"\n\n  export let currency;\n  export let options;\n\n  let name = currency.name;\n  let img = currency.img;\n  let abbreviation = currency.abbreviation;\n  let quantity = currency.quantity;\n\n  let text = \"\";\n  $: {\n    let number = options.abbreviateNumbers ? Helpers.abbreviateNumbers($quantity) : $quantity;\n    if($abbreviation){\n      if(options.abbreviations){\n        text = $abbreviation.replace(\"{#}\", number);\n      }else{\n        text = number;\n      }\n    }else{\n      text = `${$name} (x${$quantity})`;\n    }\n  }\n\n</script>\n\n<div class=\"item-piles-flexrow{options.reverse ? '-reverse' : ''} item-piles-item-row\" style=\"flex:0 1 auto;\" data-tooltip={$name} data-tooltip-activation-speed=\"0\" data-tooltip-deactivation-speed=\"0\">\n\n  <div class=\"item-piles-img-container\" style=\"min-height: {options.imgSize}px; min-width: {options.imgSize}px; max-width: {options.imgSize}px; max-height: {options.imgSize}px;\">\n    <img class=\"item-piles-img\" src=\"{$img}\"/>\n  </div>\n\n  <div class=\"item-piles-name item-piles-text\" style=\"flex:0 1 auto; margin: 0 0.25rem;\">\n    <div class=\"item-piles-name-container\">\n      {text}\n    </div>\n  </div>\n\n</div>\n","<script>\r\n\r\n  import CurrencyListEntry from \"./CurrencyListEntry.svelte\";\r\n\r\n  export let currencies;\r\n  export let options = {};\r\n\r\n  $: primary = $currencies.filter(currency => !currency.isSecondaryCurrency);\r\n  $: secondary = $currencies.filter(currency => currency.isSecondaryCurrency);\r\n\r\n  options = foundry.utils.mergeObject({\r\n    reverse: false,\r\n    abbreviations: false,\r\n    abbreviateNumbers: false,\r\n    imgSize: 24\r\n  }, options)\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow item-piles-currency-list\" style={$$props.style}>\r\n\r\n\t{#each primary as currency (currency.identifier)}\r\n\t\t<CurrencyListEntry {currency} {options}/>\r\n\t{/each}\r\n\r\n\t{#if secondary.length}\r\n\r\n\t\t<div class=\"item-piles-vertical-divider\"></div>\r\n\r\n\t\t{#each secondary as currency (currency.identifier)}\r\n\t\t\t<CurrencyListEntry {currency} {options}/>\r\n\t\t{/each}\r\n\t{/if}\r\n\r\n\t<slot/>\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  .item-piles-vertical-divider {\r\n    min-height: 1rem;\r\n    flex: 0;\r\n    margin: 2px 0.25rem 2px 0;\r\n    min-width: 1px;\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n  }\r\n</style>\r\n","<script>\r\n\r\n  import CurrencyList from \"../components/CurrencyList.svelte\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let store;\r\n  export let recipientStore;\r\n\r\n  const recipientDocument = recipientStore?.document;\r\n  const currencies = recipientStore?.allCurrencies;\r\n  const merchantCurrencies = store?.allCurrencies;\r\n  const merchantPileData = store.pileData;\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow merchant-bottom-row\">\r\n\r\n\t{#if recipientStore}\r\n\t\t<div style=\"flex: 0 1 auto;\">\r\n\t\t\t{localize(\"ITEM-PILES.Merchant.ShoppingAs\", { actorName: $recipientDocument.name })}\r\n\t\t</div>\r\n\t\t<CurrencyList {currencies}\r\n\t\t\t\t\t\t\t\t\toptions={{ abbreviations: false, imgSize: 18, abbreviateNumbers: true }}\r\n\t\t\t\t\t\t\t\t\tclass=\"item-piles-currency-list\"/>\r\n\t{:else if game.user.isGM && $merchantPileData.infiniteCurrencies}\r\n\t\t<div style=\"flex: 0 1 auto;\">\r\n\t\t\t<a class=\"item-piles-clickable item-piles-text-right item-piles-small-text item-piles-middle\"\r\n\t\t\t\t on:click={() => store.addCurrency()}>\r\n\t\t\t\t<i class=\"fas fa-plus\"></i> {localize(\"ITEM-PILES.Inspect.AddCurrency\")}\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t\t<CurrencyList currencies={merchantCurrencies}\r\n\t\t\t\t\t\t\t\t\toptions={{ abbreviations: false, imgSize: 18, abbreviateNumbers: true }}\r\n\t\t\t\t\t\t\t\t\tclass=\"item-piles-currency-list\"/>\r\n\t{/if}\r\n\r\n</div>\r\n\r\n<style>\r\n    .merchant-bottom-row {\r\n        flex: 0 1 auto;\r\n        align-items: center;\r\n        height: 31px;\r\n    }\r\n</style>\r\n","<script>\r\n\r\n  import MerchantItemTab from \"./MerchantItemTab.svelte\";\r\n  import MerchantPopulateItemsTab from \"./MerchantPopulateItemsTab.svelte\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import MerchantFooter from \"./MerchantFooter.svelte\";\r\n  import { writable } from \"svelte/store\";\r\n\r\n  export let store;\r\n  export let recipientStore;\r\n  export let activeTab;\r\n\r\n  let categories = store.categories;\r\n\r\n  let closed = store.closed;\r\n\r\n  const currencies = recipientStore?.allCurrencies || writable([]);\r\n\r\n</script>\r\n\r\n<div class=\"merchant-right-pane item-piles-flexcol\">\r\n\r\n  <div class=\"merchant-tabbed-center\"\r\n       style=\"flex: 1; max-height: calc(100% - {recipientStore && $currencies.length ? '34px' : '0px'})\">\r\n\r\n    {#if $closed && !game.user.isGM}\r\n      <div style=\"display: grid; place-items: center; height:100%;\">\r\n        <span>{localize(\"ITEM-PILES.Merchant.MerchantClosed\")}</span>\r\n      </div>\r\n    {:else if $activeTab === \"buy\"}\r\n      <MerchantItemTab {store}/>\r\n    {:else if $activeTab === \"services\" }\r\n      <MerchantItemTab {store} services={true}/>\r\n    {:else if $activeTab === \"sell\"}\r\n      <MerchantItemTab store={recipientStore} noItemsLabel=\"ITEM-PILES.Merchant.NoItemsToSell\"/>\r\n    {:else if $activeTab === \"tables\"}\r\n      <MerchantPopulateItemsTab {store}/>\r\n    {/if}\r\n\r\n  </div>\r\n\r\n\t<MerchantFooter {store} {recipientStore}/>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-right-pane {\r\n    flex: 1;\r\n    max-height: 100%;\r\n    overflow: hidden;\r\n    padding-left: 0.25rem;\r\n  }\r\n\r\n  .merchant-tabbed-center {\r\n    overflow: hidden;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let store;\r\n\r\n  const pileDataStore = store.pileData;\r\n  const merchantName = store.name;\r\n  const closed = store.closed;\r\n\r\n  let openTimeText = \"\";\r\n\r\n  const aboutTimeEnabled = game.modules.get('foundryvtt-simple-calendar')?.active || false;\r\n\r\n  $: open = $pileDataStore.openTimes.enabled ? $pileDataStore.openTimes?.open : false;\r\n  $: close = $pileDataStore.openTimes.enabled ? $pileDataStore.openTimes?.close : false;\r\n\r\n  $: {\r\n    if ($pileDataStore.openTimes.enabled) {\r\n      let openText = `${open.hour.toString().padStart(2, \"0\")}:${open.minute.toString().padStart(2, \"0\")}`;\r\n      let closeText = `${close.hour.toString().padStart(2, \"0\")}:${close.minute.toString().padStart(2, \"0\")}`;\r\n      openTimeText = `${openText} - ${closeText}`;\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow merchant-top-bar item-piles-bottom-divider\">\r\n\t<div class=\"merchant-name\">{$merchantName}</div>\r\n\t<div class=\"opening-hours item-piles-flexcol\">\r\n\t\t{#if $pileDataStore.openTimes.enabled}\r\n      <span>\r\n        {localize(\"ITEM-PILES.Merchant.OpenTimes\")}\r\n      </span>\r\n\t\t\t<span style=\"font-style: italic;\">\r\n        {#if game.user.isGM}\r\n          {#if aboutTimeEnabled && $pileDataStore.openTimes.status !== \"auto\"}\r\n          <a class=\"item-piles-right-divider\" on:click={() => { store.setOpenStatus(\"auto\"); }}>\r\n            <i class=\"fas fa-clock\"></i>\r\n\t\t\t\t\t\t{localize(`ITEM-PILES.Merchant.OpenCloseAuto`)}\r\n          </a>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t\t<a class=\"item-piles-right-divider\" on:click={() => { store.setOpenStatus($closed ? \"open\" : \"closed\"); }}>\r\n            <i class=\"fas\" class:fa-door-open={!$closed} class:fa-door-closed={$closed}></i>\r\n\t\t\t\t\t\t{localize(`ITEM-PILES.Merchant.${!$closed ? \"Open\" : \"Closed\"}`)}\r\n          </a>\r\n        {/if}\r\n\t\t\t\t{openTimeText}\r\n      </span>\r\n\t\t{:else if game.user.isGM}\r\n\t\t\t<a style=\"flex:0;\" on:click={() => { store.setOpenStatus($closed ? \"open\" : \"closed\"); }}>\r\n\t\t\t\t<i class=\"fas\" class:fa-door-open={!$closed} class:fa-door-closed={$closed}></i>\r\n\t\t\t\t{localize(`ITEM-PILES.Merchant.${!$closed ? \"Open\" : \"Closed\"}`)}\r\n\t\t\t</a>\r\n\t\t{/if}\r\n\t</div>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-top-bar {\r\n\r\n    flex: 0 1 auto;\r\n\r\n    .opening-hours {\r\n      text-align: right;\r\n      flex: 0 1 auto;\r\n      justify-content: center;\r\n\r\n      .item-piles-right-divider {\r\n        margin-right: 0.25rem;\r\n        padding-right: 0.5rem;\r\n        border-right: 1px solid rgba(0, 0, 0, 0.5);\r\n      }\r\n    }\r\n\r\n    .merchant-name {\r\n      font-size: 2em;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { getContext, onDestroy } from 'svelte';\r\n  import { ApplicationShell } from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n  import MerchantStore from \"../../stores/merchant-store.js\";\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n  import DropZone from \"../components/DropZone.svelte\";\r\n  import MerchantLeftPane from \"./MerchantLeftPane.svelte\";\r\n  import MerchantRightPane from \"./MerchantRightPane.svelte\";\r\n  import MerchantTopBar from \"./MerchantTopBar.svelte\";\r\n  import Tabs from \"../components/Tabs.svelte\";\r\n  import { get, writable } from \"svelte/store\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n\r\n  export let merchant;\r\n  export let recipient;\r\n\r\n  export let store = MerchantStore.make(application, merchant, recipient);\r\n  export let recipientStore = recipient ? MerchantStore.make(application, recipient, merchant, { recipientPileData: store.pileData }) : false;\r\n\r\n  let pileData = store.pileData;\r\n\r\n  onDestroy(() => {\r\n    store.onDestroy();\r\n    if (recipientStore) recipientStore.onDestroy();\r\n  });\r\n\r\n  let priceSelector = store.priceSelector;\r\n  let categories = store.categories;\r\n  let visibleItems = store.visibleItems;\r\n\r\n  async function dropData(data) {\r\n\r\n    if (!game.user.isGM) return;\r\n\r\n    if (!data.type) {\r\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n    }\r\n\r\n    if (data.type === \"Actor\") {\r\n      const newRecipient = data.uuid ? (await fromUuid(data.uuid)) : game.actors.get(data.id);\r\n      store.updateRecipient(newRecipient);\r\n      if (recipientStore) {\r\n        return recipientStore.updateSource(newRecipient);\r\n      }\r\n      recipientStore = MerchantStore.make(application, newRecipient, merchant, { recipientPileData: store.pileData });\r\n      return;\r\n    }\r\n\r\n    if (data.type !== \"Item\") {\r\n      throw Helpers.custom_error(\"You must drop an item, not \" + data.type.toLowerCase() + \"!\")\r\n    }\r\n\r\n    const item = await Item.implementation.fromDropData(data);\r\n    const validItem = await PileUtilities.checkItemType(merchant, item, {\r\n      errorText: \"ITEM-PILES.Errors.DisallowedItemTrade\",\r\n      warningTitle: \"ITEM-PILES.Dialogs.TypeWarning.Title\",\r\n      warningContent: \"ITEM-PILES.Dialogs.TypeWarning.TradeContent\"\r\n    });\r\n    if (!validItem) return;\r\n\r\n    return game.itempiles.API.addItems(merchant, [{\r\n      item: validItem,\r\n      quantity: 1\r\n    }]);\r\n\r\n  }\r\n\r\n  const activeTab = writable(\"buy\");\r\n\r\n  let tabs;\r\n  $: {\r\n    const hasItems = $visibleItems.some(item => !get(item.category).service)\r\n    const hasServices = $visibleItems.some(item => get(item.category).service)\r\n    const canSell = !$pileData.purchaseOnly && recipientStore;\r\n    const showBuy = hasItems || (!hasItems && !hasServices && !canSell)\r\n    tabs = [\r\n      {\r\n        value: 'buy',\r\n        label: game.i18n.localize('ITEM-PILES.Merchant.BuyItems'),\r\n        hidden: !showBuy\r\n      },\r\n      {\r\n        value: 'services',\r\n        label: game.i18n.localize('ITEM-PILES.Merchant.BuyServices'),\r\n        hidden: !hasServices\r\n      },\r\n      {\r\n        value: 'sell',\r\n        label: game.i18n.localize('ITEM-PILES.Merchant.SellItems'),\r\n        hidden: !canSell\r\n      },\r\n      {\r\n        value: 'tables',\r\n        label: game.i18n.localize('ITEM-PILES.Merchant.PopulateItems'),\r\n        hidden: !game.user.isGM\r\n      },\r\n    ];\r\n    if (tabs.find(tab => tab.value === $activeTab).hidden) {\r\n      $activeTab = tabs.find(tab => !tab.hidden).value;\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<svelte:window on:click={() => { $priceSelector = \"\"; }}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<DropZone callback={dropData} style=\"display: flex; flex-direction: column; height: 100%;\">\r\n\t\t<MerchantTopBar {store}/>\r\n\t\t<Tabs style=\"flex: 0 1 auto; font-size: 1.1rem; justify-content: flex-start;\"\r\n\t\t\t\t\tbind:tabs=\"{tabs}\"\r\n\t\t\t\t\tbind:activeTab={$activeTab}\r\n\t\t\t\t\tseparateElements\r\n\t\t\t\t\tunderscore\r\n\t\t/>\r\n\t\t<div class=\"item-piles-flexrow item-pile-merchant-content\">\r\n\t\t\t{#if $activeTab !== \"tables\"}\r\n\t\t\t\t<MerchantLeftPane {store}/>\r\n\t\t\t{/if}\r\n\t\t\t<MerchantRightPane {store} {recipientStore} {activeTab}/>\r\n\t\t</div>\r\n\t</DropZone>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .hidden {\r\n    display: none;\r\n  }\r\n\r\n  .item-pile-merchant-content {\r\n\r\n    flex: 1;\r\n    max-height: calc(100% - 84px);\r\n\r\n  }\r\n\r\n\r\n</style>\r\n","<script>\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\n  import { getContext } from \"svelte\";\n  import { getUserCharacter, getOwnedCharacters } from \"../../../helpers/utilities.js\";\n\n  const { application } = getContext('#external');\n\n  export let elementRoot;\n\n  let form;\n\n  getUserCharacter()\n\n  const users = game.users\n    .filter(u => u.active && (getUserCharacter(u) || u.isGM) && !(application.options.excludeSelf && u === game.user))\n    .map(u => ({\n      id: u.id,\n      name: u.name,\n      selected: true\n    }));\n\n  function requestSubmit() {\n    form.requestSubmit();\n  }\n\n  function submit() {\n    const finalUsers = users.filter(user => user.selected).map(user => user.id);\n    application.options.resolve(finalUsers);\n    application.close();\n  }\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\n\t<form class=\"item-piles-flexcol\" bind:this={form} on:submit|once|preventDefault={submit} style=\"padding:0.5rem;\"\n\t\t\t\tautocomplete=\"off\">\n\n\t\t<p style=\"margin-top: 0;text-align: center;\">\n\t\t\t<strong>{localize(\"ITEM-PILES.Dialogs.UserSelect.Content\")}</strong>\n\t\t</p>\n\n\t\t<div style=\"display:grid; grid-template-columns: auto 25px;\">\n\n\t\t\t{#each users as user (user.id)}\n\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center;\">\n\t\t\t\t\t<label for={\"item-piles-user-\" + user.id} class=\"item-piles-clickable\">{user.name}</label>\n\t\t\t\t</div>\n\t\t\t\t<input id={\"item-piles-user-\" + user.id} type=\"checkbox\" bind:checked={user.selected}/>\n\n\t\t\t{/each}\n\n\t\t</div>\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem;\">\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t<i class=\"fas fa-check\"></i>\n\t\t\t\t{localize(\"Okay\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</form>\n\n</ApplicationShell>\n","import UserSelectDialogShell from \"./user-select-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\n\r\nexport default class UserSelectDialog extends SvelteApplication {\r\n\r\n  /**\r\n   * @param options\r\n   */\r\n  constructor(options = {}) {\r\n    super({\r\n      title: game.i18n.localize(\"ITEM-PILES.Dialogs.UserSelect.Title\"),\r\n      svelte: {\r\n        class: UserSelectDialogShell,\r\n        target: document.body,\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 200,\r\n      height: \"auto\",\r\n      classes: [\"item-piles-app\"]\r\n    })\r\n  }\r\n\r\n  static async show(options = {}) {\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(options).render(true, { focus: true });\r\n    })\r\n  }\r\n\r\n}\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport ItemPileConfig from \"../item-pile-config/item-pile-config\";\r\nimport MerchantAppShell from \"./merchant-app-shell.svelte\";\r\nimport * as Helpers from \"../../helpers/helpers.js\";\r\nimport UserSelectDialog from \"../dialogs/user-select-dialog/user-select-dialog.js\";\r\nimport SETTINGS from \"../../constants/settings.js\";\r\nimport CONSTANTS from \"../../constants/constants.js\";\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\n\r\nexport default class MerchantApp extends SvelteApplication {\r\n\r\n  constructor(merchant, recipient = false, options = {}, dialogData = {}) {\r\n    super({\r\n      title: `Merchant: ${merchant.name}`,\r\n      id: `item-pile-merchant-${merchant.id}-${randomID()}`,\r\n      svelte: {\r\n        class: MerchantAppShell,\r\n        target: document.body,\r\n        props: {\r\n          merchant,\r\n          recipient\r\n        }\r\n      },\r\n      zIndex: 100,\r\n      ...options\r\n    }, dialogData);\r\n    this.merchant = merchant;\r\n    this.recipient = recipient;\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.OPEN_INTERFACE, this, merchant, recipient, options, dialogData);\r\n  }\r\n\r\n  /** @inheritdoc */\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: [\"app window-app sheet\", \"item-piles-merchant-sheet\", \"item-piles\", \"item-piles-app\"],\r\n      width: 800,\r\n      height: 700,\r\n      closeOnSubmit: false,\r\n      resizable: true\r\n    });\r\n  }\r\n\r\n  static getActiveApp(id) {\r\n    return Helpers.getActiveApps(`item-pile-merchant-${id}`, true);\r\n  }\r\n\r\n  static async show(merchant, recipient = false, options = {}, dialogData = {}) {\r\n    const merchantActor = Utilities.getActor(merchant);\r\n    const recipientActor = Utilities.getActor(recipient);\r\n    const result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_OPEN_INTERFACE, merchantActor, recipientActor, options, dialogData);\r\n    if (result === false) return;\r\n    const app = this.getActiveApp(merchant.id);\r\n    if (app) return app.render(false, { focus: true });\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(merchant, recipientActor, options, dialogData).render(true, { focus: true, bypassItemPiles: true });\r\n    })\r\n  }\r\n\r\n  refreshItems() {\r\n    this.svelte.applicationShell.store.refreshItems();\r\n  }\r\n\r\n  /** @override */\r\n  _getHeaderButtons() {\r\n    let buttons = super._getHeaderButtons();\r\n    const canConfigure = game.user.isGM;\r\n    if (canConfigure) {\r\n      buttons = [\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.Inspect.OpenSheet\" : \"\",\r\n          class: \"item-piles-open-actor-sheet\",\r\n          icon: \"fas fa-user\",\r\n          onclick: () => {\r\n            this.merchant.sheet.render(true, { focus: true, bypassItemPiles: true });\r\n          }\r\n        },\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.ContextMenu.ShowToPlayers\" : \"\",\r\n          class: \"item-piles-show-to-players\",\r\n          icon: \"fas fa-eye\",\r\n          onclick: async (event) => {\r\n            const activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n            if (!activeUsers.length) {\r\n              return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n            }\r\n            const users = event.altKey ? activeUsers : await UserSelectDialog.show({ excludeSelf: true });\r\n            if (!users || !users.length) return;\r\n            Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: this.merchant.name }))\r\n            return game.itempiles.API.renderItemPileInterface(this.merchant, {\r\n              userIds: users,\r\n              useDefaultCharacter: true\r\n            });\r\n          }\r\n        },\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.HUD.Configure\" : \"\",\r\n          class: \"item-piles-configure-pile\",\r\n          icon: \"fas fa-box-open\",\r\n          onclick: () => {\r\n            ItemPileConfig.show(this.merchant);\r\n          }\r\n        },\r\n      ].concat(buttons);\r\n    }\r\n    return buttons\r\n  }\r\n\r\n  async close(options) {\r\n    const result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_CLOSE_INTERFACE, this, this.merchant, this.recipient);\r\n    if (result === false) return;\r\n    for (const app of Object.values(ui.windows)) {\r\n      if (app !== this && this.svelte.applicationShell.store === app?.svelte?.applicationShell?.store) {\r\n        app.close();\r\n      }\r\n    }\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.CLOSE_INTERFACE, this, this.merchant, this.recipient);\r\n    return super.close(options);\r\n  }\r\n\r\n}\r\n","import { TJSContextMenuImpl } from '@typhonjs-fvtt/svelte-standard/component';\n\nimport {\n   A11yHelper,\n   isIterable,\n   isObject,\n   isSvelteComponent }        from '@typhonjs-fvtt/runtime/svelte/util';\n\n/**\n * Provides and manages browser window wide context menu functionality. The best way to create a context menu is to\n * attach the source KeyboardEvent or MouseEvent / PointerEvent as data in {@link TJSContextMenu.create}. This allows\n * proper keyboard handling across browsers supporting the context menu key. A A11yFocusSource data object is generated\n * which allows tracking of the source element that triggered the context menu allowing focus to return to the source\n * when the context menu is closed. This A11yFocusSource object is also forwarded on through the `onPress` callback and\n * is intended to be supplied as `SvelteApplication` options particularly for modal dialogs allowing focus to return\n * to the original source after the modal dialog is closed.\n */\nexport class TJSContextMenu\n{\n   /**\n    * Stores any active context menu.\n    */\n   static #contextMenu = void 0;\n\n   /**\n    * Creates and manages a browser wide context menu. The best way to create the context menu is to pass in the source\n    * DOM event as it is processed for the location of the context menu to display. Likewise, a A11yFocusSource object\n    * is generated that allows focus to be returned to the source location. You may supply a default focus target as a\n    * fallback via `focusEl`.\n    *\n    * @param {object}      opts - Optional parameters.\n    *\n    * @param {string}      [opts.id] - A custom CSS ID to add to the menu. This allows CSS style targeting.\n    *\n    * @param {KeyboardEvent|MouseEvent}  [opts.event] - The source MouseEvent or KeyboardEvent.\n    *\n    * @param {number}      [opts.x] - X position override for the top / left of the menu.\n    *\n    * @param {number}      [opts.y] - Y position override for the top / left of the menu.\n    *\n    * @param {Iterable<TJSContextMenuItemData>} [opts.items] - Menu items to display.\n    *\n    * @param {boolean}     [opts.focusDebug] - When true the associated A11yFocusSource object will log focus target\n    *        data when applied.\n    *\n    * @param {HTMLElement|string} [opts.focusEl] - A specific HTMLElement or selector string as the default focus\n    *        target.\n    *\n    * @param {string}      [opts.keyCode='Enter'] - Key to select menu items.\n    *\n    * @param {Record<string, string>}  [opts.styles] - Optional inline styles to apply.\n    *\n    * @param {number}      [opts.zIndex=Number.MAX_SAFE_INTEGER - 100] - Z-index for context menu.\n    *\n    * @param {number}      [opts.duration] - Transition option for duration of transition.\n    *\n    * @param {Function}    [opts.easing] - Transition option for easing function.\n    */\n   static create({ id = '', event, x, y, items, focusDebug = false, focusEl, keyCode = 'Enter', styles,\n    zIndex = Number.MAX_SAFE_INTEGER - 100, duration = 200, easing, } = {})\n   {\n      if (this.#contextMenu !== void 0) { return; }\n\n      if (!event && (typeof x !== 'number' || typeof y !== 'number'))\n      {\n         throw new Error(`TJSContextMenu.create error: No event or absolute X / Y position not defined.`);\n      }\n\n      if (event !== void 0 && !(event instanceof KeyboardEvent) && !(event instanceof MouseEvent))\n      {\n         throw new TypeError(`TJSContextMenu.create error: 'event' is not a KeyboardEvent or MouseEvent.`);\n      }\n\n      const focusSource = A11yHelper.getFocusSource({ event, x, y, focusEl, debug: focusDebug });\n\n      // Create the new context menu with the last click x / y point.\n      this.#contextMenu = new TJSContextMenuImpl({\n         target: document.body,\n         intro: true,\n         props: {\n            id,\n            x: focusSource.x,\n            y: focusSource.y,\n            items: this.#processItems(items),\n            focusSource,\n            keyCode,\n            styles,\n            transitionOptions: { duration, easing },\n            zIndex\n         }\n      });\n\n      // Register an event listener to remove any active context menu if closed from a menu selection or pointer\n      // down event to `document.body`.\n      this.#contextMenu.$on('close', () => { this.#contextMenu = void 0; });\n   }\n\n   /**\n    * Processes menu item data for conditions and evaluating the type of menu item.\n    *\n    * @param {Iterable<TJSContextMenuItemData>} items - Menu item data.\n    *\n    * @returns {object[]} Processed menu items.\n    */\n   static #processItems(items)\n   {\n      if (!isIterable(items)) { throw new TypeError(`TJSContextMenu error: 'items' is not an iterable list.`); }\n\n      const tempList = items;\n      const tempItems = [];\n\n      let cntr = -1;\n\n      for (const item of tempList)\n      {\n         cntr++;\n         if (!isObject(item)) { throw new TypeError(`TJSContextMenu error: 'item[${cntr}]' is not an object.`); }\n\n         // Filter items for any condition that prevents display.\n         if (typeof item.condition === 'function' && !item.condition()) { continue; }\n         if (typeof item.condition === 'boolean' && !item.condition) { continue; }\n\n         let type;\n\n         if (isSvelteComponent(item.class)) { type = 'class'; }\n         else if (typeof item.icon === 'string') { type = 'icon'; }\n         else if (typeof item.image === 'string') { type = 'image'; }\n         else if (typeof item.separator === 'string')\n         {\n            if (item.separator !== 'hr')\n            {\n               throw new Error(\n                `TJSContextMenu error: 'item[${cntr}]' has unknown separator type; only 'hr' is currently supported.`);\n            }\n\n            type = 'separator-hr';\n         }\n\n         if (type === void 0) { throw new TypeError(`TJSContextMenu error: Unknown type for 'item[${cntr}]'.`); }\n\n         tempItems.push({ ...item, '#type': type });\n      }\n\n      return tempItems;\n   }\n}\n\n/**\n * @typedef {object} TJSContextMenuItemData - Defines a menu item entry. Depending on the item data that is passed\n * into the menu you can define 4 types of items: 'icon / label', 'image / label', 'class / Svelte component', and\n * 'separator / hr'. A single callback function `onPress` is supported.\n *\n * @property {(item: TJSContextMenuItemData, object) => void} [onPress] - A callback function that receives the selected\n * item data and an object containing the A11yFocusSource data that can be passed to any Application / particularly modal\n * dialogs returning focus when closed.\n *\n * @property {boolean|(() => boolean)} [condition] - If a boolean and false or a function that invoked returns a falsy value\n *           this item is not added.\n *\n * @property {Function} [class] - A Svelte component class.\n *\n * @property {object} [props] - An object passed on as props for any Svelte component.\n *\n *\n * @property {string} [icon] - A string containing icon classes.\n *\n *\n * @property {string} [image] - An image icon path.\n *\n * @property {string} [imageAlt] - An image 'alt' text description.\n *\n *\n * @property {string} [label] - A text string that is passed through localization.\n *\n * @property {'hr'} [separator] - A menu item separator; only 'hr' supported.\n */\n","import { clamp } from \"../../../helpers/helpers\";\nimport { get } from \"svelte/store\";\n\nexport function isItemColliding(item, otherItem) {\n  const transform = get(item.transform);\n  const otherTransform = get(otherItem.transform);\n  return (\n    item.id !== otherItem.id &&\n    transform.x <= otherTransform.x + otherTransform.w - 1 &&\n    transform.y <= otherTransform.y + otherTransform.h - 1 &&\n    transform.x + transform.w - 1 >= otherTransform.x &&\n    transform.y + transform.h - 1 >= otherTransform.y\n  );\n}\n\nexport function getCollisions(originalItem, items) {\n  return items.filter((item) => isItemColliding(originalItem, item));\n}\n\nexport function coordinate2position(coordinate, cellSize, gap) {\n  return coordinate * cellSize + (coordinate + 1) * gap;\n}\n\nexport function coordinate2size(coordinate, cellSize, gap) {\n  return coordinate * cellSize + (coordinate - 1) * gap;\n}\n\nexport function position2coordinate(position, cellSize, size, gap) {\n  return Math.round(position / (cellSize + gap));\n}\n\nexport function snapOnMove(left, top, transform, options) {\n  const { gridSize, gap, cols, enabledCols, rows, enabledRows } = options;\n  const { w, h } = transform;\n\n  const width = w * gridSize;\n  const height = h * gridSize;\n\n  let x = position2coordinate(left, gridSize, width, gap);\n  let y = position2coordinate(top, gridSize, height, gap);\n\n  x = clamp(x, 0, Math.min(cols, enabledCols) - w);\n  y = clamp(y, 0, Math.min(rows, enabledRows) - h);\n\n  return { x, y };\n}\n\nexport function calcPosition(transform, options) {\n  const { gridSize, gap } = options;\n  return {\n    left: coordinate2position(transform.x, gridSize, gap),\n    top: coordinate2position(transform.y, gridSize, gap),\n    width: coordinate2size(transform.w, gridSize, gap),\n    height: coordinate2size(transform.h, gridSize, gap)\n  };\n}\n","<script>\n\n  import { createEventDispatcher } from 'svelte';\n  import { get, writable } from 'svelte/store';\n  import { styleFromObject } from '../../../helpers/helpers.js';\n  import { calcPosition, getCollisions, snapOnMove } from './grid-utils.js';\n\n  export let item;\n  export let options;\n  export let items;\n  export let gridContainer;\n\n  const dispatch = createEventDispatcher();\n\n  let itemRef = HTMLElement;\n  const transformStore = item.transform;\n  const previewTransform = writable({});\n  const tooltip = item.name;\n\n  $: transform = $transformStore;\n  $: gridTransform = calcPosition(transform, options);\n  $: snappedGridTransform = calcPosition({\n    ...snapOnMove($previewTransform.left, $previewTransform.top, transform, options),\n    w: transform.w,\n    h: transform.h,\n  }, options);\n  $: {\n    if (!active) $previewTransform = $transformStore;\n  }\n\n  let classes = \"\";\n  $: {\n    classes = \"\";\n    classes += \" \" + options.hoverClass;\n    classes += (options.highlightItems && item.highlight ? \" \" + options.highlightClass : \"\")\n    classes += (options.highlightItems && !item.highlight ? \" \" + options.dimClass : \"\")\n  }\n\n  $: style = styleFromObject({\n    \"position\": \"absolute\",\n    \"left\": gridTransform.left + \"px\",\n    \"top\": gridTransform.top + \"px\",\n    \"width\": gridTransform.width + \"px\",\n    \"height\": gridTransform.height + \"px\",\n    \"cursor\": 'move'\n  });\n\n  $: ghostStyle = styleFromObject({\n    \"position\": \"absolute\",\n    \"left\": snappedGridTransform.left + \"px\",\n    \"top\": snappedGridTransform.top + \"px\",\n    \"width\": snappedGridTransform.width + \"px\",\n    \"height\": snappedGridTransform.height + \"px\",\n    \"opacity\": \"0.75\",\n    \"z-index\": \"5\"\n  });\n\n  let active = false;\n  let splitting = false;\n  let collisions = [];\n  let pointerOffset = { left: 0, top: 0 };\n\n  function doubleClick(event) {\n    if (event.button !== 0) return;\n    dispatch(\"itemdoubleclick\", { item });\n  }\n\n  function moveStart(event) {\n\n    if (event.button === 2) {\n      return rightClick(event);\n    }\n\n    if (!options.canOrganize) return;\n\n    // If not left mouse, skip\n    if (event.button !== 0) return;\n\n    if (event.pointerId) {\n      itemRef.setPointerCapture(event.pointerId);\n    }\n\n    // Get offset for pointer within the grid item\n    pointerOffset = {\n      left: event.pageX - gridTransform.left,\n      top: event.pageY - gridTransform.top,\n      internalLeft: event.offsetX,\n      internalTop: event.offsetY,\n    };\n\n    dispatch(\"itembegindrag\", {\n      item,\n      target: itemRef,\n      x: event.pageX - pointerOffset.internalLeft,\n      y: event.pageY - pointerOffset.internalTop\n    });\n\n    // Setup events for when item is moved and dropped\n    window.addEventListener('pointermove', move, { passive: false });\n    window.addEventListener('pointerup', moveEnd, { passive: false });\n    window.addEventListener('touchmove', move, { passive: false });\n    window.addEventListener('touchend', moveEnd, { passive: false });\n\n  }\n\n  function splitStart(event) {\n\n    splitting = true;\n\n    // Get offset for pointer within the grid item\n    pointerOffset = {\n      left: event.pageX - gridTransform.left,\n      top: event.pageY - gridTransform.top,\n      internalLeft: event.offsetX,\n      internalTop: event.offsetY,\n    };\n\n    // Setup events for when item is moved and dropped\n    window.addEventListener('pointermove', move, { passive: false });\n    window.addEventListener('pointerup', moveEnd, { passive: false });\n    window.addEventListener('touchmove', move, { passive: false });\n    window.addEventListener('touchend', moveEnd, { passive: false });\n\n  }\n\n  function move(event) {\n\n    const { pageX, pageY } = (event.type === \"touchmove\" ? event.changedTouches[0] : event);\n\n    active = true;\n\n    const { left, top, outOfBounds } = constrainToContainer(\n      pageX - pointerOffset.left,\n      pageY - pointerOffset.top\n    );\n    active = !outOfBounds;\n    dispatch(\"itemmove\", {\n      x: pageX - pointerOffset.internalLeft,\n      y: pageY - pointerOffset.internalTop\n    });\n    previewTransform.set({\n      ...transform,\n      ...gridTransform,\n      ...snapOnMove(left, top, transform, options),\n      left,\n      top,\n    });\n\n    if (!splitting) {\n      collisions = getCollisions({ id: item.id, transform: previewTransform }, items);\n    }\n\n  }\n\n  function constrainToContainer(left, top) {\n\n    let outOfBounds = false;\n    const parentRect = gridContainer.getBoundingClientRect();\n    const relativeRect = {\n      left: (parentRect.left - parentRect.x),\n      top: (parentRect.top - parentRect.y),\n      right: (parentRect.right - parentRect.x),\n      bottom: (parentRect.bottom - parentRect.y),\n    }\n    if (left < relativeRect.left) {\n      if (left < (relativeRect.left - gridTransform.width / 2)) {\n        outOfBounds = true;\n      }\n      left = relativeRect.left;\n    }\n    if (top < relativeRect.top) {\n      if (top < (relativeRect.top - gridTransform.height / 2)) {\n        outOfBounds = true;\n      }\n      top = relativeRect.top;\n    }\n    if ((left + gridTransform.width) > relativeRect.right) {\n      if ((left + gridTransform.width) > (relativeRect.right + gridTransform.width / 2)) {\n        outOfBounds = true;\n      }\n      left = relativeRect.right - gridTransform.width;\n    }\n    if ((top + gridTransform.height) > relativeRect.bottom) {\n      if ((top + gridTransform.height) > (relativeRect.bottom + gridTransform.height / 2)) {\n        outOfBounds = true;\n      }\n      top = relativeRect.bottom - gridTransform.height;\n    }\n\n    return { left, top, outOfBounds };\n\n  }\n\n  function moveEnd(event) {\n\n    window.removeEventListener('pointermove', move);\n    window.removeEventListener('pointerup', moveEnd);\n    window.removeEventListener('touchmove', move);\n    window.removeEventListener('touchend', moveEnd);\n\n    const finalTransform = get(previewTransform);\n\n    const { pageX, pageY } = (event.type === \"touchmove\" ? event.changedTouches[0] : event);\n\n    if (event.button === 2) {\n      dispatch(\"itemstopdrag\", { cancelled: true });\n      active = false;\n    } else {\n      dispatch(\"itemstopdrag\", {\n        item,\n        outOfBounds: !active,\n        x: pageX - pointerOffset.internalLeft,\n        y: pageY - pointerOffset.internalTop,\n        gridX: finalTransform.x,\n        gridY: finalTransform.y,\n        splitting\n      })\n    }\n\n    if (!active) return;\n    active = false;\n\n    if (splitting) {\n      splitting = false;\n      return;\n    }\n\n    if (foundry.utils.isEmpty(finalTransform)\n      || (finalTransform.x === transform.x && finalTransform.y === transform.y)\n    ) {\n      return;\n    }\n\n    if (collisions.length) {\n\n      if (item.item.areItemsSimilar(collisions[0].item) && !globalThis.keyboard.downKeys.has(\"ControlLeft\")) {\n        return collisions[0].item.merge(item.item);\n      }\n\n      const offset = collisions.reduce((acc, collision) => {\n        const trans = get(collision.transform);\n        if (trans.x < acc.x) acc.x = trans.x;\n        if (trans.y < acc.y) acc.y = trans.y;\n        return acc;\n      }, { x: finalTransform.x, y: finalTransform.y });\n      for (const collision of collisions) {\n        collision.transform.update(trans => {\n          trans.x = transform.x + (trans.x - offset.x);\n          trans.y = transform.y + (trans.y - offset.y);\n          return trans;\n        });\n      }\n    }\n\n    transformStore.update(trans => {\n      trans.x = finalTransform.x;\n      trans.y = finalTransform.y;\n      return trans;\n    });\n\n    dispatch(\"itemchange\", { items: collisions.concat(item) });\n\n  }\n\n  function hoverOver() {\n    const { x, y } = itemRef.getBoundingClientRect();\n    dispatch(\"itemhover\", {\n      item,\n      target: itemRef,\n      x: x + Math.floor(options.gridSize / 2),\n      y: y + Math.floor(options.gridSize / 2)\n    });\n  }\n\n  function hoverLeave() {\n    const { x, y } = itemRef.getBoundingClientRect();\n    dispatch(\"itemhoverleave\", {\n      item,\n      target: itemRef,\n      x: x + Math.floor(options.gridSize / 2),\n      y: y + Math.floor(options.gridSize / 2)\n    });\n  }\n\n  function rightClick(event) {\n    dispatch(\"itemrightclick\", {\n      item,\n      target: itemRef,\n      x: event.pageX,\n      y: event.pageY,\n      splitStart,\n    });\n  }\n\n</script>\n\n<div\n\tbind:this={itemRef}\n\tclass={classes}\n\ton:dblclick={doubleClick}\n\ton:dragover|preventDefault\n\ton:pointerdown={moveStart}\n\ton:pointerleave={hoverLeave}\n\ton:pointerover={hoverOver}\n\ton:touchstart={moveStart}\n\tstyle={style}\n>\n\t<slot/>\n</div>\n\n{#if active}\n\t<div style={ghostStyle} class={collisions.length ? options.collisionClass : options.previewClass}></div>\n\n\t{#if collisions.length}\n\t\t<div style={style} class={collisions.length ? options.collisionClass : options.previewClass}></div>\n\t{/if}\n{/if}\n","<script>\n\n  import { createEventDispatcher } from 'svelte';\n  import { writable } from 'svelte/store';\n  import { styleFromObject } from '../../../helpers/helpers';\n  import { calcPosition } from './grid-utils';\n  import GridItem from './GridItem.svelte';\n\n  export let gridContainer = HTMLDivElement;\n  export let items = [];\n  export let dropGhost = false;\n  export let options = {\n    cols: null,\n    rows: null,\n    enabledCols: null,\n    enabledRows: null,\n    gap: 10,\n    gridSize: 50,\n    canOrganize: false,\n    backgroundGrid: false,\n    class: \"\",\n    activeClass: \"\",\n    previewClass: \"\",\n    collisionClass: \"\",\n    hoverClass: \"\",\n    highlightClass: \"\",\n    highlightItems: false\n  }\n\n  let containerHeight = writable(0);\n  let containerWidth = writable(0);\n\n  const dispatch = createEventDispatcher();\n\n  function itemChangeEvent(event) {\n    dispatch('change', { ...event.detail });\n  }\n\n  function itemHoverEvent(event) {\n    dispatch('hover', { ...event.detail });\n  }\n\n  function itemBeginDrag(event) {\n    dispatch('itembegindrag', { ...event.detail });\n  }\n\n  function itemStopDrag(event) {\n    dispatch('itemstopdrag', { ...event.detail });\n  }\n\n  function itemMove(event) {\n    dispatch('itemmove', { ...event.detail });\n  }\n\n  function itemHoverLeaveEvent(event) {\n    dispatch('leave', { ...event.detail });\n  }\n\n  function itemRightClickEvent(event) {\n    dispatch('rightclick', { ...event.detail });\n  }\n\n  function itemDoubleClickEvent(event) {\n    dispatch('doubleclick', { ...event.detail });\n  }\n\n  $: $containerWidth = options.cols * (options.gridSize + options.gap) + options.gap;\n  $: $containerHeight = options.rows * (options.gridSize + options.gap) + options.gap;\n\n  $: containerStyle = styleFromObject({\n    \"width\": $containerWidth + \"px\",\n    \"height\": $containerHeight + \"px\",\n  });\n\n  let backgroundGridStyle = \"\";\n  $: backgroundGridStyle = styleFromObject({\n    \"grid-template-columns\": `repeat(${options.cols}, ${options.gridSize + options.gap / 2}px)`,\n    \"grid-template-rows\": `repeat(${options.rows}, ${options.gridSize + options.gap / 2}px)`,\n    \"gap\": `${options.gap / 2}px`,\n    \"top\": `${options.gap / 2}px`\n  });\n\n</script>\n\n<div class=item-piles-grid-container>\n\n  <div\n    class=\"item-piles-grid {options.class}\"\n    bind:this={gridContainer}\n    style={containerStyle}\n  >\n    {#if dropGhost && dropGhost?.active}\n      {@const dropElem = calcPosition(dropGhost, options)}\n      <div\n        style={`position: absolute; left:${dropElem.left}px; top:${dropElem.top}px;\n        width: ${dropElem.width}px; height: ${dropElem.height}px;`}\n        class={options.previewClass}\n      />\n    {/if}\n    {#each items as item (item.id)}\n      <GridItem\n        bind:item={item}\n        bind:items={items}\n        bind:options={options}\n        {gridContainer}\n        on:itemdoubleclick={itemDoubleClickEvent}\n        on:itemchange={itemChangeEvent}\n        on:itemhover={itemHoverEvent}\n        on:itembegindrag={itemBeginDrag}\n        on:itemstopdrag={itemStopDrag}\n        on:itemmove={itemMove}\n        on:itemhoverleave={itemHoverLeaveEvent}\n        on:itemrightclick={itemRightClickEvent}\n      >\n        <slot {item}/>\n      </GridItem>\n    {/each}\n  </div>\n\n  {#if options.backgroundGrid}\n\n    <div class=\"item-piles-inner-grid\" style={backgroundGridStyle}>\n      {#each Array(options.rows) as _, rowIndex (rowIndex)}\n        {#each Array(options.cols) as _, colIndex (colIndex)}\n          <div class:grid-disabled={colIndex >= options.enabledCols || rowIndex >= options.enabledRows}\n               style=\"width: {options.gridSize + (options.gap/2)}px; height: {options.gridSize + (options.gap/2)}\"></div>\n        {/each}\n      {/each}\n    </div>\n\n  {/if}\n\n</div>\n\n<style lang=\"scss\">\n\n  .item-piles-grid-container {\n    position: relative;\n    display: flex;\n    justify-content: center;\n  }\n\n  .item-piles-grid {\n    position: relative !important;\n    margin: -2px;\n  }\n\n  .item-piles-inner-grid {\n    display: grid;\n    border-radius: 0.25rem;\n    position: absolute;\n    margin: -1px;\n    pointer-events: none;\n\n    > div {\n      border-radius: 0.25rem;\n      border: 1px solid rgba(0, 0, 0, 0.25);\n\n      &.grid-disabled {\n        background-color: rgba(0, 0, 0, 0.25);\n      }\n    }\n  }\n\n</style>\n","<script>\n\n  import * as Helpers from \"../../helpers/helpers.js\";\n\n  export let entry;\n\n  const item = entry.item;\n\n  const name = item.name;\n  const img = item.img;\n  const quantity = item.quantity;\n  const canStack = item.canStack;\n  const style = item.style;\n\n  $: styling = Helpers.styleFromObject($style);\n\n</script>\n\n<div class=\"grid-item\" data-tooltip={$name}\n\t\t data-tooltip-activation-speed=\"0\" data-tooltip-deactivation-speed=\"0\">\n\t{#if $img}\n\t\t<img src={$img} alt={$name}/>\n\t{/if}\n\t{#if styling}\n\t\t<div class=\"grid-item-ghost\" style={styling}></div>\n\t{/if}\n\t{#if canStack && $quantity > 1}\n\t\t<span>{$quantity}</span>\n\t{/if}\n</div>\n\n<style lang=\"scss\">\n\n  .grid-item {\n    width: 100%;\n    height: 100%;\n    background-color: rgb(56, 56, 56);\n    transition: transform 2s, top 2s, left 2s;\n    border-radius: 0.25rem;\n    position: relative;\n\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    border: 1px solid black;\n\n    img {\n      position: absolute;\n      flex-shrink: 0;\n      min-width: 100%;\n      min-height: 100%;\n      object-fit: cover;\n      transition: transform 2s, opacity 2s;\n      border: 0;\n    }\n\n    span {\n      position: absolute;\n      bottom: 0;\n      right: 3px;\n      text-align: right;\n      color: white;\n      text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;\n      pointer-events: none;\n    }\n\n    .grid-item-ghost {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n</style>\n","import ItemPileStore from \"./item-pile-store.js\";\nimport { get, writable } from \"svelte/store\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport { PileItem } from \"./pile-item.js\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport PrivateAPI from \"../API/private-api.js\";\nimport ItemPileSocket from \"../socket.js\";\nimport DropItemDialog from \"../applications/dialogs/drop-item-dialog/drop-item-dialog.js\";\nimport { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\nimport CustomDialog from \"../applications/components/CustomDialog.svelte\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport * as helpers from \"../helpers/helpers.js\";\nimport { SYSTEMS } from \"../systems.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\n\nexport class VaultStore extends ItemPileStore {\n\n  constructor(...args) {\n    super(...args);\n    this.gridData = writable({});\n    this.gridItems = writable([]);\n    this.validGridItems = writable([]);\n    this.canDepositCurrency = writable(false);\n    this.canWithdrawCurrency = writable(false);\n    this.logSearch = writable(\"\");\n    this.vaultLog = writable([]);\n    this.visibleLogItems = writable(18);\n    this.highlightedGridItems = writable([]);\n    this.vaultExpanderItems = writable([]);\n    this.dragPosition = writable({ x: 0, y: 0, w: 1, h: 1, active: false, });\n    this.mainContainer = false;\n  }\n\n  get searchDelay() {\n    return 50;\n  }\n\n  get ItemClass() {\n    return VaultItem;\n  }\n\n  setupStores(reset = false) {\n    super.setupStores(reset);\n    this.gridData.set({});\n    this.gridItems.set([]);\n    this.validGridItems.set([]);\n    this.logSearch.set(\"\");\n    this.vaultLog.set([]);\n    this.visibleLogItems.set(18);\n    this.highlightedGridItems.set([]);\n    this.vaultExpanderItems.set([]);\n    this.dragPosition.set({ x: 0, y: 0, w: 1, h: 1, active: false, });\n\n    this.refreshGridDebounce = foundry.utils.debounce(() => {\n      this.refreshGrid();\n    }, this.searchDelay);\n  }\n\n  setupSubscriptions() {\n    super.setupSubscriptions();\n    this.subscribeTo(this.pileData, () => {\n      this.refreshGridDebounce();\n      this.processLogEntries();\n    });\n\n    this.subscribeTo(this.document, () => {\n      const { data } = this.document.updateOptions;\n      if (hasProperty(data, CONSTANTS.FLAGS.LOG)) {\n        this.processLogEntries();\n      }\n    });\n\n    this.subscribeTo(this.logSearch, this.filterLogEntries.bind(this));\n\n    this.refreshGrid();\n    this.processLogEntries();\n  }\n\n  processLogEntries() {\n\n    const pileData = get(this.pileData);\n    const logEntries = PileUtilities.getActorVaultLog(this.actor);\n\n    logEntries.map(log => {\n\n      let instigator = log.actor || \"Unknown character\";\n      if (pileData.vaultLogType === \"user_actor\") {\n        instigator = game.i18n.format(\"ITEM-PILES.Vault.LogUserActor\", {\n          actor_name: log.actor || \"Unknown character\",\n          user_name: game.users.get(log.user)?.name ?? \"unknown user\",\n        })\n      } else if (pileData.vaultLogType === \"user\") {\n        instigator = game.users.get(log.user)?.name ?? \"unknown user\";\n      }\n\n      const quantity = Math.abs(log.qty) > 1\n        ? game.i18n.format(\"ITEM-PILES.Vault.LogQuantity\", { quantity: Math.abs(log.qty) })\n        : \"\";\n\n      if (!log.action) {\n        log.action = log.qty > 0 ? \"deposited\" : \"withdrew\";\n      }\n\n      const action = log.action === \"withdrew\" || log.action === \"deposited\"\n        ? game.i18n.localize(\"ITEM-PILES.Vault.\" + (log.action.slice(0, 1).toUpperCase() + log.action.slice(1)))\n        : log.action;\n\n      log.text = game.i18n.format(\"ITEM-PILES.Vault.LogEntry\", {\n        instigator,\n        action: `<span>${action}</span>`,\n        quantity: quantity,\n        item_name: `<strong>${log.name}</strong>`,\n      })\n      log.visible = true;\n\n    });\n\n    this.vaultLog.set(logEntries);\n\n    this.filterLogEntries()\n\n  }\n\n  filterLogEntries() {\n    const search = get(this.logSearch).toLowerCase();\n    const regex = new RegExp(search, \"g\");\n    this.vaultLog.update((logs) => {\n      for (let log of logs) {\n        log.visible = log.text.toLowerCase().search(regex) !== -1;\n      }\n      return logs;\n    })\n  }\n\n  refreshFreeSpaces() {\n    const pileData = get(this.pileData);\n    this.gridData.update(() => {\n\n      const vaultAccess = pileData.vaultAccess.filter(access => {\n        return fromUuidSync(access.uuid)?.isOwner;\n      });\n\n      const access = vaultAccess.reduce((acc, access) => {\n        acc.canOrganize = acc.canOrganize || access.organize;\n        acc.canWithdrawItems = (acc.canWithdrawItems || access.items.withdraw) && !!this.recipient;\n        acc.canDepositItems = (acc.canDepositItems || access.items.deposit) && !!this.recipient;\n        acc.canWithdrawCurrencies = (acc.canWithdrawCurrencies || access.currencies.withdraw) && !!this.recipient;\n        acc.canDepositCurrencies = (acc.canDepositCurrencies || access.currencies.deposit) && !!this.recipient;\n        return acc;\n      }, {\n        canOrganize: this.actor.isOwner,\n        canWithdrawItems: this.actor.isOwner && !!this.recipient,\n        canDepositItems: this.actor.isOwner && !!this.recipient,\n        canWithdrawCurrencies: this.actor.isOwner && !!this.recipient,\n        canDepositCurrencies: this.actor.isOwner && !!this.recipient\n      });\n\n      return {\n        ...PileUtilities.getVaultGridData(this.actor, pileData),\n        ...access,\n        canEditCurrencies: game.user.isGM,\n        fullAccess: game.user.isGM || Object.values(access).every(Boolean),\n        gridSize: 40,\n        gap: 4\n      }\n    })\n  }\n\n  canItemsFitWithout(itemToCompare) {\n\n    const pileData = get(this.pileData);\n    const items = get(this.validGridItems);\n    const vaultExpanders = get(this.vaultExpanderItems);\n\n    const expansions = vaultExpanders.reduce((acc, item) => {\n      if (item === itemToCompare) return acc;\n      acc.cols += get(item.itemFlagData).addsCols * get(item.quantity);\n      acc.rows += get(item.itemFlagData).addsRows * get(item.quantity);\n      return acc;\n    }, {\n      cols: pileData.baseExpansionCols ?? 0,\n      rows: pileData.baseExpansionRows ?? 0\n    });\n\n    const enabledCols = Math.min(pileData.cols, expansions.cols);\n    const enabledRows = Math.min(pileData.rows, expansions.rows);\n\n    const enabledSpaces = enabledCols * enabledRows;\n\n    return enabledSpaces - items.length;\n\n  }\n\n  updateGrid(items) {\n\n    if (!items.length) return;\n\n    const itemsToUpdate = items.map(item => {\n      const transform = get(item.transform);\n      return {\n        _id: item.id,\n        [CONSTANTS.FLAGS.ITEM + \".x\"]: transform.x,\n        [CONSTANTS.FLAGS.ITEM + \".y\"]: transform.y\n      }\n    });\n\n    helpers.debug(\"itemsToUpdate\", itemsToUpdate);\n\n    const actorUuid = Utilities.getUuid(this.actor);\n    if (this.actor.isOwner) {\n      return PrivateAPI._commitActorChanges(actorUuid, {\n        itemsToUpdate,\n      });\n    }\n\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.COMMIT_ACTOR_CHANGES, actorUuid, {\n      itemsToUpdate,\n    });\n  }\n\n  refreshItems() {\n    super.refreshItems();\n    const pileData = get(this.pileData);\n    this.validGridItems.set(get(this.allItems).filter(entry => {\n      const itemFlagData = get(entry.itemFlagData);\n      return (!pileData.vaultExpansion || !itemFlagData.vaultExpander) && !entry.isCurrency;\n    }));\n    this.highlightedGridItems.set(get(this.items).filter(entry => {\n      const itemFlagData = get(entry.itemFlagData);\n      return !pileData.vaultExpansion || !itemFlagData.vaultExpander;\n    }).map(item => item.id));\n    this.vaultExpanderItems.set(get(this.allItems).filter(entry => {\n      const itemFlagData = get(entry.itemFlagData);\n      return !pileData.vaultExpansion || itemFlagData.vaultExpander;\n    }));\n    this.refreshGridDebounce();\n  }\n\n  createItem(...args) {\n    super.createItem(...args);\n    this.refreshGrid();\n  }\n\n  deleteItem(...args) {\n    super.deleteItem(...args);\n    this.refreshGrid();\n  }\n\n  refreshGrid() {\n    this.refreshFreeSpaces();\n    this.gridItems.set(this.placeItemsOnGrid());\n  }\n\n  placeItemsOnGrid() {\n    const search = get(this.search)\n    const highlightedItems = get(this.highlightedGridItems);\n    const gridData = get(this.gridData);\n    const allItems = [...get(this.validGridItems)];\n    const existingItems = [];\n\n    const grid = Array.from(Array(gridData.enabledCols).keys()).map((_, x) => {\n      return Array.from(Array(gridData.enabledRows).keys()).map((_, y) => {\n        const item = allItems.find(item => {\n          return item.x === x && item.y === y\n        });\n        if (item) {\n          allItems.splice(allItems.indexOf(item), 1);\n          existingItems.push({\n            id: item.id,\n            transform: item.transform,\n            highlight: search && highlightedItems.includes(item.id),\n            item,\n          });\n        }\n        return item?.id ?? null;\n      });\n    });\n\n    helpers.debug(\"grid\", grid);\n\n    helpers.debug(\"existingItems\", existingItems);\n\n    helpers.debug(\"allItems\", allItems);\n\n    const itemsToUpdate = allItems\n      .map(item => {\n        for (let x = 0; x < gridData.enabledCols; x++) {\n          for (let y = 0; y < gridData.enabledRows; y++) {\n            if (!grid[x][y]) {\n              grid[x][y] = item.id;\n              item.transform.update(trans => {\n                trans.x = x;\n                trans.y = y;\n                return trans;\n              });\n              return {\n                id: item.id,\n                transform: item.transform,\n                highlight: search && highlightedItems.includes(item.id),\n                item\n              };\n            }\n          }\n        }\n      })\n      .filter(Boolean)\n\n    this.updateGrid(itemsToUpdate)\n\n    return itemsToUpdate.concat(existingItems);\n\n  }\n\n  async onDropData(data, event, isExpander) {\n\n    const dragPosition = get(this.dragPosition);\n    const { x, y } = dragPosition;\n    this.dragPosition.set({ x: 0, y: 0, w: 1, h: 1, active: false, });\n\n    if (data.type === \"Actor\" && game.user.isGM) {\n      const oldHeight = this.mainContainer.getBoundingClientRect().height;\n      const newRecipient = data.uuid ? (await fromUuid(data.uuid)) : game.actors.get(data.id);\n      this.updateRecipient(newRecipient);\n      this.refreshFreeSpaces();\n      if (!this.recipient) {\n        setTimeout(() => {\n          const newHeight = this.mainContainer.getBoundingClientRect().height - oldHeight;\n          application.position.stores.height.set(get(application.position.stores.height) + newHeight);\n        });\n      }\n      return;\n    }\n\n    if (data.type !== \"Item\") {\n      Helpers.custom_warning(`You can't drop documents of type \"${data.type}\" into this Item Piles vault!`, true)\n      return false;\n    }\n\n    const item = await Item.implementation.fromDropData(data);\n\n    const itemData = item.toObject();\n\n    if (!itemData) {\n      console.error(data);\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\n    }\n\n    const source = (data.uuid ? fromUuidSync(data.uuid) : false)?.parent ?? false;\n    const target = this.actor;\n\n    if (source === target) {\n      Helpers.custom_warning(`You can't drop items into the vault that originate from the vault!`, true)\n      return false;\n    }\n\n    if (!source && !game.user.isGM) {\n      Helpers.custom_warning(`Only GMs can drop items from the sidebar!`, true)\n      return false;\n    }\n\n    const vaultExpander = getProperty(itemData, CONSTANTS.FLAGS.ITEM + \".vaultExpander\");\n\n    if (isExpander && !vaultExpander) {\n      Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultItemNotExpander\"), true)\n      return false;\n    }\n\n    const gridData = get(this.gridData);\n\n    let flagData = PileUtilities.getItemFlagData(itemData);\n    setProperty(flagData, \"x\", x);\n    setProperty(flagData, \"y\", y);\n    setProperty(itemData, CONSTANTS.FLAGS.ITEM, flagData);\n\n    if (!this.hasSimilarItem(itemData) && !vaultExpander && !gridData?.freeSpaces) {\n      Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultFull\"), true)\n      return false;\n    }\n\n    return PrivateAPI._depositWithdrawItem({\n      source,\n      target,\n      itemData: {\n        item: itemData,\n        quantity: 1\n      },\n      gridPosition: { x, y }\n    });\n\n  }\n\n}\n\nexport class VaultItem extends PileItem {\n\n  setupStores(...args) {\n    super.setupStores(...args);\n    this.transform = writable({\n      x: 0, y: 0, w: 1, h: 1\n    });\n    this.x = 0;\n    this.y = 0;\n    this.style = writable({});\n  }\n\n  setupSubscriptions() {\n    super.setupSubscriptions();\n    let setup = false;\n    this.subscribeTo(this.itemDocument, () => {\n      let rarityColor = get(this.rarityColor);\n      if (rarityColor) {\n        this.style.set({ \"box-shadow\": `inset 0px 0px 7px 0px ${rarityColor}` });\n      } else {\n        this.style.set(SYSTEMS.DATA?.VAULT_STYLES ? SYSTEMS.DATA?.VAULT_STYLES.filter(style => {\n          return getProperty(this.item, style.path) === style.value;\n        }).reduce((acc, style) => {\n          return foundry.utils.mergeObject(acc, style.styling);\n        }, {}) : {});\n      }\n    });\n    this.subscribeTo(this.itemFlagData, (data) => {\n      if (setup) {\n        helpers.debug(\"itemFlagData\", data);\n      }\n      this.transform.set({\n        x: data.x, y: data.y, w: data.width ?? 1, h: data.height ?? 1\n      });\n    });\n    this.subscribeTo(this.transform, (transform) => {\n      if (setup) {\n        helpers.debug(\"transform\", transform);\n      }\n      this.x = transform.x;\n      this.y = transform.y;\n    });\n    this.subscribeTo(this.quantity, () => {\n      const itemFlagData = get(this.itemFlagData);\n      if (!itemFlagData.vaultExpander) return;\n      this.store.refreshFreeSpaces();\n      this.store.refreshGridDebounce();\n    })\n    setup = true;\n  }\n\n  async take() {\n\n    const pileData = get(this.store.pileData);\n    const itemFlagData = get(this.itemFlagData);\n\n    if (pileData.vaultExpansion && itemFlagData.vaultExpander) {\n      const slotsLeft = this.store.canItemsFitWithout(this);\n      if (slotsLeft < 0) {\n        return TJSDialog.prompt({\n          title: \"Item Piles\", content: {\n            class: CustomDialog, props: {\n              header: game.i18n.localize(\"ITEM-PILES.Dialogs.CantRemoveVaultExpander.Title\"),\n              content: game.i18n.format(\"ITEM-PILES.Dialogs.CantRemoveVaultExpander.Content\", {\n                num_items: Math.abs(slotsLeft)\n              })\n            }\n          },\n          modal: true\n        });\n      }\n    }\n\n    let quantity = get(this.quantity);\n    if (quantity > 1) {\n      quantity = await DropItemDialog.show(this.item, this.store.actor, {\n        localizationTitle: \"WithdrawItem\"\n      });\n    }\n    return game.itempiles.API.transferItems(this.store.actor, this.store.recipient, [{\n      _id: this.id,\n      quantity\n    }], { interactionId: this.store.interactionId });\n  }\n\n  async split(x, y) {\n\n    let quantity = await DropItemDialog.show(this.item, this.store.actor, {\n      localizationTitle: \"SplitItem\",\n      quantityAdjustment: -1\n    });\n\n    await game.itempiles.API.removeItems(this.store.actor, [{\n      _id: this.id,\n      quantity\n    }], { interactionId: this.store.interactionId });\n\n    const itemData = this.item.toObject();\n\n    const flagData = PileUtilities.getItemFlagData(this.item);\n    setProperty(flagData, \"x\", x);\n    setProperty(flagData, \"y\", y);\n    setProperty(itemData, CONSTANTS.FLAGS.ITEM, flagData);\n\n    await game.itempiles.API.addItems(this.store.actor, [{\n      item: itemData,\n      quantity\n    }], { interactionId: this.store.interactionId });\n\n  }\n\n  async merge(itemToMerge) {\n\n    const itemDelta = await game.itempiles.API.removeItems(this.store.actor, [{\n      _id: itemToMerge.id\n    }], {\n      interactionId: this.store.interactionId,\n      skipVaultLogging: true\n    });\n\n    return game.itempiles.API.addItems(this.store.actor, [{ id: this.id, quantity: Math.abs(itemDelta[0].quantity) }], {\n      interactionId: this.store.interactionId,\n      skipVaultLogging: true\n    })\n\n  }\n\n  areItemsSimilar(itemToCompare) {\n    return !Utilities.areItemsDifferent(this.item, itemToCompare.item)\n      && PileUtilities.canItemStack(itemToCompare.item, this.store.actor);\n  }\n\n}\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n\r\n  export let store;\r\n  export let item;\r\n\r\n  const name = item.name;\r\n  const img = item.img;\r\n  const quantity = item.quantity;\r\n  const itemFlagData = item.itemFlagData;\r\n  const pileData = store.pileData;\r\n\r\n  const editQuantities = store.editQuantities;\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow item-piles-item-row item-piles-even-color\">\r\n\r\n\t<div class=\"item-piles-img-container\">\r\n\t\t<img class=\"item-piles-img\" src=\"{$img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t<p>{$name}</p>\r\n\t\t\t{#if !$editQuantities && item.canStack}\r\n\t\t\t\t<span class=\"item-piles-small-text\">(x{$quantity})</span>\r\n\t\t\t{/if}\r\n\t\t\t<span class=\"item-piles-small-text\">\r\n        {($itemFlagData.addsCols ? localize(\"ITEM-PILES.Vault.ExpandsCols\", { cols: $itemFlagData.addsCols }) : \"\")\r\n        + ($itemFlagData.addsCols && $itemFlagData.addsRows ? \", \" : \"\") +\r\n        ($itemFlagData.addsRows ? localize(\"ITEM-PILES.Vault.ExpandsRows\", { rows: $itemFlagData.addsRows }) : \"\")}\r\n      </span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if !$editQuantities}\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => { item.take() }}\r\n\t\t\tclass=\"item-piles-item-take-button\"\r\n\t\t\ttype=\"button\">\r\n\t\t\t{localize(\"ITEM-PILES.Inspect.Take\")}\r\n\t\t</button>\r\n\r\n\t{:else}\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => { item.remove() }}\r\n\t\t\tclass=\"item-piles-item-take-button\"\r\n\t\t\ttype=\"button\">\r\n\t\t\t{localize(\"Remove\")}\r\n\t\t</button>\r\n\r\n\t{/if}\r\n\t\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-item-row .item-piles-name {\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { get, writable } from \"svelte/store\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  let form;\r\n\r\n  export let data;\r\n  export let elementRoot;\r\n\r\n  const vaultAccessStore = writable(data);\r\n\r\n  const validUsers = Array.from(game.users).filter(user => !user.isGM);\r\n\r\n  const validActors = Array.from(game.actors).filter(actor => actor.hasPlayerOwner);\r\n\r\n  const validDocs = validUsers.concat(validActors).map(document => ({ uuid: document.uuid, document }));\r\n\r\n  $: validDocuments = validDocs.filter(document => !$vaultAccessStore.some(access => access.uuid === document.uuid))\r\n  $: validUuids = new Set(validDocuments.map(document => document.uuid));\r\n\r\n  function addAccess() {\r\n    if (!validDocuments.length) return\r\n    vaultAccessStore.update(value => {\r\n      value.push({\r\n        uuid: validDocuments[0].uuid,\r\n        document: validDocuments[0].document,\r\n        organize: true,\r\n        items: {\r\n          withdraw: true,\r\n          deposit: true\r\n        },\r\n        currencies: {\r\n          withdraw: true,\r\n          deposit: true\r\n        }\r\n      });\r\n      return value;\r\n    });\r\n  }\r\n\r\n  function removeAccess(index) {\r\n    vaultAccessStore.update(value => {\r\n      value.splice(index, 1)\r\n      return value;\r\n    })\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve?.(get(vaultAccessStore).map(access => {\r\n      delete access.document;\r\n      return access;\r\n    }));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  function preventDefault(event) {\r\n    event.preventDefault();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\r\n\t\t<p style=\"text-align: center;\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Explanation\")}\r\n\t\t</p>\r\n\r\n\t\t<div class=\"form-group item-pile-access-grid\">\r\n\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t<div style=\"text-align: left;\">\r\n\t\t\t\t\t<span>Player/Character</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>Organize Items</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>Items</span>\r\n\t\t\t\t\t<div><i>Withdraw</i> | <i>Deposit</i></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>Currencies</span>\r\n\t\t\t\t\t<div><i>Withdraw</i> | <i>Deposit</i></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<a on:click={() => addAccess()} style=\"margin-right: 0.5rem;\">\r\n\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#each $vaultAccessStore as access, index (access.uuid)}\r\n\t\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<select bind:value={access.uuid}>\r\n\t\t\t\t\t\t\t{#each validDocs as document (document.uuid)}\r\n\t\t\t\t\t\t\t\t{#if access.uuid === document.uuid || validUuids.has(document.uuid)}\r\n\t\t\t\t\t\t\t\t\t<option value={document.uuid}>{document.document.name}</option>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.organize}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.items.withdraw}>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.items.deposit}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.currencies.withdraw}>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.currencies.deposit}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a on:click={() => removeAccess(index)} class=\"item-piles-clickable-red\" style=\"margin-right: 0.5rem;\">\r\n\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t<footer class=\"item-piles-top-divider\">\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-pile-access-grid {\r\n    display: grid;\r\n    grid-template-columns: 1.5fr 1fr 1fr 1fr auto;\r\n    gap: 4px;\r\n\r\n    select {\r\n      width: 100%;\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper {\r\n      display: contents;\r\n      border-bottom: 1px solid rgba(0, 0, 0, 0.5);\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper:first-of-type {\r\n      > div {\r\n        margin-bottom: 0.25rem;\r\n        text-align: center;\r\n\r\n        > div {\r\n          font-size: 0.75rem;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import VaultAccessEditorShell from './vault-access-editor-shell.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class VaultAccessEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: \"ITEM-PILES.Applications.VaultAccessEditor.Title\",\r\n      width: 600,\r\n      svelte: {\r\n        class: VaultAccessEditorShell\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import VaultAccessEditor from \"../../editors/vault-access-editor/vault-access-editor.js\";\r\n  import { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\n  import CustomDialog from \"../../components/CustomDialog.svelte\";\r\n  import * as PileUtilities from \"../../../helpers/pile-utilities.js\";\r\n  import CONSTANTS from \"../../../constants/constants.js\";\r\n\r\n  export let pileData;\r\n  export let pileActor;\r\n\r\n  async function showVaultAccessEditor() {\r\n    const data = pileData.vaultAccess || [];\r\n    return VaultAccessEditor.show(data, {\r\n      id: `vault-access-editor-item-pile-config-${pileActor.id}`,\r\n      title: localize(\"ITEM-PILES.Applications.VaultAccessEditor.Title\", { actor_name: pileActor.name }),\r\n    }).then((result) => {\r\n      pileData.vaultAccess = result || [];\r\n    });\r\n  }\r\n\r\n  async function clearVaultLog() {\r\n    const doThing = await TJSDialog.confirm({\r\n      id: `sharing-dialog-item-pile-config-${pileActor.id}`,\r\n      title: \"Item Piles - \" + localize(\"ITEM-PILES.Dialogs.ClearVaultLog.Title\"),\r\n      content: {\r\n        class: CustomDialog,\r\n        props: {\r\n          header: localize(\"ITEM-PILES.Dialogs.ClearVaultLog.Title\"),\r\n          content: localize(\"ITEM-PILES.Dialogs.ClearVaultLog.Content\", { actor_name: pileActor.name })\r\n        },\r\n      },\r\n      modal: true\r\n    });\r\n    if (!doThing) return;\r\n    return PileUtilities.clearVaultLog(pileActor);\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:6;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Layout\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LayoutExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Columns\")}</i>\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Rows\")}</i>\r\n\t\t</div>\r\n\t\t<div style=\"align-items: center;\">\r\n\t\t\t<input style=\"text-align: right;\" type=\"number\" placeholder=\"Enter a number...\" bind:value={pileData.cols}/>\r\n\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t<input type=\"number\" placeholder=\"Enter a number...\" bind:value={pileData.rows}/>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.CanStackItems\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.CanStackItemsExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.canStackItems}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.EnableExpansion\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.EnableExpansionExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.vaultExpansion}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:6;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.BaseExpansion\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.BaseExpansionExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Columns\")}</i>\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Rows\")}</i>\r\n\t\t</div>\r\n\t\t<div style=\"align-items: center;\">\r\n\t\t\t<input disabled={!pileData.vaultExpansion} style=\"text-align: right;\" type=\"number\"\r\n\t\t\t\t\t\t placeholder=\"Enter a number...\" bind:value={pileData.baseExpansionCols}/>\r\n\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t<input disabled={!pileData.vaultExpansion} type=\"number\" placeholder=\"Enter a number...\"\r\n\t\t\t\t\t\t bind:value={pileData.baseExpansionRows}/>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Access\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.AccessExplanation\")}</p>\r\n\t</label>\r\n\t<button style=\"flex:2;\" type=\"button\" on:click={() => showVaultAccessEditor()}>\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ManageAccess\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LogVaultAccess\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LogVaultAccessExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.logVaultActions}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ClearVaultLog\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ClearVaultLogExplanation\")}</p>\r\n\t</label>\r\n\t<button style=\"flex:2;\" type=\"button\" on:click={() => clearVaultLog()}>\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ClearVaultLog\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormat\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<select bind:value={pileData.vaultLogType}>\r\n\t\t<option value={CONSTANTS.VAULT_LOGGING_TYPES.USER_ACTOR}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatUserActor\")}\r\n\t\t</option>\r\n\t\t<option value={CONSTANTS.VAULT_LOGGING_TYPES.USER}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatUser\")}\r\n\t\t</option>\r\n\t\t<option value={CONSTANTS.VAULT_LOGGING_TYPES.ACTOR}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatActor\")}\r\n\t\t</option>\r\n\t</select>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  .item-piles-grid-columns {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    & > div {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n\r\n      & > * {\r\n        flex: 1;\r\n        margin: 0 0.25rem;\r\n      }\r\n\r\n      & > span {\r\n        flex: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\r\n  import { current_component } from 'svelte/internal';\r\n  import { styleFromObject } from \"../../../helpers/helpers.js\";\r\n\r\n  export let position;\r\n  export let zIndex;\r\n  export let style;\r\n  export let component;\r\n  export let componentData;\r\n  const local = current_component;\r\n\r\n  $: elementStyle = styleFromObject({\r\n    \"left\": $position.x + \"px\",\r\n    \"top\": $position.y + \"px\",\r\n    \"z-index\": zIndex,\r\n    ...style\r\n  });\r\n\r\n</script>\r\n\r\n\r\n<div class=\"item-piles-floting-element\" style={elementStyle}>\r\n\t<svelte:component this={component} {...componentData}/>\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-floting-element {\r\n    position: fixed;\r\n    pointer-events: none;\r\n    color: red;\r\n  }\r\n\r\n</style>\r\n\r\n","import FloatingElementImpl from \"./FloatingElementImpl.svelte\";\r\nimport { writable } from \"svelte/store\";\r\n\r\nexport class FloatingElement {\r\n\r\n  static id = void 0;\r\n  static element = void 0;\r\n  static positionStore = writable(false);\r\n\r\n  static create({ id, x, y, zIndex = Number.MAX_SAFE_INTEGER - 100, style = {}, component, componentData } = {}) {\r\n\r\n    if (this.element) return this.element;\r\n\r\n    this.positionStore.set({ x, y })\r\n    this.id = id;\r\n\r\n    this.element = new FloatingElementImpl({\r\n      target: document.body,\r\n      props: {\r\n        position: this.positionStore,\r\n        zIndex,\r\n        style,\r\n        component,\r\n        componentData\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n  static destroy() {\r\n    this.element.$destroy();\r\n    this.element = void 0;\r\n    this.id = void 0;\r\n    this.positionStore.set(false);\r\n  }\r\n\r\n\r\n}\r\n","<script>\r\n  import CONSTANTS from '../../constants/constants.js';\r\n\r\n  import { getContext, onDestroy } from 'svelte';\r\n  import { fade } from 'svelte/transition';\r\n  import { ApplicationShell } from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n  import { TJSContextMenu } from \"@typhonjs-fvtt/svelte-standard/application\";\r\n  import { get, writable } from 'svelte/store';\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  import ItemPileInventoryApp from \"../item-pile-inventory-app/item-pile-inventory-app.js\";\r\n  import VaultApp from \"./vault-app.js\";\r\n\r\n  import Grid from '../components/Grid/Grid.svelte';\r\n  import CurrencyList from '../components/CurrencyList.svelte';\r\n  import DropZone from '../components/DropZone.svelte';\r\n  import VaultItemEntry from './VaultItemEntry.svelte';\r\n\r\n  import { snapOnMove } from '../components/Grid/grid-utils';\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import { isCoordinateWithinPosition } from \"../../helpers/helpers.js\";\r\n\r\n  import { VaultStore } from \"../../stores/vault-store.js\";\r\n  import Tabs from \"../components/Tabs.svelte\";\r\n  import VaultExpanderEntry from \"./VaultExpanderEntry.svelte\";\r\n  import vault from \"../item-pile-config/settings/vault.svelte\";\r\n  import { FloatingElement } from \"../components/FloatingElement/FloatingElement.js\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  export let actor;\r\n  export let recipient;\r\n\r\n  export let store = VaultStore.make(application, actor, recipient);\r\n\r\n  const currencies = store.allCurrencies;\r\n  const pileDataStore = store.pileData;\r\n  const gridDataStore = store.gridData;\r\n  const gridItems = store.gridItems;\r\n  const vaultExpanderItems = store.vaultExpanderItems;\r\n  const searchStore = store.search;\r\n  const logSearchStore = store.logSearch;\r\n  const vaultLog = store.vaultLog;\r\n  const visibleLogItems = store.visibleLogItems;\r\n  const recipientDocument = store.recipientDocument;\r\n  const numCurrencies = store.numCurrencies;\r\n  const dragPositionStore = store.dragPosition;\r\n\r\n  $: pileData = $pileDataStore;\r\n  $: gridData = $gridDataStore;\r\n\r\n  const floatingElementPositionStore = FloatingElement.positionStore;\r\n  let element;\r\n\r\n  function onDragOverEvent(event) {\r\n    onDragOver(event.clientX, event.clientY);\r\n  }\r\n\r\n  $: {\r\n    if ($floatingElementPositionStore) {\r\n      onDragOver($floatingElementPositionStore?.x + 20, $floatingElementPositionStore?.y + 20);\r\n    } else {\r\n      onDragLeave();\r\n    }\r\n  }\r\n\r\n  async function onDragOver(clientX, clientY) {\r\n    const rect = element.getBoundingClientRect();\r\n    if (FloatingElement.id === application.id || !isCoordinateWithinPosition(clientX, clientY, rect)) {\r\n      return onDragLeave();\r\n    }\r\n    const x = (clientX - rect.left) - (gridData.gridSize / 2); //x position within the element.\r\n    const y = (clientY - rect.top) - (gridData.gridSize / 2);  //y position within the element.\r\n    dragPositionStore.set({\r\n      ...snapOnMove(x, y, { w: 1, h: 1 }, { ...gridData }),\r\n      w: 1,\r\n      h: 1,\r\n      active: true\r\n    });\r\n  }\r\n\r\n  async function onDragLeave() {\r\n    dragPositionStore.set({ x: 0, y: 0, w: 1, h: 1, active: false, });\r\n  }\r\n\r\n  onDestroy(() => {\r\n    store.onDestroy();\r\n  });\r\n\r\n  function doubleClickItem(event) {\r\n    if (!gridData.canWithdrawItems) return;\r\n    event.detail.item.item.take();\r\n  }\r\n\r\n  function rightClickItem(event) {\r\n    setTimeout(() => {\r\n\r\n      const contextMenu = []\r\n\r\n      if (gridData.canWithdrawItems) {\r\n        contextMenu.push({\r\n          icon: 'fas fa-hand', label: \"Take\", onPress: () => {\r\n            event.detail.item.item.take();\r\n          }\r\n        });\r\n      }\r\n\r\n      const quantity = get(event.detail.item.item.quantity);\r\n      const freeSpacesAfterSplit = gridData.freeSpaces;\r\n\r\n      if ((gridData.canDepositItems || game.user.isGM) && event.detail.item.item.canStack && quantity > 1 && freeSpacesAfterSplit) {\r\n        contextMenu.push({\r\n          icon: 'fas fa-object-ungroup', label: \"Split\", onPress: () => {\r\n            beginSplitItem(event)\r\n          }\r\n        });\r\n      }\r\n\r\n      if (pileData.canInspectItems || game.user.isGM) {\r\n        contextMenu.push({\r\n          icon: 'fas fa-eye', label: \"Inspect\", onPress: () => {\r\n            event.detail.item.item.preview();\r\n          }\r\n        });\r\n      }\r\n\r\n      Hooks.call(CONSTANTS.HOOKS.PILE.PRE_RIGHT_CLICK_ITEM, event.detail.item.item.item, contextMenu, actor, store.recipient);\r\n\r\n      if (!contextMenu.length) return;\r\n\r\n      TJSContextMenu.create({\r\n        x: event.detail.x,\r\n        y: event.detail.y,\r\n        zIndex: 1000000000000,\r\n        transitionOptions: { duration: 0 },\r\n        items: contextMenu\r\n      })\r\n    })\r\n  }\r\n\r\n  function beginSplitItem(event) {\r\n\r\n    const { item, splitStart, x, y } = event.detail;\r\n\r\n    FloatingElement.create({\r\n      id: application.id,\r\n      x,\r\n      y,\r\n      style: {\r\n        width: gridData.gridSize + \"px\",\r\n        height: gridData.gridSize + \"px\",\r\n        opacity: 0.7,\r\n      },\r\n      component: VaultItemEntry,\r\n      componentData: { entry: item }\r\n    });\r\n\r\n    splitStart({\r\n      pageX: x,\r\n      pageY: y,\r\n      offsetX: Math.floor(gridData.gridSize / 2),\r\n      offsetY: Math.floor(gridData.gridSize / 2)\r\n    });\r\n\r\n  }\r\n\r\n  function itemBeginDrag(event) {\r\n    const { x, y, item } = event.detail;\r\n    FloatingElement.create({\r\n      id: application.id,\r\n      x,\r\n      y,\r\n      style: {\r\n        width: gridData.gridSize + \"px\",\r\n        height: gridData.gridSize + \"px\",\r\n        opacity: 0.7,\r\n      },\r\n      component: VaultItemEntry,\r\n      componentData: { entry: item }\r\n    })\r\n  }\r\n\r\n  function itemStopDrag(event) {\r\n\r\n    if (!FloatingElement.id) return;\r\n\r\n    FloatingElement.destroy();\r\n\r\n    if (event.detail.cancelled) return;\r\n\r\n    const { item, outOfBounds, x, y, gridX, gridY, splitting } = event.detail;\r\n\r\n    if (splitting) {\r\n      if (outOfBounds) return;\r\n      item.item.split(gridX, gridY);\r\n      return;\r\n    }\r\n\r\n    if (!outOfBounds) return;\r\n\r\n    const hitApps = Object.values(ui.windows)\r\n      .sort((a, b) => b.position.zIndex - a.position.zIndex)\r\n      .filter(app => {\r\n        return (app instanceof ActorSheet || app instanceof ItemPileInventoryApp || app instanceof VaultApp)\r\n          && isCoordinateWithinPosition(x, y, app.element[0].getBoundingClientRect());\r\n      });\r\n\r\n    let dropData = {\r\n      type: \"Item\",\r\n      uuid: item.item.item.uuid\r\n    }\r\n\r\n    if (hitApps.length) {\r\n      if (hitApps[0] === application) return;\r\n      dropData.target = hitApps[0].actor;\r\n      if (hitApps[0] instanceof VaultApp) {\r\n        return hitApps[0].store.onDropData(dropData);\r\n      }\r\n    } else {\r\n      const mouse = canvas.app.renderer.plugins.interaction.mouse;\r\n      const position = mouse.getLocalPosition(canvas.app.stage);\r\n      dropData.x = position.x;\r\n      dropData.y = position.y;\r\n    }\r\n\r\n    Hooks.call(\"dropCanvasData\", canvas, dropData);\r\n\r\n  }\r\n\r\n  function itemMove(event) {\r\n    const { x, y } = event.detail;\r\n    if (!FloatingElement.id) return;\r\n    FloatingElement.positionStore.set({ x, y });\r\n  }\r\n\r\n  let activeTab = writable(\"vault\");\r\n\r\n  const applicationHeight = application.position.stores.height;\r\n  const applicationWidth = application.position.stores.width;\r\n  const applicationLeft = application.position.stores.left;\r\n  const defaultWidth = get(application.position.stores.width);\r\n\r\n  $: {\r\n    if ($activeTab === \"vault\" && $applicationWidth) {\r\n      application.position.stores.width.set(defaultWidth);\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<main bind:this={store.mainContainer} class=\"item-piles-flexcol\" in:fade={{duration: 500}}>\r\n\r\n\t\t{#if gridData.fullAccess && (pileData.vaultExpansion || pileData.logVaultActions)}\r\n\t\t\t<Tabs bind:activeTab={$activeTab} tabs={[\r\n        {\r\n          value: \"vault\",\r\n          label: \"ITEM-PILES.Vault.VaultTab\",\r\n          icon: \"fas fa-vault\",\r\n        },\r\n        {\r\n          value: \"expanders\",\r\n          label: \"ITEM-PILES.Vault.ExpandersTab\",\r\n          icon: \"fas fa-maximize\",\r\n          hidden: !pileData.vaultExpansion || !gridData.fullAccess\r\n        },\r\n        {\r\n          value: \"log\",\r\n          label: \"ITEM-PILES.Vault.LogTab\",\r\n          icon: \"fas fa-note-sticky\",\r\n          hidden: !pileData.logVaultActions || !gridData.fullAccess\r\n        }\r\n      ]} style=\"flex: 0 1 auto; margin-bottom: 0.5rem; padding-bottom: 0.5rem;\"/>\r\n\t\t{/if}\r\n\r\n\t\t{#if $activeTab === \"vault\"}\r\n\r\n\t\t\t<div class=\"form-group item-piles-flexrow item-piles-bottom-divider\"\r\n\t\t\t\t\t style=\"margin: 0.25rem 0; align-items: center; flex: 0 1 auto;\">\r\n\t\t\t\t<label style=\"flex:0 1 auto; margin-right: 5px;\">Search:</label>\r\n\t\t\t\t<input type=\"text\" bind:value={$searchStore}>\r\n\t\t\t</div>\r\n\r\n\t\t\t<DropZone callback={(data) => store.onDropData(data)} overCallback={onDragOverEvent} leaveCallback={onDragLeave}\r\n\t\t\t\t\t\t\t\tstyle=\"display: flex; flex: 1; justify-content: center; align-items: center;\">\r\n\r\n\t\t\t\t<Grid bind:items={$gridItems}\r\n\t\t\t\t\t\t\tbind:gridContainer={element}\r\n\t\t\t\t\t\t\toptions={{\r\n              ...gridData,\r\n              class: \"item-piles-grid-background\",\r\n              activeClass: \"item-piles-grid-item-active\",\r\n              previewClass: \"item-piles-grid-item-preview\",\r\n              collisionClass: \"item-piles-grid-item-collision\",\r\n              hoverClass: \"item-piles-grid-item-hover\",\r\n              highlightClass: \"item-piles-grid-item-highlight\",\r\n              dimClass: \"item-piles-grid-item-dim\",\r\n              backgroundGrid: true,\r\n              highlightItems: !!$searchStore\r\n            }}\r\n\t\t\t\t\t\t\tdropGhost={$dragPositionStore}\r\n\t\t\t\t\t\t\ton:change={(event) => store.updateGrid(event.detail.items)}\r\n\t\t\t\t\t\t\ton:itembegindrag={itemBeginDrag}\r\n\t\t\t\t\t\t\ton:itemstopdrag={itemStopDrag}\r\n\t\t\t\t\t\t\ton:itemmove={itemMove}\r\n\t\t\t\t\t\t\ton:rightclick={rightClickItem}\r\n\t\t\t\t\t\t\ton:doubleclick={doubleClickItem}\r\n\t\t\t\t\t\t\tlet:item\r\n\t\t\t\t>\r\n\t\t\t\t\t<VaultItemEntry entry={item}/>\r\n\t\t\t\t</Grid>\r\n\r\n\t\t\t</DropZone>\r\n\r\n\t\t\t{#if $recipientDocument?.name}\r\n\t\t\t\t<div class=\"item-piles-flexrow item-piles-top-divider\" style=\"flex: 0 1 auto; align-items: center;\">\r\n          <span>\r\n            <a on:click={() => {\r\n              const [appPosition, actorPosition] = Helpers.getApplicationPositions(application, store.recipient.sheet);\r\n              application.position.stores.left.set(appPosition.left);\r\n              application.position.stores.top.set(appPosition.top);\r\n              store.recipient.sheet.render(true, actorPosition);\r\n            }}>\r\n              <i class=\"fa-solid fa-suitcase\"></i>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Vault.ViewingAs\", { actor_name: $recipientDocument.name })}\r\n            </a>\r\n          </span>\r\n\t\t\t\t\t{#if gridData.canDepositCurrencies || gridData.canWithdrawCurrencies}\r\n\t\t\t\t\t\t<div style=\"flex:0 1 auto; justify-self: flex-end; display: flex; justify-content: flex-end;\">\r\n\t\t\t\t\t\t\t{#if gridData.canWithdrawCurrencies}\r\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"item-piles-small-button\" on:click={() => store.withdrawCurrency()}>\r\n\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Vault.Withdraw\")}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{#if gridData.canDepositCurrencies}\r\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"item-piles-small-button\" on:click={() => store.depositCurrency()}>\r\n\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Vault.Deposit\")}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<div class=\"item-piles-flexrow\" style=\"margin-top: 0.25rem; flex:0 1 auto;\">\r\n\r\n\t\t\t\t<CurrencyList {currencies}\r\n\t\t\t\t\t\t\t\t\t\t\toptions={{ abbreviations: false, imgSize: 18, abbreviateNumbers: true }}\r\n\t\t\t\t\t\t\t\t\t\t\tstyle=\"align-items: center;\">\r\n\t\t\t\t\t{#if gridData.canEditCurrencies}\r\n\t\t\t\t\t\t<a style=\"order: 100; display:flex; flex: 0; margin-left: 0.25rem;\" on:click={() => store.addCurrency()}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-cog\"></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</CurrencyList>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t{/if}\r\n\r\n\t\t{#if $activeTab === \"expanders\"}\r\n\r\n\t\t\t<DropZone callback={(data, event) => { store.onDropData(data, event, true) }}\r\n\t\t\t\t\t\t\t\tstyle=\"display: flex; flex-direction: column; flex:1;\">\r\n\r\n\t\t\t\t<div style=\"text-align: center;\" class=\"item-piles-bottom-divider\">\r\n\t\t\t\t\t{@html localize(\"ITEM-PILES.Vault.\" + (\r\n            gridData.totalSpaces === gridData.enabledSpaces\r\n              ? \"CapacityFull\"\r\n              : (gridData.enabledSpaces ? \"CapacityLeft\" : \"NeedsCapacity\")), {\r\n            total_capacity: `<strong>${gridData.totalSpaces}</strong>`,\r\n            capacity: `<strong>${gridData.enabledSpaces}</strong>`,\r\n          })}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"item-piles-items-list\">\r\n\r\n\t\t\t\t\t{#each $vaultExpanderItems as item (item.id)}\r\n\t\t\t\t\t\t<VaultExpanderEntry {store} bind:item={item}/>\r\n\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{#if !$vaultExpanderItems.length}\r\n\t\t\t\t\t<div style=\"flex: 1 0 auto; display: flex; align-items: center; place-content: center;\">\r\n\t\t\t\t\t\t<i>Drag and drop items to expand spaces</i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</DropZone>\r\n\r\n\t\t{/if}\r\n\r\n\t\t{#if $activeTab === \"log\"}\r\n\r\n\t\t\t<div class=\"form-group item-piles-flexrow item-piles-bottom-divider\"\r\n\t\t\t\t\t style=\"margin: 0.25rem 0; align-items: center; flex: 0 1 auto;\">\r\n\t\t\t\t<label style=\"flex:0 1 auto; margin-right: 5px;\">Log search:</label>\r\n\t\t\t\t<input type=\"text\" bind:value={$logSearchStore}>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"item-piles-vault-log\"\r\n\t\t\t\t\t style=\"max-height: {$applicationHeight-130}px; overflow-y: scroll; font-size: 0.75rem; padding-right: 0.5rem;\">\r\n\r\n\t\t\t\t{#each $vaultLog.slice(0, $visibleLogItems).filter(log => log.visible) as log, index (index)}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass:item-piles-log-deposit={log.action === \"deposited\" || (!log.action && log.qty > 0)}\r\n\t\t\t\t\t\tclass:item-piles-log-withdrawal={log.action === \"withdrew\" || (!log.action && log.qty < 0)}\r\n\t\t\t\t\t\tclass:item-piles-log-other={log.action && log.action !== \"deposited\" && log.action !== \"withdrew\"}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{@html log.text} - {Helpers.timeSince(log.date)} ago\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/each}\r\n\r\n\t\t\t\t{#if $vaultLog.length > $visibleLogItems}\r\n\t\t\t\t\t<div class=\"item-piles-top-divider\" style=\"text-align: center;\">\r\n\t\t\t\t\t\t<a on:click={() => { $visibleLogItems += 20; }}><i>Load more transactions ({$visibleLogItems}\r\n\t\t\t\t\t\t\t/ {$vaultLog.length})...</i></a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\r\n\t\t{/if}\r\n\r\n\t</main>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  main {\r\n    z-index: 0;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport VaultShell from \"./vault-shell.svelte\";\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\nimport ItemPileConfig from \"../item-pile-config/item-pile-config.js\";\r\nimport * as Helpers from \"../../helpers/helpers.js\";\r\nimport UserSelectDialog from \"../dialogs/user-select-dialog/user-select-dialog.js\";\r\nimport SETTINGS from \"../../constants/settings.js\";\r\nimport CONSTANTS from \"../../constants/constants.js\";\r\n\r\nexport default class VaultApp extends SvelteApplication {\r\n\r\n  /**\r\n   *\r\n   * @param actor\r\n   * @param recipient\r\n   * @param options\r\n   * @param dialogData\r\n   */\r\n  constructor(actor, recipient, options = {}, dialogData = {}) {\r\n    super({\r\n      id: `item-pile-vault-${actor?.token?.id ?? actor.id}-${randomID()}`,\r\n      title: actor.name,\r\n      svelte: {\r\n        class: VaultShell,\r\n        target: document.body,\r\n        props: {\r\n          actor,\r\n          recipient\r\n        }\r\n      },\r\n      zIndex: 100,\r\n      ...options\r\n    }, dialogData);\r\n\r\n    this.actor = actor;\r\n    this.recipient = recipient;\r\n\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.OPEN_INTERFACE, this, actor, recipient, options, dialogData);\r\n\r\n  }\r\n\r\n  get store() {\r\n    return this.svelte.applicationShell.store;\r\n  }\r\n\r\n  /** @inheritdoc */\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      closeOnSubmit: false,\r\n      classes: [\"app\", \"window-app\", \"sheet\", \"item-pile-vault\", \"item-piles\", \"item-piles-app\"],\r\n      resizable: false\r\n    });\r\n  }\r\n\r\n  static getActiveApps(id = \"\") {\r\n    return Helpers.getActiveApps(`item-pile-vault-${id}`);\r\n  }\r\n\r\n  static async show(source, recipient = false, options = {}, dialogData = {}) {\r\n    source = Utilities.getActor(source);\r\n    recipient = Utilities.getActor(recipient);\r\n    const result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_OPEN_INTERFACE, source, recipient, options, dialogData);\r\n    if (result === false) return;\r\n    const apps = this.getActiveApps(source?.token?.id ?? source.id);\r\n    if (apps.length) {\r\n      for (let app of apps) {\r\n        app.render(false, { focus: true });\r\n      }\r\n      return;\r\n    }\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(source, recipient, options, dialogData).render(true, { focus: true });\r\n    })\r\n  }\r\n\r\n  async close(options) {\r\n    const result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n    if (result === false) return;\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n    return super.close(options);\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  _getHeaderButtons() {\r\n    let buttons = super._getHeaderButtons();\r\n    const canConfigure = game.user.isGM;\r\n    if (canConfigure) {\r\n      buttons = [\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.Inspect.OpenSheet\" : \"\",\r\n          class: \"item-piles-open-actor-sheet\",\r\n          icon: \"fas fa-user\",\r\n          onclick: () => {\r\n            this.actor.sheet.render(true, { focus: true, bypassItemPiles: true });\r\n          }\r\n        },\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.ContextMenu.ShowToPlayers\" : \"\",\r\n          class: \"item-piles-show-to-players\",\r\n          icon: \"fas fa-eye\",\r\n          onclick: async (event) => {\r\n            const activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n            if (!activeUsers.length) {\r\n              return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n            }\r\n            const users = event.altKey ? activeUsers : await UserSelectDialog.show({ excludeSelf: true });\r\n            if (!users || !users.length) return;\r\n            Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: this.actor.name }))\r\n            return game.itempiles.API.renderItemPileInterface(this.actor, {\r\n              userIds: users,\r\n              useDefaultCharacter: true\r\n            });\r\n          }\r\n        },\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.HUD.Configure\" : \"\",\r\n          class: \"item-piles-configure-pile\",\r\n          icon: \"fas fa-box-open\",\r\n          onclick: () => {\r\n            ItemPileConfig.show(this.actor);\r\n          }\r\n        },\r\n      ].concat(buttons);\r\n    }\r\n    return buttons\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import { SecondaryCurrenciesEditor, CurrenciesEditor } from \"../../editors/currencies-editor/currencies-editor.js\";\r\n  import ItemFiltersEditor from \"../../editors/item-filters-editor/item-filters-editor.js\";\r\n  import MacroSelector from \"../../components/MacroSelector.svelte\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import * as Helpers from \"../../../helpers/helpers.js\";\r\n  import SETTINGS from \"../../../constants/settings.js\";\r\n  import TextEditorDialog from \"../../dialogs/text-editor-dialog/text-editor-dialog.js\";\r\n  import { writable } from \"svelte/store\";\r\n\r\n  export let pileActor;\r\n  export let pileData;\r\n  export let pileEnabled;\r\n\r\n  const deleteWhenEmptySetting = localize(Helpers.getSetting(SETTINGS.DELETE_EMPTY_PILES) ? \"Yes\" : \"No\");\r\n\r\n  let hasOverrideCurrencies = writable(typeof pileData?.overrideCurrencies === \"object\");\r\n  let hasOverrideSecondaryCurrencies = writable(typeof pileData?.overrideSecondaryCurrencies === \"object\");\r\n  let hasOverrideItemFilters = writable(typeof pileData?.overrideItemFilters === \"object\");\r\n\r\n  $: {\r\n    if (!$hasOverrideCurrencies) {\r\n      pileData.overrideCurrencies = false;\r\n    }\r\n  }\r\n  $: {\r\n    if (!$hasOverrideSecondaryCurrencies) {\r\n      pileData.overrideSecondaryCurrencies = false;\r\n    }\r\n  }\r\n  $: {\r\n    if (!$hasOverrideItemFilters) {\r\n      pileData.overrideItemFilters = false;\r\n    }\r\n  }\r\n\r\n  async function showCurrenciesEditor() {\r\n    pileData.overrideCurrencies = pileData?.overrideCurrencies || game.itempiles.API.CURRENCIES;\r\n    return CurrenciesEditor.show(\r\n      pileData.overrideCurrencies,\r\n      { id: `currencies-item-pile-config-${pileActor.id}` },\r\n      { title: game.i18n.format(\"ITEM-PILES.Applications.CurrenciesEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n    ).then((result) => {\r\n      pileData.overrideCurrencies = result;\r\n    });\r\n  }\r\n\r\n  async function showSecondaryCurrenciesEditor() {\r\n    pileData.overrideSecondaryCurrencies = pileData?.overrideSecondaryCurrencies || game.itempiles.API.SECONDARY_CURRENCIES;\r\n    return SecondaryCurrenciesEditor.show(\r\n      pileData.overrideSecondaryCurrencies,\r\n      { id: `secondary-currencies-item-pile-config-${pileActor.id}` },\r\n      { title: game.i18n.format(\"ITEM-PILES.Applications.SecondaryCurrenciesEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n    ).then((result) => {\r\n      pileData.overrideSecondaryCurrencies = result;\r\n    });\r\n  }\r\n\r\n  async function showItemFiltersEditor() {\r\n    pileData.overrideItemFilters = pileData?.overrideItemFilters || game.itempiles.API.ITEM_FILTERS;\r\n    return ItemFiltersEditor.show(\r\n      pileData.overrideItemFilters,\r\n      { id: `item-filters-item-pile-config-${pileActor.id}` },\r\n      { title: game.i18n.format(\"ITEM-PILES.Applications.FilterEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n    ).then((result) => {\r\n      pileData.overrideItemFilters = result;\r\n    });\r\n  }\r\n\r\n  async function showDescriptionDialog() {\r\n    return TextEditorDialog.show(pileData.description, { id: \"item-pile-text-editor-\" + pileActor.id }).then((result) => {\r\n      pileData.description = result || \"\";\r\n    });\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EnabledPile\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EnabledPileExplanation\")}</p>\r\n\t</label>\r\n\r\n\t<span class=\"item-piles-flexrow\" style=\"max-width: 100px; justify-content: flex-end; align-items:center;\">\r\n          {#if !$pileEnabled}\r\n            <div style=\"flex:0 1 auto; margin-right: 1rem;\" class=\"blob\"><i class=\"fas fa-exclamation\"></i></div>\r\n          {/if}\r\n\t\t<span style=\"flex:0 1 auto;\"><input type=\"checkbox\" bind:checked={$pileEnabled}/></span>\r\n        </span>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.Distance\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.GridUnits\")}</p>\r\n\t</label>\r\n\t<input style=\"flex:4;\" type=\"number\" placeholder=\"Infinity\" bind:value={pileData.distance}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.InspectItems\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.InspectItemsExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.canInspectItems}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DisplayItemTypes\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DisplayItemTypesExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.displayItemTypes}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.Macro\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.MacroExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n<div class=\"form-group\">\r\n\t<MacroSelector bind:macro={pileData.macro}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmpty\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyExplanation\")}</p>\r\n\t</label>\r\n\t<select style=\"flex:4;\" bind:value={pileData.deleteWhenEmpty}>\r\n\t\t<option\r\n\t\t\tvalue=\"default\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyDefault\")}\r\n\t\t\t({localize(deleteWhenEmptySetting)})\r\n\t\t</option>\r\n\t\t<option value={true}>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyYes\")}</option>\r\n\t\t<option value={false}>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyNo\")}</option>\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescription\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescriptionExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n<div class=\"form-group\">\r\n\t<button type=\"button\" style=\"flex:4;\" on:click={() => { showDescriptionDialog() }}>\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescription\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideCurrencies\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideCurrenciesExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={$hasOverrideCurrencies}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button type=\"button\" on:click={() => { showCurrenciesEditor() }}\r\n\t\t\t\t\tdisabled={!$hasOverrideCurrencies} style=\"flex:4;\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureOverrideCurrencies\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideSecondaryCurrencies\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideSecondaryCurrenciesExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={$hasOverrideSecondaryCurrencies}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button type=\"button\" on:click={() => { showSecondaryCurrenciesEditor() }}\r\n\t\t\t\t\tdisabled={!$hasOverrideSecondaryCurrencies} style=\"flex:4;\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureOverrideSecondaryCurrencies\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideItemFilters\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideItemFiltersExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={$hasOverrideItemFilters}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button type=\"button\" on:click={() => { showItemFiltersEditor() }}\r\n\t\t\t\t\tdisabled={!$hasOverrideItemFilters} style=\"flex:4;\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureOverrideItemFilters\")}\r\n\t</button>\r\n</div>\r\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import SliderInput from \"../../components/SliderInput.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { get, writable } from \"svelte/store\";\r\n  import * as Helpers from \"../../../helpers/helpers.js\";\r\n  import SETTINGS from \"../../../constants/settings.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  export let data = [];\r\n\r\n  const itemTypePriceModifiers = writable(data);\r\n\r\n  let form;\r\n  let unusedTypes;\r\n  let systemTypes = Object.entries(CONFIG.Item.typeLabels);\r\n  let currentCustomCategories = Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES)));\r\n\r\n  $: {\r\n    const allTypes = systemTypes.map(([type]) => type).concat(currentCustomCategories).map(type => type.toLowerCase())\r\n    unusedTypes = allTypes.filter(type => {\r\n      return !$itemTypePriceModifiers.some(priceData => priceData.type === type || (priceData.type === \"custom\" && priceData.category === type))\r\n    });\r\n  }\r\n\r\n  function add() {\r\n    if (!unusedTypes.length) return;\r\n    itemTypePriceModifiers.update(val => {\r\n      val.push({\r\n        type: unusedTypes[0],\r\n        category: \"\",\r\n        override: false,\r\n        buyPriceModifier: 1,\r\n        sellPriceModifier: 0.5\r\n      });\r\n      return val;\r\n    })\r\n  }\r\n\r\n  function remove(index) {\r\n    itemTypePriceModifiers.update(val => {\r\n      val.splice(index, 1);\r\n      return val;\r\n    })\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve?.(get(itemTypePriceModifiers));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.Explanation\")}</p>\r\n\r\n\t\t<div>\r\n\r\n\t\t\t<table>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th style=\"width:5%;\">{localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.Override\")}</th>\r\n\t\t\t\t\t<th style=\"width:20%;\">{localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.ItemType\")}</th>\r\n\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</th>\r\n\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</th>\r\n\t\t\t\t\t<th style=\"width:5%;\">\r\n          <span class:item-piles-clickable-link={unusedTypes.length} on:click={add}>\r\n            <i class=\"fas fa-plus\"></i>\r\n          </span>\r\n\t\t\t\t\t</th>\r\n\t\t\t\t</tr>\r\n\t\t\t\t{#each $itemTypePriceModifiers as priceData, index (index)}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={priceData.override}>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t<select on:change={(e) => {\r\n\t\t\t\t\t\t\t\t\tpriceData.type = e.target.value;\r\n\t\t\t\t\t\t\t\t\tpriceData.category = e.target.value === \"custom\" ? e.target.options[e.target.selectedIndex].text.toLowerCase() : \"\";\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<optgroup label=\"System Types\">\r\n\t\t\t\t\t\t\t\t\t\t{#each systemTypes as [itemType, label] (itemType)}\r\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"{itemType}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{priceData.type === itemType}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled=\"{itemType !== priceData.type && !unusedTypes.includes(itemType)}\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localize(label)}\r\n\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t\t</optgroup>\r\n\t\t\t\t\t\t\t\t\t{#if currentCustomCategories.length}\r\n\t\t\t\t\t\t\t\t\t\t<optgroup label=\"Custom Categories\">\r\n\t\t\t\t\t\t\t\t\t\t\t{#each currentCustomCategories as customCategory}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"custom\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{priceData.type === 'custom' && customCategory.toLowerCase() === priceData.category.toLowerCase()}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled=\"{customCategory.toLowerCase() !== priceData.category.toLowerCase() && !unusedTypes.includes(customCategory.toLowerCase())}\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{customCategory}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t\t\t</optgroup>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t<SliderInput style=\"flex:4;\" bind:value={priceData.buyPriceModifier}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t<SliderInput style=\"flex:4;\" bind:value={priceData.sellPriceModifier}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t</table>\r\n\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .border-highlight {\r\n    padding: 1rem;\r\n    margin: 0.25rem;\r\n    border-radius: 10px;\r\n    border: 2px dashed gray;\r\n  }\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import ItemTypePriceModifiersShell from './item-type-price-modifiers-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class ItemTypePriceModifiersEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.Title\"),\r\n      width: 600,\r\n      svelte: {\r\n        class: ItemTypePriceModifiersShell,\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  export let value = \"\";\r\n  export let templateType;\r\n  export let required = false;\r\n\r\n  const id = \"property-list-\" + randomID();\r\n  const templates = foundry.utils.deepClone(game.system.template[templateType]);\r\n  const templateObject = {\r\n    name: \"\",\r\n    type: \"\",\r\n    system: templates.types\r\n      .map(type => {\r\n        let obj = templates[type];\r\n        if (obj['templates']) {\r\n          for (const template of obj['templates']) {\r\n            obj = foundry.utils.mergeObject(obj, templates[\"templates\"][template]);\r\n          }\r\n          delete obj['templates'];\r\n        }\r\n        return obj;\r\n      })\r\n      .reduce((acc, obj) => {\r\n        return foundry.utils.mergeObject(acc, obj);\r\n      }, {})\r\n  };\r\n\r\n  let suggestions = [];\r\n  $: {\r\n    let trimmedValue = value.trim();\r\n    let options = getProperty(templateObject, trimmedValue);\r\n    if (!options) {\r\n      trimmedValue = trimmedValue.split(\".\").slice(0, -1).join(\".\")\r\n      options = getProperty(templateObject, trimmedValue);\r\n    }\r\n    suggestions = options ? Object.keys(options).map(t => trimmedValue + \".\" + t).sort() : Object.keys(templateObject);\r\n  }\r\n\r\n</script>\r\n\r\n<input type=\"text\" list={id} bind:value required={required}/>\r\n<datalist id={id}>\r\n\t{#each suggestions as suggestion}\r\n\t\t<option>{suggestion}</option>\r\n\t{/each}\r\n</datalist>\r\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { get, writable } from \"svelte/store\";\r\n  import PropertyPathInput from \"../../components/PropertyPathInput.svelte\";\r\n  import StringListEditor from \"../string-list-editor/string-list-editor.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  let form;\r\n\r\n  export let data;\r\n  export let elementRoot;\r\n\r\n  const merchantColumns = writable(data);\r\n\r\n  function addColumn() {\r\n    merchantColumns.update(value => {\r\n      value.push({\r\n        label: \"\",\r\n        path: \"\",\r\n        formatting: \"{#}\",\r\n        mapping: {}\r\n      });\r\n      return value;\r\n    });\r\n  }\r\n\r\n  function removeColumn(index) {\r\n    merchantColumns.update(value => {\r\n      value.splice(index, 1)\r\n      return value;\r\n    })\r\n  }\r\n\r\n  async function showMappingEditor(index) {\r\n    const data = get(merchantColumns)[index];\r\n    return StringListEditor.show(\r\n      Object.entries(data.mapping),\r\n      {\r\n        id: `merchant-columns-mapping-editor-${data.path}`,\r\n        title: localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.MappingTitle\", { label: data.label }),\r\n        content: localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.MappingContent\"),\r\n        keyValuePair: true,\r\n      }\r\n    ).then((result) => {\r\n      merchantColumns.update(value => {\r\n        value[index].mapping = Object.fromEntries(result);\r\n        return value;\r\n      })\r\n    });\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(get(merchantColumns));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  function preventDefault(event) {\r\n    event.preventDefault();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p style=\"text-align: center;\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Explanation\")}\r\n\t\t</p>\r\n\r\n\t\t<div class=\"form-group item-pile-column-grid item-piles-top-divider\">\r\n\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t<div style=\"text-align: left;\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Label\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.PropertyPath\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Formatting\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\"></div>\r\n\t\t\t\t<a on:click={() => addColumn()} style=\"margin-right: 0.5rem;\">\r\n\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#each $merchantColumns as column, index}\r\n\t\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={column.label} required/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<PropertyPathInput bind:value={column.path} templateType=\"Item\" required/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={column.formatting} required/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => showMappingEditor(index)} disabled={!column.label || !column.path}>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.ConfigureMapping\")}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a on:click={() => removeColumn(index)} class=\"item-piles-clickable-red\"\r\n\t\t\t\t\t\t style=\"margin-right: 0.5rem; text-align: center;\">\r\n\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t<footer class=\"item-piles-top-divider\">\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> { localize(\"Save\") }\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-pile-column-grid {\r\n    display: grid;\r\n    grid-template-columns: 1fr 0.75fr 0.75fr 1fr auto;\r\n    gap: 4px;\r\n\r\n    select {\r\n      width: 100%;\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper {\r\n      display: contents;\r\n      border-bottom: 1px solid rgba(0, 0, 0, 0.5);\r\n\r\n      button {\r\n        line-height: 1.3rem;\r\n      }\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper:first-of-type {\r\n      > div {\r\n        margin-bottom: 0.25rem;\r\n        text-align: center;\r\n\r\n        > div {\r\n          font-size: 0.75rem;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import MerchantColumnsEditorShell from \"./merchant-columns-editor-shell.svelte\";\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class MerchantColumnsEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: \"ITEM-PILES.Applications.MerchantColumnsEditor.Title\",\r\n      width: 600,\r\n      svelte: {\r\n        class: MerchantColumnsEditorShell\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  import ItemTypePriceModifiersEditor\r\n    from \"../../editors/item-type-price-modifiers-editor/item-type-price-modifiers-editor.js\";\r\n  import PriceModifiersEditor from \"../../editors/price-modifiers-editor/price-modifiers-editor.js\";\r\n  import FilePicker from \"../../components/FilePicker.svelte\";\r\n  import SliderInput from \"../../components/SliderInput.svelte\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import MerchantColumnsEditor from \"../../editors/merchant-columns-editor/merchant-columns-editor.js\";\r\n\r\n  export let pileData;\r\n  export let pileActor;\r\n\r\n  const simpleCalendarActive = game.modules.get('foundryvtt-simple-calendar')?.active;\r\n\r\n  const weekdays = (simpleCalendarActive ? window.SimpleCalendar.api.getAllWeekdays() : []).map(weekday => {\r\n    weekday.selected = pileData.closedDays.includes(weekday.name);\r\n    return weekday;\r\n  });\r\n\r\n  const refreshItemDays = (simpleCalendarActive ? window.SimpleCalendar.api.getAllWeekdays() : []).map(weekday => {\r\n    weekday.selected = pileData.refreshItemsDays.includes(weekday.name);\r\n    return weekday;\r\n  });\r\n\r\n  pileData.closedDays = pileData.closedDays.filter(closedWeekday => {\r\n    return weekdays.some(weekday => weekday.name === closedWeekday);\r\n  });\r\n\r\n  const holidays = (simpleCalendarActive ? window.SimpleCalendar.api.getCurrentCalendar().noteCategories : []).map(holiday => {\r\n    return { name: holiday.name, selected: pileData.closedHolidays.includes(holiday.name) };\r\n  });\r\n\r\n  pileData.closedHolidays = pileData.closedHolidays.filter(closedHoliday => {\r\n    return holidays.some(holiday => holiday.name === closedHoliday);\r\n  });\r\n\r\n  const refreshItemsHolidays = (simpleCalendarActive ? window.SimpleCalendar.api.getCurrentCalendar().noteCategories : []).map(holiday => {\r\n    return { name: holiday.name, selected: pileData.refreshItemsHolidays.includes(holiday.name) };\r\n  });\r\n\r\n  pileData.refreshItemsHolidays = pileData.refreshItemsHolidays.filter(refreshItemsHoliday => {\r\n    return refreshItemsHolidays.some(holiday => holiday.name === refreshItemsHoliday);\r\n  });\r\n\r\n  async function showItemTypePriceModifiers() {\r\n    const data = pileData.itemTypePriceModifiers || [];\r\n    return ItemTypePriceModifiersEditor.show(\r\n      data,\r\n      { id: `item-type-price-modifier-item-pile-config-${pileActor.id}` },\r\n      { title: localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n    ).then((result) => {\r\n      pileData.itemTypePriceModifiers = result || [];\r\n    });\r\n  }\r\n\r\n  async function showActorPriceModifiers() {\r\n    const data = pileData.actorPriceModifiers || [];\r\n    return PriceModifiersEditor.show(\r\n      data,\r\n      { id: `price-modifier-item-pile-config-${pileActor.id}` },\r\n      { title: localize(\"ITEM-PILES.Applications.PriceModifiersEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n    ).then((result) => {\r\n      pileData.actorPriceModifiers = result || [];\r\n      pileData.actorPriceModifiers.forEach(modifier => {\r\n        if (modifier.actor) {\r\n          delete modifier['actor'];\r\n        }\r\n      })\r\n    });\r\n  }\r\n\r\n  async function showMerchantColumns() {\r\n    const data = pileData.merchantColumns || [];\r\n    return MerchantColumnsEditor.show(\r\n      data,\r\n      { id: `merchant-columns-item-pile-config-${pileActor.id}` },\r\n      { title: localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n    ).then((result) => {\r\n      pileData.merchantColumns = result || [];\r\n    });\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantImage\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantImageExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker type=\"imagevideo\" bind:value={pileData.merchantImage} placeholder=\"path/image.png\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteQuantity\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteQuantityExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.infiniteQuantity}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteCurrency\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteCurrencyExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.infiniteCurrencies}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.KeepZero\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.KeepZeroExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.keepZeroQuantity}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantity\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"break\"></div>\r\n\t<select style=\"flex:4;\" bind:value={pileData.displayQuantity}>\r\n\t\t<option value=\"yes\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityYes\")}\r\n\t\t</option>\r\n\t\t<option value=\"no\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityNo\")}\r\n\t\t</option>\r\n\t\t<option value=\"alwaysyes\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityYesAlways\")}\r\n\t\t</option>\r\n\t\t<option value=\"alwaysno\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityNoAlways\")}\r\n\t\t</option>\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnly\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnlyExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.purchaseOnly}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItems\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItemsExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.hideNewItems}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideItemsWithZeroCost\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideItemsWithZeroCostExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.hideItemsWithZeroCost}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OnlyAcceptBasePrice\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OnlyAcceptBasePriceExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.onlyAcceptBasePrice}/>\r\n</div>\r\n\r\n<div class=\"form-group slider-group\">\r\n\t<label style=\"flex:3;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PriceModifierTitle\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PriceModifierExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n\r\n<div class=\"form-group slider-group\">\r\n\t<label style=\"flex:3;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</span>\r\n\t</label>\r\n\t<SliderInput style=\"flex:4;\" bind:value={pileData.buyPriceModifier}/>\r\n</div>\r\n\r\n<div class=\"form-group slider-group\">\r\n\t<label style=\"flex:3;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</span>\r\n\t</label>\r\n\t<SliderInput style=\"flex:4;\" bind:value={pileData.sellPriceModifier}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ItemTypeModifier\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ItemTypeModifiersExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<button type=\"button\" on:click={() => { showItemTypePriceModifiers() }}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ConfigureItemTypePriceModifiers\")}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ActorPriceModifiers\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ActorPriceModifiersExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<button type=\"button\" on:click={() => { showActorPriceModifiers() }}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ConfigureActorPriceModifiers\")}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantColumns\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantColumnsExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<button type=\"button\" on:click={() => { showMerchantColumns() }}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ConfigureMerchantColumns\")}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatus\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"break\"></div>\r\n\t<select style=\"flex:4;\" bind:value={pileData.openTimes.status}>\r\n\t\t<option value=\"open\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusOpen\")}\r\n\t\t</option>\r\n\t\t<option value=\"closed\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusClosed\")}\r\n\t\t</option>\r\n\t\t{#if simpleCalendarActive && pileData.openTimes.enabled}\r\n\t\t\t<option value=\"auto\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusAuto\")}\r\n\t\t\t</option>\r\n\t\t{/if}\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenTimes\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenTimesExplanation\")}</p>\r\n\t</label>\r\n\t<input type=\"checkbox\" bind:checked={pileData.openTimes.enabled}/>\r\n</div>\r\n\r\n<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t<div class=\"item-piles-flexcol\" style=\"margin-right:1rem\">\r\n\t\t<label class=\"item-piles-text-center\">\r\n\t\t\tOpen Time:\r\n\t\t</label>\r\n\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t<input type=\"number\" style=\"text-align: right;\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t\t\t\t bind:value=\"{pileData.openTimes.open.hour}\"/>\r\n\t\t\t<span style=\"flex: 0; line-height:1.7; margin: 0 0.25rem;\">:</span>\r\n\t\t\t<input type=\"number\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t\t\t\t bind:value=\"{pileData.openTimes.open.minute}\"/>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label class=\"item-piles-text-center\">\r\n\t\t\tClose Time:\r\n\t\t</label>\r\n\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t<input type=\"number\" style=\"text-align: right;\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t\t\t\t bind:value=\"{pileData.openTimes.close.hour}\"/>\r\n\t\t\t<span style=\"flex: 0; line-height:1.7; margin: 0 0.25rem;\">:</span>\r\n\t\t\t<input type=\"number\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t\t\t\t bind:value=\"{pileData.openTimes.close.minute}\"/>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n{#if simpleCalendarActive}\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedDays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedDaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div class=\"item-piles-flexrow\" style=\"text-align: center;\">\r\n\t\t\t{#each weekdays as weekday (weekday.id + \"-weekday-close\")}\r\n\t\t\t\t<div class=\"item-piles-flexcol\" style=\"align-items: center;\">\r\n\t\t\t\t\t<label>{weekday.abbreviation}</label>\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t\t\t\t bind:checked={weekday.selected}\r\n\t\t\t\t\t\t\t\t disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t\t\t\t on:change={() => {\r\n                 let weekdaySet = new Set(pileData.closedDays);\r\n                 if(weekday.selected){\r\n                   weekdaySet.add(weekday.name)\r\n                 }else{\r\n                   weekdaySet.delete(weekday.name)\r\n                 }\r\n                 pileData.closedDays = Array.from(weekdaySet);\r\n               }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedHolidays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedHolidaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div style=\"display: grid; grid-template-columns: 1fr 1fr;\">\r\n\t\t\t{#each holidays as holiday, index (holiday.name + \"-\" + index)}\r\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"flex:0 1 auto;\">\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t\t\t\t bind:checked={holiday.selected}\r\n\t\t\t\t\t\t\t\t disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t\t\t\t on:change={() => {\r\n                 let holidaySet = new Set(pileData.closedHolidays);\r\n                 if(holiday.selected){\r\n                   holidaySet.add(holiday.name)\r\n                 }else{\r\n                   holidaySet.delete(holiday.name)\r\n                 }\r\n                 pileData.closedHolidays = Array.from(holidaySet);\r\n               }}/>\r\n\t\t\t\t\t<label>{holiday.name}</label>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"form-group item-piles-top-divider\">\r\n\t\t<label>\r\n\t\t\t<p style=\"color: #c02609;\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsWarning\")}\r\n\t\t\t</p>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsOnOpen\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsOnOpenExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.refreshItemsOnOpen} disabled={!pileData.openTimes.enabled}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsDays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsDaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div class=\"item-piles-flexrow\" style=\"text-align: center;\">\r\n\t\t\t{#each refreshItemDays as weekday (weekday.id + \"-weekday-refresh\")}\r\n\t\t\t\t<div class=\"item-piles-flexcol\" style=\"align-items: center;\">\r\n\t\t\t\t\t<label>{weekday.abbreviation}</label>\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t\t\t\t bind:checked={weekday.selected}\r\n\t\t\t\t\t\t\t\t disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t\t\t\t on:change={() => {\r\n                 let weekdaySet = new Set(pileData.refreshItemsDays);\r\n                 if(weekday.selected){\r\n                   weekdaySet.add(weekday.name)\r\n                 }else{\r\n                   weekdaySet.delete(weekday.name)\r\n                 }\r\n                 pileData.refreshItemsDays = Array.from(weekdaySet);\r\n               }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsHolidays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsHolidaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div style=\"display: grid; grid-template-columns: 1fr 1fr;\">\r\n\t\t\t{#each refreshItemsHolidays as holiday, index (holiday.name + \"-remove-\" + index)}\r\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"flex:0 1 auto;\">\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t\t\t\t bind:checked={holiday.selected}\r\n\t\t\t\t\t\t\t\t disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t\t\t\t on:change={() => {\r\n\t\t\t\t\t\t\t\t\t let holidaySet = new Set(pileData.refreshItemsHolidays);\r\n\t\t\t\t\t\t\t\t\t if(holiday.selected){\r\n\t\t\t\t\t\t\t\t\t\t holidaySet.add(holiday.name)\r\n\t\t\t\t\t\t\t\t\t }else{\r\n\t\t\t\t\t\t\t\t\t\t holidaySet.delete(holiday.name)\r\n\t\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t\t\t pileData.refreshItemsHolidays = Array.from(holidaySet);\r\n\t\t\t\t\t\t\t\t }}/>\r\n\t\t\t\t\t<label>{holiday.name}</label>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n{/if}\r\n\r\n\r\n<style>\r\n    .form-group {\r\n        border-radius: 5px;\r\n    }\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let pileData;\r\n\r\n</script>\r\n\r\n\r\n<div class=\"form-group\">\r\n  <label>\r\n    <span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.DisplayOne\")}</span>\r\n    <p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.DisplayOneExplanation\")}</p>\r\n  </label>\r\n  <input type=\"checkbox\" bind:checked={pileData.displayOne}/>\r\n</div>\r\n\r\n<div class=\"item-pile-display-one-settings\">\r\n\r\n  <div class=\"form-group\">\r\n    <label>\r\n      <span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.ItemName\")}</span>\r\n      <p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.ItemNameExplanation\")}</p>\r\n    </label>\r\n    <input type=\"checkbox\" bind:checked={pileData.showItemName}/>\r\n  </div>\r\n\r\n  <div class=\"form-group\">\r\n    <label>\r\n      <span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.OverrideScale\")}</span>\r\n    </label>\r\n    <input type=\"checkbox\" bind:checked={pileData.overrideSingleItemScale}/>\r\n  </div>\r\n\r\n  <div class=\"form-group\" class:item-piles-disabled={!pileData.overrideSingleItemScale}>\r\n    <label style=\"flex:3;\">\r\n      <span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.Scale\")}</span>\r\n    </label>\r\n    <input style=\"flex:3;\" type=\"range\" min=\"0.2\" step=\"0.01\" max=\"3\" class=\"item-piles-scaleRange\"\r\n           disabled=\"{!pileData.overrideSingleItemScale}\" bind:value=\"{pileData.singleItemScale}\"/>\r\n    <input style=\"flex:0.5; margin-left:1rem;\" type=\"number\" step=\"0.01\" class=\"item-piles-scaleInput\"\r\n           disabled=\"{!pileData.overrideSingleItemScale}\" bind:value=\"{pileData.singleItemScale}\"/>\r\n  </div>\r\n\r\n</div>\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import FilePicker from \"../../components/FilePicker.svelte\";\r\n\r\n  export let pileData;\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.Closed\")}</label>\r\n  <input type=\"checkbox\" bind:checked={pileData.closed}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.Locked\")}</label>\r\n  <input type=\"checkbox\" bind:checked={pileData.locked}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.ClosedImagePath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"imagevideo\" bind:value={pileData.closedImage} placeholder=\"path/image.png\"/>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.OpenedImagePath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"imagevideo\" bind:value={pileData.openedImage} placeholder=\"path/image.png\"/>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.EmptyImagePath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"imagevideo\" bind:value={pileData.emptyImage} placeholder=\"path/image.png\"/>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.LockedImagePath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"imagevideo\" bind:value={pileData.lockedImage} placeholder=\"path/image.png\"/>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.CloseSoundPath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"audio\" bind:value={pileData.closeSound} placeholder=\"path/sound.wav\"/>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.OpenSoundPath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"audio\" bind:value={pileData.openSound} placeholder=\"path/sound.wav\"/>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n  <label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.LockedSoundPath\")}</label>\r\n  <div class=\"form-fields\">\r\n    <FilePicker type=\"audio\" bind:value={pileData.lockedSound} placeholder=\"path/sound.wav\"/>\r\n  </div>\r\n</div>\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\n  import CustomDialog from \"../../components/CustomDialog.svelte\";\r\n  import * as SharingUtilities from \"../../../helpers/sharing-utilities.js\";\r\n\r\n  export let pileData;\r\n  export let pileActor;\r\n\r\n  async function resetSharingData() {\r\n    const doThing = await TJSDialog.confirm({\r\n      id: `sharing-dialog-item-pile-config-${pileActor.id}`,\r\n      title: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Title\"),\r\n      content: {\r\n        class: CustomDialog,\r\n        props: {\r\n          header: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Title\"),\r\n          content: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Content\")\r\n        },\r\n      },\r\n      buttons: {\r\n        yes: {\r\n          icon: '<i class=\"fas fa-check\"></i>',\r\n          label: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Confirm\"),\r\n        }\r\n      },\r\n      modal: true\r\n    });\r\n    if (!doThing) return;\r\n    return SharingUtilities.clearItemPileSharingData(pileActor);\r\n  }\r\n\r\n</script>\r\n\r\n<details class=\"item-piles-collapsible item-piles-clickable\">\r\n\r\n\t<summary>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.Title\")}</summary>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareItemsEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareItemsEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.shareItemsEnabled}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareCurrenciesEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareCurrenciesEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.shareCurrenciesEnabled}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.TakeAllEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.TakeAllEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.takeAllEnabled}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.SplitAllEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.SplitAllEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.splitAllEnabled}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.InactivePlayers\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.InactivePlayersExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.activePlayers}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label style=\"flex:4;\">\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ResetSharingData\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ResetSharingDataExplanation\")}</p>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<button type=\"button\" class=\"item-piles-config-reset-sharing-data\" style=\"flex:4;\"\r\n\t\t\t\t\t\ton:click={() => { resetSharingData() }}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ResetSharingData\")}\r\n\t\t</button>\r\n\t</div>\r\n\r\n</details>\r\n","<script>\r\n\r\n  import CONSTANTS from \"../../../constants/constants.js\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let pileData;\r\n\r\n  const flags = Object.entries(CONSTANTS.CUSTOM_PILE_TYPES[pileData.type]);\r\n  for (const [key, data] of flags) {\r\n    if (pileData[key] === undefined) {\r\n      pileData[key] = data.value;\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n\r\n{#each Object.entries(CONSTANTS.CUSTOM_PILE_TYPES[pileData.type]) as [key, data] (key)}\r\n\r\n  <div class=\"form-group\">\r\n    <label style=\"flex:4;\">\r\n      <span>{localize(data.title)}</span>\r\n      {#if data.label}\r\n        <p>{localize(data.label)}</p>\r\n      {/if}\r\n    </label>\r\n    {#if data.type === String}\r\n      <input type=\"text\" bind:value={pileData[key]}/>\r\n    {:else if data.type === Number}\r\n      <input type=\"number\" bind:value={pileData[key]}/>\r\n    {:else if data.type === Boolean}\r\n      <input type=\"checkbox\" bind:checked={pileData[key]}/>\r\n    {/if}\r\n\r\n  </div>\r\n\r\n{/each}\r\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import CONSTANTS from \"../../constants/constants.js\";\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n\r\n  import Tabs from \"../components/Tabs.svelte\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { writable } from \"svelte/store\";\r\n\r\n  import MerchantApp from \"../merchant-app/merchant-app.js\";\r\n  import ItemPileInventoryApp from \"../item-pile-inventory-app/item-pile-inventory-app.js\";\r\n  import VaultApp from \"../vault-app/vault-app.js\";\r\n\r\n  import MainSettings from \"./settings/main.svelte\";\r\n  import MerchantSettings from \"./settings/merchant.svelte\";\r\n  import ItemPileSettings from \"./settings/itempile.svelte\";\r\n  import ContainerSettings from \"./settings/container.svelte\";\r\n  import SharingSettings from \"./settings/sharing.svelte\";\r\n  import VaultSettings from \"./settings/vault.svelte\";\r\n  import CustomSettings from \"./settings/custom.svelte\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  export let pileActor;\r\n\r\n  let form;\r\n\r\n  let pileData = PileUtilities.getActorFlagData(pileActor);\r\n\r\n  if (typeof pileData?.deleteWhenEmpty === \"boolean\") {\r\n    pileData.deleteWhenEmpty = !!pileData?.deleteWhenEmpty;\r\n  }\r\n\r\n  let pileEnabled = writable(pileData.enabled);\r\n\r\n  $: pileData.enabled = $pileEnabled;\r\n\r\n  async function updateSettings() {\r\n\r\n    let defaults = foundry.utils.duplicate(CONSTANTS.PILE_DEFAULTS);\r\n\r\n    const types = [\r\n      \"closedImage\",\r\n      \"emptyImage\",\r\n      \"openedImage\",\r\n      \"lockedImage\",\r\n      \"closeSound\",\r\n      \"openSound\",\r\n      \"lockedSound\",\r\n      \"unlockedSound\",\r\n    ];\r\n\r\n    for (let type of types) {\r\n      if (pileData[type].includes(\"*\")) {\r\n        pileData[type + \"s\"] = await Helpers.getFiles(pileData[type], { applyWildCard: true, softFail: true });\r\n        pileData[type + \"s\"] = pileData[type + \"s\"] || [];\r\n      }\r\n    }\r\n\r\n    const data = foundry.utils.mergeObject(defaults, pileData);\r\n\r\n    data.deleteWhenEmpty = {\r\n      \"default\": \"default\",\r\n      \"true\": true,\r\n      \"false\": false\r\n    }[data.deleteWhenEmpty];\r\n\r\n    const currentData = PileUtilities.getActorFlagData(pileActor);\r\n    const diff = Object.keys(foundry.utils.diffObject(currentData, foundry.utils.deepClone(data)));\r\n\r\n    game.itempiles.API.updateItemPile(pileActor, data).then(async () => {\r\n      if (diff.includes(\"enabled\") || diff.includes(\"type\")) {\r\n        const promises = [];\r\n        let apps = [];\r\n        switch (currentData.type) {\r\n          case CONSTANTS.PILE_TYPES.MERCHANT:\r\n            if (MerchantApp.getActiveApp(pileActor.id)) {\r\n              promises.push(MerchantApp.getActiveApp(pileActor.id).close());\r\n            }\r\n            if (MerchantApp.getActiveApp(pileActor?.token?.id)) {\r\n              promises.push(MerchantApp.getActiveApp(pileActor?.token?.id).close());\r\n            }\r\n            break;\r\n\r\n          case CONSTANTS.PILE_TYPES.VAULT:\r\n            apps = VaultApp.getActiveApps(pileActor.id)\r\n              .concat(VaultApp.getActiveApps(pileActor?.token?.id));\r\n            break;\r\n\r\n          default:\r\n            apps = ItemPileInventoryApp.getActiveApps(pileActor.id)\r\n              .concat(ItemPileInventoryApp.getActiveApps(pileActor?.token?.id));\r\n            break;\r\n        }\r\n\r\n        for (let app of apps) {\r\n          promises.push(app.close());\r\n        }\r\n\r\n        if (promises.length || pileActor?.sheet.rendered) {\r\n          await Promise.allSettled(promises);\r\n          if (data.enabled) {\r\n            pileActor?.sheet.close();\r\n            game.itempiles.API.renderItemPileInterface(pileActor);\r\n          } else if (!data.enabled) {\r\n            pileActor?.sheet.render(true, { bypassItemPiles: true });\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    application.close();\r\n\r\n  }\r\n\r\n  function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  let tabs = [];\r\n  $: {\r\n    tabs = [\r\n      {\r\n        value: \"main\",\r\n        label: \"ITEM-PILES.Applications.ItemPileConfig.Main.Title\",\r\n        highlight: !$pileEnabled\r\n      },\r\n      {\r\n        value: \"other\",\r\n        label: \"ITEM-PILES.Applications.ItemPileConfig.Other.Title\"\r\n      }\r\n    ]\r\n  }\r\n\r\n  let activeTab = \"main\";\r\n\r\n  const customTypes = Object.keys(CONSTANTS.CUSTOM_PILE_TYPES);\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|once|preventDefault={updateSettings} autocomplete=off\r\n\t\t\t\tclass=\"item-piles-config-container\">\r\n\r\n\t\t<Tabs bind:activeTab bind:tabs/>\r\n\r\n\t\t<section class=\"tab-body\">\r\n\r\n\t\t\t<div class=\"tab\">\r\n\r\n\t\t\t\t{#if activeTab === 'main'}\r\n\r\n\t\t\t\t\t<MainSettings bind:pileData {pileActor} {pileEnabled}/>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if activeTab === \"other\"}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Other.Type\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Other.TypeExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex:4;\" bind:value={pileData.type}>\r\n\t\t\t\t\t\t\t{#each Object.values(CONSTANTS.PILE_TYPES) as type}\r\n\t\t\t\t\t\t\t\t<option value={type}>\r\n\t\t\t\t\t\t\t\t\t{localize(`ITEM-PILES.Types.${type}`)}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t{#each customTypes as customType}\r\n\t\t\t\t\t\t\t\t<option value={customType}>\r\n\t\t\t\t\t\t\t\t\t{localize(`ITEM-PILES.Types.${customType}`)}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<hr>\r\n\r\n\t\t\t\t\t{#if pileData.type === CONSTANTS.PILE_TYPES.MERCHANT}\r\n\r\n\t\t\t\t\t\t<MerchantSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{:else if pileData.type === CONSTANTS.PILE_TYPES.PILE || pileData.type === CONSTANTS.PILE_TYPES.CONTAINER}\r\n\r\n\t\t\t\t\t\t{#if pileData.type === CONSTANTS.PILE_TYPES.PILE}\r\n\r\n\t\t\t\t\t\t\t<ItemPileSettings bind:pileData/>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t{#if pileData.type === CONSTANTS.PILE_TYPES.CONTAINER}\r\n\r\n\t\t\t\t\t\t\t<ContainerSettings bind:pileData/>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t<hr>\r\n\r\n\t\t\t\t\t\t<SharingSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{:else if pileData.type === CONSTANTS.PILE_TYPES.VAULT}\r\n\r\n\t\t\t\t\t\t<VaultSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{:else if customTypes.includes(pileData.type)}\r\n\r\n\t\t\t\t\t\t<CustomSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</section>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i>\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Update\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n","import * as Utilities from \"../../helpers/utilities.js\";\r\nimport { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport ItemPileConfigShell from './item-pile-config.svelte';\r\nimport { getActiveApps } from \"../../helpers/helpers.js\";\r\n\r\nexport default class ItemPileConfig extends SvelteApplication {\r\n\r\n  constructor(pileActor, options = {}) {\r\n\r\n    super({\r\n      id: `item-pile-config-${pileActor.id}-${randomID()}`,\r\n      title: game.i18n.format(\"ITEM-PILES.Applications.ItemPileConfig.Title\", { actor_name: pileActor.name }),\r\n      svelte: {\r\n        class: ItemPileConfigShell,\r\n        target: document.body,\r\n        props: {\r\n          pileActor\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    });\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      width: 430,\r\n      height: 627,\r\n      classes: [\"item-piles-config\", \"item-piles-app\"],\r\n      resizable: true\r\n    })\r\n  }\r\n\r\n  static getActiveApp(id) {\r\n    return getActiveApps(`item-pile-config-${id}`, true)\r\n  }\r\n\r\n  static async show(target, options = {}, dialogData = {}) {\r\n    const targetActor = Utilities.getActor(target);\r\n    const app = this.getActiveApp(targetActor.id);\r\n    if (app) return app.render(false, { focus: true });\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(targetActor, options, dialogData).render(true);\r\n    })\r\n  }\r\n\r\n  async close(options) {\r\n    Object.values(ui.windows).forEach(app => {\r\n      if (app !== this && app.rendered && app.options?.parentApp === this) {\r\n        app.close();\r\n      }\r\n    })\r\n    return super.close(options);\r\n  }\r\n}\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport ItemPileInventoryShell from \"./item-pile-inventory-shell.svelte\";\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\nimport ItemPileConfig from \"../item-pile-config/item-pile-config.js\";\r\nimport * as Helpers from \"../../helpers/helpers.js\";\r\nimport UserSelectDialog from \"../dialogs/user-select-dialog/user-select-dialog.js\";\r\nimport SETTINGS from \"../../constants/settings.js\";\r\nimport CONSTANTS from \"../../constants/constants.js\";\r\n\r\nexport default class ItemPileInventoryApp extends SvelteApplication {\r\n\r\n  /**\r\n   *\r\n   * @param actor\r\n   * @param recipient\r\n   * @param overrides\r\n   * @param options\r\n   * @param dialogData\r\n   */\r\n  constructor(actor, recipient, options = {}, dialogData = {}) {\r\n    super({\r\n      id: `item-pile-inventory-${actor?.token?.id ?? actor.id}-${randomID()}`,\r\n      title: actor.name,\r\n      svelte: {\r\n        class: ItemPileInventoryShell,\r\n        target: document.body,\r\n        props: {\r\n          actor,\r\n          recipient\r\n        }\r\n      },\r\n      zIndex: 100,\r\n      ...options\r\n    }, dialogData);\r\n\r\n    this.actor = actor;\r\n    this.recipient = recipient;\r\n\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.OPEN_INTERFACE, this, actor, recipient, options, dialogData);\r\n\r\n  }\r\n\r\n  /** @inheritdoc */\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      closeOnSubmit: false,\r\n      classes: [\"app\", \"window-app\", \"sheet\", \"item-pile-inventory\", \"item-piles\", \"item-piles-app\"],\r\n      width: 550,\r\n      height: \"auto\",\r\n    });\r\n  }\r\n\r\n  static getActiveApps(id) {\r\n    return Helpers.getActiveApps(`item-pile-inventory-${id}`);\r\n  }\r\n\r\n  static async show(source, recipient = false, options = {}, dialogData = {}) {\r\n    source = Utilities.getActor(source);\r\n    recipient = Utilities.getActor(recipient);\r\n    const result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_OPEN_INTERFACE, source, recipient, options, dialogData);\r\n    if (result === false) return;\r\n    const apps = this.getActiveApps(source?.token?.id ?? source.id);\r\n    if (apps.length) {\r\n      for (let app of apps) {\r\n        app.render(false, { focus: true });\r\n      }\r\n      return;\r\n    }\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(source, recipient, options, dialogData).render(true, { focus: true, bypassItemPiles: true });\r\n    })\r\n  }\r\n\r\n  async close(options) {\r\n    const result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n    if (result === false) return;\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n    return super.close(options);\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  _getHeaderButtons() {\r\n    let buttons = super._getHeaderButtons();\r\n    const canConfigure = game.user.isGM;\r\n    if (canConfigure) {\r\n      buttons = [\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.Inspect.OpenSheet\" : \"\",\r\n          class: \"item-piles-open-actor-sheet\",\r\n          icon: \"fas fa-user\",\r\n          onclick: () => {\r\n            this.actor.sheet.render(true, { focus: true, bypassItemPiles: true });\r\n          }\r\n        },\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.ContextMenu.ShowToPlayers\" : \"\",\r\n          class: \"item-piles-show-to-players\",\r\n          icon: \"fas fa-eye\",\r\n          onclick: async (event) => {\r\n            const activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n            if (!activeUsers.length) {\r\n              return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n            }\r\n            const users = event.altKey ? activeUsers : await UserSelectDialog.show({ excludeSelf: true });\r\n            if (!users || !users.length) return;\r\n            Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: this.actor.name }))\r\n            return game.itempiles.API.renderItemPileInterface(this.actor, {\r\n              userIds: users,\r\n              useDefaultCharacter: true\r\n            });\r\n          }\r\n        },\r\n        {\r\n          label: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.HUD.Configure\" : \"\",\r\n          class: \"item-piles-configure-pile\",\r\n          icon: \"fas fa-box-open\",\r\n          onclick: () => {\r\n            ItemPileConfig.show(this.actor);\r\n          }\r\n        },\r\n      ].concat(buttons);\r\n    }\r\n    return buttons\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n  export let item;\r\n  export let quantity;\r\n  export let sourceActor;\r\n  export let targetActor;\r\n\r\n</script>\r\n\r\n\r\n<div class=\"item-piles-dialog-root\">\r\n\r\n\t<p class=\"header\">\r\n\t\t{localize(\"ITEM-PILES.Dialogs.ReceiveItem.Header\")}\r\n\t</p>\r\n\r\n\t<div class=\"item-piles-give-image-container\">\r\n\t\t<img src=\"{sourceActor.img}\"/>\r\n\t\t<i class=\"fas fa-arrow-right\"></i>\r\n\t\t<img src=\"{targetActor.img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-give-item-container\">\r\n\t\t<img src=\"{item.img}\"/>\r\n\t\t<span>{item.name} ({quantity})</span>\r\n\t</div>\r\n\r\n\t<p>{localize(\"ITEM-PILES.Dialogs.ReceiveItem.Content\", {\r\n    source_actor_name: sourceActor.name,\r\n    target_actor_name: targetActor.name\r\n  })}</p>\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-dialog-root {\r\n\r\n    margin-bottom: 0.5rem;\r\n    font-size: 0.9rem;\r\n    text-align: center;\r\n\r\n    .header {\r\n      margin-bottom: 0.5rem;\r\n      font-size: 1.2rem;\r\n      font-weight: bold;\r\n    }\r\n\r\n    .item-piles-give-item-container, .item-piles-give-image-container {\r\n      display: grid;\r\n\r\n      grid-auto-flow: column;\r\n      align-items: center;\r\n      justify-items: center;\r\n      justify-content: center;\r\n      align-content: center;\r\n      gap: 1rem;\r\n\r\n      margin-bottom: 0.5rem;\r\n\r\n    }\r\n\r\n    .item-piles-give-image-container {\r\n\r\n      font-size: 2rem;\r\n\r\n      img {\r\n        max-height: 70px;\r\n        border: 0;\r\n      }\r\n    }\r\n\r\n    .item-piles-give-item-container {\r\n\r\n      font-size: 1rem;\r\n\r\n      img {\r\n        max-height: 40px;\r\n        border: 0;\r\n        border-radius: 0.5rem;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","import * as Helpers from \"../helpers/helpers.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport { hotkeyState } from \"../hotkeys.js\";\r\nimport DropItemDialog from \"../applications/dialogs/drop-item-dialog/drop-item-dialog.js\";\r\nimport ItemPileInventoryApp from \"../applications/item-pile-inventory-app/item-pile-inventory-app.js\";\r\nimport Transaction from \"../helpers/transaction.js\";\r\nimport ItemPileStore from \"../stores/item-pile-store.js\";\r\nimport MerchantApp from \"../applications/merchant-app/merchant-app.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\nimport { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport CustomDialog from \"../applications/components/CustomDialog.svelte\";\r\nimport GiveItemsShell from \"../applications/dialogs/give-items-dialog/give-items-shell.svelte\";\r\nimport BankVaultApp from \"../applications/vault-app/vault-app.js\";\r\n\r\nconst preloadedFiles = new Set();\r\n\r\nexport default class PrivateAPI {\r\n\r\n  /**\r\n   * Initializes the API for Foundry's core hooks\r\n   */\r\n  static initialize() {\r\n    Helpers.hooks.on(\"canvasReady\", this._onCanvasReady.bind(this));\r\n    Helpers.hooks.on(\"createItem\", this._onCreateItem.bind(this));\r\n    Helpers.hooks.on(\"updateItem\", this._onUpdateItem.bind(this));\r\n    Helpers.hooks.on(\"deleteItem\", this._onDeleteItem.bind(this));\r\n    Helpers.hooks.on(\"updateActor\", this._onUpdateActor.bind(this));\r\n    Helpers.hooks.on(\"deleteToken\", this._onDeleteToken.bind(this));\r\n    Helpers.hooks.on(\"deleteActor\", this._onDeleteActor.bind(this));\r\n    Helpers.hooks.on(\"preCreateToken\", this._onPreCreateToken.bind(this))\r\n    Helpers.hooks.on(\"createToken\", this._onCreateToken.bind(this))\r\n    Helpers.hooks.on(\"dropCanvasData\", this._dropData.bind(this));\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static async _onCanvasReady(canvas) {\r\n    const tokens = [...canvas.tokens.placeables].map(token => token.document);\r\n    for (const doc of tokens) {\r\n      await this._preloadItemPileFiles(doc);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onCreateItem(doc) {\r\n    if (!doc.parent) return;\r\n    ItemPileStore.notifyChanges(\"createItem\", doc.parent, doc);\r\n    if (!PileUtilities.isValidItemPile(doc.parent)) return;\r\n    this._evaluateItemPileChange(doc.parent, {}, true);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onUpdateItem(doc) {\r\n    if (!doc.parent) return;\r\n    if (!PileUtilities.isValidItemPile(doc.parent)) return;\r\n    this._evaluateItemPileChange(doc.parent, {}, true);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onDeleteItem(doc) {\r\n    if (!doc.parent) return;\r\n    ItemPileStore.notifyChanges(\"deleteItem\", doc.parent, doc);\r\n    if (!PileUtilities.isValidItemPile(doc.parent)) return;\r\n    this._evaluateItemPileChange(doc.parent, {}, true);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onUpdateActor(doc, changes) {\r\n    if (!PileUtilities.isValidItemPile(doc)) return;\r\n    this._evaluateItemPileChange(doc, changes);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onDeleteToken(doc) {\r\n    ItemPileStore.notifyChanges(\"delete\", doc.actor)\r\n    if (!PileUtilities.isValidItemPile(doc)) return;\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.DELETE, doc);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onDeleteActor(doc) {\r\n    ItemPileStore.notifyChanges(\"delete\", doc)\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onPreCreateToken(doc, data) {\r\n    let itemPileConfig = foundry.utils.deepClone(getProperty(data, CONSTANTS.FLAGS.PILE));\r\n    itemPileConfig = foundry.utils.mergeObject(\r\n      foundry.utils.deepClone(CONSTANTS.PILE_DEFAULTS),\r\n      itemPileConfig\r\n    );\r\n    if (!itemPileConfig?.enabled) return;\r\n    if (!doc.isLinked) {\r\n      doc.updateSource({\r\n        [`actorData.flags.${CONSTANTS.MODULE_NAME}.-=sharing`]: null,\r\n      });\r\n    }\r\n    if (itemPileConfig.closedImage.includes(\"*\")) {\r\n      itemPileConfig.closedImage = Helpers.random_array_element(itemPileConfig.closedImages);\r\n      itemPileConfig.closedImages = [];\r\n    }\r\n    if (itemPileConfig.emptyImage.includes(\"*\")) {\r\n      itemPileConfig.emptyImage = Helpers.random_array_element(itemPileConfig.emptyImages);\r\n      itemPileConfig.emptyImages = [];\r\n    }\r\n    if (itemPileConfig.openedImage.includes(\"*\")) {\r\n      itemPileConfig.openedImage = Helpers.random_array_element(itemPileConfig.openedImages);\r\n      itemPileConfig.openedImages = [];\r\n    }\r\n    if (itemPileConfig.lockedImage.includes(\"*\")) {\r\n      itemPileConfig.lockedImage = Helpers.random_array_element(itemPileConfig.lockedImages);\r\n      itemPileConfig.lockedImages = [];\r\n    }\r\n    doc.updateSource({\r\n      [CONSTANTS.FLAGS.PILE]: itemPileConfig, [\"actorData.\" + CONSTANTS.FLAGS.PILE]: itemPileConfig\r\n    });\r\n    const targetItems = PileUtilities.getActorItems(doc.actor);\r\n    const targetCurrencies = PileUtilities.getActorCurrencies(doc.actor);\r\n    const pileData = { data: itemPileConfig, items: targetItems, currencies: targetCurrencies };\r\n    const scale = PileUtilities.getItemPileTokenScale(doc, pileData);\r\n    const docData = {\r\n      \"texture.src\": PileUtilities.getItemPileTokenImage(doc, pileData),\r\n      \"texture.scaleX\": scale,\r\n      \"texture.scaleY\": scale,\r\n      \"name\": PileUtilities.getItemPileName(doc, pileData)\r\n    };\r\n    doc.updateSource(docData);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  static _onCreateToken(doc) {\r\n    if (!PileUtilities.isValidItemPile(doc)) return;\r\n    const itemPileConfig = PileUtilities.getActorFlagData(doc.actor)\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.CREATE, doc, itemPileConfig);\r\n    return this._preloadItemPileFiles(doc);\r\n  }\r\n\r\n  static async _addItems(targetUuid, items, userId, {\r\n    removeExistingActorItems = false, skipVaultLogging = false, interactionId = false\r\n  } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n\r\n    if (removeExistingActorItems) {\r\n      const existingItems = PileUtilities.getActorItems(targetActor);\r\n      await transaction.appendItemChanges(existingItems, { remove: true });\r\n    }\r\n\r\n    await transaction.appendItemChanges(items);\r\n\r\n    const { itemsToUpdate, itemsToCreate } = transaction.prepare(); // Prepare data\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_ADD, targetActor, itemsToCreate, itemsToUpdate, interactionId);\r\n    if (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n    const { itemDeltas } = await transaction.commit(); // Actually add the items to the actor\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.ADD, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"addItems\", target: targetUuid, items: itemDeltas, userId: userId, interactionId: interactionId\r\n    });\r\n\r\n    if (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n      await PileUtilities.updateVaultLog(targetActor, {\r\n        userId,\r\n        items: itemDeltas,\r\n        withdrawal: false\r\n      });\r\n    }\r\n\r\n    return itemDeltas;\r\n\r\n  }\r\n\r\n  static async _removeItems(targetUuid, items, userId, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n\r\n    await transaction.appendItemChanges(items, { remove: true });\r\n\r\n    const { itemsToUpdate, itemsToDelete } = transaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_REMOVE, targetActor, itemsToUpdate, itemsToDelete, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    const { itemDeltas } = await transaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.REMOVE, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"removeItems\", target: targetUuid, items: itemDeltas, userId: userId, interactionId: interactionId\r\n    });\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(targetUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(targetUuid);\r\n    }\r\n\r\n    if (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n      await PileUtilities.updateVaultLog(targetActor, {\r\n        userId,\r\n        items: itemDeltas,\r\n        withdrawal: true\r\n      });\r\n    }\r\n\r\n    return itemDeltas;\r\n\r\n  }\r\n\r\n  static async _transferItems(sourceUuid, targetUuid, items, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendItemChanges(items, { remove: true });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_TRANSFER, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { itemDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.TRANSFER, sourceUuid, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferItems\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n    const itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n    const itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(itemPileUuid);\r\n    } else if (PileUtilities.isItemPileLootable(itemPile)) {\r\n      if (PileUtilities.isItemPileEmpty(itemPile)) {\r\n        await SharingUtilities.clearItemPileSharingData(itemPile);\r\n      } else {\r\n        await SharingUtilities.setItemPileSharingData(sourceUuid, targetUuid, {\r\n          items: itemDeltas\r\n        });\r\n      }\r\n    } else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n      const pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n      const actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n      await PileUtilities.updateVaultLog(pileActor, {\r\n        userId,\r\n        actor: actorToLog,\r\n        items: itemDeltas,\r\n        withdrawal: sourceIsItemPile\r\n      });\r\n    }\r\n\r\n    return itemDeltas;\r\n\r\n  }\r\n\r\n  static async _transferAllItems(sourceUuid, targetUuid, userId, {\r\n    itemFilters = false, skipVaultLogging = false, interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const itemsToTransfer = PileUtilities.getActorItems(sourceActor, { itemFilters }).map(item => item.toObject());\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_TRANSFER_ALL, sourceActor, sourceUpdates, targetActor, targetUpdates, userId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { itemDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.TRANSFER_ALL, sourceUuid, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferAllItems\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(sourceUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(sourceUuid);\r\n    } else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n      const sourceIsItemPile = PileUtilities.isItemPileVault(sourceActor);\r\n      const pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n      const actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n      await PileUtilities.updateVaultLog(pileActor, {\r\n        userId,\r\n        actor: actorToLog,\r\n        items: itemDeltas,\r\n        withdrawal: sourceIsItemPile\r\n      });\r\n    }\r\n\r\n    return itemDeltas;\r\n  }\r\n\r\n  static async _addCurrencies(targetUuid, currencies, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n\r\n    const currenciesToAdd = PileUtilities.getPriceFromString(currencies).currencies\r\n      .filter(currency => currency.quantity);\r\n\r\n    const itemsToAdd = currenciesToAdd.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const attributesToAdd = currenciesToAdd.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    await transaction.appendItemChanges(itemsToAdd, { type: \"currency\" });\r\n    await transaction.appendActorChanges(attributesToAdd, { type: \"currency\" });\r\n\r\n    const { actorUpdates, itemsToCreate, itemsToUpdate } = transaction.prepare(); // Prepare data\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_ADD, targetActor, actorUpdates, itemsToCreate, itemsToUpdate, interactionId);\r\n    if (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n    const { itemDeltas, attributeDeltas } = await transaction.commit(); // Actually add the items to the actor\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.ADD, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"addCurrencies\",\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    });\r\n\r\n    if (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n      await PileUtilities.updateVaultLog(targetActor, {\r\n        userId,\r\n        items: itemDeltas,\r\n        attributes: attributeDeltas,\r\n        withdrawal: false\r\n      });\r\n    }\r\n\r\n    return { itemDeltas, attributeDeltas };\r\n\r\n  }\r\n\r\n  static async _removeCurrencies(targetUuid, currencies, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n\r\n    const priceData = PileUtilities.getPriceFromString(currencies)\r\n    const overallCost = priceData.overallCost;\r\n\r\n    const paymentData = PileUtilities.getPaymentData({\r\n      purchaseData: [{ cost: overallCost, quantity: 1 }],\r\n      buyer: targetActor\r\n    });\r\n\r\n    const itemsToRemove = paymentData.finalPrices.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const attributesToRemove = paymentData.finalPrices.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    const itemsToAdd = paymentData.buyerChange.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const attributesToAdd = paymentData.buyerChange.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    await transaction.appendItemChanges(itemsToRemove, { remove: true, type: \"currency\" });\r\n    await transaction.appendActorChanges(attributesToRemove, { remove: true, type: \"currency\" });\r\n    await transaction.appendItemChanges(itemsToAdd, { type: \"currency\" });\r\n    await transaction.appendActorChanges(attributesToAdd, { type: \"currency\" });\r\n\r\n    const { actorUpdates, itemsToUpdate } = transaction.prepare(); // Prepare data\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_REMOVE, targetActor, actorUpdates, itemsToUpdate, interactionId);\r\n    if (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n    const { itemDeltas, attributeDeltas } = await transaction.commit(); // Actually add the items to the actor\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.REMOVE, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"removeCurrencies\",\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    });\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(targetUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(targetUuid);\r\n    }\r\n\r\n    if (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n      await PileUtilities.updateVaultLog(targetActor, {\r\n        userId,\r\n        items: itemDeltas,\r\n        attributes: attributeDeltas,\r\n        withdrawal: true\r\n      });\r\n    }\r\n\r\n    return { itemDeltas, attributeDeltas };\r\n\r\n  }\r\n\r\n  static async _transferCurrencies(sourceUuid, targetUuid, currencies, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const priceData = PileUtilities.getPriceFromString(currencies);\r\n    const overallCost = priceData.overallCost;\r\n\r\n    const paymentData = PileUtilities.getPaymentData({\r\n      purchaseData: [{ cost: overallCost, quantity: 1 }],\r\n      buyer: sourceActor\r\n    });\r\n\r\n    const sourceItemsToRemove = paymentData.finalPrices.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const sourceAttributesToRemove = paymentData.finalPrices.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    const sourceItemsToAdd = paymentData.buyerChange.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const sourceAttributesToAdd = paymentData.buyerChange.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendItemChanges(sourceItemsToRemove, { remove: true, type: \"currency\" });\r\n    await sourceTransaction.appendActorChanges(sourceAttributesToRemove, { remove: true, type: \"currency\" });\r\n    await sourceTransaction.appendItemChanges(sourceItemsToAdd, { type: \"currency\" });\r\n    await sourceTransaction.appendActorChanges(sourceAttributesToAdd, { type: \"currency\" });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetItemsToAdd = paymentData.sellerReceive.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const targetAttributesToAdd = paymentData.sellerReceive.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendItemChanges(targetItemsToAdd, { type: \"currency\" });\r\n    await targetTransaction.appendActorChanges(targetAttributesToAdd, { type: \"currency\" });\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_TRANSFER, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.TRANSFER, sourceUuid, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferCurrencies\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n    const itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n    const itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(itemPileUuid);\r\n    } else if (PileUtilities.isItemPileLootable(itemPile)) {\r\n      if (PileUtilities.isItemPileEmpty(itemPile)) {\r\n        await SharingUtilities.clearItemPileSharingData(itemPile);\r\n      } else {\r\n        await SharingUtilities.setItemPileSharingData(sourceUuid, targetUuid, {\r\n          items: itemDeltas,\r\n          attributes: attributeDeltas\r\n        });\r\n      }\r\n    } else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n      const sourceIsItemPile = PileUtilities.isItemPileVault(sourceActor);\r\n      const pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n      const actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n      await PileUtilities.updateVaultLog(pileActor, {\r\n        userId,\r\n        actor: actorToLog,\r\n        items: itemDeltas,\r\n        attributes: attributeDeltas,\r\n        withdrawal: sourceIsItemPile\r\n      });\r\n    }\r\n\r\n    return { itemDeltas, attributeDeltas };\r\n\r\n  }\r\n\r\n  static async _transferAllCurrencies(sourceUuid, targetUuid, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const currencyList = PileUtilities.getCurrencyList();\r\n    const sourceCurrencyList = PileUtilities.getActorCurrencies(sourceActor, { currencyList });\r\n\r\n    const itemsToTransfer = sourceCurrencyList.filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n    const attributesToTransfer = sourceCurrencyList.filter(currency => currency.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true, type: \"currency\" });\r\n    await sourceTransaction.appendActorChanges(attributesToTransfer, { remove: true, type: \"currency\" });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n    await targetTransaction.appendActorChanges(sourceUpdates.attributeDeltas);\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_TRANSFER_ALL, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.TRANSFER_ALL, sourceUuid, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferAllCurrencies\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(sourceUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(sourceUuid);\r\n    } else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n      const sourceIsItemPile = PileUtilities.isItemPileVault(sourceActor);\r\n      const pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n      const actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n      await PileUtilities.updateVaultLog(pileActor, {\r\n        userId,\r\n        actor: actorToLog,\r\n        items: itemDeltas,\r\n        attributes: attributeDeltas,\r\n        withdrawal: sourceIsItemPile\r\n      });\r\n    }\r\n\r\n    return { itemDeltas, attributeDeltas };\r\n\r\n  }\r\n\r\n  static async _setAttributes(targetUuid, attributes, userId, { interactionId = false } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n    await transaction.appendActorChanges(attributes, { set: true });\r\n    const { actorUpdates } = transaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_SET, targetActor, actorUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    const { attributeDeltas } = await transaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.SET, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"setAttributes\",\r\n      target: targetUuid,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    });\r\n\r\n    return attributeDeltas;\r\n\r\n  }\r\n\r\n  static async _addAttributes(targetUuid, attributes, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n    await transaction.appendActorChanges(attributes);\r\n    const { actorUpdates } = transaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_ADD, targetActor, actorUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    const { attributeDeltas } = await transaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.ADD, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"addAttributes\",\r\n      target: targetUuid,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    });\r\n\r\n    if (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n      await PileUtilities.updateVaultLog(targetActor, {\r\n        userId,\r\n        attributes: attributeDeltas,\r\n        withdrawal: false\r\n      });\r\n    }\r\n\r\n    return attributeDeltas;\r\n\r\n  }\r\n\r\n  static async _removeAttributes(targetUuid, attributes, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const transaction = new Transaction(targetActor);\r\n    await transaction.appendActorChanges(attributes, { remove: true });\r\n    const { actorUpdates } = transaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_REMOVE, targetActor, actorUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    const { attributeDeltas } = await transaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.REMOVE, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n    await this._executeItemPileMacro(targetUuid, {\r\n      action: \"removeAttributes\",\r\n      target: targetUuid,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    });\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(targetUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(targetUuid);\r\n    }\r\n\r\n    if (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n      await PileUtilities.updateVaultLog(targetActor, {\r\n        userId,\r\n        attributes: attributeDeltas,\r\n        withdrawal: true\r\n      });\r\n    }\r\n\r\n    return attributeDeltas;\r\n\r\n  }\r\n\r\n  static async _transferAttributes(sourceUuid, targetUuid, attributes, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendActorChanges(attributes, { remove: true });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendActorChanges(sourceUpdates.attributeDeltas);\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_TRANSFER, sourceActor, sourceUpdates.actorUpdates, targetActor, targetUpdates.actorUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { attributeDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.ATTRIBUTE.TRANSFER, sourceUuid, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferAttributes\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n    const itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n    const itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(itemPileUuid);\r\n    } else if (PileUtilities.isItemPileLootable(itemPile)) {\r\n      if (PileUtilities.isItemPileEmpty(itemPile)) {\r\n        await SharingUtilities.clearItemPileSharingData(itemPile);\r\n      } else {\r\n        await SharingUtilities.setItemPileSharingData(sourceUuid, targetUuid, {\r\n          attributes: attributeDeltas\r\n        });\r\n      }\r\n    } else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n      const pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n      const actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n      await PileUtilities.updateVaultLog(pileActor, {\r\n        userId,\r\n        actor: actorToLog,\r\n        attributes: attributeDeltas,\r\n        withdrawal: sourceIsItemPile\r\n      });\r\n    }\r\n\r\n    return attributeDeltas;\r\n\r\n  }\r\n\r\n  static async _transferAllAttributes(sourceUuid, targetUuid, userId, {\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const sourceAttributes = PileUtilities.getActorCurrencies(sourceActor).filter(entry => entry.type === \"attribute\");\r\n    const attributesToTransfer = sourceAttributes.filter(attribute => {\r\n      return hasProperty(targetActor, attribute.data.path);\r\n    }).map(attribute => attribute.data.path);\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendActorChanges(attributesToTransfer, { remove: true });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendActorChanges(sourceUpdates.attributeDeltas);\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_TRANSFER_ALL, sourceActor, sourceUpdates.actorUpdates, targetActor, targetUpdates.actorUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { attributeDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.TRANSFER_ALL, sourceUuid, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferAllAttributes\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n    const itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n    const itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPile);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(itemPileUuid);\r\n    }\r\n\r\n    return attributeDeltas;\r\n\r\n  }\r\n\r\n  static async _transferEverything(sourceUuid, targetUuid, userId, { itemFilters = false, interactionId } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const itemsToTransfer = PileUtilities.getActorItems(sourceActor, { itemFilters }).map(item => item.toObject());\r\n\r\n    const sourceCurrencies = PileUtilities.getActorCurrencies(sourceActor);\r\n\r\n    const itemCurrenciesToTransfer = sourceCurrencies\r\n      .filter(currency => currency.type === \"item\")\r\n      .map(currency => ({ id: currency.id, quantity: currency.quantity }));\r\n\r\n    const attributesToTransfer = sourceCurrencies\r\n      .filter(entry => entry.type === \"attribute\")\r\n      .map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n    const sourceTransaction = new Transaction(sourceActor);\r\n    await sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true });\r\n    await sourceTransaction.appendItemChanges(itemCurrenciesToTransfer, {\r\n      remove: true,\r\n      type: \"currency\"\r\n    });\r\n    await sourceTransaction.appendActorChanges(attributesToTransfer, { remove: true, type: \"currency\" });\r\n    const sourceUpdates = sourceTransaction.prepare();\r\n\r\n    const targetTransaction = new Transaction(targetActor);\r\n    await targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n    await targetTransaction.appendActorChanges(sourceUpdates.attributeDeltas);\r\n    const targetUpdates = targetTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_TRANSFER_EVERYTHING, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    await sourceTransaction.commit();\r\n    const { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n    await ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.TRANSFER_EVERYTHING, sourceUuid, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n    const macroData = {\r\n      action: \"transferEverything\",\r\n      source: sourceUuid,\r\n      target: targetUuid,\r\n      items: itemDeltas,\r\n      attributes: attributeDeltas,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    };\r\n    await this._executeItemPileMacro(sourceUuid, macroData);\r\n    await this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(sourceUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(sourceUuid);\r\n    }\r\n\r\n    return {\r\n      itemsTransferred: itemDeltas, attributesTransferred: attributeDeltas\r\n    };\r\n\r\n  }\r\n\r\n  static async _commitActorChanges(actorUuid, {\r\n    actorUpdates = {},\r\n    itemsToUpdate = [],\r\n    itemsToDelete = [],\r\n    itemsToCreate = []\r\n  } = {}) {\r\n    const actor = Utilities.getActor(actorUuid);\r\n    if (!foundry.utils.isEmpty(actorUpdates)) {\r\n      await actor.update(actorUpdates);\r\n    }\r\n    const createdItems = itemsToCreate.length ? await actor.createEmbeddedDocuments(\"Item\", itemsToCreate) : [];\r\n    if (itemsToUpdate.length) await actor.updateEmbeddedDocuments(\"Item\", itemsToUpdate);\r\n    if (itemsToDelete.length) await actor.deleteEmbeddedDocuments(\"Item\", itemsToDelete);\r\n    return createdItems.map(item => item.toObject());\r\n  }\r\n\r\n  /**\r\n   * If not given an actor, this method creates an item pile at a location, then adds an item to it.\r\n   *\r\n   * If a target was provided, it will just add the item to that target actor.\r\n   *\r\n   * If an actor was provided, it will transfer the item from the actor to the target actor.\r\n   *\r\n   * @param {String} userId\r\n   * @param {String} sceneId\r\n   * @param {String/Boolean} [sourceUuid=false]\r\n   * @param {String/Boolean} [targetUuid=false]\r\n   * @param {Object/Boolean} [position=false]\r\n   * @param {Number/Boolean} [elevation=false]\r\n   * @param {Object} [itemData=false]\r\n   *\r\n   * @returns {sourceUuid: string/boolean, targetUuid: string/boolean, position: object/boolean, itemsDropped: array }\r\n   */\r\n  static async _dropItems({\r\n    userId, sceneId, sourceUuid = false, targetUuid = false, itemData = false, position = false, elevation = false\r\n  } = {}) {\r\n\r\n    let itemsDropped;\r\n\r\n    // If there's a source of the item (it wasn't dropped from the item bar)\r\n    if (sourceUuid) {\r\n\r\n      setProperty(itemData.item, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE, itemData.quantity);\r\n\r\n      // If there's a target token, add the item to it, otherwise create a new pile at the drop location\r\n      if (targetUuid) {\r\n        itemsDropped = await this._transferItems(sourceUuid, targetUuid, [itemData.item], userId);\r\n      } else {\r\n        itemsDropped = (await this._removeItems(sourceUuid, [itemData.item], userId)).map(item => {\r\n          item.quantity = Math.abs(item.quantity)\r\n          Utilities.setItemQuantity(item.item, Math.abs(item.quantity), true);\r\n          return item;\r\n        });\r\n        targetUuid = await this._createItemPile({\r\n          sceneId, position, items: itemsDropped, tokenOverrides: {\r\n            elevation: elevation || fromUuidSync(sourceUuid)?.elevation || 0\r\n          }\r\n        })\r\n      }\r\n\r\n      // If there's no source (it was dropped from the item bar)\r\n    } else {\r\n\r\n      // If there's a target token, add the item to it, otherwise create a new pile at the drop location\r\n      if (targetUuid) {\r\n        itemsDropped = await this._addItems(targetUuid, [itemData], userId);\r\n      } else {\r\n        targetUuid = await this._createItemPile({\r\n          sceneId,\r\n          position,\r\n          items: [itemData],\r\n          tokenOverrides: { elevation: elevation || 0 }\r\n        });\r\n      }\r\n\r\n    }\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.DROP, sourceUuid, targetUuid, itemsDropped, position);\r\n\r\n    return { sourceUuid, targetUuid, position, itemsDropped };\r\n\r\n  }\r\n\r\n  static async _createItemPile({\r\n    sceneId = null,\r\n    position = false,\r\n    actor = false,\r\n    createActor = false,\r\n    items = false,\r\n    tokenOverrides = {},\r\n    actorOverrides = {},\r\n    itemPileFlags = {},\r\n    folders = false,\r\n  } = {}) {\r\n\r\n    let returns = {};\r\n\r\n    let pileActor;\r\n\r\n    if (createActor) {\r\n\r\n      let pileDataDefaults = foundry.utils.deepClone(CONSTANTS.PILE_DEFAULTS);\r\n\r\n      pileDataDefaults.enabled = true;\r\n      if (foundry.utils.isEmpty(itemPileFlags)) {\r\n        pileDataDefaults.deleteWhenEmpty = true;\r\n        pileDataDefaults.displayOne = true;\r\n        pileDataDefaults.showItemName = true;\r\n        pileDataDefaults.overrideSingleItemScale = true;\r\n        pileDataDefaults.singleItemScale = 0.75;\r\n      }\r\n\r\n      pileDataDefaults = foundry.utils.mergeObject(pileDataDefaults, itemPileFlags);\r\n\r\n      const actorData = {\r\n        name: actor || \"New Item Pile\",\r\n        type: Helpers.getSetting(\"actorClassType\"),\r\n        img: \"icons/svg/item-bag.svg\"\r\n      };\r\n\r\n      if (folders) {\r\n        const folder = await Utilities.createFoldersFromNames(folders);\r\n        if (folder) {\r\n          actorData.folder = folder.id;\r\n        }\r\n      }\r\n\r\n      pileActor = await Actor.create(actorData);\r\n\r\n      const prototypeTokenData = foundry.utils.mergeObject({\r\n        name: \"Item Pile\",\r\n        actorLink: false,\r\n        bar1: { attribute: \"\" },\r\n        vision: false,\r\n        displayName: 50,\r\n        [CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n        [CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\r\n        ...Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS)\r\n      }, tokenOverrides)\r\n\r\n      const actorUpdate = foundry.utils.mergeObject({\r\n        [CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n        [CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\r\n        prototypeToken: prototypeTokenData,\r\n      }, actorOverrides)\r\n\r\n      await pileActor.update(actorUpdate);\r\n\r\n    } else if (!actor) {\r\n\r\n      pileActor = game.actors.get(Helpers.getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID));\r\n\r\n      if (!pileActor) {\r\n\r\n        Helpers.custom_notify(\"A Default Item Pile has been added to your Actors list. You can configure the default look and behavior on it, or duplicate it to create different styles.\")\r\n\r\n        let pileDataDefaults = foundry.utils.deepClone(CONSTANTS.PILE_DEFAULTS);\r\n\r\n        pileDataDefaults.enabled = true;\r\n        if (foundry.utils.isEmpty(itemPileFlags)) {\r\n          pileDataDefaults.deleteWhenEmpty = true;\r\n          pileDataDefaults.displayOne = true;\r\n          pileDataDefaults.showItemName = true;\r\n          pileDataDefaults.overrideSingleItemScale = true;\r\n          pileDataDefaults.singleItemScale = 0.75;\r\n        }\r\n\r\n        pileDataDefaults = foundry.utils.mergeObject(pileDataDefaults, itemPileFlags);\r\n\r\n        const actorData = {\r\n          name: \"Default Item Pile\",\r\n          type: Helpers.getSetting(\"actorClassType\"),\r\n          img: \"icons/svg/item-bag.svg\"\r\n        };\r\n\r\n        if (folders) {\r\n          const folder = await Utilities.createFoldersFromNames(folders);\r\n          if (folder) {\r\n            actorData.folder = folder.id;\r\n          }\r\n        }\r\n\r\n        pileActor = await Actor.create(actorData);\r\n\r\n        await pileActor.update({\r\n          [CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n          [CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\r\n          prototypeToken: {\r\n            name: \"Item Pile\",\r\n            actorLink: false,\r\n            bar1: { attribute: \"\" },\r\n            vision: false,\r\n            displayName: 50,\r\n            [CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n            [CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\r\n            ...Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS)\r\n          }\r\n        })\r\n\r\n        await game.settings.set(CONSTANTS.MODULE_NAME, \"defaultItemPileActorID\", pileActor.id);\r\n\r\n      }\r\n\r\n    } else {\r\n\r\n      pileActor = await fromUuid(actor);\r\n\r\n      if (!pileActor) {\r\n        throw Helpers.custom_error(\"Could not find actor with UUID \" + actor);\r\n      }\r\n\r\n    }\r\n\r\n    if (items) {\r\n      for (let i = 0; i < items.length; i++) {\r\n        let itemData = items[i]?.item ?? items[i];\r\n        itemData = await Item.implementation.create(itemData, { temporary: true });\r\n        itemData = itemData.toObject();\r\n        if (SYSTEMS.DATA.ITEM_TRANSFORMER) {\r\n          itemData = await SYSTEMS.DATA.ITEM_TRANSFORMER(itemData);\r\n        }\r\n        items[i] = itemData;\r\n      }\r\n    } else {\r\n      items = []\r\n    }\r\n\r\n    items = items ? items.map(item => {\r\n      return item.item ?? item;\r\n    }) : [];\r\n\r\n    if (position && sceneId) {\r\n\r\n      let overrideData = foundry.utils.mergeObject({\r\n        ...position,\r\n        ...tokenOverrides,\r\n        ...Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS)\r\n      }, {});\r\n\r\n      let pileData = PileUtilities.getActorFlagData(pileActor);\r\n      pileData.enabled = true;\r\n      pileData = foundry.utils.mergeObject(pileData, itemPileFlags);\r\n\r\n      if (!pileActor.prototypeToken.actorLink) {\r\n\r\n        overrideData['actorData'] = actorOverrides;\r\n\r\n        const data = { data: pileData, items: [...items] };\r\n\r\n        for (let index = 0; index < data.items.length; index++) {\r\n          data.items[index] = await Item.implementation.create(data.items[index], { temporary: true });\r\n        }\r\n\r\n        const overrideImage = getProperty(overrideData, \"texture.src\") ?? getProperty(overrideData, \"img\");\r\n        const overrideScale = getProperty(overrideData, \"texture.scaleX\")\r\n          ?? getProperty(overrideData, \"texture.scaleY\")\r\n          ?? getProperty(overrideData, \"scale\");\r\n\r\n        const scale = PileUtilities.getItemPileTokenScale(pileActor, data, overrideScale);\r\n\r\n        overrideData = foundry.utils.mergeObject(overrideData, {\r\n          \"texture.src\": PileUtilities.getItemPileTokenImage(pileActor, data, overrideImage),\r\n          \"texture.scaleX\": scale,\r\n          \"texture.scaleY\": scale,\r\n          \"name\": PileUtilities.getItemPileName(pileActor, data, overrideData?.name),\r\n        });\r\n\r\n      }\r\n\r\n      const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CREATE, overrideData, items);\r\n      if (hookResult === false) return false;\r\n\r\n      const tokenData = await pileActor.getTokenDocument(overrideData);\r\n\r\n      const scene = game.scenes.get(sceneId);\r\n\r\n      const [tokenDocument] = await scene.createEmbeddedDocuments(\"Token\", [tokenData]);\r\n\r\n      if (items.length && !pileActor.prototypeToken.actorLink) {\r\n        new Promise(async (resolve) => {\r\n          await Helpers.wait(250);\r\n          await Helpers.hooks.runWithout(async () => {\r\n            await tokenDocument.actor.createEmbeddedDocuments(\"Item\", items);\r\n          });\r\n          resolve();\r\n        });\r\n      }\r\n\r\n      returns[\"tokenUuid\"] = Utilities.getUuid(tokenDocument);\r\n\r\n    } else if (pileActor.prototypeToken.actorLink) {\r\n\r\n      if (items.length && !pileActor.prototypeToken.actorLink) {\r\n        await Helpers.hooks.runWithout(async () => {\r\n          await pileActor.createEmbeddedDocuments(\"Item\", items);\r\n        });\r\n      }\r\n\r\n    }\r\n\r\n    returns[\"actorUuid\"] = pileActor.uuid;\r\n\r\n    return returns;\r\n\r\n  }\r\n\r\n  static async _turnTokensIntoItemPiles(targetUuids, pileSettings = {}, tokenSettings = {}) {\r\n\r\n    const tokenUpdateGroups = {};\r\n    const actorUpdateGroups = {};\r\n\r\n    for (const targetUuid of targetUuids) {\r\n\r\n      const target = fromUuidSync(targetUuid);\r\n\r\n      let targetItemPileSettings = PileUtilities.getActorFlagData(target);\r\n\r\n      const defaultItemPileId = Helpers.getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID);\r\n      const defaultItemPileActor = game.actors.get(defaultItemPileId);\r\n      if (defaultItemPileActor) {\r\n        const defaultItemPileSettings = PileUtilities.getActorFlagData(defaultItemPileActor);\r\n        targetItemPileSettings = foundry.utils.mergeObject(targetItemPileSettings, defaultItemPileSettings);\r\n      }\r\n\r\n      let specificPileSettings = foundry.utils.mergeObject(targetItemPileSettings, pileSettings);\r\n      specificPileSettings.enabled = true;\r\n\r\n      const targetItems = PileUtilities.getActorItems(target, { itemFilters: specificPileSettings.overrideItemFilters });\r\n      const targetCurrencies = PileUtilities.getActorCurrencies(target, { currencyList: specificPileSettings.overrideCurrencies });\r\n\r\n      const data = { data: specificPileSettings, items: targetItems, currencies: targetCurrencies };\r\n\r\n      let specificTokenSettings = Helpers.isFunction(tokenSettings)\r\n        ? await tokenSettings(target)\r\n        : foundry.utils.deepClone(tokenSettings);\r\n\r\n      const overrideImage = getProperty(specificTokenSettings, \"texture.src\") ?? getProperty(specificTokenSettings, \"img\");\r\n      const overrideScale = getProperty(specificTokenSettings, \"texture.scaleX\")\r\n        ?? getProperty(specificTokenSettings, \"texture.scaleY\")\r\n        ?? getProperty(specificTokenSettings, \"scale\");\r\n\r\n      const scale = PileUtilities.getItemPileTokenScale(target, data, overrideScale);\r\n\r\n      specificTokenSettings = foundry.utils.mergeObject(specificTokenSettings, {\r\n        \"texture.src\": PileUtilities.getItemPileTokenImage(target, data, overrideImage),\r\n        \"texture.scaleX\": scale,\r\n        \"texture.scaleY\": scale,\r\n        \"name\": PileUtilities.getItemPileName(target, data, specificTokenSettings?.name)\r\n      });\r\n\r\n      const sceneId = targetUuid.split('.')[1];\r\n      const tokenId = targetUuid.split('.')[3];\r\n\r\n      if (!tokenUpdateGroups[sceneId]) {\r\n        tokenUpdateGroups[sceneId] = []\r\n      }\r\n\r\n      tokenUpdateGroups[sceneId].push({\r\n        \"_id\": tokenId, ...specificTokenSettings,\r\n        [CONSTANTS.FLAGS.PILE]: specificPileSettings,\r\n        [`actorData.${CONSTANTS.FLAGS.PILE}`]: specificPileSettings\r\n      });\r\n\r\n      if (target.isLinked) {\r\n        if (actorUpdateGroups[target.actor.id]) continue;\r\n        actorUpdateGroups[target.actor.id] = {\r\n          \"_id\": target.actor.id,\r\n          [CONSTANTS.FLAGS.PILE]: specificPileSettings\r\n        }\r\n      }\r\n    }\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_TURN_INTO, tokenUpdateGroups, actorUpdateGroups);\r\n    if (hookResult === false) return false;\r\n\r\n    await Actor.updateDocuments(Object.values(actorUpdateGroups));\r\n\r\n    for (const [sceneId, updateData] of Object.entries(tokenUpdateGroups)) {\r\n      const scene = game.scenes.get(sceneId);\r\n      await scene.updateEmbeddedDocuments(\"Token\", updateData);\r\n    }\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.PILE.TURN_INTO, tokenUpdateGroups, actorUpdateGroups);\r\n\r\n    return targetUuids;\r\n\r\n  }\r\n\r\n  static async _revertTokensFromItemPiles(targetUuids, tokenSettings) {\r\n\r\n    const actorUpdateGroups = {};\r\n    const tokenUpdateGroups = {};\r\n\r\n    for (const targetUuid of targetUuids) {\r\n\r\n      let target = fromUuidSync(targetUuid);\r\n\r\n      let specificPileSettings = PileUtilities.getActorFlagData(target);\r\n      specificPileSettings.enabled = false;\r\n\r\n      const sceneId = targetUuid.split('.')[1];\r\n      const tokenId = targetUuid.split('.')[3];\r\n\r\n      if (!tokenUpdateGroups[sceneId]) {\r\n        tokenUpdateGroups[sceneId] = [];\r\n      }\r\n\r\n      const specificTokenSettings = Helpers.isFunction(tokenSettings)\r\n        ? await tokenSettings(target)\r\n        : foundry.utils.deepClone(tokenSettings);\r\n\r\n      tokenUpdateGroups[sceneId].push({\r\n        \"_id\": tokenId,\r\n        ...specificTokenSettings,\r\n        [CONSTANTS.FLAGS.PILE]: specificPileSettings,\r\n        [`actorData.${CONSTANTS.FLAGS.PILE}`]: specificPileSettings\r\n      });\r\n\r\n      if (target.isLinked) {\r\n        if (actorUpdateGroups[target.actor.id]) continue;\r\n        actorUpdateGroups[target.actor.id] = {\r\n          \"_id\": target.actor.id,\r\n          [CONSTANTS.FLAGS.PILE]: specificPileSettings\r\n        }\r\n      }\r\n    }\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_REVERT_FROM, tokenUpdateGroups, actorUpdateGroups);\r\n    if (hookResult === false) return false;\r\n\r\n    await Actor.updateDocuments(Object.values(actorUpdateGroups));\r\n\r\n    for (const [sceneId, updateData] of Object.entries(tokenUpdateGroups)) {\r\n      const scene = game.scenes.get(sceneId);\r\n      await scene.updateEmbeddedDocuments(\"Token\", updateData);\r\n    }\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.PILE.REVERT_FROM, tokenUpdateGroups, actorUpdateGroups);\r\n\r\n    return targetUuids;\r\n\r\n  }\r\n\r\n  static async _updateItemPile(targetUuid, newData, { interactingTokenUuid = false, tokenSettings = false } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n    const interactingToken = interactingTokenUuid ? Utilities.getToken(interactingTokenUuid) : false;\r\n\r\n    const oldData = PileUtilities.getActorFlagData(targetActor);\r\n\r\n    const data = foundry.utils.mergeObject(foundry.utils.deepClone(oldData), foundry.utils.deepClone(newData));\r\n\r\n    const diff = foundry.utils.diffObject(oldData, data);\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_UPDATE, targetActor, data, interactingToken, tokenSettings);\r\n    if (hookResult === false) return false;\r\n\r\n    await Helpers.wait(15);\r\n\r\n    await PileUtilities.updateItemPileData(targetActor, data, tokenSettings);\r\n\r\n    if (PileUtilities.isItemPileContainer(targetActor, data)) {\r\n      if (diff?.closed === true) {\r\n        await this._executeItemPileMacro(targetUuid, {\r\n          action: \"closeItemPile\", source: interactingTokenUuid, target: targetUuid\r\n        });\r\n      }\r\n      if (diff?.locked === true) {\r\n        await this._executeItemPileMacro(targetUuid, {\r\n          action: \"lockItemPile\", source: interactingTokenUuid, target: targetUuid\r\n        });\r\n      }\r\n      if (diff?.locked === false) {\r\n        await this._executeItemPileMacro(targetUuid, {\r\n          action: \"unlockItemPile\", source: interactingTokenUuid, target: targetUuid\r\n        });\r\n      }\r\n      if (diff?.closed === false) {\r\n        await this._executeItemPileMacro(targetUuid, {\r\n          action: \"openItemPile\", source: interactingTokenUuid, target: targetUuid\r\n        });\r\n      }\r\n    }\r\n\r\n    return ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.UPDATED_PILE, targetUuid, diff, interactingTokenUuid);\r\n  }\r\n\r\n  static _updatedItemPile(targetUuid, diffData, interactingTokenUuid) {\r\n\r\n    const target = Utilities.getToken(targetUuid);\r\n\r\n    const interactingToken = interactingTokenUuid ? fromUuidSync(interactingTokenUuid) : false;\r\n\r\n    if (foundry.utils.isEmpty(diffData)) return false;\r\n\r\n    const data = PileUtilities.getActorFlagData(target);\r\n\r\n    Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.UPDATE, target, diffData, interactingToken)\r\n\r\n    if (PileUtilities.isItemPileContainer(target, data)) {\r\n      if (diffData?.closed === true) {\r\n        Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.CLOSE, target, interactingToken)\r\n      }\r\n      if (diffData?.locked === true) {\r\n        Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.LOCK, target, interactingToken)\r\n      }\r\n      if (diffData?.locked === false) {\r\n        Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.UNLOCK, target, interactingToken)\r\n      }\r\n      if (diffData?.closed === false) {\r\n        Helpers.hooks.callAll(CONSTANTS.HOOKS.PILE.OPEN, target, interactingToken)\r\n      }\r\n    }\r\n  }\r\n\r\n  static async _deleteItemPile(targetUuid) {\r\n    const target = Utilities.getToken(targetUuid);\r\n    if (!target) return false;\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_DELETE, target);\r\n    if (hookResult === false) return false;\r\n    return target.document.delete();\r\n  }\r\n\r\n  /* -------- PRIVATE ITEM PILE METHODS -------- */\r\n\r\n  /**\r\n   * Checks whether a given item pile would need to update its images, text, and/or scale\r\n   *\r\n   * @param {foundry.abstract.Document} doc\r\n   * @param {object} changes\r\n   * @param {boolean} force\r\n   * @returns {*}\r\n   * @private\r\n   */\r\n  static _evaluateItemPileChange(doc, changes = {}, force = false) {\r\n    const duplicatedChanges = foundry.utils.deepClone(changes);\r\n    const target = doc?.token ?? doc;\r\n    if (!Helpers.isResponsibleGM()) return;\r\n    if (!force && !PileUtilities.shouldEvaluateChange(target, duplicatedChanges)) return;\r\n    const targetUuid = target.uuid;\r\n    return Helpers.debounceManager.setDebounce(targetUuid, async (uuid) => {\r\n      if (!Utilities.getDocument(uuid)) return;\r\n      const deleted = PileUtilities.shouldItemPileBeDeleted(uuid);\r\n      if (deleted) return;\r\n      await Helpers.hooks.runWithout(async () => {\r\n        await PileUtilities.updateItemPileData(uuid);\r\n      });\r\n    })(targetUuid);\r\n  }\r\n\r\n  /**\r\n   * Pre-loads all images and sounds related to a given token document on the client-side.\r\n   *\r\n   * @param {TokenDocument} tokenDocument\r\n   * @return {Promise<boolean>}\r\n   */\r\n  static async _preloadItemPileFiles(tokenDocument) {\r\n\r\n    if (!PileUtilities.isItemPileContainer(tokenDocument)) return false;\r\n\r\n    const pileData = PileUtilities.getActorFlagData(tokenDocument);\r\n\r\n    if (Helpers.getSetting(\"preloadFiles\")) {\r\n      await Promise.allSettled(Object.entries(pileData).map(entry => {\r\n        return new Promise(async (resolve) => {\r\n          const [property, filePath] = entry;\r\n          if (Array.isArray(filePath)) {\r\n            return resolve();\r\n          }\r\n          const isImage = property.toLowerCase().includes(\"image\");\r\n          const isSound = property.toLowerCase().includes(\"sound\");\r\n          if ((!isImage && !isSound) || (!filePath || preloadedFiles.has(filePath))) return resolve();\r\n          preloadedFiles.add(filePath);\r\n          if (isImage) {\r\n            await loadTexture(filePath);\r\n            Helpers.debug(`Preloaded image: ${filePath}`);\r\n          } else if (isSound) {\r\n            Helpers.debug(`Preloaded sound: ${filePath}`);\r\n            await AudioHelper.preloadSound(filePath);\r\n          }\r\n          resolve();\r\n        });\r\n      }));\r\n    }\r\n\r\n    Helpers.debug(`Initialized item pile with uuid ${tokenDocument.uuid}`);\r\n  }\r\n\r\n  /**\r\n   * This executes any macro that is configured on the item pile, providing the macro with extra data relating to the\r\n   * action that prompted the execution (if the advanced-macros module is installed)\r\n   *\r\n   * @param {String} targetUuid\r\n   * @param {Object} macroData\r\n   * @return {Promise/Boolean}\r\n   */\r\n  static async _executeItemPileMacro(targetUuid, macroData) {\r\n\r\n    const target = Utilities.getToken(targetUuid);\r\n\r\n    if (!PileUtilities.isValidItemPile(target)) return false;\r\n\r\n    const pileData = PileUtilities.getActorFlagData(target);\r\n\r\n    if (!pileData.macro) return false;\r\n\r\n    // Reformat macro data to contain useful information\r\n    if (macroData.source) {\r\n      macroData.source = fromUuidSync(macroData.source);\r\n    }\r\n\r\n    if (Array.isArray(macroData.target)) {\r\n\r\n      macroData.target = macroData.target.map(target => fromUuidSync(target));\r\n\r\n    } else {\r\n\r\n      if (macroData.target) {\r\n        macroData.target = fromUuidSync(macroData.target);\r\n      }\r\n\r\n      const sourceActor = macroData.source instanceof TokenDocument ? macroData.source.actor : macroData.source;\r\n      const targetActor = macroData.target instanceof TokenDocument ? macroData.target.actor : macroData.target;\r\n\r\n      if (macroData.items) {\r\n        macroData.items = macroData.items.map(item => targetActor.items.get(item?.item?._id ?? item._id));\r\n      }\r\n\r\n      if (macroData.sourceItems) {\r\n        macroData.sourceItems = macroData.sourceItems.map(item => sourceActor.items.get(item?.item?._id ?? item._id));\r\n      }\r\n\r\n      if (macroData.targetItems) {\r\n        macroData.targetItems = macroData.targetItems.map(item => targetActor.items.get(item?.item?._id ?? item._id));\r\n      }\r\n\r\n    }\r\n\r\n    return Utilities.runMacro(pileData.macro, macroData)\r\n\r\n  }\r\n\r\n  /**\r\n   * This handles any dropped data onto the canvas or a set item pile\r\n   *\r\n   * @param {canvas} canvas\r\n   * @param {Object} data\r\n   * @return {Promise}\r\n   */\r\n  static async _dropData(canvas, data) {\r\n\r\n    if (data.type !== \"Item\") return;\r\n\r\n    let item = await Item.implementation.fromDropData(data);\r\n    let itemData = item ? item.toObject() : false;\r\n\r\n    if (!itemData) {\r\n      console.error(data);\r\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n    }\r\n\r\n    const dropData = {\r\n      source: false,\r\n      target: data?.target ?? false,\r\n      elevation: data?.elevation,\r\n      itemData: {\r\n        item: itemData, quantity: 1,\r\n      },\r\n      position: false\r\n    };\r\n\r\n    dropData.source = Utilities.getSourceActorFromDropData(data);\r\n\r\n    if (!dropData.source && !game.user.isGM) {\r\n      return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.NoSourceDrop\"), true)\r\n    }\r\n\r\n    const pre_drop_determined_hook = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_DROP_DETERMINED, dropData.source, dropData.target, dropData.itemData, dropData.position);\r\n    if (pre_drop_determined_hook === false) return;\r\n\r\n    let droppableDocuments = [];\r\n    let x, y;\r\n\r\n    if (dropData.target) {\r\n\r\n      droppableDocuments.push(dropData.target);\r\n\r\n    } else {\r\n\r\n      const position = canvas.grid.getTopLeft(data.x, data.y);\r\n      x = position[0];\r\n      y = position[1];\r\n\r\n      droppableDocuments = Utilities.getTokensAtLocation({ x, y })\r\n        .map(token => Utilities.getDocument(token));\r\n\r\n      if (droppableDocuments.length && game.modules.get(\"midi-qol\")?.active && game.settings.get(\"midi-qol\", \"DragDropTarget\")) {\r\n        Helpers.custom_warning(\"You have Drag & Drop Targetting enabled in MidiQOL, which disables drag & drop items\");\r\n        return;\r\n      }\r\n\r\n      if (!droppableDocuments.length) {\r\n        dropData.position = { x, y };\r\n      }\r\n    }\r\n\r\n    const droppableItemPiles = droppableDocuments.filter(token => PileUtilities.isValidItemPile(token));\r\n    const droppableNormalTokens = droppableDocuments.filter(token => !PileUtilities.isValidItemPile(token));\r\n\r\n    dropData.target = droppableItemPiles?.[0] ?? droppableNormalTokens[0];\r\n\r\n    const sourceIsVault = dropData.source ? PileUtilities.isItemPileVault(dropData.source) : false;\r\n    const targetIsVault = PileUtilities.isItemPileVault(dropData.target);\r\n    const targetIsItemPile = PileUtilities.isValidItemPile(droppableItemPiles[0]);\r\n\r\n    const canGiveItems = Helpers.getSetting(SETTINGS.ENABLE_GIVING_ITEMS);\r\n    const canDropItems = Helpers.getSetting(SETTINGS.ENABLE_DROPPING_ITEMS);\r\n\r\n    const givingItem = canGiveItems && dropData.target && !targetIsItemPile;\r\n    const droppingItem = canDropItems && (dropData.target || dropData.position);\r\n\r\n    if ((sourceIsVault || targetIsVault) && dropData.target) {\r\n      return this._depositWithdrawItem(dropData, sourceIsVault, targetIsVault);\r\n    } else if (givingItem && canGiveItems) {\r\n      return this._giveItem(dropData);\r\n    } else if (droppingItem && canDropItems) {\r\n      return this._dropItem(dropData);\r\n    }\r\n\r\n  }\r\n\r\n  static async _depositWithdrawItem(dropData, sourceIsVault = false, targetIsVault = true) {\r\n\r\n    const sourceActor = Utilities.getActor(dropData.source);\r\n    const targetActor = Utilities.getActor(dropData.target);\r\n    if (sourceActor && targetActor && sourceActor === targetActor) return;\r\n\r\n    const vaultActor = (!sourceIsVault && targetIsVault) || !sourceActor ? targetActor : sourceActor;\r\n    const localization = (!sourceIsVault && targetIsVault) || !sourceActor ? \"DepositItem\" : \"WithdrawItem\";\r\n\r\n    const validItem = await PileUtilities.checkItemType(vaultActor, dropData.itemData.item);\r\n    if (!validItem) return;\r\n    dropData.itemData.item = validItem;\r\n\r\n    const item = await Item.implementation.create(dropData.itemData.item, { temporary: true });\r\n\r\n    let itemQuantity = Utilities.getItemQuantity(dropData.itemData.item);\r\n    if (itemQuantity > 1 && PileUtilities.canItemStack(dropData.itemData.item, vaultActor)) {\r\n      const quantity = await DropItemDialog.show(item, vaultActor, {\r\n        localizationTitle: localization\r\n      });\r\n      Utilities.setItemQuantity(dropData.itemData.item, quantity);\r\n      dropData.itemData.quantity = quantity;\r\n    } else {\r\n      dropData.itemData.quantity = 1;\r\n    }\r\n\r\n    let flagData = PileUtilities.getItemFlagData(dropData.itemData.item);\r\n    if (!sourceIsVault && targetIsVault) {\r\n      setProperty(flagData, \"x\", dropData.gridPosition.x);\r\n      setProperty(flagData, \"y\", dropData.gridPosition.y);\r\n    }\r\n    setProperty(dropData.itemData, CONSTANTS.FLAGS.ITEM, flagData);\r\n\r\n    if (sourceActor) {\r\n      return game.itempiles.API.transferItems(sourceActor, targetActor, [dropData.itemData], { interactionId: dropData.interactionId });\r\n    }\r\n\r\n    if (!game.user.isGM) return;\r\n\r\n    return game.itempiles.API.addItems(targetActor, [dropData.itemData], { interactionId: dropData.interactionId });\r\n\r\n  }\r\n\r\n  static async _giveItem(dropData) {\r\n\r\n    const sourceActor = Utilities.getActor(dropData.source);\r\n    const targetActor = Utilities.getActor(dropData.target);\r\n    if (sourceActor === targetActor) return;\r\n\r\n    const sourceUuid = Utilities.getUuid(sourceActor);\r\n    const targetUuid = Utilities.getUuid(targetActor);\r\n\r\n    const validItem = await PileUtilities.checkItemType(dropData.target, dropData.itemData.item);\r\n    if (!validItem) return;\r\n    dropData.itemData.item = validItem;\r\n\r\n    const actorOwners = Object.entries(dropData.target?.actor?.ownership ?? dropData.target?.ownership)\r\n      .filter(entry => {\r\n        return entry[0] !== \"default\" && entry[1] === CONST.DOCUMENT_PERMISSION_LEVELS.OWNER;\r\n      })\r\n      .map(entry => game.users.get(entry[0]))\r\n      .sort(user => user.isGM ? 1 : -1);\r\n\r\n    const user = actorOwners?.[0];\r\n\r\n    if (user && !user?.active && !game.user.isGM) {\r\n      return TJSDialog.prompt({\r\n        title: game.i18n.localize(\"ITEM-PILES.Dialogs.GiveItemUserNotActive.Title\"), content: {\r\n          class: CustomDialog, props: {\r\n            content: game.i18n.format(\"ITEM-PILES.Dialogs.GiveItemUserNotActive.Content\", {\r\n              actor_name: dropData.target.actor.name, user_name: user.name\r\n            })\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    const item = await Item.implementation.create(dropData.itemData.item, { temporary: true });\r\n\r\n    if (!dropData.source && game.user.isGM) {\r\n      Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ItemAdded\", {\r\n        target_actor_name: dropData.target.name, item_name: item.name\r\n      }));\r\n      return this._addItems(targetUuid, [dropData.itemData.item], game.user.id)\r\n    }\r\n\r\n    const gms = Helpers.getActiveGMs().map(user => user.id);\r\n\r\n    if (user?.active || gms.length || game.user.isGM) {\r\n\r\n      if (PileUtilities.canItemStack(dropData.itemData.item)) {\r\n        const quantity = await DropItemDialog.show(item, dropData.target.actor, {\r\n          localizationTitle: \"GiveItem\"\r\n        });\r\n        Utilities.setItemQuantity(dropData.itemData.item, quantity);\r\n        dropData.itemData.quantity = quantity;\r\n      } else {\r\n        dropData.itemData.quantity = 1;\r\n      }\r\n\r\n      if (Hooks.call(CONSTANTS.HOOKS.ITEM.PRE_GIVE, dropData.source, dropData.target, dropData.itemData, user.id) === false) {\r\n        return;\r\n      }\r\n\r\n      if ((!user || !user?.active || user === game.user) && game.user.isGM) {\r\n        if (dropData.source) {\r\n          Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ItemTransferred\", {\r\n            source_actor_name: dropData.source.name, target_actor_name: dropData.target.name, item_name: item.name\r\n          }));\r\n          Hooks.callAll(CONSTANTS.HOOKS.ITEM.GIVE, dropData.source, dropData.target, dropData.itemData, game.user.id);\r\n          return this._transferItems(sourceUuid, targetUuid, [dropData.itemData.item], game.user.id)\r\n        }\r\n      }\r\n\r\n      return ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.GIVE_ITEMS, [user ? user.id : gms[0]], {\r\n        userId: game.user.id, sourceUuid, targetUuid, itemData: dropData.itemData\r\n      });\r\n    }\r\n  }\r\n\r\n  static async _dropItem(dropData) {\r\n\r\n    const sourceActor = Utilities.getActor(dropData.source);\r\n    const targetActor = Utilities.getActor(dropData.target);\r\n    if (sourceActor && targetActor && sourceActor === targetActor) return;\r\n\r\n    if (dropData.target && PileUtilities.isItemPileMerchant(dropData.target)) return;\r\n\r\n    const validItem = await PileUtilities.checkItemType(dropData.target, dropData.itemData.item);\r\n    if (!validItem) return;\r\n    dropData.itemData.item = validItem;\r\n\r\n    if (dropData.target && !dropData.position && !game.user.isGM) {\r\n\r\n      if (!(dropData.target instanceof Actor && dropData.source instanceof Actor)) {\r\n\r\n        const sourceToken = canvas.tokens.placeables.find(token => token.actor === dropData.source);\r\n\r\n        if (sourceToken) {\r\n\r\n          const distance = Math.floor(Utilities.distance_between_rect(sourceToken, dropData.target.object) / canvas.grid.size) + 1\r\n\r\n          const pileData = PileUtilities.getActorFlagData(dropData.target);\r\n\r\n          const maxDistance = pileData?.distance ? pileData?.distance : Infinity;\r\n\r\n          if (distance > maxDistance) {\r\n            Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.PileTooFar\"), true);\r\n            return;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (game.itempiles.API.isItemPileLocked(dropData.target)) {\r\n        Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.PileLocked\"), true);\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (PileUtilities.canItemStack(dropData.itemData.item, targetActor)) {\r\n      if (hotkeyState.altDown) {\r\n\r\n        Utilities.setItemQuantity(dropData.itemData.item, 1);\r\n        dropData.itemData.quantity = 1;\r\n\r\n      } else {\r\n\r\n        let quantity = Utilities.getItemQuantity(dropData.itemData.item) ?? 1;\r\n\r\n        if (!dropData.skipCheck) {\r\n          const item = await Item.implementation.create(dropData.itemData.item, { temporary: true });\r\n          quantity = await DropItemDialog.show(item, dropData.target, { unlimitedQuantity: !dropData.source && game.user.isGM });\r\n          if (!quantity) return;\r\n        }\r\n\r\n        Utilities.setItemQuantity(dropData.itemData.item, Number(quantity));\r\n        dropData.itemData.quantity = Number(quantity);\r\n\r\n      }\r\n    }\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_DROP, dropData.source, dropData.target, dropData.position, dropData.itemData);\r\n    if (hookResult === false) return;\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DROP_ITEMS, {\r\n      userId: game.user.id,\r\n      sceneId: canvas?.scene?.id ?? \"\",\r\n      sourceUuid: Utilities.getUuid(dropData.source),\r\n      targetUuid: Utilities.getUuid(dropData.target),\r\n      position: dropData.position,\r\n      elevation: dropData.elevation,\r\n      itemData: dropData.itemData\r\n    });\r\n\r\n  }\r\n\r\n  static async _giveItems({ userId, sourceUuid, targetUuid, itemData } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const item = await Item.implementation.create(itemData.item, { temporary: true });\r\n\r\n    const accepted = await TJSDialog.confirm({\r\n      title: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.ReceiveItem.Title\"),\r\n      content: {\r\n        class: GiveItemsShell,\r\n        props: {\r\n          sourceActor,\r\n          targetActor,\r\n          quantity: itemData.quantity,\r\n          item\r\n        }\r\n      }\r\n    });\r\n\r\n    if (accepted) {\r\n      await PrivateAPI._addItems(targetUuid, [itemData], game.user.id);\r\n    }\r\n\r\n    return ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.GIVE_ITEMS_RESPONSE, [userId], {\r\n      userId: game.user.id, accepted, sourceUuid, targetUuid, itemData\r\n    });\r\n\r\n  }\r\n\r\n  static async _giveItemsResponse({ userId, accepted, sourceUuid, targetUuid, itemData } = {}) {\r\n    const user = game.users.get(userId);\r\n    if (accepted) {\r\n      await ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.GIVE, sourceUuid, targetUuid, itemData, game.user.id, userId)\r\n      await PrivateAPI._removeItems(sourceUuid, [itemData], game.user.id);\r\n      return Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.GiveItemAccepted\", { user_name: user.name }));\r\n    }\r\n    return Helpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.GiveItemDeclined\", { user_name: user.name }), true);\r\n  }\r\n\r\n  static async _itemPileClicked(pileDocument) {\r\n\r\n    if (!PileUtilities.isValidItemPile(pileDocument)) return;\r\n\r\n    const pileToken = pileDocument.object;\r\n\r\n    if (!Helpers.isGMConnected()) {\r\n      Helpers.custom_warning(`Item Piles requires a GM to be connected for players to be able to loot item piles.`, true)\r\n      return;\r\n    }\r\n\r\n    Helpers.debug(`Clicked: ${pileDocument.uuid}`);\r\n\r\n    const pileData = PileUtilities.getActorFlagData(pileDocument);\r\n\r\n    const maxDistance = pileData.distance ? pileData.distance : Infinity;\r\n\r\n    let validTokens = [];\r\n\r\n    let playerToken = false;\r\n    if (game.user.character) {\r\n      playerToken = canvas.tokens.placeables.find(token => token.actor === game.user.character && Utilities.tokens_close_enough(pileToken, token, maxDistance));\r\n    }\r\n\r\n    if (!playerToken && canvas.tokens.controlled.length > 0) {\r\n      validTokens = [...canvas.tokens.controlled];\r\n      validTokens = validTokens.filter(token => token.document !== pileDocument);\r\n    } else if (game.user.character) {\r\n      if (playerToken) {\r\n        validTokens.push(playerToken);\r\n      }\r\n    }\r\n\r\n    if (!validTokens.length && !game.user.isGM) {\r\n      validTokens.push(...canvas.tokens.placeables);\r\n      if (_token) {\r\n        validTokens.unshift(_token);\r\n      }\r\n    }\r\n\r\n    validTokens = validTokens.filter(token => token.owner && token.document !== pileDocument).filter(token => {\r\n      return Utilities.tokens_close_enough(pileToken, token, maxDistance) || game.user.isGM;\r\n    });\r\n\r\n    let interactingActor;\r\n\r\n    if (!validTokens.length && !game.user.isGM) {\r\n      if (maxDistance === Infinity) {\r\n        interactingActor = Utilities.getUserCharacter();\r\n      }\r\n      if (!interactingActor) {\r\n        Helpers.custom_warning(game.i18n.localize(maxDistance === Infinity\r\n          ? \"ITEM-PILES.Errors.NoTokenFound\"\r\n          : \"ITEM-PILES.Errors.PileTooFar\"\r\n        ), true);\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (!interactingActor && validTokens.length) {\r\n      if (validTokens.includes(_token)) {\r\n        interactingActor = _token.actor;\r\n      } else if (validTokens.includes(playerToken)) {\r\n        interactingActor = playerToken.actor;\r\n      } else {\r\n        validTokens.sort((potentialTargetA, potentialTargetB) => {\r\n          return Utilities.grids_between_tokens(pileToken, potentialTargetA) - Utilities.grids_between_tokens(pileToken, potentialTargetB);\r\n        });\r\n        interactingActor = validTokens[0].actor;\r\n      }\r\n    }\r\n\r\n    if (PileUtilities.isItemPileContainer(pileDocument) && interactingActor) {\r\n\r\n      if (pileData.locked && !game.user.isGM) {\r\n        Helpers.debug(`Attempted to open locked item pile with UUID ${pileDocument.uuid}`);\r\n        return game.itempiles.API.rattleItemPile(pileDocument, interactingActor);\r\n      }\r\n\r\n      if (pileData.closed) {\r\n        Helpers.debug(`Opened item pile with UUID ${pileDocument.uuid}`);\r\n        await game.itempiles.API.openItemPile(pileDocument, interactingActor);\r\n      }\r\n\r\n    }\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CLICK, pileDocument, interactingActor);\r\n    if (hookResult === false) return;\r\n\r\n    return this._renderItemPileInterface(pileDocument.uuid, { inspectingTargetUuid: interactingActor?.uuid });\r\n\r\n  }\r\n\r\n  static async _splitItemPileContents(itemPileUuid, actorUuids, userId, instigator) {\r\n\r\n    const itemPileActor = Utilities.getActor(itemPileUuid);\r\n\r\n    const items = PileUtilities.getActorItems(itemPileActor);\r\n    const currencies = PileUtilities.getActorCurrencies(itemPileActor);\r\n\r\n    const pileData = PileUtilities.getActorFlagData(itemPileActor);\r\n    const shareData = SharingUtilities.getItemPileSharingData(itemPileActor);\r\n\r\n    const tempPileTransaction = new Transaction(itemPileActor);\r\n\r\n    const numPlayers = actorUuids.length;\r\n\r\n    if (pileData.shareItemsEnabled) {\r\n      const itemsToRemove = items.map(item => {\r\n        const itemData = item.toObject();\r\n        const quantity = Math.floor(Utilities.getItemQuantity(itemData) / numPlayers) * numPlayers;\r\n        return {\r\n          item: itemData, quantity\r\n        }\r\n      }).filter(entry => entry.quantity);\r\n      await tempPileTransaction.appendItemChanges(itemsToRemove, { remove: true });\r\n    }\r\n\r\n    const currencyItems = currencies.filter(entry => entry.type === \"item\").map(entry => {\r\n      const itemData = entry.item.toObject();\r\n      const quantity = Math.floor(Utilities.getItemQuantity(itemData) / numPlayers) * numPlayers;\r\n      return {\r\n        item: itemData, quantity\r\n      }\r\n    }).filter(entry => entry.quantity);\r\n    await tempPileTransaction.appendItemChanges(currencyItems, { remove: true, type: \"currency\" });\r\n\r\n    const attributes = currencies.filter(entry => entry.type === \"attribute\").map(attribute => {\r\n      return {\r\n        ...attribute, quantity: Math.floor(attribute.quantity / numPlayers) * numPlayers\r\n      }\r\n    });\r\n    await tempPileTransaction.appendActorChanges(attributes, { remove: true, type: \"currency\" });\r\n\r\n    const preparedData = tempPileTransaction.prepare();\r\n\r\n    const transactionMap = actorUuids.map(uuid => {\r\n      return [uuid, new Transaction(Utilities.getActor(uuid))];\r\n    });\r\n\r\n    for (const [uuid, transaction] of transactionMap) {\r\n\r\n      if (pileData.shareItemsEnabled) {\r\n        await transaction.appendItemChanges(deepClone(preparedData).itemDeltas.filter(delta => delta.type === \"item\").map(delta => {\r\n          delta.quantity = SharingUtilities.getItemSharesLeftForActor(itemPileActor, delta.item, transaction.actor, {\r\n            players: numPlayers, shareData: shareData, floor: true\r\n          });\r\n          return delta;\r\n        }));\r\n      }\r\n\r\n      if (pileData.shareCurrenciesEnabled || pileData.splitAllEnabled) {\r\n        await transaction.appendItemChanges(deepClone(preparedData).itemDeltas.filter(delta => delta.type === \"currency\").map(delta => {\r\n          delta.quantity = SharingUtilities.getItemSharesLeftForActor(itemPileActor, delta.item, transaction.actor, {\r\n            players: numPlayers, shareData: shareData, floor: true\r\n          });\r\n          return delta;\r\n        }), { type: \"currency\" });\r\n\r\n        await transaction.appendActorChanges(Object.entries(deepClone(preparedData).attributeDeltas).map(entry => {\r\n          let [path] = entry;\r\n          const quantity = SharingUtilities.getAttributeSharesLeftForActor(itemPileActor, path, transaction.actor, {\r\n            players: numPlayers, shareData: shareData, floor: true\r\n          });\r\n          return { path, quantity };\r\n        }));\r\n      }\r\n    }\r\n\r\n    const actorPreparedData = Object.fromEntries(transactionMap.map(entry => [entry[0], entry[1].prepare()]));\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_SPLIT_INVENTORY, itemPileActor, preparedData, actorPreparedData, userId, instigator);\r\n    if (hookResult === false) return false;\r\n\r\n    const pileDeltas = await tempPileTransaction.commit();\r\n    const actorDeltas = {};\r\n    for (const [uuid, transaction] of transactionMap) {\r\n      actorDeltas[uuid] = await transaction.commit();\r\n    }\r\n\r\n    await SharingUtilities.clearItemPileSharingData(itemPileActor);\r\n\r\n    await ItemPileSocket.callHook(CONSTANTS.HOOKS.PILE.SPLIT_INVENTORY, itemPileUuid, pileDeltas, actorDeltas, userId, instigator);\r\n\r\n    await this._executeItemPileMacro(itemPileUuid, {\r\n      action: \"splitInventory\", source: itemPileUuid, target: actorUuids, transfers: {\r\n        pileDeltas, actorDeltas\r\n      }, userId: userId, instigator: instigator\r\n    });\r\n\r\n    const shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n    if (shouldBeDeleted) {\r\n      await this._deleteItemPile(itemPileUuid);\r\n    }\r\n\r\n    return {\r\n      pileDeltas, actorDeltas\r\n    };\r\n\r\n  }\r\n\r\n  static async _updateTokenHud() {\r\n    if (!canvas.tokens.hud.rendered) return;\r\n    return canvas.tokens.hud.render(true);\r\n  }\r\n\r\n  static async _renderItemPileInterface(targetUuid, {\r\n    inspectingTargetUuid = false, useDefaultCharacter = false, remote = false\r\n  } = {}) {\r\n\r\n    const target = Utilities.getActor(targetUuid);\r\n\r\n    let inspectingTarget;\r\n    if (useDefaultCharacter) {\r\n      inspectingTarget = Utilities.getUserCharacter();\r\n    } else {\r\n      inspectingTarget = inspectingTargetUuid ? fromUuidSync(inspectingTargetUuid) : false;\r\n    }\r\n\r\n    if (PileUtilities.isItemPileVault(target)) {\r\n      return BankVaultApp.show(target, inspectingTarget)\r\n    }\r\n\r\n    if (PileUtilities.isItemPileMerchant(target)) {\r\n      return MerchantApp.show(target, inspectingTarget)\r\n    }\r\n\r\n    return ItemPileInventoryApp.show(target, inspectingTarget, { remote });\r\n\r\n  }\r\n\r\n  static async _tradeItems(sellerUuid, buyerUuid, items, userId, { interactionId = false } = {}) {\r\n\r\n    const sellingActor = Utilities.getActor(sellerUuid);\r\n    const buyingActor = Utilities.getActor(buyerUuid);\r\n\r\n    const itemPrices = PileUtilities.getPaymentData({\r\n      purchaseData: items.map(data => {\r\n        return {\r\n          ...data,\r\n          item: sellingActor.items.get(data.id)\r\n        }\r\n      }),\r\n      seller: sellingActor,\r\n      buyer: buyingActor\r\n    });\r\n\r\n    const preCalcHookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_CALC_TRADE, sellingActor, buyingActor, itemPrices, userId, interactionId);\r\n    if (preCalcHookResult === false) return false;\r\n\r\n    const sellerTransaction = new Transaction(sellingActor);\r\n    const sellerFlagData = PileUtilities.getActorFlagData(sellerTransaction);\r\n    const sellerIsMerchant = PileUtilities.isItemPileMerchant(sellingActor, sellerFlagData);\r\n    const sellerInfiniteQuantity = sellerIsMerchant && sellerFlagData.infiniteQuantity;\r\n    const sellerInfiniteCurrencies = sellerIsMerchant && sellerFlagData.infiniteCurrencies;\r\n    const sellerKeepZeroQuantity = sellerIsMerchant && sellerFlagData.keepZeroQuantity;\r\n\r\n    for (const payment of itemPrices.sellerReceive) {\r\n      if (!payment.quantity) continue;\r\n      if (payment.type === \"attribute\") {\r\n        await sellerTransaction.appendActorChanges([{\r\n          path: payment.data.path, quantity: payment.quantity\r\n        }], { type: payment.isCurrency ? \"currency\" : payment.type });\r\n      } else {\r\n        await sellerTransaction.appendItemChanges([{\r\n          item: payment.data.item, quantity: payment.quantity\r\n        }], { type: payment.isCurrency ? \"currency\" : payment.type });\r\n      }\r\n    }\r\n\r\n    for (const entry of itemPrices.buyerReceive) {\r\n      if (!entry.quantity) {\r\n        continue;\r\n      }\r\n      const onlyDelta = (sellerInfiniteCurrencies && entry.isCurrency) || (sellerInfiniteQuantity && !entry.isCurrency);\r\n      if (entry.type === \"attribute\") {\r\n        await sellerTransaction.appendActorChanges([{\r\n          path: entry.data.path, quantity: entry.quantity\r\n        }], {\r\n          remove: true,\r\n          type: entry.isCurrency ? \"currency\" : entry.type,\r\n          onlyDelta\r\n        });\r\n      } else {\r\n        const itemFlagData = PileUtilities.getItemFlagData(entry.item);\r\n        const itemInfiniteQuantity = {\r\n          \"default\": sellerFlagData?.infiniteQuantity ?? false,\r\n          \"yes\": true,\r\n          \"no\": false\r\n        }[itemFlagData.infiniteQuantity ?? \"default\"];\r\n        if (sellerIsMerchant && itemInfiniteQuantity) continue;\r\n        await sellerTransaction.appendItemChanges([{\r\n          item: entry.item, quantity: entry.quantity\r\n        }], {\r\n          remove: true,\r\n          type: entry.isCurrency ? \"currency\" : entry.type,\r\n          keepIfZero: itemFlagData.isService || sellerKeepZeroQuantity || itemFlagData.keepZeroQuantity,\r\n          onlyDelta\r\n        });\r\n      }\r\n    }\r\n\r\n    const buyerTransaction = new Transaction(buyingActor);\r\n    const buyerFlagData = PileUtilities.getActorFlagData(buyingActor);\r\n    const buyerIsMerchant = PileUtilities.isItemPileMerchant(buyingActor, buyerFlagData);\r\n    const buyerInfiniteCurrencies = buyerIsMerchant && buyerFlagData.infiniteCurrencies;\r\n    const buyerInfiniteQuantity = buyerIsMerchant && buyerFlagData.infiniteQuantity;\r\n    const buyerHidesNewItems = buyerIsMerchant && buyerFlagData.hideNewItems;\r\n\r\n    for (const price of itemPrices.finalPrices) {\r\n      if (!price.quantity) {\r\n        continue;\r\n      }\r\n      const onlyDelta = (buyerInfiniteCurrencies && price.isCurrency) || (buyerInfiniteQuantity && !price.isCurrency);\r\n      if (price.type === \"attribute\") {\r\n        await buyerTransaction.appendActorChanges([{\r\n          path: price.data.path, quantity: price.quantity\r\n        }], { remove: true, type: price.isCurrency ? \"currency\" : price.type, onlyDelta });\r\n      } else {\r\n        await buyerTransaction.appendItemChanges([{\r\n          item: price.data.item, quantity: price.quantity\r\n        }], { remove: true, type: price.isCurrency ? \"currency\" : price.type, onlyDelta });\r\n      }\r\n    }\r\n\r\n    for (const entry of itemPrices.buyerReceive) {\r\n      if (!entry.quantity) continue;\r\n      if (entry.type === \"attribute\") {\r\n        await buyerTransaction.appendActorChanges([{\r\n          path: entry.data.path, quantity: entry.quantity\r\n        }], { type: entry.type });\r\n      } else {\r\n        const itemFlagData = PileUtilities.getItemFlagData(entry.item);\r\n        if (itemFlagData.isService) continue;\r\n        const item = entry.item.toObject();\r\n        if (buyerHidesNewItems) {\r\n          setProperty(item, CONSTANTS.FLAGS.ITEM + '.hidden', true);\r\n        }\r\n        await buyerTransaction.appendItemChanges([{\r\n          item: item, quantity: entry.quantity\r\n        }], { type: entry.type });\r\n      }\r\n    }\r\n\r\n    for (const change of itemPrices.buyerChange) {\r\n      if (!change.quantity) continue;\r\n      if (change.type === \"attribute\") {\r\n        await buyerTransaction.appendActorChanges([{\r\n          path: change.data.path, quantity: change.quantity\r\n        }], { type: \"currency\" });\r\n      } else {\r\n        await buyerTransaction.appendItemChanges([{\r\n          item: change.data.item, quantity: change.quantity\r\n        }], { type: \"currency\" });\r\n      }\r\n    }\r\n\r\n    const sellerUpdates = sellerTransaction.prepare();\r\n    const buyerUpdates = buyerTransaction.prepare();\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_TRADE, sellingActor, sellerUpdates, buyingActor, buyerUpdates, userId, interactionId);\r\n    if (hookResult === false) return false;\r\n\r\n    const sellerTransactionData = await sellerTransaction.commit();\r\n    const buyerTransactionData = await buyerTransaction.commit();\r\n\r\n    const itemPileActorUuid = sellerIsMerchant ? sellerUuid : buyerUuid;\r\n\r\n    await this._executeItemPileMacro(itemPileActorUuid, {\r\n      action: \"tradeItems\",\r\n      source: sellerUuid,\r\n      target: buyerUuid,\r\n      sourceIsMerchant: sellerIsMerchant,\r\n      sourceItems: sellerTransactionData.itemDeltas,\r\n      sourceAttributes: sellerTransactionData.attributeDeltas,\r\n      targetItems: buyerTransactionData.itemDeltas,\r\n      targetAttributes: buyerTransactionData.attributeDeltas,\r\n      prices: itemPrices,\r\n      userId: userId,\r\n      interactionId: interactionId\r\n    });\r\n\r\n    if (sellerIsMerchant) {\r\n      for (let entry of itemPrices.buyerReceive) {\r\n        const itemFlagData = PileUtilities.getItemFlagData(entry.item);\r\n        if (!itemFlagData.macro) continue;\r\n        await Utilities.runMacro(itemFlagData.macro, {\r\n          seller: sellingActor, buyer: buyingActor, item: entry.item, quantity: entry.quantity\r\n        });\r\n      }\r\n    }\r\n\r\n    await ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.ITEM.TRADE, sellerUuid, buyerUuid, itemPrices, userId, interactionId);\r\n\r\n    return {\r\n      itemDeltas: buyerTransactionData.itemDeltas, attributeDeltas: buyerTransactionData.attributeDeltas, itemPrices\r\n    };\r\n\r\n  }\r\n\r\n  static async _rollItemTable({\r\n    table = \"\",\r\n    timesToRoll = \"1\",\r\n    resetTable = true,\r\n    displayChat = false,\r\n    rollData = {},\r\n    targetActor = false,\r\n    removeExistingActorItems = false,\r\n    userId = false,\r\n  } = {}) {\r\n\r\n    const rollTable = await fromUuid(table);\r\n\r\n    if (!table.startsWith(\"Compendium\")) {\r\n      if (resetTable) {\r\n        await rollTable.reset();\r\n      }\r\n\r\n      await rollTable.update({\r\n        results: rollTable.results.map(result => ({\r\n          _id: result.id,\r\n          weight: result.range[1] - (result.range[0] - 1)\r\n        }))\r\n      });\r\n      await rollTable.normalize();\r\n    }\r\n\r\n    const roll = new Roll(timesToRoll.toString(), rollData).evaluate({ async: false });\r\n    if (roll.total <= 0) {\r\n      return [];\r\n    }\r\n\r\n    let items = [];\r\n    const tableDraw = await rollTable.drawMany(roll.total, { displayChat, recursive: true });\r\n    for (const rollData of tableDraw.results) {\r\n      const existingItem = items.find((item) => item.documentId === rollData.documentId);\r\n      if (existingItem) {\r\n        existingItem.quantity++;\r\n      } else {\r\n\r\n        let item;\r\n        if (rollData.documentCollection === \"Item\") {\r\n          item = game.items.get(rollData.documentId);\r\n        } else {\r\n          const compendium = game.packs.get(rollData.documentCollection);\r\n          if (compendium) {\r\n            item = await compendium.getDocument(rollData.documentId);\r\n          }\r\n        }\r\n\r\n        if (item instanceof Item) {\r\n          items.push({\r\n            ...rollData, item: item.toObject(), quantity: 1,\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    if (targetActor) {\r\n      items = await this._addItems(targetActor, items, userId, { removeExistingActorItems });\r\n    }\r\n\r\n    return items;\r\n\r\n  }\r\n\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport * as Utilities from \"./helpers/utilities.js\";\r\nimport PrivateAPI from \"./API/private-api.js\";\r\n\r\nexport const hotkeyActionState = {\r\n  get openPileInventory() {\r\n    return (!hotkeyState.ctrlDown && !game.settings.get(CONSTANTS.MODULE_NAME, \"invertSheetOpen\"))\r\n      || (hotkeyState.ctrlDown && game.settings.get(CONSTANTS.MODULE_NAME, \"invertSheetOpen\"));\r\n  }\r\n}\r\n\r\nexport const hotkeyState = {\r\n  ctrlDown: false,\r\n  altDown: false,\r\n  shiftDown: false\r\n}\r\n\r\nexport function registerHotkeysPre() {\r\n  \r\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"force-open-item-pile-inventory\", {\r\n    name: \"Force open inventory\",\r\n    uneditable: [\r\n      { key: \"ControlLeft\" },\r\n    ],\r\n    onDown: () => {\r\n      hotkeyState.ctrlDown = true;\r\n    },\r\n    onUp: () => {\r\n      hotkeyState.ctrlDown = false;\r\n    },\r\n    reservedModifiers: [\"SHIFT\", \"ALT\"]\r\n  });\r\n  \r\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"force-drop-item\", {\r\n    name: \"Force drop item (GM only)\",\r\n    uneditable: [\r\n      { key: \"ShiftLeft\" },\r\n    ],\r\n    onDown: () => {\r\n      hotkeyState.shiftDown = true;\r\n    },\r\n    onUp: () => {\r\n      hotkeyState.shiftDown = false;\r\n    },\r\n    reservedModifiers: [\"ALT\", \"CONTROL\"]\r\n  });\r\n  \r\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"force-drop-one-item\", {\r\n    name: \"Force drop one item\",\r\n    uneditable: [\r\n      { key: \"AltLeft\" },\r\n    ],\r\n    onDown: () => {\r\n      hotkeyState.altDown = true;\r\n    },\r\n    onUp: () => {\r\n      hotkeyState.altDown = false;\r\n    },\r\n    reservedModifiers: [\"SHIFT\", \"CONTROL\"]\r\n  });\r\n  \r\n}\r\n\r\nexport function registerHotkeysPost() {\r\n  \r\n  if (!game.user.isGM) {\r\n    let clicked = false;\r\n    window.addEventListener(\"mousedown\", (event) => {\r\n      if (!canvas.ready) return;\r\n      if (!(canvas.activeLayer instanceof TokenLayer)) return;\r\n      if (game.activeTool !== \"select\") return;\r\n      const hover = document.elementFromPoint(event.clientX, event.clientY);\r\n      if (!hover || (hover.id !== \"board\")) return;\r\n      if (event.button !== 0) return;\r\n      \r\n      const pos = canvas.app.renderer.plugins.interaction.mouse.getLocalPosition(canvas.app.stage);\r\n      const tokens = Utilities.getTokensAtLocation(pos)\r\n        .filter(token => {\r\n          const canView = token._canView(game.user);\r\n          const canSee = token.visible || game.user.isGM;\r\n          return !canView && canSee;\r\n        });\r\n      if (!tokens.length) return;\r\n      tokens.sort((a, b) => b.zIndex - a.zIndex);\r\n      const token = Utilities.getDocument(tokens[0]);\r\n      \r\n      if (clicked === token) {\r\n        clicked = false;\r\n        return PrivateAPI._itemPileClicked(token);\r\n      }\r\n      \r\n      clicked = token;\r\n      setTimeout(() => {\r\n        clicked = false;\r\n      }, 500);\r\n    });\r\n  }\r\n}","import CONSTANTS from \"../constants/constants.js\";\r\nimport * as Utilities from \"./utilities.js\";\r\n\r\nexport function setupCaches() {\r\n\r\n  Hooks.on(CONSTANTS.HOOKS.PILE.DELETE, (doc) => {\r\n    const uuid = Utilities.getUuid(doc);\r\n    let actor = Utilities.getActor(doc);\r\n    if (actor instanceof Actor) {\r\n      actor = actor.toObject();\r\n    }\r\n    deletedActorCache.set(uuid, actor);\r\n  });\r\n\r\n}\r\n\r\nclass DebouncedCache extends Map {\r\n\r\n  #debounceClear = {};\r\n  #timeout = {};\r\n\r\n  constructor(timeout = 50) {\r\n    super();\r\n    this.#timeout = timeout;\r\n  }\r\n\r\n  set(key, value) {\r\n    this.#setDebounce(key)\r\n    return super.set(key, value);\r\n  }\r\n\r\n  #setDebounce(key) {\r\n    if (!this.#debounceClear[key]) {\r\n      this.#debounceClear[key] = foundry.utils.debounce(() => {\r\n        delete this.#debounceClear[key];\r\n        this.delete(key);\r\n      }, this.#timeout)\r\n    }\r\n    this.#debounceClear[key]();\r\n  }\r\n}\r\n\r\n\r\nexport const deletedActorCache = new DebouncedCache(5000);\r\nexport const cachedActorCurrencies = new DebouncedCache();\r\nexport const cachedFilterList = new DebouncedCache();\r\nexport const cachedCurrencyList = new DebouncedCache();\r\n\r\n","import * as Utilities from \"./utilities.js\"\nimport CONSTANTS from \"../constants/constants.js\";\nimport * as Helpers from \"./helpers.js\";\nimport { SYSTEMS } from \"../systems.js\";\nimport { hotkeyState } from \"../hotkeys.js\";\nimport SETTINGS from \"../constants/settings.js\";\nimport { cachedActorCurrencies, cachedCurrencyList, cachedFilterList } from \"./caches.js\";\n\n\nfunction getFlagData(inDocument, flag, defaults, existing = false) {\n  const defaultFlags = foundry.utils.duplicate(defaults);\n  const flags = existing || (getProperty(inDocument, flag) ?? {});\n  let data = { ...flags };\n  if (flag === CONSTANTS.FLAGS.PILE) {\n    data = migrateFlagData(inDocument, data);\n  }\n  return foundry.utils.mergeObject(defaultFlags, data);\n}\n\nexport function migrateFlagData(document, data = false) {\n\n  let flags = data || getProperty(document, CONSTANTS.FLAGS.PILE);\n\n  if (flags.type) {\n    return flags;\n  }\n\n  if (flags.isMerchant) {\n    flags.type = CONSTANTS.PILE_TYPES.MERCHANT;\n  } else if (flags.isContainer) {\n    flags.type = CONSTANTS.PILE_TYPES.CONTAINER;\n  } else {\n    flags.type = CONSTANTS.PILE_TYPES.PILE;\n  }\n\n  return flags;\n\n}\n\nexport function canItemStack(item, targetActor) {\n  const itemData = item instanceof Item ? item.toObject() : item;\n  const unstackableType = Utilities.getItemTypesThatCanStack().has(itemData.type);\n  if (!unstackableType || (targetActor && !isItemPileVault(targetActor))) return unstackableType;\n  const itemFlagData = getItemFlagData(itemData);\n  const actorFlagData = getActorFlagData(targetActor);\n  return {\n    \"default\": actorFlagData.canStackItems,\n    \"yes\": true,\n    \"no\": false\n  }[itemFlagData?.canStack ?? \"default\"];\n}\n\nexport function getItemFlagData(item, data = false) {\n  return getFlagData(Utilities.getDocument(item), CONSTANTS.FLAGS.ITEM, { ...CONSTANTS.ITEM_DEFAULTS }, data);\n}\n\nexport function getActorFlagData(target, data = false) {\n  const defaults = foundry.utils.mergeObject(\n    { ...CONSTANTS.PILE_DEFAULTS },\n    { ...(Helpers.getSetting(SETTINGS.PILE_DEFAULTS) ?? {}) }\n  );\n  return getFlagData(Utilities.getActor(target), CONSTANTS.FLAGS.PILE, defaults, data);\n}\n\nexport function isValidItemPile(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  return targetActor && pileData?.enabled;\n}\n\nexport function isRegularItemPile(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  return targetActor && pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.PILE;\n}\n\nexport function isItemPileContainer(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  return pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.CONTAINER;\n}\n\nexport function isItemPileLootable(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  return targetActor && pileData?.enabled && (pileData?.type === CONSTANTS.PILE_TYPES.PILE || pileData?.type === CONSTANTS.PILE_TYPES.CONTAINER);\n}\n\nexport function isItemPileVault(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  return pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.VAULT;\n}\n\nexport function isItemPileMerchant(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  return pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.MERCHANT;\n}\n\nexport function isItemPileClosed(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  if (!pileData?.enabled || pileData?.type !== CONSTANTS.PILE_TYPES.CONTAINER) return false;\n  return pileData.closed;\n}\n\nexport function isItemPileLocked(target, data = false) {\n  const targetActor = Utilities.getActor(target);\n  const pileData = getActorFlagData(targetActor, data);\n  if (!pileData?.enabled || pileData?.type !== CONSTANTS.PILE_TYPES.CONTAINER) return false;\n  return pileData.locked;\n}\n\nexport function isItemPileEmpty(target) {\n\n  const targetActor = Utilities.getActor(target);\n  if (!targetActor) return false;\n\n  const validItemPile = isValidItemPile(targetActor);\n  if (!validItemPile) return false;\n\n  const hasNoItems = getActorItems(targetActor).length === 0;\n  const hasNoAttributes = getActorCurrencies(targetActor).length === 0;\n\n  return validItemPile && hasNoItems && hasNoAttributes;\n\n}\n\nexport function shouldItemPileBeDeleted(targetUuid) {\n\n  const target = fromUuidSync(targetUuid);\n\n  if (!(target instanceof TokenDocument)) return false;\n\n  const pileData = getActorFlagData(target);\n\n  if (!isItemPileLootable(target, pileData) || !isItemPileEmpty(target)) {\n    return false;\n  }\n\n  if (typeof pileData?.deleteWhenEmpty === \"boolean\") {\n    return pileData?.deleteWhenEmpty;\n  }\n\n  return {\n    \"default\": Helpers.getSetting(\"deleteEmptyPiles\"), \"true\": true, \"false\": false\n  }[pileData?.deleteWhenEmpty ?? \"default\"];\n\n}\n\nexport function getItemPileActors(filter = false) {\n  return Array.from(game.actors).filter((a) => {\n    return getProperty(a, CONSTANTS.FLAGS.PILE)?.enabled && (filter ? filter(a) : true);\n  });\n}\n\nexport function getItemPileTokens(filter = false) {\n\n  const allTokensOnScenes = Array.from(game.scenes)\n    .map(scene => ([\n      scene.id,\n      Array.from(scene.tokens).filter(t => {\n        return getProperty(t, CONSTANTS.FLAGS.PILE)?.enabled && !t.actorLink;\n      })\n    ]))\n    .filter(([_, tokens]) => tokens.length)\n\n  const validTokensOnScenes = allTokensOnScenes.map(([scene, tokens]) => [\n    scene,\n    tokens.filter((token) => {\n      return filter ? filter(token) : true;\n    })\n  ]).filter(([_, tokens]) => tokens.length);\n\n  return { allTokensOnScenes, validTokensOnScenes };\n}\n\nexport function getActorItems(target, { itemFilters = false, getItemCurrencies = false } = {}) {\n  const actor = Utilities.getActor(target);\n  const actorItemFilters = itemFilters ? cleanItemFilters(itemFilters) : getActorItemFilters(actor);\n  const currencies = (actor\n    ? getActorCurrencies(actor, { getAll: true })\n    : game.itempiles.API.CURRENCIES.concat(game.itempiles.API.SECONDARY_CURRENCIES))\n    .map(entry => entry.id);\n  return actor.items.filter(item => (getItemCurrencies || currencies.indexOf(item.id) === -1) && !isItemInvalid(actor, item, actorItemFilters));\n}\n\n// Lots happening here, but in essence, it gets the actor's currencies, and creates an array of them\nexport function getActorCurrencies(target, {\n  forActor = false,\n  currencyList = false,\n  getAll = false,\n  secondary = true\n} = {}) {\n  const actor = Utilities.getActor(target);\n  const actorUuid = Utilities.getUuid(actor.uuid)\n  const actorItems = actor ? Array.from(actor.items) : [];\n  const cached = cachedActorCurrencies.get(actorUuid)\n  currencyList = cached ? false : currencyList || getCurrencyList(forActor || actor);\n  let currencies = cached || (currencyList.map((currency, index) => {\n    if (currency.type === \"attribute\" || !currency.type) {\n      const path = currency?.data?.path ?? currency?.path;\n      return {\n        ...currency,\n        quantity: 0,\n        path: path,\n        id: path,\n        index\n      }\n    }\n    const item = Utilities.findSimilarItem(actorItems, currency.data.item);\n    return {\n      ...currency,\n      quantity: 0,\n      id: item?.id || null,\n      item,\n      index\n    }\n  }))\n\n  cachedActorCurrencies.set(actorUuid, currencies);\n\n  currencies = currencies.map(currency => {\n    currency.quantity = currency.type === \"attribute\"\n      ? getProperty(actor, currency.path)\n      : Utilities.getItemQuantity(currency.item);\n    return currency;\n  });\n\n  if (!getAll) {\n    currencies = currencies.filter(currency => currency.quantity > 0);\n  }\n\n  if (!secondary) {\n    currencies = currencies.filter(currency => !currency.secondary);\n  }\n\n  return currencies;\n}\n\nexport function getActorPrimaryCurrency(target) {\n  const actor = Utilities.getActor(target);\n  return getActorCurrencies(actor, { getAll: true }).find(currency => currency.primary);\n}\n\nexport function getCurrencyList(target = false, pileData = false) {\n  let targetUuid = false;\n  if (target) {\n    targetUuid = Utilities.getUuid(target);\n    if (cachedCurrencyList.has(targetUuid)) {\n      return cachedCurrencyList.get(targetUuid)\n    }\n    const targetActor = Utilities.getActor(target);\n    pileData = getActorFlagData(targetActor, pileData);\n  }\n\n  const primaryCurrencies = (pileData?.overrideCurrencies || game.itempiles.API.CURRENCIES);\n  const secondaryCurrencies = (pileData?.overrideSecondaryCurrencies || game.itempiles.API.SECONDARY_CURRENCIES).map(currency => {\n    currency.secondary = true;\n    return currency;\n  });\n\n  const currencies = primaryCurrencies.concat(secondaryCurrencies);\n\n  const currencyList = currencies.map(currency => {\n    currency.name = game.i18n.localize(currency.name);\n    return currency;\n  });\n  if (target) {\n    cachedCurrencyList.set(targetUuid, currencyList);\n  }\n  return currencyList;\n}\n\nexport function getActorItemFilters(target, pileData = false) {\n  if (!target) return cleanItemFilters(game.itempiles.API.ITEM_FILTERS);\n  const targetUuid = Utilities.getUuid(target);\n  if (cachedFilterList.has(targetUuid)) {\n    return cachedFilterList.get(targetUuid)\n  }\n  const targetActor = Utilities.getActor(target);\n  pileData = getActorFlagData(targetActor, pileData);\n  const itemFilters = isValidItemPile(targetActor, pileData) && pileData?.overrideItemFilters\n    ? cleanItemFilters(pileData.overrideItemFilters)\n    : cleanItemFilters(game.itempiles.API.ITEM_FILTERS);\n  cachedFilterList.set(targetUuid, itemFilters);\n  return itemFilters;\n}\n\nexport function cleanItemFilters(itemFilters) {\n  return itemFilters ? foundry.utils.duplicate(itemFilters).map(filter => {\n    filter.path = filter.path.trim();\n    filter.filters = (Array.isArray(filter.filters) ? filter.filters : filter.filters.split(','))\n      .map(string => {\n        if (typeof string === \"boolean\") return string;\n        const str = string.trim();\n        if (str.toLowerCase() === \"true\" || str.toLowerCase() === \"false\") {\n          return str.toLowerCase() === \"true\";\n        }\n        return str;\n      });\n    filter.filters = new Set(filter.filters)\n    return filter;\n  }) : [];\n}\n\nexport function isItemInvalid(targetActor, item, itemFilters = false) {\n  const pileItemFilters = itemFilters ? itemFilters : getActorItemFilters(targetActor)\n  const itemData = item instanceof Item ? item.toObject() : item;\n  for (const filter of pileItemFilters) {\n    if (!hasProperty(itemData, filter.path)) continue;\n    const attributeValue = getProperty(itemData, filter.path);\n    if (filter.filters.has(attributeValue)) {\n      return attributeValue;\n    }\n  }\n  return false;\n}\n\nexport async function checkItemType(targetActor, item, {\n  errorText = \"ITEM-PILES.Errors.DisallowedItemDrop\",\n  warningTitle = \"ITEM-PILES.Dialogs.TypeWarning.Title\",\n  warningContent = \"ITEM-PILES.Dialogs.TypeWarning.DropContent\",\n  runTransformer = true\n} = {}) {\n\n  const disallowedType = isItemInvalid(targetActor, item);\n  if (disallowedType) {\n    if (!game.user.isGM) {\n      return Helpers.custom_warning(game.i18n.format(errorText, { type: disallowedType }), true)\n    }\n\n    if (SYSTEMS.DATA.ITEM_TRANSFORMER && runTransformer) {\n      item = await SYSTEMS.DATA.ITEM_TRANSFORMER(item);\n    }\n\n    const newDisallowedType = isItemInvalid(targetActor, item);\n\n    if (newDisallowedType && !hotkeyState.shiftDown) {\n      const force = await Dialog.confirm({\n        title: game.i18n.localize(warningTitle),\n        content: `<p class=\"item-piles-dialog\">${game.i18n.format(warningContent, { type: newDisallowedType })}</p>`,\n        defaultYes: false\n      });\n      if (!force) {\n        return false;\n      }\n    }\n  } else {\n    if (SYSTEMS.DATA.ITEM_TRANSFORMER && runTransformer) {\n      item = await SYSTEMS.DATA.ITEM_TRANSFORMER(item);\n    }\n  }\n\n  return item;\n\n}\n\nexport function isItemCurrency(item, { target = false, actorCurrencies = false } = {}) {\n  const currencies = (actorCurrencies || getActorCurrencies(item.parent || false, {\n    forActor: target,\n    getAll: true\n  }))\n    .filter(currency => currency.type === \"item\")\n    .map(item => item.data.item);\n  return !!Utilities.findSimilarItem(currencies, item);\n}\n\nexport function getItemCurrencyData(item, { target = false, actorCurrencies = false }) {\n  return (actorCurrencies || getActorCurrencies(item?.parent || false, {\n    forActor: target,\n    getAll: true,\n    combine: true\n  }))\n    .filter(currency => currency.type === \"item\")\n    .find(currency => {\n      return item.name === currency.data.item.name && item.type === currency.data.item.type;\n    })\n}\n\nexport function getItemPileTokenImage(token, {\n  data = false,\n  items = false,\n  currencies = false\n} = {}, overrideImage = null) {\n\n  const pileDocument = Utilities.getDocument(token);\n\n  const itemPileData = getActorFlagData(pileDocument, data);\n\n  const originalImg = overrideImage ?? (pileDocument instanceof TokenDocument\n      ? pileDocument.texture.src\n      : pileDocument.prototypeToken.texture.src\n  );\n\n  if (!isValidItemPile(pileDocument)) return originalImg;\n\n  items = items || getActorItems(pileDocument);\n  currencies = currencies || getActorCurrencies(pileDocument);\n\n  const numItems = items.length + currencies.length;\n\n  let img = originalImg;\n\n  if (itemPileData.type === CONSTANTS.PILE_TYPES.CONTAINER) {\n\n    img = itemPileData.lockedImage || itemPileData.closedImage || itemPileData.openedImage || itemPileData.emptyImage;\n\n    if (itemPileData.locked && itemPileData.lockedImage) {\n      img = itemPileData.lockedImage;\n    } else if (itemPileData.closed && itemPileData.closedImage) {\n      img = itemPileData.closedImage;\n    } else if (itemPileData.emptyImage && isItemPileEmpty(pileDocument)) {\n      img = itemPileData.emptyImage;\n    } else if (itemPileData.openedImage) {\n      img = itemPileData.openedImage;\n    }\n\n  } else if (itemPileData.displayOne && numItems === 1) {\n\n    img = items.length > 0 ? items[0].img : currencies[0].img;\n\n  } else if (itemPileData.displayOne && numItems > 1) {\n\n    img = originalImg;\n\n  }\n\n  return img || originalImg;\n\n}\n\nexport function getItemPileTokenScale(target, {\n  data = false,\n  items = false,\n  currencies = false\n} = {}, overrideScale = null) {\n\n  const pileDocument = Utilities.getDocument(target);\n\n  let itemPileData = getActorFlagData(pileDocument, data);\n\n  const baseScale = overrideScale ?? (pileDocument instanceof TokenDocument\n      ? pileDocument.texture.scaleX\n      : pileDocument.prototypeToken.texture.scaleX\n  );\n\n  if (!isValidItemPile(pileDocument, itemPileData)) {\n    return baseScale;\n  }\n\n  items = items || getActorItems(pileDocument);\n  currencies = currencies || getActorCurrencies(pileDocument);\n\n  const numItems = items.length + currencies.length;\n\n  if (itemPileData?.type === CONSTANTS.PILE_TYPES.CONTAINER || !itemPileData.displayOne || !itemPileData.overrideSingleItemScale || numItems > 1 || numItems === 0) {\n    return baseScale;\n  }\n\n  return itemPileData.singleItemScale;\n\n}\n\nexport function getItemPileName(target, { data = false, items = false, currencies = false } = {}, overrideName = null) {\n\n  const pileDocument = Utilities.getDocument(target);\n\n  const itemPileData = getActorFlagData(pileDocument, data);\n\n  let name = overrideName ?? (pileDocument instanceof TokenDocument ? pileDocument.name : pileDocument.prototypeToken.name);\n\n  if (!isValidItemPile(pileDocument, itemPileData)) {\n    return name;\n  }\n\n  items = items || getActorItems(pileDocument);\n  currencies = currencies || getActorCurrencies(pileDocument);\n\n  const numItems = items.length + currencies.length;\n\n  if (itemPileData?.type === CONSTANTS.PILE_TYPES.CONTAINER || !itemPileData.displayOne || !itemPileData.showItemName || numItems > 1 || numItems === 0) {\n    return name;\n  }\n\n  const item = items.length > 0 ? items[0] : currencies[0];\n  const quantity = (items.length > 0 ? Utilities.getItemQuantity(item) : currencies[0]?.quantity) ?? 1\n\n  return item.name + (quantity > 1 ? \" x \" + quantity : \"\");\n\n}\n\nexport function shouldEvaluateChange(target, changes) {\n  const flags = getActorFlagData(target, getProperty(changes, CONSTANTS.FLAGS.PILE) ?? {});\n  if (!isValidItemPile(target, flags)) return false;\n  return (flags.type === CONSTANTS.PILE_TYPES.CONTAINER && (flags.closedImage || flags.emptyImage || flags.openedImage || flags.lockedImage))\n    || flags.displayOne || flags.showItemName || flags.overrideSingleItemScale;\n}\n\nfunction getRelevantTokensAndActor(target) {\n\n  const relevantDocument = Utilities.getDocument(target);\n\n  let documentActor;\n  let documentTokens = [];\n\n  if (relevantDocument instanceof Actor) {\n    documentActor = relevantDocument;\n    if (relevantDocument.token) {\n      documentTokens.push(relevantDocument?.token);\n    } else {\n      documentTokens = canvas.tokens.placeables.filter(token => token.document.actor === documentActor).map(token => token.document);\n    }\n  } else {\n    documentActor = relevantDocument.actor;\n    if (relevantDocument.isLinked) {\n      documentTokens = canvas.tokens.placeables.filter(token => token.document.actor === documentActor).map(token => token.document);\n    } else {\n      documentTokens.push(relevantDocument);\n    }\n  }\n\n  return [documentActor, documentTokens]\n\n}\n\nexport async function updateItemPileData(target, flagData, tokenData) {\n\n  if (!target) return;\n\n  if (!flagData) flagData = getActorFlagData(target);\n  if (!tokenData) tokenData = {};\n  tokenData = foundry.utils.mergeObject(tokenData, {});\n\n  let [documentActor, documentTokens] = getRelevantTokensAndActor(target);\n\n  const items = getActorItems(documentActor, { itemFilters: flagData.overrideItemFilters });\n  const actorCurrencies = (flagData.overrideCurrencies || []).concat(flagData.overrideSecondaryCurrencies || []);\n  const currencies = getActorCurrencies(documentActor, { currencyList: actorCurrencies });\n\n  const pileData = { data: flagData, items, currencies };\n\n  flagData = cleanFlagData(flagData);\n\n  const updates = documentTokens.map(tokenDocument => {\n    const overrideImage = getProperty(tokenData, \"texture.src\") ?? getProperty(tokenData, \"img\");\n    const overrideScale = getProperty(tokenData, \"texture.scaleX\")\n      ?? getProperty(tokenData, \"texture.scaleY\")\n      ?? getProperty(tokenData, \"scale\");\n    const scale = getItemPileTokenScale(tokenDocument, pileData, overrideScale);\n    const newTokenData = foundry.utils.mergeObject(tokenData, {\n      \"texture.src\": getItemPileTokenImage(tokenDocument, pileData, overrideImage),\n      \"texture.scaleX\": scale,\n      \"texture.scaleY\": scale,\n      \"name\": getItemPileName(tokenDocument, pileData, tokenData?.name),\n    });\n    const data = {\n      \"_id\": tokenDocument.id, ...newTokenData\n    };\n    if (!foundry.utils.isEmpty(flagData)) {\n      data[CONSTANTS.FLAGS.PILE] = flagData;\n      data[CONSTANTS.FLAGS.VERSION] = Helpers.getModuleVersion();\n    }\n    if (!tokenDocument.actorLink) {\n      data[\"actorData.\" + CONSTANTS.FLAGS.PILE] = flagData;\n      data[\"actorData.\" + CONSTANTS.FLAGS.VERSION] = Helpers.getModuleVersion();\n      if (tokenDocument.actor === documentActor) {\n        documentActor = false;\n      }\n    }\n    return data;\n  });\n\n  if (canvas.scene && !foundry.utils.isEmpty(updates)) {\n    await canvas.scene.updateEmbeddedDocuments(\"Token\", updates);\n  }\n\n  if (!foundry.utils.isEmpty(flagData) && documentActor) {\n    await documentActor.update({\n      [CONSTANTS.FLAGS.PILE]: flagData,\n      [CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\n      [`token.${CONSTANTS.FLAGS.PILE}`]: flagData,\n      [`token.${CONSTANTS.FLAGS.VERSION}`]: Helpers.getModuleVersion()\n    });\n  }\n\n  return true;\n}\n\nexport function cleanFlagData(flagData) {\n  const defaults = foundry.utils.mergeObject(\n    { ...CONSTANTS.PILE_DEFAULTS },\n    Helpers.getSetting(SETTINGS.PILE_DEFAULTS) ?? {}\n  );\n  const defaultKeys = Object.keys(defaults);\n  const difference = new Set(Object.keys(foundry.utils.diffObject(flagData, defaults)));\n  const toRemove = new Set(defaultKeys.filter(key => !difference.has(key)));\n  if (flagData.enabled) {\n    toRemove.delete(\"type\")\n  }\n  if (!CONSTANTS.CUSTOM_PILE_TYPES[flagData.type]) {\n    const baseKeys = new Set(defaultKeys);\n    for (const key of Object.keys(flagData)) {\n      if (!baseKeys.has(key)) {\n        delete flagData[key];\n        flagData[\"-=\" + key] = null;\n      }\n    }\n  }\n  for (const key of toRemove) {\n    delete flagData[key];\n    flagData[\"-=\" + key] = null;\n  }\n  return flagData;\n}\n\nexport function cleanItemFlagData(flagData) {\n  const defaults = Object.keys(CONSTANTS.ITEM_DEFAULTS);\n  const difference = new Set(Object.keys(foundry.utils.diffObject(flagData, CONSTANTS.ITEM_DEFAULTS)));\n  const toRemove = new Set(defaults.filter(key => !difference.has(key)));\n  for (const key of toRemove) {\n    delete flagData[key];\n    flagData[\"-=\" + key] = null;\n  }\n  return flagData;\n}\n\nexport function updateItemData(item, update, { returnUpdate = false, version = false } = {}) {\n  const flagData = cleanItemFlagData(foundry.utils.mergeObject(getItemFlagData(item), update.flags ?? {}));\n  const updates = foundry.utils.mergeObject(update?.data ?? {}, {});\n  setProperty(updates, CONSTANTS.FLAGS.ITEM, flagData)\n  setProperty(updates, CONSTANTS.FLAGS.VERSION, version || Helpers.getModuleVersion())\n  if (returnUpdate) {\n    updates[\"_id\"] = item?.id ?? item?._id;\n    return updates;\n  }\n  return item.update(updates);\n}\n\n/* -------------------------- Merchant Methods ------------------------- */\n\nexport function getMerchantModifiersForActor(merchant, {\n  item = false,\n  actor = false,\n  pileFlagData = false,\n  itemFlagData = false\n} = {}) {\n\n  let {\n    buyPriceModifier, sellPriceModifier, itemTypePriceModifiers, actorPriceModifiers\n  } = getActorFlagData(merchant, pileFlagData);\n\n  if (item) {\n    if (!itemFlagData) {\n      itemFlagData = getItemFlagData(item);\n    }\n    const itemTypePriceModifier = itemTypePriceModifiers\n      .sort((a, b) => a.type === \"custom\" && b.type !== \"custom\" ? -1 : 0)\n      .find(priceData => {\n        return priceData.type === \"custom\"\n          ? priceData.category.toLowerCase() === itemFlagData.customCategory.toLowerCase()\n          : priceData.type === item.type;\n      });\n    if (itemTypePriceModifier) {\n      buyPriceModifier = itemTypePriceModifier.override ? itemTypePriceModifier.buyPriceModifier : buyPriceModifier * itemTypePriceModifier.buyPriceModifier;\n      sellPriceModifier = itemTypePriceModifier.override ? itemTypePriceModifier.sellPriceModifier : sellPriceModifier * itemTypePriceModifier.sellPriceModifier;\n    }\n  }\n\n  if (actor && actorPriceModifiers) {\n    const actorSpecificModifiers = actorPriceModifiers?.find(data => data.actorUuid === Utilities.getUuid(actor) || data.actor === actor.id);\n    if (actorSpecificModifiers) {\n      buyPriceModifier = actorSpecificModifiers.override ? actorSpecificModifiers.buyPriceModifier : buyPriceModifier * actorSpecificModifiers.buyPriceModifier;\n      sellPriceModifier = actorSpecificModifiers.override ? actorSpecificModifiers.sellPriceModifier : sellPriceModifier * actorSpecificModifiers.sellPriceModifier;\n    }\n  }\n\n  return {\n    buyPriceModifier, sellPriceModifier\n  }\n}\n\nfunction getSmallestExchangeRate(currencies) {\n  return currencies.length > 1 ? Math.min(...currencies.map(currency => currency.exchangeRate)) : (Helpers.getSetting(SETTINGS.CURRENCY_DECIMAL_DIGITS) ?? 0.00001);\n}\n\nfunction getExchangeRateDecimals(smallestExchangeRate) {\n  return smallestExchangeRate.toString().includes(\".\") ? smallestExchangeRate.toString().split(\".\")[1].length : 0;\n}\n\nexport function getPriceArray(totalCost, currencies) {\n\n  const primaryCurrency = currencies.find(currency => currency.primary);\n\n  if (currencies.length === 1) {\n    return [{\n      ...primaryCurrency,\n      cost: totalCost,\n      baseCost: totalCost,\n      maxCurrencyCost: totalCost,\n      string: primaryCurrency.abbreviation.replace('{#}', totalCost)\n    }]\n  }\n\n  const smallestExchangeRate = getSmallestExchangeRate(currencies);\n\n  const prices = [];\n\n  if (primaryCurrency.exchangeRate === smallestExchangeRate) {\n\n    let cost = totalCost;\n\n    for (const currency of currencies) {\n\n      const numCurrency = Math.floor(cost / currency.exchangeRate);\n\n      cost = cost - (numCurrency * currency.exchangeRate);\n\n      prices.push({\n        ...currency,\n        cost: Math.round(numCurrency),\n        baseCost: Math.round(numCurrency),\n        maxCurrencyCost: Math.ceil(totalCost / currency.exchangeRate),\n        string: currency.abbreviation.replace(\"{#}\", numCurrency)\n      });\n\n    }\n\n    return prices;\n\n  }\n\n  const decimals = getExchangeRateDecimals(smallestExchangeRate);\n\n  let fraction = Helpers.roundToDecimals(totalCost % 1, decimals);\n  let cost = Math.round(totalCost - fraction);\n\n  let skipPrimary = false;\n  if (cost) {\n    skipPrimary = true;\n    prices.push({\n      ...primaryCurrency,\n      cost: cost,\n      baseCost: cost,\n      maxCurrencyCost: totalCost,\n      string: primaryCurrency.abbreviation.replace('{#}', cost)\n    });\n  }\n\n  for (const currency of currencies) {\n\n    if (currency === primaryCurrency && skipPrimary) continue;\n\n    const numCurrency = Math.floor(Helpers.roundToDecimals(fraction / currency.exchangeRate, decimals));\n\n    fraction = Helpers.roundToDecimals(fraction - (numCurrency * currency.exchangeRate), decimals);\n\n    prices.push({\n      ...currency,\n      cost: Math.round(numCurrency),\n      baseCost: Math.round(numCurrency),\n      maxCurrencyCost: Math.ceil(totalCost / currency.exchangeRate),\n      string: currency.abbreviation.replace(\"{#}\", numCurrency)\n    });\n  }\n\n  prices.sort((a, b) => b.exchangeRate - a.exchangeRate);\n\n  return prices;\n}\n\nexport function getPriceFromString(str, currencyList = false) {\n\n  if (!currencyList) {\n    currencyList = getCurrencyList().filter(currency => !currency.secondary);\n  }\n\n  const currencies = foundry.utils.duplicate(currencyList)\n    .map(currency => {\n      currency.quantity = 0\n      currency.identifier = currency.abbreviation.toLowerCase().replace(\"{#}\", \"\")\n      return currency;\n    });\n\n  const splitBy = new RegExp(\"(.*?) *(\" + currencies.map(currency => currency.identifier).join(\"|\") + \")\", \"g\");\n\n  const parts = [...str.trim().toLowerCase().matchAll(splitBy)];\n\n  let overallCost = 0;\n  for (const part of parts) {\n    for (const currency of currencies) {\n\n      if (part[2] !== currency.identifier) continue;\n\n      try {\n        const roll = new Roll(part[1]).evaluate({ async: false })\n        currency.quantity = roll.total;\n        if (roll.total !== Number(part[1])) {\n          currency.roll = roll;\n        }\n        overallCost += roll.total * currency.exchangeRate;\n      } catch (err) {\n\n      }\n    }\n  }\n\n  if (overallCost === 0) {\n    try {\n      const roll = new Roll(str).evaluate({ async: false });\n      if (roll.total) {\n        const primaryCurrency = currencies.find(currency => currency.primary);\n        primaryCurrency.quantity = roll.total;\n        if (roll.total !== Number(str)) {\n          primaryCurrency.roll = roll;\n        }\n        overallCost = roll.total;\n      }\n    } catch (err) {\n\n    }\n  }\n\n  return { currencies, overallCost };\n\n}\n\nexport function getPriceData({\n  cost = false,\n  item = false,\n  seller = false,\n  buyer = false,\n  sellerFlagData = false,\n  buyerFlagData = false,\n  itemFlagData = false,\n  quantity = 1\n} = {}) {\n\n  let priceData = [];\n\n  buyerFlagData = getActorFlagData(buyer, buyerFlagData);\n  if (!isItemPileMerchant(buyer, buyerFlagData)) {\n    buyerFlagData = false;\n  }\n\n  sellerFlagData = getActorFlagData(seller, sellerFlagData);\n  if (!isItemPileMerchant(seller, sellerFlagData)) {\n    sellerFlagData = false;\n  }\n\n  if (cost && !item) {\n    item = {};\n    setProperty(item, game.itempiles.API.ITEM_PRICE_ATTRIBUTE, cost);\n    setProperty(item, CONSTANTS.FLAGS.ITEM, CONSTANTS.ITEM_DEFAULTS);\n  }\n\n  itemFlagData = itemFlagData || getItemFlagData(item);\n\n  let merchant = sellerFlagData ? seller : buyer;\n\n  if (merchant === buyer && itemFlagData.cantBeSoldToMerchants) {\n    priceData.push({\n      free: false,\n      basePrices: [],\n      basePriceString: \"\",\n      prices: [],\n      priceString: \"\",\n      totalCost: 0,\n      baseCost: 0,\n      primary: true,\n      maxQuantity: 0,\n      quantity\n    });\n    return priceData;\n  }\n\n  // Retrieve the item price modifiers\n  let modifier = 1;\n  if (sellerFlagData) {\n\n    modifier = getMerchantModifiersForActor(seller, {\n      item, actor: buyer, pileFlagData: sellerFlagData, itemFlagData\n    }).buyPriceModifier;\n\n  } else if (buyerFlagData) {\n\n    modifier = getMerchantModifiersForActor(buyer, {\n      item, actor: seller, pileFlagData: buyerFlagData, itemFlagData\n    }).sellPriceModifier;\n\n  }\n\n  const disableNormalCost = itemFlagData.disableNormalCost && !sellerFlagData.onlyAcceptBasePrice;\n  const hasOtherPrices = itemFlagData.prices.filter(priceGroup => priceGroup.length).length > 0;\n\n  const currencyList = getCurrencyList(merchant).filter(currency => !currency.secondary);\n  const currencies = getActorCurrencies(merchant, { currencyList, getAll: true, secondary: false });\n\n  // In order to easily calculate an item's total worth, we can use the smallest exchange rate and convert all prices\n  // to it, in order have a stable form of exchange calculation\n  const smallestExchangeRate = getSmallestExchangeRate(currencyList);\n  const decimals = getExchangeRateDecimals(smallestExchangeRate);\n\n  let overallCost;\n  let itemCost = Utilities.getItemCost(item);\n  if (SYSTEMS.DATA.ITEM_COST_TRANSFORMER) {\n    overallCost = SYSTEMS.DATA.ITEM_COST_TRANSFORMER(item, currencyList);\n    if (overallCost === false) {\n      Helpers.debug(\"failed to find price for item:\", item)\n    }\n  } else if (typeof itemCost === \"string\" && isNaN(Number(itemCost))) {\n    overallCost = getPriceFromString(itemCost, currencyList).overallCost;\n  } else {\n    overallCost = Number(itemCost);\n  }\n\n  if (itemFlagData?.free || (!disableNormalCost && (overallCost === 0 || overallCost < smallestExchangeRate) && !hasOtherPrices) || modifier <= 0) {\n    priceData.push({\n      free: true,\n      basePrices: [],\n      basePriceString: \"\",\n      prices: [],\n      priceString: \"\",\n      totalCost: 0,\n      baseCost: 0,\n      primary: true,\n      maxQuantity: Infinity,\n      quantity: quantity\n    })\n    return priceData;\n  }\n\n  // If the item does include its normal cost, we calculate that here\n  if (overallCost >= smallestExchangeRate && (!itemFlagData.disableNormalCost || (merchant === buyer && buyerFlagData.onlyAcceptBasePrice))) {\n\n    // Base prices is the displayed price, without quantity taken into account\n    const baseCost = Helpers.roundToDecimals(overallCost * modifier, decimals);\n    const basePrices = getPriceArray(baseCost, currencies);\n\n    // Prices is the cost with the amount of quantity taken into account, which may change the number of the different\n    // types of currencies it costs (eg, an item wouldn't cost 1 gold and 100 silver, it would cost 11 gold\n    let totalCost = Helpers.roundToDecimals(overallCost * modifier * quantity, decimals);\n    let prices = getPriceArray(totalCost, currencies);\n\n    if (baseCost) {\n\n      priceData.push({\n        basePrices,\n        basePriceString: basePrices.filter(price => price.cost).map(price => price.string).join(\" \"),\n        prices,\n        priceString: prices.filter(price => price.cost).map(price => price.string).join(\" \"),\n        totalCost,\n        baseCost,\n        primary: true,\n        maxQuantity: 0,\n        quantity: quantity\n      });\n\n    }\n  }\n\n  // If the item has custom prices, we include them here\n  if (itemFlagData.prices.length && !(merchant === buyer && buyerFlagData.onlyAcceptBasePrice)) {\n\n    priceData = priceData.concat(itemFlagData.prices.map(priceGroup => {\n      const prices = priceGroup.map(price => {\n        const itemModifier = price.fixed ? 1 : modifier;\n        const cost = Math.round(price.quantity * itemModifier * quantity);\n        const baseCost = Math.round(price.quantity * itemModifier);\n        price.name = game.i18n.localize(price.name);\n        return {\n          ...price,\n          cost,\n          baseCost,\n          modifier: itemModifier,\n          priceString: cost ? price.abbreviation.replace(\"{#}\", cost) : \"\",\n          basePriceString: baseCost ? price.abbreviation.replace(\"{#}\", baseCost) : \"\"\n        };\n      });\n\n      return {\n        prices,\n        priceString: prices.filter(price => price.priceString).map(price => price.priceString).join(\" \"),\n        basePriceString: prices.filter(price => price.basePriceString).map(price => price.basePriceString).join(\" \"),\n        maxQuantity: 0,\n        quantity: quantity\n      }\n    }));\n  }\n\n  // If there's a buyer, we also calculate how many of the item the buyer can afford\n  if (!buyer) return priceData;\n\n  const buyerInfiniteCurrencies = buyerFlagData?.infiniteCurrencies;\n  const buyerInfiniteQuantity = buyerFlagData?.infiniteQuantity;\n\n  const recipientCurrencies = getActorCurrencies(buyer, { currencyList, secondary: false });\n  const totalCurrencies = recipientCurrencies.map(currency => currency.quantity * currency.exchangeRate).reduce((acc, num) => acc + num, 0);\n\n  // For each price group, check for properties and items and make sure that the actor can afford it\n  for (const priceGroup of priceData) {\n    priceGroup.maxQuantity = Infinity;\n    if (priceGroup.baseCost !== undefined) {\n      if (buyerInfiniteCurrencies) continue;\n      priceGroup.maxQuantity = Math.floor(totalCurrencies / priceGroup.baseCost);\n      priceGroup.prices.forEach(price => {\n        price.maxQuantity = priceGroup.maxQuantity;\n      });\n    } else {\n      if (buyerInfiniteQuantity) continue;\n      for (const price of priceGroup.prices) {\n        if (price.type === \"attribute\") {\n          const attributeQuantity = Number(getProperty(buyer, price.data.path));\n          price.buyerQuantity = attributeQuantity;\n\n          if (price.percent) {\n            const percent = Math.min(1, price.baseCost / 100);\n            const percentQuantity = Math.max(0, Math.floor(attributeQuantity * percent));\n            price.maxQuantity = Math.floor(attributeQuantity / percentQuantity);\n            price.baseCost = !buyer ? price.baseCost : percentQuantity;\n            price.cost = !buyer ? price.cost : percentQuantity * quantity;\n            price.quantity = !buyer ? price.quantity : percentQuantity;\n          } else {\n            price.maxQuantity = Math.floor(attributeQuantity / price.baseCost);\n          }\n\n          priceGroup.maxQuantity = Math.min(priceGroup.maxQuantity, price.maxQuantity)\n\n        } else {\n          const foundItem = Utilities.findSimilarItem(buyer.items, price.data.item);\n          const itemQuantity = foundItem ? Utilities.getItemQuantity(foundItem) : 0;\n          price.buyerQuantity = itemQuantity;\n\n          if (price.percent) {\n            const percent = Math.min(1, price.baseCost / 100);\n            const percentQuantity = Math.max(0, Math.floor(itemQuantity * percent));\n            price.maxQuantity = Math.floor(itemQuantity / percentQuantity);\n            price.baseCost = !buyer ? price.baseCost : percentQuantity;\n            price.cost = !buyer ? price.cost : percentQuantity * quantity;\n            price.quantity = !buyer ? price.quantity : percentQuantity;\n          } else {\n            price.maxQuantity = Math.floor(itemQuantity / price.baseCost);\n          }\n\n          priceGroup.maxQuantity = Math.min(priceGroup.maxQuantity, price.maxQuantity);\n        }\n      }\n    }\n  }\n\n  return priceData;\n}\n\nexport function getPaymentData({\n  purchaseData = [],\n  seller = false,\n  buyer = false,\n  sellerFlagData = false,\n  buyerFlagData = false\n} = {}) {\n\n  buyerFlagData = getActorFlagData(buyer, buyerFlagData);\n  if (!isItemPileMerchant(buyer, buyerFlagData)) {\n    buyerFlagData = false;\n  }\n\n  sellerFlagData = getActorFlagData(seller, sellerFlagData);\n  if (!isItemPileMerchant(seller, sellerFlagData)) {\n    sellerFlagData = false;\n  }\n\n  const merchant = sellerFlagData ? seller : buyer;\n  const currencyList = getCurrencyList(merchant).filter(currency => !currency.secondary);\n  const currencies = getActorCurrencies(merchant, { currencyList, getAll: true, secondary: false });\n  const smallestExchangeRate = getSmallestExchangeRate(currencies)\n  const decimals = getExchangeRateDecimals(smallestExchangeRate);\n\n  const recipientCurrencies = getActorCurrencies(buyer, { currencyList, getAll: true, secondary: false });\n\n  const buyerInfiniteCurrencies = buyerFlagData?.infiniteCurrencies;\n\n  const paymentData = purchaseData.map(data => {\n      const prices = getPriceData({\n        cost: data.cost,\n        item: data.item,\n        seller,\n        buyer,\n        sellerFlagData,\n        buyerFlagData,\n        itemFlagData: data.itemFlagData,\n        quantity: data.quantity || 1\n      })[data.paymentIndex || 0];\n      return {\n        ...prices, item: data.item\n      };\n    })\n    .reduce((priceData, priceGroup) => {\n\n      if (!priceGroup.maxQuantity && (buyer || seller)) {\n        priceData.canBuy = false;\n        priceData.reason = [\"ITEM-PILES.Applications.TradeMerchantItem.\" + (buyer === merchant ? \"TheyCantAfford\" : \"YouCantAfford\")];\n        return priceData;\n      }\n\n      if (priceGroup.primary) {\n\n        priceData.totalCurrencyCost = Helpers.roundToDecimals(priceData.totalCurrencyCost + priceGroup.totalCost, decimals);\n        priceData.primary = true;\n\n      } else {\n\n        for (const price of priceGroup.prices) {\n\n          let existingPrice = priceData.otherPrices.find(otherPrice => {\n            return otherPrice.id === price.id || (otherPrice.name === price.name && otherPrice.img === price.img && otherPrice.type === price.type);\n          });\n\n          if (existingPrice) {\n            existingPrice.cost += price.cost;\n          } else {\n            const index = priceData.otherPrices.push(price);\n            existingPrice = priceData.otherPrices[index - 1];\n            existingPrice.quantity = 0;\n          }\n\n          existingPrice.quantity += price.cost;\n          existingPrice.buyerQuantity -= price.cost;\n\n          if (existingPrice.buyerQuantity < 0) {\n            priceData.canBuy = false;\n            priceData.reason = [\"ITEM-PILES.Applications.TradeMerchantItem.\" + (buyer === merchant ? \"TheyCantAfford\" : \"YouCantAfford\")];\n          }\n        }\n      }\n\n      if (priceGroup.item) {\n\n        const itemQuantity = Utilities.getItemQuantity(priceGroup.item);\n\n        const quantityPerPrice = game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE\n          ? getProperty(priceGroup.item, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE) ?? 1\n          : 1;\n\n        const requiredQuantity = Math.floor(priceGroup.quantity * quantityPerPrice);\n\n        if (requiredQuantity > itemQuantity && requiredQuantity > (priceGroup.maxQuantity * quantityPerPrice)) {\n          priceData.canBuy = false;\n          priceData.reason = [`ITEM-PILES.Applications.TradeMerchantItem.${buyer === merchant ? \"You\" : \"They\"}LackQuantity`, {\n            quantity: itemQuantity,\n            requiredQuantity\n          }];\n        }\n\n        priceData.buyerReceive.push({\n          type: \"item\",\n          name: priceGroup.item.name,\n          img: priceGroup.item.img,\n          quantity: requiredQuantity,\n          item: priceGroup.item,\n        });\n      }\n\n      return priceData;\n\n    }, {\n      totalCurrencyCost: 0, canBuy: true, primary: false, finalPrices: [], otherPrices: [], reason: [],\n\n      buyerReceive: [], buyerChange: [], sellerReceive: []\n    });\n\n  if (paymentData.totalCurrencyCost && !seller && !buyer) {\n\n    paymentData.finalPrices = getPriceArray(paymentData.totalCurrencyCost, recipientCurrencies);\n\n  } else if (paymentData.totalCurrencyCost) {\n\n    // The price array that we need to fill\n    const prices = getPriceArray(paymentData.totalCurrencyCost, recipientCurrencies);\n\n    // This is the target price amount we need to hit\n    let priceLeft = paymentData.totalCurrencyCost;\n\n    // Starting from the smallest currency increment in the price\n    for (let i = prices.length - 1; i >= 0; i--) {\n\n      const price = prices[i];\n\n      const buyerPrice = {\n        ...price,\n        buyerQuantity: buyerInfiniteCurrencies ? Infinity : price.quantity,\n        quantity: 0,\n        isCurrency: true\n      }\n\n      if (price.type === \"item\") {\n        buyerPrice.item = price.data.item;\n      }\n\n      // If we have met the price target (or exceeded it, eg, we need change), populate empty entry\n      if (priceLeft <= 0 || !price.cost || currencies.length === 1) {\n        if (currencies.length === 1) {\n          buyerPrice.quantity = price.cost;\n          priceLeft = 0;\n        }\n        paymentData.finalPrices.push(buyerPrice);\n        continue;\n      }\n\n      // If the buyer does not have enough to cover the cost, put what we can into it, otherwise all of it\n      buyerPrice.quantity = buyerPrice.buyerQuantity < price.cost ? buyerPrice.buyerQuantity : price.cost;\n\n      // If it's the primary currency\n      if (price.primary) {\n        // And the buyer has enough of the primary currency to cover the rest of the price, use that\n        const totalCurrencyValue = Helpers.roundToDecimals(buyerPrice.buyerQuantity * price.exchangeRate, decimals);\n        if (totalCurrencyValue > priceLeft) {\n          buyerPrice.quantity = Math.ceil(priceLeft);\n        }\n      }\n\n      paymentData.finalPrices.push(buyerPrice);\n\n      // Then adjust the remaining price - if this goes below zero, we will need change back\n      priceLeft = Helpers.roundToDecimals(priceLeft - (buyerPrice.quantity * price.exchangeRate), decimals);\n\n    }\n\n    // If there's STILL some remaining price (eg, we haven't been able to scrounge up enough currency to pay for it)\n    // we can start using the larger currencies, such as platinum in D&D 5e\n    if (currencies.length > 1) {\n      while (priceLeft > 0) {\n\n        // We then need to loop through each price, and check if we have any more left over\n        for (const buyerPrice of paymentData.finalPrices) {\n\n          // If we don't, look for the next one\n          let buyerCurrencyQuantity = buyerPrice.buyerQuantity - buyerPrice.quantity;\n          if (!buyerCurrencyQuantity) continue;\n\n          // Otherwise, add enough to cover the remaining cost\n          const newQuantity = Math.ceil(Math.min(buyerCurrencyQuantity, priceLeft / buyerPrice.exchangeRate));\n          buyerPrice.quantity += newQuantity;\n          priceLeft = Helpers.roundToDecimals(priceLeft - (newQuantity * buyerPrice.exchangeRate), decimals);\n\n          if (priceLeft <= 0) break;\n\n        }\n\n        if (priceLeft > 0) {\n          paymentData.finalPrices = paymentData.finalPrices.sort((a, b) => b.exchangeRate - a.exchangeRate);\n        } else {\n          break;\n        }\n      }\n\n      paymentData.finalPrices = paymentData.finalPrices.sort((a, b) => b.exchangeRate - a.exchangeRate);\n\n      // Since the change will be negative, we'll need to flip it, since this is what we'll get back\n      let change = Math.abs(priceLeft);\n      for (const currency of currencies) {\n\n        if (!change) break;\n\n        // Get the remaining price, and normalize it to this currency\n        let numCurrency = Math.floor(Helpers.roundToDecimals(change / currency.exchangeRate, decimals));\n        change = Helpers.roundToDecimals(change - (numCurrency * currency.exchangeRate), decimals);\n\n        // If there's some currencies to be gotten back\n        if (numCurrency) {\n          // We check if we've paid with this currency\n          const payment = paymentData.finalPrices.find(payment => {\n            return payment.id === currency.id || (payment.name === currency.name && payment.img === currency.img && payment.type === currency.type);\n          });\n          if (!payment) continue;\n\n          // If we have paid with this currency, and we're getting some back, we can do one of two things:\n          if ((payment.quantity - numCurrency) >= 0) {\n            // Either just subtract it from the total paid if some of our payment will still remain\n            // IE, the change we got back didn't cancel out the payment\n            payment.quantity -= numCurrency;\n          } else {\n            // Or if it does cancel out our payment, we add that to the change we'll get back and remove the payment entirely\n            paymentData.buyerChange.push({\n              ...currency, isCurrency: true, quantity: numCurrency - payment.quantity\n            });\n            payment.quantity = 0;\n          }\n        }\n      }\n    }\n\n    // Copy the final currencies that the seller will get\n    paymentData.sellerReceive = paymentData.finalPrices.map(price => {\n      return { ...price };\n    });\n\n    // But, we'll need to make sure they have enough change to _give_ to the buyer\n    // We collate the total amount of change needed\n    let changeNeeded = paymentData.buyerChange.reduce((acc, change) => {\n      const currency = currencies.find(currency => {\n        return change.id === currency.id || (change.name === currency.name && change.img === currency.img && change.type === currency.type);\n      });\n      return acc + currency.quantity >= change.quantity ? 0 : (change.quantity - currency.quantity) * change.exchangeRate;\n    }, 0);\n\n    // If the seller needs give the buyer some change, we'll modify the payment they'll get to cover for it\n    if (changeNeeded) {\n\n      // If the seller is being given enough of the primary currency to cover for the cost, we use that\n      const primaryCurrency = paymentData.sellerReceive.find(price => price.primary && (price.quantity * price.exchangeRate) > changeNeeded);\n      if (primaryCurrency) {\n        primaryCurrency.quantity--;\n        changeNeeded -= 1 * primaryCurrency.exchangeRate;\n      } else {\n        // Otherwise, we'll use the biggest currency we can find to cover for it\n        const biggestCurrency = paymentData.sellerReceive.find(price => price.quantity && (price.quantity * price.exchangeRate) > changeNeeded);\n        biggestCurrency.quantity--;\n        changeNeeded -= 1 * biggestCurrency.exchangeRate;\n      }\n\n      changeNeeded = Math.abs(changeNeeded);\n\n      // Then loop through each currency and add enough currency so that the total adds up\n      for (const currency of paymentData.sellerReceive) {\n        if (!changeNeeded) break;\n        let numCurrency = Math.floor(Helpers.roundToDecimals(changeNeeded / currency.exchangeRate, decimals));\n        changeNeeded = Helpers.roundToDecimals(changeNeeded - (numCurrency * currency.exchangeRate), decimals);\n        currency.quantity += numCurrency;\n      }\n    }\n  }\n\n  paymentData.finalPrices = paymentData.finalPrices.concat(paymentData.otherPrices);\n  paymentData.sellerReceive = paymentData.sellerReceive.concat(paymentData.otherPrices);\n\n  paymentData.basePriceString = paymentData.finalPrices\n    .filter(price => price.cost)\n    .map(price => {\n      let abbreviation = price.abbreviation;\n      if (price.percent && abbreviation.includes(\"%\")) {\n        abbreviation = abbreviation.replaceAll(\"%\", \"\")\n      }\n      return abbreviation.replace(\"{#}\", price.cost)\n    }).join(\" \");\n\n  delete paymentData.otherPrices;\n\n  return paymentData;\n\n}\n\n/* ---------------------- VAULT FUNCTIONS ---------------------- */\n\nexport function getVaultGridData(vaultActor, flagData = false) {\n\n  const vaultFlags = getActorFlagData(vaultActor, flagData);\n\n  const vaultItems = getActorItems(vaultActor);\n  const validVaultItems = vaultItems.filter(item => {\n    return !getItemFlagData(item).vaultExpander;\n  });\n\n  let enabledCols = vaultFlags.cols;\n  let enabledRows = vaultFlags.rows;\n\n  if (vaultFlags.vaultExpansion) {\n\n    const vaultExpanders = vaultItems.filter(item => {\n      return getItemFlagData(item).vaultExpander;\n    }).map(item => ({\n      itemFlagData: getItemFlagData(item),\n      quantity: Utilities.getItemQuantity(item)\n    }))\n\n    const expansions = vaultExpanders.reduce((acc, item) => {\n      acc.cols += (item.itemFlagData.addsCols ?? 0) * item.quantity;\n      acc.rows += (item.itemFlagData.addsRows ?? 0) * item.quantity;\n      return acc;\n    }, {\n      cols: vaultFlags.baseExpansionCols ?? 0,\n      rows: vaultFlags.baseExpansionRows ?? 0\n    });\n\n    enabledCols = expansions.cols;\n    enabledRows = expansions.rows;\n\n  }\n\n  enabledCols = Math.min(enabledCols, vaultFlags.cols);\n  enabledRows = Math.min(enabledRows, vaultFlags.rows);\n\n  return {\n    totalSpaces: Math.max(0, (vaultFlags.cols * vaultFlags.rows)),\n    enabledSpaces: Math.max(0, (enabledCols * enabledRows)),\n    freeSpaces: Math.max(0, (enabledCols * enabledRows) - validVaultItems.length),\n    enabledCols: enabledCols,\n    enabledRows: enabledRows,\n    cols: vaultFlags.cols,\n    rows: vaultFlags.rows\n  }\n\n}\n\nexport async function updateVaultLog(itemPile, {\n  actor = false,\n  userId = false,\n  items = [],\n  attributes = [],\n  withdrawal = true,\n  vaultLogData = {},\n} = {}) {\n\n  const formattedItems = [];\n  const formattedCurrencies = [];\n\n  const currencies = getActorCurrencies(itemPile, { getAll: true });\n\n  const date = Date.now();\n\n  for (const itemData of items) {\n    if (currencies.some(currency => currency.name === itemData.item.name)) {\n      formattedCurrencies.push({\n        actor: actor?.name ?? false,\n        user: userId,\n        name: itemData.item.name,\n        qty: itemData.quantity * (withdrawal ? -1 : 1),\n        action: vaultLogData?.action ?? (withdrawal ? \"withdrew\" : \"deposited\"),\n        date\n      });\n    } else {\n      const item = await Item.implementation.create(itemData.item, { temporary: true });\n      formattedItems.push({\n        actor: actor?.name ?? false,\n        user: userId,\n        name: item.name,\n        qty: itemData.quantity * (withdrawal ? -1 : 1),\n        action: vaultLogData?.action ?? (withdrawal ? \"withdrew\" : \"deposited\"),\n        date\n      });\n    }\n  }\n\n  for (const [key, quantity] of Object.entries(attributes)) {\n    const currency = currencies.find(currency => currency.data.path === key);\n    if (currency) {\n      formattedCurrencies.push({\n        actor: actor?.name ?? false,\n        user: userId,\n        name: currency.name,\n        qty: quantity * (withdrawal ? -1 : 1),\n        action: vaultLogData?.action ?? (withdrawal ? \"withdrew\" : \"deposited\"),\n        date\n      });\n    }\n  }\n\n  const vaultLog = getActorVaultLog(itemPile);\n\n  return itemPile.update({\n    [CONSTANTS.FLAGS.LOG]: formattedItems.concat(formattedCurrencies).concat(vaultLog)\n  });\n}\n\nexport function getActorVaultLog(actor) {\n  return getProperty(Utilities.getActor(actor), CONSTANTS.FLAGS.LOG) || [];\n}\n\nexport function clearVaultLog(actor) {\n  return actor.update({\n    [CONSTANTS.FLAGS.LOG]: []\n  });\n}\n\nexport async function rollMerchantTables({ tableData = false, actor = false } = {}) {\n\n  if (tableData && !Array.isArray(tableData)) {\n    tableData = [tableData]\n  } else if (!tableData && actor) {\n    const flagData = getActorFlagData(actor);\n    tableData = flagData.tablesForPopulate;\n  } else if (!tableData && !actor) {\n    return [];\n  }\n\n  const items = [];\n\n  for (const table of tableData) {\n\n    const rollableTable = game.tables.get(table.id);\n\n    if (!rollableTable) continue;\n\n    await rollableTable.reset();\n    await rollableTable.normalize();\n\n    let tableItems = [];\n\n    if (table.addAll) {\n\n      for (const [itemId, formula] of Object.entries(table.items)) {\n        const rollResult = rollableTable.results.get(itemId).toObject();\n        const item = await getItem(rollResult);\n        if (!item) continue;\n        const roll = new Roll(formula).evaluate({ async: false });\n        if (roll.total <= 0) continue;\n        tableItems.push({\n          ...rollResult,\n          item: item,\n          quantity: roll.total\n        })\n      }\n\n    } else {\n\n      const roll = new Roll((table.timesToRoll ?? \"1\").toString()).evaluate({ async: false });\n\n      if (roll.total <= 0) {\n        continue;\n      }\n\n      tableItems = await game.itempiles.API.rollItemTable(rollableTable, { timesToRoll: roll.total });\n\n    }\n\n    tableItems.forEach(newItem => {\n\n      const existingItem = items.find(\n        (item) => item.documentId === newItem.documentId\n      );\n      if (existingItem) {\n        existingItem.quantity++;\n      } else {\n        if (table?.customCategory && !getProperty(newItem.item, CONSTANTS.FLAGS.ITEM + \".customCategory\")) {\n          setProperty(newItem, CONSTANTS.FLAGS.ITEM + \".customCategory\", table?.customCategory);\n        }\n        items.push({\n          ...newItem\n        });\n      }\n    })\n  }\n\n  return items;\n}\n\n\nasync function getItem(itemToGet) {\n  let item;\n  if (itemToGet.documentCollection === \"Item\") {\n    item = game.items.get(itemToGet.documentId);\n  } else {\n    const compendium = game.packs.get(itemToGet.documentCollection);\n    if (compendium) {\n      item = await compendium.getDocument(itemToGet.documentId);\n    }\n  }\n  return item;\n}\n","<script>\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\n  import FilePicker from \"./FilePicker.svelte\";\n  import { flip } from \"svelte/animate\";\n  import { dndzone, SOURCES, TRIGGERS } from 'svelte-dnd-action';\n  import DropZone from \"./DropZone.svelte\";\n  import * as Helpers from \"../../helpers/helpers.js\";\n  import * as Utilities from \"../../helpers/utilities.js\";\n  import CONSTANTS from \"../../constants/constants.js\";\n  import { getSetting } from \"../../helpers/helpers.js\";\n  import SETTINGS from \"../../constants/settings.js\";\n  import { getActorFlagData } from \"../../helpers/pile-utilities.js\";\n\n  export let prices;\n  export let item;\n  export let remove = false;\n  export let presets = true;\n\n  let currencies = getSetting(SETTINGS.CURRENCIES);\n  let secondaryCurrencies = getSetting(SETTINGS.SECONDARY_CURRENCIES);\n  if (item.parent) {\n    const flags = getActorFlagData(item.parent)\n    if (flags.overrideCurrencies) {\n      currencies = flags.overrideCurrencies;\n    }\n    if (flags.overrideSecondaryCurrencies) {\n      secondaryCurrencies = flags.overrideSecondaryCurrencies;\n    }\n  }\n\n  let presetPrices = currencies\n    .concat(secondaryCurrencies)\n    .map(currency => {\n      return {\n        id: randomID(),\n        quantity: 1,\n        fixed: true,\n        percent: false,\n        ...currency,\n      }\n    })\n    .concat(getSetting(SETTINGS.PRICE_PRESETS));\n\n  let isHovering = false;\n  let flipDurationMs = 200;\n  let dragDisabled = true;\n  let selectedPreset = \"\";\n\n  function removeEntry(index) {\n    prices.splice(index, 1);\n    prices = prices;\n  }\n\n  function addAttribute() {\n    prices = [...prices, {\n      id: randomID(),\n      type: \"attribute\",\n      name: \"New Attribute\",\n      img: \"\",\n      abbreviation: \"{#}N\",\n      data: {\n        path: \"\"\n      },\n      quantity: 1,\n      fixed: true,\n      percent: false\n    }];\n  }\n\n  function addPreset(index) {\n    const preset = foundry.utils.duplicate(presetPrices[index]);\n    preset.id = randomID();\n    prices = [...prices, preset];\n  }\n\n  async function dropData(data) {\n\n    if (!data.type) {\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\n    }\n\n    if (data.type !== \"Item\") {\n      throw Helpers.custom_error(\"You must drop an item, not \" + data.type.toLowerCase() + \"!\")\n    }\n\n    let uuid = false;\n    if (data.pack) {\n      uuid = \"Compendium\" + data.pack + \".\" + data.id;\n    }\n\n    let item = await Item.implementation.fromDropData(data);\n    let itemData = item.toObject();\n\n    if (!itemData) {\n      console.error(data);\n      throw Helpers.custom_error(\"Something went wrong when dropping this item!\")\n    }\n\n    const itemCurrencies = prices.map(entry => entry.data?.item ?? {});\n    const foundItem = Utilities.findSimilarItem(itemCurrencies, itemData);\n\n    if (foundItem) {\n      const index = itemCurrencies.indexOf(foundItem);\n      prices[index].data = {\n        uuid,\n        item: itemData\n      }\n      Helpers.custom_notify(`Updated item data for ${localize(prices[index].name)} (item name ${itemData.name})`)\n    } else {\n      prices = [...prices, {\n        id: randomID(),\n        type: \"item\",\n        name: itemData.name,\n        img: itemData.img,\n        abbreviation: \"{#} \" + itemData.name,\n        data: {\n          uuid,\n          item: itemData\n        },\n        quantity: 1,\n        fixed: true,\n        percent: false\n      }];\n    }\n  }\n\n  async function editItem(index) {\n    const data = prices[index].data;\n    let item;\n    if (data.uuid) {\n      item = await fromUuid(data.uuid);\n    } else {\n      let itemData = data.item;\n      if (itemData._id) delete itemData._id;\n      if (itemData.ownership) delete itemData.ownership;\n      const items = Array.from(game.items);\n      item = Utilities.findSimilarItem(items, itemData);\n      if (!item) {\n        setProperty(itemData, CONSTANTS.FLAGS.TEMPORARY_ITEM, true);\n        item = await Item.implementation.create(itemData);\n        Helpers.custom_notify(`An item has been created for ${item.name} - drag and drop it into the list to update the stored item data`)\n      }\n    }\n    item.sheet.render(true);\n  }\n\n  function handleConsider(e) {\n    const { items: newItems, info: { source, trigger } } = e.detail;\n    prices = newItems;\n    // Ensure dragging is stopped on drag finish via keyboard\n    if (source === SOURCES.KEYBOARD && trigger === TRIGGERS.DRAG_STOPPED) {\n      dragDisabled = true;\n    }\n  }\n\n  function handleFinalize(e) {\n    const { items: newItems, info: { source } } = e.detail;\n    prices = newItems;\n    // Ensure dragging is stopped on drag finish via pointer (mouse, touch)\n    if (source === SOURCES.POINTER) {\n      dragDisabled = true;\n    }\n  }\n\n  function startDrag(e) {\n    // preventing default to prevent lag on touch devices (because of the browser checking for screen scrolling)\n    e.preventDefault();\n    dragDisabled = false;\n  }\n\n  function handleKeyDown(e) {\n    if ((e.key === \"Enter\" || e.key === \" \") && dragDisabled) dragDisabled = false;\n  }\n\n</script>\n\n\n<DropZone callback={dropData} bind:isHovering={isHovering}>\n\t<div class=\"table-container item-piles-top-divider\">\n\t\t<div class=\"item-piles-sortable-list-columns header\">\n\t\t\t<div></div>\n\t\t\t<div>Name</div>\n\t\t\t<div>Cost</div>\n\t\t\t<div>Fixed</div>\n\t\t\t<div>%</div>\n\t\t\t<div>Short</div>\n\t\t\t<div>Icon</div>\n\t\t\t<div>Data</div>\n\t\t\t<div>\n\t\t\t\t{#if remove}\n\t\t\t\t\t<a class=\"item-piles-clickable-red\" on:click={() => remove()}><i class=\"fas fa-times\"></i></a>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t\t<section\n\t\t\tuse:dndzone=\"{{ items: prices, dragDisabled, flipDurationMs }}\"\n\t\t\ton:consider=\"{handleConsider}\"\n\t\t\ton:finalize=\"{handleFinalize}\"\n\t\t>\n\t\t\t{#if isHovering}\n\t\t\t\t<div class=\"drop-to-add\">Drop to add</div>\n\t\t\t{/if}\n\t\t\t{#each prices as price, index (price.id)}\n\t\t\t\t<div class=\"item-piles-sortable-list-columns item-piles-sortable-list-entry item-piles-even-color\"\n\t\t\t\t\t\t animate:flip=\"{{ duration: flipDurationMs }}\">\n\t\t\t\t\t<div tabIndex={dragDisabled? 0 : -1}\n\t\t\t\t\t\t\t aria-label=\"drag-handle\"\n\t\t\t\t\t\t\t style={dragDisabled ? 'cursor: grab' : 'cursor: grabbing'}\n\t\t\t\t\t\t\t on:mousedown={startDrag}\n\t\t\t\t\t\t\t on:touchstart={startDrag}\n\t\t\t\t\t\t\t on:keydown={handleKeyDown}\n\t\t\t\t\t><i class=\"fas fa-bars\"></i></div>\n\t\t\t\t\t<div><input type=\"text\" bind:value={price.name}/></div>\n\t\t\t\t\t<div><input type=\"number\" bind:value={price.quantity}/></div>\n\t\t\t\t\t<div><input type=\"checkbox\" bind:checked={price.fixed} min=\"0\"\n\t\t\t\t\t\t\t\t\t\t\tmax=\"{price.percent ? 100 : 1000000000000000}\"/></div>\n\t\t\t\t\t<div><input type=\"checkbox\" bind:checked={price.percent}/></div>\n\t\t\t\t\t<div><input type=\"text\" bind:value={price.abbreviation}/></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FilePicker type=\"imagevideo\" showImage={true} showInput={false} bind:value={price.img}/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{#if price.type === \"attribute\"}\n\t\t\t\t\t\t\t<input type=\"text\" bind:value={price.data.path} placeholder=\"system.attributes.hp.value\"/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button type=\"button\" on:click={() => editItem(index)}>\n\t\t\t\t\t\t\t\t<i class=\"fas fa-eye\"></i> View item\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button type=\"button\" on:click={() => removeEntry(index)}><i class=\"fas fa-times\"></i></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t\t<div class=\"item-piles-sortable-list-columns\" style=\"margin-top: 0.5rem;\">\n\t\t\t\t<div class=\"full-span\">\n\t\t\t\t\t<a on:click={() => addAttribute()} class:invisible={isHovering}>\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.DropMeClickMe\")}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t{#if presetPrices.length && presets}\n\t\t\t\t\t<div class=\"full-span\" style=\"margin-top:0.5rem;\">\n\t\t\t\t\t\t<span style=\"margin-right:0.25rem;\">{localize(\"ITEM-PILES.Applications.ItemEditor.PricePreset\")}</span>\n\t\t\t\t\t\t<select class=\"price-preset-selector\" bind:value={selectedPreset}\n\t\t\t\t\t\t\t\t\t\ton:change={() => { addPreset(selectedPreset); selectedPreset = \"\"; }}>\n\t\t\t\t\t\t\t<option value=\"\">{localize(\"ITEM-PILES.Applications.ItemEditor.SelectPreset\")}</option>\n\t\t\t\t\t\t\t{#each presetPrices as price, index (index)}\n\t\t\t\t\t\t\t\t<option value={index}>{price.name}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</section>\n\t</div>\n</DropZone>\n\n<style lang=\"scss\">\n\n  .price-preset-selector {\n    height: 20px;\n    font-size: 0.8rem;\n  }\n\n  .item-piles-sortable-list-columns {\n    grid-template-columns: 28px 1.1fr 35px 28px 28px 0.5fr 60px 1fr 28px;\n    min-height: 30px;\n  }\n\n  .item-piles-sortable-list-entry {\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    border-radius: 4px;\n  }\n\n  .item-piles-even-color {\n    &:nth-child(even) {\n      background-color: #e5e5d6;\n    }\n\n    &:nth-child(odd) {\n      background-color: #f8f8e7;\n    }\n  }\n\n  .invisible {\n    opacity: 0;\n  }\n\n  .table-container {\n    position: relative;\n  }\n\n  .drop-to-add {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    left: 0;\n    border-radius: 5px;\n    box-shadow: inset 0 0 15px 5px rgb(0, 0, 0, 0.5);\n    background-color: rgba(255, 255, 255, 0.75);\n    z-index: 100000;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 1.5rem;\n    overflow: hidden;\n  }\n\n  .full-span {\n    grid-column: 1/-1;\n  }\n\n</style>\n","<script>\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import PriceList from \"../../components/PriceList.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let data;\r\n  export let elementRoot;\r\n  let form;\r\n\r\n  let prices = foundry.utils.deepClone(data);\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(prices);\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off class=\"item-piles-config-container\">\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.PricePresetEditor.Explanation\")}</p>\r\n\r\n\t\t<PriceList bind:prices presets={false}/>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"ITEM-PILES.Applications.PricePresetEditor.Update\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  p {\r\n    font-size: 0.8rem;\r\n    text-align: center;\r\n    line-height: 1rem;\r\n  }\r\n\r\n  table {\r\n\r\n    td {\r\n      vertical-align: middle;\r\n    }\r\n\r\n    tr {\r\n\r\n      &.is-active {\r\n        background-color: #3273dc;\r\n        color: #fff;\r\n      }\r\n\r\n      &.is-dragging {\r\n        background-color: rgba(50, 220, 132, 0.55);\r\n        color: #fff;\r\n      }\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import PricePresetEditorShell from \"./price-preset-editor-shell.svelte\";\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class PricePresetEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      id: `item-pile-price-preset-editor-${randomID()}`,\r\n      title: game.i18n.format(\"ITEM-PILES.Applications.PricePresetEditor.Title\"),\r\n      width: 500,\r\n      svelte: {\r\n        class: PricePresetEditorShell,\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { get, writable } from \"svelte/store\";\r\n  import SETTINGS from \"../../../constants/settings.js\";\r\n  import { getSetting } from \"../../../helpers/helpers.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  let form;\r\n\r\n  export let elementRoot;\r\n  export let data;\r\n\r\n  const itemFilters = (getSetting(SETTINGS.ITEM_FILTERS).find(filter => filter.path === \"type\")?.filters ?? \"\").split(',');\r\n\r\n  const unstackableItemTypesStore = writable(data);\r\n  let systemTypes = game.system.template.Item.types.filter(type => !itemFilters.includes(type));\r\n  let unusedTypes = [];\r\n\r\n  $: {\r\n    unusedTypes = systemTypes.filter(systemType => !$unstackableItemTypesStore.some(type => type === systemType));\r\n  }\r\n\r\n  function add() {\r\n    if (!unusedTypes.length) return;\r\n    unstackableItemTypesStore.update(arr => {\r\n      arr.push(unusedTypes[0]);\r\n      return arr;\r\n    })\r\n  }\r\n\r\n  function remove(index) {\r\n    unstackableItemTypesStore.update(arr => {\r\n      arr.splice(index, 1)\r\n      return arr;\r\n    })\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(get(unstackableItemTypesStore));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.UnstackableItemTypesEditor.Explanation\")}</p>\r\n\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>{localize(\"ITEM-PILES.Applications.UnstackableItemTypesEditor.Type\")}</th>\r\n\t\t\t\t<th class=\"small\"><a on:click={add} class=\"item-piles-clickable\"><i class=\"fas fa-plus\"></i></a></th>\r\n\t\t\t</tr>\r\n\t\t\t{#each $unstackableItemTypesStore as type, index (index)}\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<select bind:value={type}>\r\n\t\t\t\t\t\t\t{#each systemTypes as systemType}\r\n\t\t\t\t\t\t\t\t<option value=\"{systemType}\" disabled=\"{systemType !== type && !unusedTypes.includes(systemType)}\">\r\n\t\t\t\t\t\t\t\t\t{systemType}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t{/each}\r\n\t\t</table>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    select {\r\n      width: 100%;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import UnstackableItemTypesEditorShell from './unstackable-item-types-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class UnstackableItemTypesEditor extends Editor {\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.UnstackableItemTypesEditor.Title\"),\r\n      width: 300,\r\n      svelte: {\r\n        class: UnstackableItemTypesEditorShell,\r\n      },\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  import { get, writable } from \"svelte/store\";\r\n  import { getContext } from \"svelte\";\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let data;\r\n  export let elementRoot;\r\n\r\n  let form;\r\n\r\n  const options = application.options;\r\n\r\n  const styleValues = data?.subscribe ? data : writable(data);\r\n\r\n  const styleStore = Object.entries(get(styleValues));\r\n  let values = writable(styleStore.length ? styleStore : [[\"\", \"\"]])\r\n\r\n  function add() {\r\n    values.update(arr => {\r\n      return [...arr, [\"\", \"\"]];\r\n    })\r\n  }\r\n\r\n  function remove(index) {\r\n    values.update(arr => {\r\n      arr.splice(index, 1);\r\n      return arr;\r\n    })\r\n  }\r\n\r\n  $: {\r\n    const data = Object.fromEntries($values\r\n      .map(entry => [entry[0].trim(), entry[1].trim()])\r\n      .filter(entry => entry[0].length && entry[1].length)\r\n    );\r\n    styleValues.set(data);\r\n    if (options.onchange) {\r\n      options.onchange(data);\r\n    }\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(Object.fromEntries(get(values)));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\r\n\t\t<div style=\"display: grid; grid-template-columns: 1.25fr 2fr {options.readOnly ? '' : 'auto'}; gap: 5px;\"\r\n\t\t\t\t class=\"item-piles-bottom-divider\">\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.StylesEditor.\" + (options.variables ? \"Variable\" : \"Style\"))}</span>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.StylesEditor.Value\")}</span>\r\n\t\t\t{#if !options.readOnly}\r\n\t\t\t\t<a class=\"item-piles-flexrow align-center-row item-piles-clickable-green\" style=\"text-align: center;\"\r\n\t\t\t\t\t on:click={() => add()}>\r\n\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#each $values as [key, value], index (index)}\r\n\t\t\t\t<input disabled={options.readOnly} autocomplete=\"false\" type=\"text\" bind:value={key}/>\r\n\t\t\t\t<input autocomplete=\"false\" type=\"text\" bind:value={value}/>\r\n\t\t\t\t{#if !options.readOnly}\r\n\t\t\t\t\t<a class=\"item-piles-flexrow align-center-row\" style=\"text-align: center;\" on:click={() => remove(index)}>\r\n\t\t\t\t\t\t<i class=\"fas fa-times item-piles-clickable-red\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t{/if}\r\n\t\t\t{/each}\r\n\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.options.resolve(null); application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n","import StylesEditorShell from './styles-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class StylesEditor extends Editor {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.StylesEditor.Title\"),\r\n      svelte: {\r\n        class: StylesEditorShell,\r\n      }\r\n    })\r\n  }\r\n}\r\n","<script>\r\n\r\n  import * as Helpers from \"../../../helpers/helpers.js\";\r\n  import { get, writable } from \"svelte/store\";\r\n  import { getContext } from \"svelte\";\r\n  import StylesEditor from \"../styles-editor/styles-editor.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let index;\r\n  export let entry;\r\n  export let image;\r\n  export let remove;\r\n\r\n  let style = writable(entry.styling);\r\n\r\n  async function renderStyleEditor(event) {\r\n\r\n    const oldStyle = entry.styling;\r\n\r\n    const newStyles = await StylesEditor.show(style, {\r\n      width: 400,\r\n      left: application.position.left + 405,\r\n      top: event.clientY - 75,\r\n      readOnly: true\r\n    });\r\n\r\n    style.set(newStyles || oldStyle);\r\n    entry.styling = newStyles || oldStyle;\r\n\r\n  }\r\n\r\n</script>\r\n\r\n<div><input type=\"text\" required placeholder=\"system.rarity\" bind:value=\"{entry.path}\"/></div>\r\n<div><input type=\"text\" required placeholder=\"rare\" bind:value=\"{entry.value}\"/></div>\r\n<div>\r\n\t{#if image}\r\n\t\t<img class=\"item-piles-item-image-example\" src={image}/>\r\n\t{/if}\r\n\t<div class=\"img-div\" style={Helpers.styleFromObject($style)}></div>\r\n</div>\r\n<div>\r\n\t<a class=\"item-piles-clickable-green\" on:click={(evt) => renderStyleEditor(evt)}>\r\n\t\t<i class=\"fas fa-cog\"></i>\r\n\t</a>\r\n</div>\r\n<div>\r\n\t<a class=\"item-piles-clickable-red\" on:click={remove(index)}>\r\n\t\t<i class=\"fas fa-times\"></i>\r\n\t</a>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n    display: flex;\r\n    align-items: center;\r\n    position: relative;\r\n    justify-content: center;\r\n\r\n    img, .img-div {\r\n      position: absolute;\r\n      border-radius: 4px;\r\n      min-height: 24px;\r\n      min-width: 24px;\r\n      max-height: 24px;\r\n      max-width: 24px;\r\n    }\r\n\r\n    a {\r\n      padding: 0;\r\n      line-height: inherit;\r\n      text-align: center;\r\n\r\n      > i {\r\n        line-height: inherit;\r\n        margin: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { get, writable } from \"svelte/store\";\r\n  import StyleEntry from \"./StyleEntry.svelte\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  let form;\r\n\r\n  export let elementRoot;\r\n  export let data;\r\n\r\n  const vaultStyleStore = writable(data);\r\n\r\n  loadImages();\r\n\r\n  function add() {\r\n    vaultStyleStore.update(arr => {\r\n      arr.push({ path: \"\", value: \"\", styling: {} })\r\n      return arr;\r\n    });\r\n  }\r\n\r\n  let images = [];\r\n\r\n  async function loadImages() {\r\n    const data = await FilePicker.browse(\"public\", \"icons/weapons/swords/*.webp\", { wildcard: true });\r\n    images = data.files;\r\n  }\r\n\r\n  function remove(index) {\r\n    vaultStyleStore.update(arr => {\r\n      arr.splice(index, 1)\r\n      return arr;\r\n    });\r\n  }\r\n\r\n  async function updateSettings() {\r\n    application.options.resolve(get(vaultStyleStore));\r\n    application.close();\r\n  }\r\n\r\n  export function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form bind:this={form} on:submit|preventDefault={updateSettings} autocomplete=off>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.VaultStylesEditor.Explanation\")}</p>\r\n\r\n\t\t<div class=\"item-piles-table\">\r\n\t\t\t<div>{localize(\"ITEM-PILES.Applications.VaultStylesEditor.Path\")}</div>\r\n\t\t\t<div>{localize(\"ITEM-PILES.Applications.VaultStylesEditor.Value\")}</div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div style=\"text-align: right;\"><a on:click={add} class=\"item-piles-clickable\"><i class=\"fas fa-plus\"></i></a>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#each $vaultStyleStore as entry, index (index)}\r\n\t\t\t\t<StyleEntry bind:entry image={images[index]} {index} {remove}/>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button type=\"button\" on:click|once={() => { application.close(); }}>\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-table {\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr 26px 21px 21px;\r\n    padding: 3px;\r\n    gap: 3px;\r\n\r\n    div > a {\r\n      display: flex;\r\n      align-items: center;\r\n      position: relative;\r\n      justify-content: center;\r\n\r\n      a {\r\n        padding: 0;\r\n        line-height: inherit;\r\n        text-align: center;\r\n\r\n\r\n        > i {\r\n          line-height: inherit;\r\n          margin: 0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import VaultStylesEditorShell from './vault-styles-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class VaultStylesEditor extends Editor {\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Applications.VaultStylesEditor.Title\"),\r\n      svelte: {\r\n        class: VaultStylesEditorShell,\r\n      }\r\n    })\r\n  }\r\n}\r\n","import { CurrenciesEditor, SecondaryCurrenciesEditor } from \"./currencies-editor/currencies-editor.js\";\r\nimport ItemFiltersEditor from \"./item-filters-editor/item-filters-editor.js\";\r\nimport StringListEditor from \"./string-list-editor/string-list-editor.js\";\r\nimport PriceModifiersEditor from \"./price-modifiers-editor/price-modifiers-editor.js\";\r\nimport PricePresetEditor from \"./price-preset-editor/price-preset-editor.js\";\r\nimport UnstackableItemTypesEditor from \"./unstackable-item-types-editor/unstackable-item-types-editor.js\";\r\nimport VaultStylesEditor from \"./vault-styles-editor/vault-styles-editor.js\";\r\nimport StylesEditor from \"./styles-editor/styles-editor.js\";\r\n\r\nexport default {\r\n  \"currencies\": CurrenciesEditor,\r\n  \"secondary-currencies\": SecondaryCurrenciesEditor,\r\n  \"item-filters\": ItemFiltersEditor,\r\n  \"item-similarities\": StringListEditor,\r\n  \"item-categories\": StringListEditor,\r\n  \"styles\": StylesEditor,\r\n  \"vault-styles\": VaultStylesEditor,\r\n  \"price-modifiers\": PriceModifiersEditor,\r\n  \"unstackable-item-types\": UnstackableItemTypesEditor,\r\n  \"price-presets\": PricePresetEditor\r\n}\r\n","<script>\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { getContext } from 'svelte';\r\n  import editors from \"../editors/index.js\";\r\n  import { openEditor } from \"../../helpers/helpers.js\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let key;\r\n  export let data;\r\n  export let callback = false;\r\n\r\n  let editor = false;\r\n  if (!callback) {\r\n    editor = editors[data.application];\r\n    callback = () => {\r\n      showEditor();\r\n    }\r\n  }\r\n\r\n  function showEditor() {\r\n    if (editor) {\r\n      const combinedData = data?.mergedDefaults\r\n        ? foundry.utils.mergeObject(data.mergedDefaults, data.value)\r\n        : data.value;\r\n      openEditor(key, combinedData).then((result) => {\r\n        if (!result) return;\r\n        if (data?.mergedDefaults) {\r\n          result = foundry.utils.diffObject(data?.mergedDefaults, result);\r\n        }\r\n        data.value = result;\r\n      });\r\n      application.options.zLevel = 100;\r\n    }\r\n  }\r\n\r\n  function reset() {\r\n    data.value = foundry.utils.deepClone(data.default);\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"setting form-scope item-piles-flexrow\">\r\n\r\n\t<div class=\"label-side\">\r\n\t\t<label>\r\n\t\t\t{localize(data.name)}\r\n\t\t\t{#if !data.hideResetButton}\r\n\t\t\t\t<a on:click={() => reset()} data-tooltip=\"Reset setting\">\r\n\t\t\t\t\t<i class=\"fas fa-undo reset-setting\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\t\t</label>\r\n\t\t<p class=\"notes\">{localize(data.hint)}</p>\r\n\t</div>\r\n\r\n\t<div class=\"form-fields input-side\">\r\n\t\t<div class=\"button-container\">\r\n\t\t\t<button type=\"button\" on:click={() => { callback(); }}>\r\n\t\t\t\t<i class=\"{data.icon}\"></i>\r\n\t\t\t\t{localize(data.label)}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .setting:not(:last-child) {\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n  }\r\n\r\n  .reset-setting {\r\n    font-size: 0.75rem;\r\n    margin-left: 0.5rem;\r\n    opacity: 0.5;\r\n    transition: opacity 250ms;\r\n\r\n    &:hover {\r\n      opacity: 1.0;\r\n    }\r\n  }\r\n\r\n  .invalid {\r\n    border: 2px solid #d93131;\r\n  }\r\n\r\n  label {\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  .form-fields {\r\n    flex: 0 1 auto;\r\n  }\r\n\r\n  .setting-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .label-side {\r\n    flex: 1;\r\n    margin-right: 1rem;\r\n  }\r\n\r\n  .button-container {\r\n    min-width: 220px;\r\n    max-width: 220px;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  button {\r\n    flex: 1;\r\n    line-height: initial;\r\n    padding: 0.5rem 0;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import SETTINGS from \"../../constants/settings.js\";\r\n\r\n  import { getContext } from 'svelte';\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { ApplicationShell } from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n\r\n  import * as helpers from \"../../helpers/helpers.js\"\r\n  import { applyDefaultSettings } from \"../../settings.js\";\r\n\r\n  import Setting from \"./Setting.svelte\";\r\n  import SettingButton from \"./SettingButton.svelte\";\r\n  import Tabs from \"../components/Tabs.svelte\";\r\n  import { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\n  import CustomDialog from \"../components/CustomDialog.svelte\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  let form;\r\n\r\n  let settings = {};\r\n  let userCanChangeSettings = game.user.hasPermission(\"SETTINGS_MODIFY\");\r\n\r\n  getSettings();\r\n\r\n  function getSettings() {\r\n    settings = Object.fromEntries(Object.entries(SETTINGS.GET_DEFAULT()).map(entry => {\r\n      entry[1].value = helpers.getSetting(entry[0]);\r\n      return entry;\r\n    }));\r\n\r\n    settings[SETTINGS.POPULATION_TABLES_FOLDER].choices = {\r\n      \"root\": \"ITEM-PILES.Settings.PopulationTablesFolder.AllTables\",\r\n      ...Object.fromEntries(\r\n        game.folders\r\n          .filter(f => f.type === \"RollTable\")\r\n          .map(f => [f.id, f.name])\r\n      )\r\n    }\r\n  }\r\n\r\n  function requestSubmit() {\r\n    form.requestSubmit();\r\n  }\r\n\r\n  async function updateSettings() {\r\n    let settingsToUpdate = Object.entries(settings).filter(entry => userCanChangeSettings || entry[1].scope === \"client\");\r\n    for (let [key, setting] of settingsToUpdate) {\r\n      await helpers.setSetting(key, setting.value);\r\n    }\r\n    application.close();\r\n  }\r\n\r\n  async function resetSettings() {\r\n\r\n    const doThing = await TJSDialog.confirm({\r\n      title: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSettings.Title\"),\r\n      content: {\r\n        class: CustomDialog,\r\n        props: {\r\n          content: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSettings.Content\")\r\n        }\r\n      },\r\n      buttons: {\r\n        yes: {\r\n          icon: '<i class=\"fas fa-check\"></i>',\r\n          label: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSettings.Confirm\")\r\n        },\r\n        no: {\r\n          icon: '<i class=\"fas fa-times\"></i>',\r\n          label: game.i18n.localize(\"No\")\r\n        }\r\n      },\r\n      modal: true,\r\n      draggable: false,\r\n      rejectClose: false,\r\n      defaultYes: true,\r\n      options: {\r\n        height: \"auto\"\r\n      }\r\n    });\r\n\r\n    if (!doThing) return;\r\n\r\n    return applyDefaultSettings();\r\n  }\r\n\r\n  let tabs = [\r\n    { value: \"local\", label: localize(\"ITEM-PILES.Applications.Settings.Local\") },\r\n    { value: \"module\", label: localize(\"ITEM-PILES.Applications.Settings.Module\"), hidden: !userCanChangeSettings },\r\n    { value: \"styles\", label: localize(\"ITEM-PILES.Applications.Settings.Styles\"), hidden: !userCanChangeSettings },\r\n    { value: \"system\", label: localize(\"ITEM-PILES.Applications.Settings.System\"), hidden: !userCanChangeSettings },\r\n  ];\r\n\r\n  let activeTab = tabs[0].value;\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form bind:this={form} on:submit|once|preventDefault={updateSettings} autocomplete=\"off\">\r\n\r\n\t\t<h2 style=\"text-align: center; margin-bottom: 1rem;\">{localize(\"ITEM-PILES.Applications.Settings.Title\")}</h2>\r\n\r\n\t\t{#if userCanChangeSettings}\r\n\t\t\t<Tabs bind:activeTab {tabs}/>\r\n\t\t{/if}\r\n\r\n\t\t<section class=\"tab-body\">\r\n\r\n\t\t\t<div class=\"tab flex\" class:active={activeTab === 'local'} data-scope=\"primary\" data-tab=\"local\">\r\n\r\n\t\t\t\t<Setting key={SETTINGS.INVERT_SHEET_OPEN} bind:data=\"{settings[SETTINGS.INVERT_SHEET_OPEN]}\"/>\r\n\t\t\t\t<Setting key={SETTINGS.HIDE_ACTOR_HEADER_TEXT} bind:data=\"{settings[SETTINGS.HIDE_ACTOR_HEADER_TEXT]}\"/>\r\n\t\t\t\t<Setting key={SETTINGS.HIDE_ACTOR_HEADER_BUTTON} bind:data=\"{settings[SETTINGS.HIDE_ACTOR_HEADER_BUTTON]}\"/>\r\n\t\t\t\t<Setting key={SETTINGS.PRELOAD_FILES} bind:data=\"{settings[SETTINGS.PRELOAD_FILES]}\"/>\r\n\t\t\t\t<Setting key={SETTINGS.DEBUG} bind:data=\"{settings[SETTINGS.DEBUG]}\"/>\r\n\t\t\t\t<Setting key={SETTINGS.DEBUG_HOOKS} bind:data=\"{settings[SETTINGS.DEBUG_HOOKS]}\"/>\r\n\r\n\t\t\t\t<div style=\"text-align: center; font-size: 1rem; margin-top:3rem;\">\r\n\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.Settings.MoreToCome\")}\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t<p style=\"margin-bottom:1rem;\">\r\n\t\t\t\t\t\t<a class=\"link-text\"\r\n\t\t\t\t\t\t\t href=\"https://github.com/fantasycalendar/FoundryVTT-ItemPiles/issues/new?assignees=&labels=&template=feature_request.md&title=\"\r\n\t\t\t\t\t\t\t target=\"_blank\"\r\n\t\t\t\t\t\t>{localize(\"ITEM-PILES.Applications.Settings.Request\")}</a>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.Settings.Donate\")}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<a href=\"https://ko-fi.com/fantasycomputerworks\" target=\"_blank\" style=\"text-decoration: none !important;\">\r\n\t\t\t\t\t\t\t<button class=\"donate-button\" type=\"button\">\r\n\t\t\t\t\t\t\t\t<img src=\"https://storage.ko-fi.com/cdn/cup-border.png\">\r\n\t\t\t\t\t\t\t\t<span>Donate</span>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t{#if userCanChangeSettings}\r\n\t\t\t\t<div class=\"tab flex\" class:active={activeTab === 'module'} data-scope=\"primary\" data-tab=\"module\">\r\n\t\t\t\t\t<Setting key={SETTINGS.ENABLE_DROPPING_ITEMS} bind:data=\"{settings[SETTINGS.ENABLE_DROPPING_ITEMS]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ENABLE_GIVING_ITEMS} bind:data=\"{settings[SETTINGS.ENABLE_GIVING_ITEMS]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ENABLE_TRADING} bind:data=\"{settings[SETTINGS.ENABLE_TRADING]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.SHOW_TRADE_BUTTON} bind:data=\"{settings[SETTINGS.SHOW_TRADE_BUTTON]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.INSPECT_ITEMS_IN_TRADE} bind:data=\"{settings[SETTINGS.INSPECT_ITEMS_IN_TRADE]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.OUTPUT_TO_CHAT} bind:data=\"{settings[SETTINGS.OUTPUT_TO_CHAT]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.DELETE_EMPTY_PILES} bind:data=\"{settings[SETTINGS.DELETE_EMPTY_PILES]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.POPULATION_TABLES_FOLDER} bind:data=\"{settings[SETTINGS.POPULATION_TABLES_FOLDER]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.HIDE_TOKEN_BORDER} bind:data=\"{settings[SETTINGS.HIDE_TOKEN_BORDER]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.PRICE_PRESETS} bind:data=\"{settings[SETTINGS.PRICE_PRESETS]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.CUSTOM_ITEM_CATEGORIES} bind:data=\"{settings[SETTINGS.CUSTOM_ITEM_CATEGORIES]}\"/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"tab flex\" class:active={activeTab === 'styles'} data-scope=\"primary\" data-tab=\"styles\">\r\n\t\t\t\t\t<SettingButton key={SETTINGS.CSS_VARIABLES} bind:data=\"{settings[SETTINGS.CSS_VARIABLES]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.VAULT_STYLES} bind:data=\"{settings[SETTINGS.VAULT_STYLES]}\"/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"tab flex\" class:active={activeTab === 'system'} data-scope=\"primary\" data-tab=\"system\">\r\n\t\t\t\t\t<SettingButton data={{\r\n            name: \"ITEM-PILES.Settings.Reset.Title\",\r\n            hint: \"ITEM-PILES.Settings.Reset.Hint\",\r\n            label: \"ITEM-PILES.Settings.Reset.Label\",\r\n            icon: \"fas fa-undo\",\r\n            hideResetButton: true\r\n          }} callback={async () => {\r\n            await resetSettings()\r\n            getSettings();\r\n          }}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ACTOR_CLASS_TYPE} bind:data=\"{settings[SETTINGS.ACTOR_CLASS_TYPE]}\"\r\n\t\t\t\t\t\t\t\t\t options={game.system.template.Actor.types}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_QUANTITY_ATTRIBUTE} bind:data=\"{settings[SETTINGS.ITEM_QUANTITY_ATTRIBUTE]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_PRICE_ATTRIBUTE} bind:data=\"{settings[SETTINGS.ITEM_PRICE_ATTRIBUTE]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.CURRENCIES} bind:data=\"{settings[SETTINGS.CURRENCIES]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.SECONDARY_CURRENCIES} bind:data=\"{settings[SETTINGS.SECONDARY_CURRENCIES]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.CURRENCY_DECIMAL_DIGITS} bind:data=\"{settings[SETTINGS.CURRENCY_DECIMAL_DIGITS]}\"\r\n\t\t\t\t\t\t\t\t\t disabled=\"{settings[SETTINGS.CURRENCIES].value.length !== 1}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.ITEM_FILTERS} bind:data=\"{settings[SETTINGS.ITEM_FILTERS]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.ITEM_SIMILARITIES} bind:data=\"{settings[SETTINGS.ITEM_SIMILARITIES]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.UNSTACKABLE_ITEM_TYPES} bind:data=\"{settings[SETTINGS.UNSTACKABLE_ITEM_TYPES]}\"/>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t</section>\r\n\r\n\t\t<footer>\r\n\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"ITEM-PILES.Applications.Settings.Submit\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .link-text {\r\n    color: var(--color-text-hyperlink);\r\n  }\r\n\r\n  .donate-button {\r\n    border: 0;\r\n    border-radius: 9999px;\r\n    background-color: #00bfa5;\r\n    align-items: center;\r\n    font-family: nunito, quicksand, sans-serif;\r\n    font-size: 16px;\r\n    width: max-content;\r\n    justify-content: space-between;\r\n    padding: 5px 15px;\r\n    font-weight: 700;\r\n    cursor: pointer;\r\n    -webkit-border-radius: 100px;\r\n    display: flex;\r\n    margin: 10px auto;\r\n\r\n    img {\r\n      border: 0;\r\n      width: 39px;\r\n    }\r\n\r\n    span {\r\n      margin-left: 8px;\r\n      color: white !important;\r\n    }\r\n  }\r\n\r\n  .preset-select {\r\n    display: flex;\r\n    flex-direction: row;\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n\r\n    align-items: center;\r\n\r\n    label {\r\n      flex: 0 1 auto;\r\n      margin-right: 0.5rem;\r\n    }\r\n\r\n    select {\r\n      flex: 1;\r\n    }\r\n\r\n    button {\r\n      margin-left: 0.25rem;\r\n      flex: 0 1 auto;\r\n      width: auto;\r\n      height: 27px;\r\n      text-align: center;\r\n      line-height: normal;\r\n    }\r\n  }\r\n\r\n  .tab-body {\r\n    max-height: 729px;\r\n    min-height: 729px;\r\n    overflow-y: scroll;\r\n    padding: 5px;\r\n  }\r\n\r\n  footer {\r\n    border-top: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-top: 0.5rem;\r\n    padding-top: 0.5rem;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { getActiveApps } from '../../helpers/helpers';\r\nimport SettingsShell from './settings-shell.svelte';\r\n\r\nclass SettingsApp extends SvelteApplication {\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      id: `item-piles-application-system-settings-${randomID()}`,\r\n      title: \"Item Piles Module Configuration\",\r\n      width: 600,\r\n      svelte: {\r\n        class: SettingsShell,\r\n        target: document.body\r\n      },\r\n      zIndex: 100,\r\n      classes: [\"item-piles-app\"],\r\n    });\r\n  }\r\n\r\n  static getActiveApp() {\r\n    return getActiveApps(\"item-piles-application-system-settings\", true);\r\n  }\r\n\r\n  static async show(options = {}, dialogData = {}) {\r\n    const app = this.getActiveApp()\r\n    if (app) return app.render(false, { focus: true });\r\n    return new Promise((resolve) => {\r\n      options.resolve = resolve;\r\n      new this(options, dialogData).render(true, { focus: true });\r\n    })\r\n  }\r\n}\r\n\r\nexport default class SettingsShim extends FormApplication {\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  constructor() {\r\n    super({});\r\n    SettingsApp.show();\r\n  }\r\n\r\n  async _updateObject(event, formData) {\r\n  }\r\n\r\n  render() {\r\n    this.close();\r\n  }\r\n\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport SETTINGS from \"./constants/settings.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\nimport { SYSTEMS } from \"./systems.js\";\r\nimport SettingsShim from \"./applications/settings-app/settings-app.js\";\r\nimport { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport CustomDialog from \"./applications/components/CustomDialog.svelte\";\r\n\r\nexport function registerSettings() {\r\n\r\n  game.settings.registerMenu(CONSTANTS.MODULE_NAME, \"configure-settings\", {\r\n    name: \"ITEM-PILES.Settings.Configure.Title\",\r\n    label: \"ITEM-PILES.Settings.Configure.Label\",\r\n    hint: \"ITEM-PILES.Settings.Configure.Hint\",\r\n    icon: \"fas fa-cog\",\r\n    type: SettingsShim,\r\n    restricted: false\r\n  });\r\n\r\n  for (let [name, data] of Object.entries(SETTINGS.GET_DEFAULT())) {\r\n    game.settings.register(CONSTANTS.MODULE_NAME, name, data);\r\n  }\r\n\r\n}\r\n\r\nexport async function applyDefaultSettings() {\r\n  const settings = SETTINGS.GET_SYSTEM_DEFAULTS();\r\n  for (const [name, data] of Object.entries(settings)) {\r\n    await Helpers.setSetting(name, data.default);\r\n  }\r\n  await Helpers.setSetting(SETTINGS.SYSTEM_VERSION, SYSTEMS.DATA.VERSION);\r\n  await patchCurrencySettings();\r\n}\r\n\r\nexport async function patchCurrencySettings() {\r\n  const currencies = Helpers.getSetting(SETTINGS.CURRENCIES);\r\n  for (let currency of currencies) {\r\n    if (currency.type !== \"item\" || !currency.data.uuid || currency.data.item) continue;\r\n    const item = await fromUuid(currency.data.uuid);\r\n    if (!item) continue;\r\n    currency.data.item = item.toObject();\r\n  }\r\n  return Helpers.setSetting(SETTINGS.CURRENCIES, currencies);\r\n}\r\n\r\nexport function applySystemSpecificStyles(data = false) {\r\n  const defaultCssVariables = foundry.utils.deepClone(SETTINGS.DEFAULT_CSS_VARIABLES);\r\n  const cssVariables = data || Helpers.getSetting(SETTINGS.CSS_VARIABLES);\r\n  const mergedCssVariables = foundry.utils.mergeObject(defaultCssVariables, cssVariables)\r\n  const root = document.documentElement;\r\n  for (const [style, val] of Object.entries(mergedCssVariables)) {\r\n    if (!val) {\r\n      root.style.removeProperty(`--item-piles-${style}`)\r\n    } else {\r\n      root.style.setProperty(`--item-piles-${style}`, val);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function checkSystem() {\r\n\r\n  if (!SYSTEMS.HAS_SYSTEM_SUPPORT) {\r\n\r\n    if (Helpers.getSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN)) return;\r\n\r\n    let settingsValid = true;\r\n    for (const [name, data] of Object.entries(SETTINGS.GET_DEFAULT())) {\r\n      settingsValid = settingsValid && Helpers.getSetting(name).length !== (new data.type).length\r\n    }\r\n\r\n    if (settingsValid) return;\r\n\r\n    TJSDialog.prompt({\r\n      title: game.i18n.localize(\"ITEM-PILES.Dialogs.NoSystemFound.Title\"),\r\n      content: {\r\n        class: CustomDialog,\r\n        props: {\r\n          content: game.i18n.localize(\"ITEM-PILES.Dialogs.NoSystemFound.Content\")\r\n        }\r\n      }\r\n    });\r\n\r\n    return Helpers.setSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN, true);\r\n\r\n  }\r\n\r\n  if (Helpers.getSetting(SETTINGS.SYSTEM_FOUND) || SYSTEMS.DATA.INTEGRATION) {\r\n    const currentVersion = Helpers.getSetting(SETTINGS.SYSTEM_VERSION);\r\n    const newVersion = SYSTEMS.DATA.VERSION;\r\n    Helpers.debug(`Comparing system version - Current: ${currentVersion} - New: ${newVersion}`)\r\n    if (isNewerVersion(newVersion, currentVersion)) {\r\n      Helpers.debug(`Applying system settings for ${game.system.title}`)\r\n      await applyDefaultSettings();\r\n    }\r\n    return;\r\n  }\r\n  \r\n  await Helpers.setSetting(SETTINGS.SYSTEM_FOUND, true);\r\n\r\n  if (Helpers.getSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN)) {\r\n    Helpers.custom_notify(game.i18n.localize(\"ITEM-PILES.Notifications.SystemSupportFound\"));\r\n  }\r\n\r\n  return applyDefaultSettings();\r\n}\r\n","import { SYSTEMS } from \"../systems.js\";\r\nimport { refreshItemTypesThatCanStack } from \"../helpers/utilities.js\";\r\nimport { applySystemSpecificStyles } from \"../settings.js\";\r\n\r\nconst SETTINGS = {\r\n\r\n  // Client settings\r\n  OUTPUT_TO_CHAT: \"outputToChat\",\r\n  INVERT_SHEET_OPEN: \"invertSheetOpen\",\r\n  HIDE_ACTOR_HEADER_TEXT: \"hideActorHeaderText\",\r\n  HIDE_ACTOR_HEADER_BUTTON: \"hideActorHeaderButton\",\r\n  PRELOAD_FILES: \"preloadFiles\",\r\n  DEBUG: \"debug\",\r\n  DEBUG_HOOKS: \"debugHooks\",\r\n\r\n  // Module Settings\r\n  ENABLE_DROPPING_ITEMS: \"enableDroppingItems\",\r\n  ENABLE_TRADING: \"enableTrading\",\r\n  ENABLE_GIVING_ITEMS: \"enableGivingItems\",\r\n  SHOW_TRADE_BUTTON: \"showTradeButton\",\r\n  DELETE_EMPTY_PILES: \"deleteEmptyPiles\",\r\n  INSPECT_ITEMS_IN_TRADE: \"inspectItemsInTrade\",\r\n  POPULATION_TABLES_FOLDER: \"populationTablesFolder\",\r\n  PRICE_PRESETS: \"pricePresets\",\r\n  HIDE_TOKEN_BORDER: \"hideTokenBorder\",\r\n\r\n  // Style settings\r\n  CSS_VARIABLES: \"cssVariables\",\r\n  VAULT_STYLES: \"vaultStyles\",\r\n\r\n  // System Settings\r\n  CURRENCIES: \"currencies\",\r\n  SECONDARY_CURRENCIES: \"secondaryCurrencies\",\r\n  CURRENCY_DECIMAL_DIGITS: \"currencyDecimalDigits\",\r\n  ITEM_FILTERS: \"itemFilters\",\r\n  ACTOR_CLASS_TYPE: \"actorClassType\",\r\n  ITEM_QUANTITY_ATTRIBUTE: \"itemQuantityAttribute\",\r\n  ITEM_PRICE_ATTRIBUTE: \"itemPriceAttribute\",\r\n  QUANTITY_FOR_PRICE_ATTRIBUTE: \"quantityForPriceAttribute\",\r\n  ITEM_SIMILARITIES: \"itemSimilarities\",\r\n  UNSTACKABLE_ITEM_TYPES: \"unstackableItemTypes\",\r\n  PILE_DEFAULTS: \"pileDefaults\",\r\n  TOKEN_FLAG_DEFAULTS: \"tokenFlagDefaults\",\r\n\r\n  // Hidden settings\r\n  DEFAULT_ITEM_PILE_JOURNAL_ID: \"defaultItemPileJournalID\",\r\n  DEFAULT_ITEM_PILE_ACTOR_ID: \"defaultItemPileActorID\",\r\n  SYSTEM_FOUND: \"systemFound\",\r\n  SYSTEM_NOT_FOUND_WARNING_SHOWN: \"systemNotFoundWarningShown\",\r\n  SYSTEM_VERSION: \"systemVersion\",\r\n  CUSTOM_ITEM_CATEGORIES: \"customItemCategories\",\r\n\r\n  HIDE_TOKEN_BORDER_OPTIONS: {\r\n    EVERYONE: \"everyone\",\r\n    PLAYERS: \"players\",\r\n    SHOW: \"show\"\r\n  },\r\n\r\n  DEFAULT_CSS_VARIABLES: {\r\n    \"inactive\": \"rgba(31,143,255,1)\",\r\n    \"minor-inactive\": \"rgba(201,200,185,1)\",\r\n    \"shadow-primary\": \"rgba(255,0,0,1)\",\r\n    \"even-color\": \"rgba(240,240,223,1)\",\r\n    \"odd-color\": \"rgba(0,0,0,0)\",\r\n    \"border-dark-primary\": \"rgba(25,24,19,1)\",\r\n    \"border-light-primary\": \"rgba(181,179,164,1)\",\r\n    \"text-light-highlight\": \"rgba(240,240,224,1)\",\r\n    \"text-important\": \"rgba(255,100,0,1)\"\r\n  },\r\n\r\n  GET_DEFAULT() {\r\n    return foundry.utils.deepClone(SETTINGS.DEFAULTS())\r\n  },\r\n\r\n  GET_SYSTEM_DEFAULTS() {\r\n    return Object.fromEntries(Object.entries(SETTINGS.GET_DEFAULT()).filter(entry => {\r\n      return entry[1].system;\r\n    }));\r\n  },\r\n\r\n  DEFAULTS: () => ({\r\n\r\n    [SETTINGS.CURRENCIES]: {\r\n      name: \"ITEM-PILES.Settings.Currencies.Title\",\r\n      label: \"ITEM-PILES.Settings.Currencies.Label\",\r\n      hint: \"ITEM-PILES.Settings.Currencies.Hint\",\r\n      icon: \"fa fa-money-bill-alt\",\r\n      application: \"currencies\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.CURRENCIES,\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.SECONDARY_CURRENCIES]: {\r\n      name: \"ITEM-PILES.Settings.SecondaryCurrencies.Title\",\r\n      label: \"ITEM-PILES.Settings.SecondaryCurrencies.Label\",\r\n      hint: \"ITEM-PILES.Settings.SecondaryCurrencies.Hint\",\r\n      icon: \"fa fa-money-bill-alt\",\r\n      application: \"secondary-currencies\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.SECONDARY_CURRENCIES,\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.CURRENCY_DECIMAL_DIGITS]: {\r\n      name: \"ITEM-PILES.Settings.CurrencyDecimalDigits.Title\",\r\n      hint: \"ITEM-PILES.Settings.CurrencyDecimalDigits.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.CURRENCY_DECIMAL_DIGITS,\r\n      step: 0.00001,\r\n      min: 0,\r\n      max: 1,\r\n      type: Number\r\n    },\r\n\r\n    [SETTINGS.ITEM_FILTERS]: {\r\n      name: \"ITEM-PILES.Settings.ItemFilters.Title\",\r\n      label: \"ITEM-PILES.Settings.ItemFilters.Label\",\r\n      hint: \"ITEM-PILES.Settings.ItemFilters.Hint\",\r\n      icon: \"fa fa-filter\",\r\n      application: \"item-filters\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.ITEM_FILTERS,\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.ITEM_SIMILARITIES]: {\r\n      name: \"ITEM-PILES.Settings.ItemSimilarities.Title\",\r\n      label: \"ITEM-PILES.Settings.ItemSimilarities.Label\",\r\n      hint: \"ITEM-PILES.Settings.ItemSimilarities.Hint\",\r\n      icon: \"fa fa-equals\",\r\n      application: \"item-similarities\",\r\n      applicationOptions: {\r\n        title: \"ITEM-PILES.Applications.SimilaritiesEditor.Title\",\r\n        content: \"ITEM-PILES.Applications.SimilaritiesEditor.Explanation\",\r\n        column: \"ITEM-PILES.Applications.SimilaritiesEditor.Path\",\r\n      },\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.ITEM_SIMILARITIES,\r\n      onChange: () => {\r\n        refreshItemTypesThatCanStack();\r\n      },\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.UNSTACKABLE_ITEM_TYPES]: {\r\n      name: \"ITEM-PILES.Settings.UnstackableItemTypes.Title\",\r\n      label: \"ITEM-PILES.Settings.UnstackableItemTypes.Label\",\r\n      hint: \"ITEM-PILES.Settings.UnstackableItemTypes.Hint\",\r\n      icon: \"fa fa-equals\",\r\n      application: \"unstackable-item-types\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.UNSTACKABLE_ITEM_TYPES,\r\n      onChange: () => {\r\n        refreshItemTypesThatCanStack();\r\n      },\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.CSS_VARIABLES]: {\r\n      name: \"ITEM-PILES.Settings.CssVariables.Title\",\r\n      label: \"ITEM-PILES.Settings.CssVariables.Label\",\r\n      hint: \"ITEM-PILES.Settings.CssVariables.Hint\",\r\n      icon: \"fa-solid fa-wand-magic-sparkles\",\r\n      application: \"styles\",\r\n      applicationOptions: {\r\n        readOnly: true,\r\n        variables: true\r\n      },\r\n      scope: \"world\",\r\n      config: false,\r\n      default: SYSTEMS.DATA.CSS_VARIABLES,\r\n      mergedDefaults: SETTINGS.DEFAULT_CSS_VARIABLES,\r\n      onchange: (data) => {\r\n        applySystemSpecificStyles(data);\r\n      },\r\n      type: Object\r\n    },\r\n\r\n    [SETTINGS.VAULT_STYLES]: {\r\n      name: \"ITEM-PILES.Settings.VaultStyles.Title\",\r\n      label: \"ITEM-PILES.Settings.VaultStyles.Label\",\r\n      hint: \"ITEM-PILES.Settings.VaultStyles.Hint\",\r\n      icon: \"fa-solid fa-wand-magic-sparkles\",\r\n      application: \"vault-styles\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: SYSTEMS.DATA.VAULT_STYLES,\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.ACTOR_CLASS_TYPE]: {\r\n      name: \"ITEM-PILES.Settings.ActorClass.Title\",\r\n      hint: \"ITEM-PILES.Settings.ActorClass.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.ACTOR_CLASS_TYPE,\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.ITEM_QUANTITY_ATTRIBUTE]: {\r\n      name: \"ITEM-PILES.Settings.Quantity.Title\",\r\n      hint: \"ITEM-PILES.Settings.Quantity.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.ITEM_QUANTITY_ATTRIBUTE,\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.ITEM_PRICE_ATTRIBUTE]: {\r\n      name: \"ITEM-PILES.Settings.Price.Title\",\r\n      hint: \"ITEM-PILES.Settings.Price.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.ITEM_PRICE_ATTRIBUTE,\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.QUANTITY_FOR_PRICE_ATTRIBUTE]: {\r\n      name: \"ITEM-PILES.Settings.QuantityForPrice.Title\",\r\n      hint: \"ITEM-PILES.Settings.QuantityForPrice.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.QUANTITY_FOR_PRICE_ATTRIBUTE,\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.PILE_DEFAULTS]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.PILE_DEFAULTS,\r\n      type: Object\r\n    },\r\n\r\n    [SETTINGS.TOKEN_FLAG_DEFAULTS]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      system: true,\r\n      default: SYSTEMS.DATA.TOKEN_FLAG_DEFAULTS,\r\n      type: Object\r\n    },\r\n\r\n    [SETTINGS.CUSTOM_ITEM_CATEGORIES]: {\r\n      name: \"ITEM-PILES.Settings.CustomItemCategories.Title\",\r\n      label: \"ITEM-PILES.Settings.CustomItemCategories.Label\",\r\n      hint: \"ITEM-PILES.Settings.CustomItemCategories.Hint\",\r\n      application: \"item-categories\",\r\n      applicationOptions: {\r\n        title: \"ITEM-PILES.Applications.CustomItemCategoriesEditor.Title\",\r\n        content: \"ITEM-PILES.Applications.CustomItemCategoriesEditor.Explanation\",\r\n        column: \"ITEM-PILES.Applications.CustomItemCategoriesEditor.Category\",\r\n      },\r\n      scope: \"world\",\r\n      config: false,\r\n      default: [],\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.SYSTEM_VERSION]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      default: \"0.0.0\",\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      default: \"\",\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.DEFAULT_ITEM_PILE_JOURNAL_ID]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      default: \"\",\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.SYSTEM_FOUND]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN]: {\r\n      scope: \"world\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.OUTPUT_TO_CHAT]: {\r\n      name: \"ITEM-PILES.Settings.OutputToChat.Title\",\r\n      hint: \"ITEM-PILES.Settings.OutputToChat.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: 1,\r\n      choices: [\r\n        \"ITEM-PILES.Settings.OutputToChat.Off\",\r\n        \"ITEM-PILES.Settings.OutputToChat.Public\",\r\n        \"ITEM-PILES.Settings.OutputToChat.SelfGM\",\r\n        \"ITEM-PILES.Settings.OutputToChat.Blind\",\r\n      ],\r\n      type: Number\r\n    },\r\n\r\n    [SETTINGS.INSPECT_ITEMS_IN_TRADE]: {\r\n      name: \"ITEM-PILES.Settings.InspectItemsTrade.Title\",\r\n      hint: \"ITEM-PILES.Settings.InspectItemsTrade.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: true,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.POPULATION_TABLES_FOLDER]: {\r\n      name: \"ITEM-PILES.Settings.PopulationTablesFolder.Title\",\r\n      hint: \"ITEM-PILES.Settings.PopulationTablesFolder.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: \"root\",\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.DELETE_EMPTY_PILES]: {\r\n      name: \"ITEM-PILES.Settings.DeleteEmptyPiles.Title\",\r\n      hint: \"ITEM-PILES.Settings.DeleteEmptyPiles.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.ENABLE_DROPPING_ITEMS]: {\r\n      name: \"ITEM-PILES.Settings.EnableDroppingItems.Title\",\r\n      hint: \"ITEM-PILES.Settings.EnableDroppingItems.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: true,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.ENABLE_TRADING]: {\r\n      name: \"ITEM-PILES.Settings.EnableTrading.Title\",\r\n      hint: \"ITEM-PILES.Settings.EnableTrading.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: true,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.ENABLE_GIVING_ITEMS]: {\r\n      name: \"ITEM-PILES.Settings.EnableGivingItems.Title\",\r\n      hint: \"ITEM-PILES.Settings.EnableGivingItems.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: true,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.SHOW_TRADE_BUTTON]: {\r\n      name: \"ITEM-PILES.Settings.ShowTradeButton.Title\",\r\n      hint: \"ITEM-PILES.Settings.ShowTradeButton.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: true,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.PRICE_PRESETS]: {\r\n      name: \"ITEM-PILES.Settings.PricePresets.Title\",\r\n      label: \"ITEM-PILES.Settings.PricePresets.Label\",\r\n      hint: \"ITEM-PILES.Settings.PricePresets.Hint\",\r\n      scope: \"world\",\r\n      icon: \"fa fa-tags\",\r\n      application: \"price-presets\",\r\n      config: false,\r\n      default: [],\r\n      type: Array\r\n    },\r\n\r\n    [SETTINGS.HIDE_TOKEN_BORDER]: {\r\n      name: \"ITEM-PILES.Settings.HideTokenBorder.Title\",\r\n      label: \"ITEM-PILES.Settings.HideTokenBorder.Label\",\r\n      hint: \"ITEM-PILES.Settings.HideTokenBorder.Hint\",\r\n      scope: \"world\",\r\n      config: false,\r\n      default: SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.EVERYONE,\r\n      choices: {\r\n        [SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.EVERYONE]: \"ITEM-PILES.Settings.HideTokenBorder.HideEveryone\",\r\n        [SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.PLAYERS]: \"ITEM-PILES.Settings.HideTokenBorder.HidePlayers\",\r\n        [SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.SHOW]: \"ITEM-PILES.Settings.HideTokenBorder.Show\"\r\n      },\r\n      type: String\r\n    },\r\n\r\n    [SETTINGS.INVERT_SHEET_OPEN]: {\r\n      name: \"ITEM-PILES.Settings.InvertSheetOpen.Title\",\r\n      hint: \"ITEM-PILES.Settings.InvertSheetOpen.Hint\",\r\n      scope: \"client\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.HIDE_ACTOR_HEADER_TEXT]: {\r\n      name: \"ITEM-PILES.Settings.HideHeaderButtonText.Title\",\r\n      hint: \"ITEM-PILES.Settings.HideHeaderButtonText.Hint\",\r\n      scope: \"client\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.HIDE_ACTOR_HEADER_BUTTON]: {\r\n      name: \"ITEM-PILES.Settings.HideHeaderButton.Title\",\r\n      hint: \"ITEM-PILES.Settings.HideHeaderButton.Hint\",\r\n      scope: \"client\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.PRELOAD_FILES]: {\r\n      name: \"ITEM-PILES.Settings.PreloadFiles.Title\",\r\n      hint: \"ITEM-PILES.Settings.PreloadFiles.Hint\",\r\n      scope: \"client\",\r\n      config: false,\r\n      default: true,\r\n      type: Boolean\r\n    },\r\n\r\n    [SETTINGS.DEBUG]: {\r\n      name: \"ITEM-PILES.Settings.Debug.Title\",\r\n      hint: \"ITEM-PILES.Settings.Debug.Hint\",\r\n      scope: \"client\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n\r\n    [SETTINGS.DEBUG_HOOKS]: {\r\n      name: \"ITEM-PILES.Settings.DebugHooks.Title\",\r\n      hint: \"ITEM-PILES.Settings.DebugHooks.Hint\",\r\n      scope: \"client\",\r\n      config: false,\r\n      default: false,\r\n      type: Boolean\r\n    },\r\n\r\n  })\r\n}\r\n\r\nexport default SETTINGS;\r\n","import * as Helpers from \"./helpers.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport { getItemFlagData } from \"./pile-utilities.js\";\r\nimport { deletedActorCache } from \"./caches.js\";\r\n\r\nexport function getActor(target) {\r\n  if (target instanceof Actor) return target;\r\n  let targetDoc = target;\r\n  if (stringIsUuid(target)) {\r\n    targetDoc = fromUuidSync(target);\r\n    if (!targetDoc && deletedActorCache.has(target)) {\r\n      return deletedActorCache.get(target);\r\n    }\r\n  }\r\n  targetDoc = getDocument(targetDoc);\r\n  return targetDoc?.character ?? targetDoc?.actor ?? targetDoc;\r\n}\r\n\r\n/**\r\n * @param documentUuid\r\n * @returns {PlaceableObject|foundry.abstract.Document}\r\n */\r\nexport function getToken(documentUuid) {\r\n  const document = fromUuidSync(documentUuid);\r\n  return document instanceof TokenDocument ? document.object : document;\r\n}\r\n\r\nexport function getDocument(target) {\r\n  if (stringIsUuid(target)) {\r\n    target = fromUuidSync(target);\r\n  }\r\n  return target?.document ?? target;\r\n}\r\n\r\nexport function stringIsUuid(inId) {\r\n  return typeof inId === \"string\"\r\n    && (inId.match(/\\./g) || []).length\r\n    && !inId.endsWith(\".\");\r\n}\r\n\r\nexport function getUuid(target) {\r\n  if (stringIsUuid(target)) return target;\r\n  const document = getDocument(target);\r\n  return document?.uuid ?? false;\r\n}\r\n\r\n/**\r\n * Find and retrieves an item in a list of items\r\n *\r\n * @param {Array<Item|Object>} items\r\n * @param {Item|Object} findItem\r\n * @param {boolean/object} actorFlagData\r\n * @param {boolean} ignoreVault\r\n * @returns {*}\r\n */\r\nexport function findSimilarItem(items, findItem, actorFlagData = false, ignoreVault = false) {\r\n\r\n  const itemSimilarities = game.itempiles.API.ITEM_SIMILARITIES;\r\n\r\n  let findItemData = findItem instanceof Item ? findItem.toObject() : findItem;\r\n  findItemData = findItemData?.item ?? findItemData;\r\n  const findItemId = findItemData?._id;\r\n\r\n  let hasUniqueKey = false;\r\n  for (let prop of CONSTANTS.ITEM_FORCED_UNIQUE_KEYS) {\r\n    if (getProperty(findItemData, prop)) {\r\n      hasUniqueKey = true;\r\n      break;\r\n    }\r\n  }\r\n\r\n  const actorIsVault = actorFlagData ? actorFlagData?.enabled && actorFlagData?.type === CONSTANTS.PILE_TYPES.VAULT : false;\r\n\r\n  const filteredItems = items\r\n    .filter(item => {\r\n      for (let prop of CONSTANTS.ITEM_FORCED_UNIQUE_KEYS) {\r\n        if (getProperty(item?.item ?? item, prop)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    })\r\n    .filter(item => {\r\n      const itemId = item instanceof Item ? item.id : item?.item?._id ?? item?._id ?? item?.id;\r\n      if (itemId && findItemId && itemId === findItemId) {\r\n        return true;\r\n      }\r\n\r\n      if (!itemSimilarities.some(path => hasProperty(findItem, path))) {\r\n        return false;\r\n      }\r\n\r\n      if (hasUniqueKey) {\r\n        return false;\r\n      }\r\n\r\n      let itemData = item instanceof Item ? item.toObject() : item;\r\n      itemData = itemData?.item ?? itemData;\r\n      if (areItemsDifferent(itemData, findItemData)) {\r\n        return false;\r\n      }\r\n\r\n      return itemSimilarities.length > 0;\r\n    })\r\n\r\n  let sortedItems = filteredItems;\r\n  if (actorIsVault && !ignoreVault) {\r\n\r\n    let distanceItems = filteredItems.map(item => {\r\n      const itemX = getProperty(item, CONSTANTS.FLAGS.ITEM + \".x\") ?? Infinity;\r\n      const itemY = getProperty(item, CONSTANTS.FLAGS.ITEM + \".y\") ?? Infinity;\r\n      const findX = getProperty(findItem, CONSTANTS.FLAGS.ITEM + \".x\") ?? Infinity;\r\n      const findY = getProperty(findItem, CONSTANTS.FLAGS.ITEM + \".y\") ?? Infinity;\r\n      const distance = new Ray({ x: itemX, y: itemY }, { x: findX, y: findY }).distance;\r\n      return { distance, item };\r\n    });\r\n\r\n    distanceItems.sort((a, b) => a.distance - b.distance);\r\n    distanceItems = distanceItems.filter(item => {\r\n      return item.distance === 0 && {\r\n        \"default\": actorFlagData?.canStackItems ?? true,\r\n        \"yes\": true,\r\n        \"no\": false\r\n      }[getItemFlagData(item)?.canStack ?? \"default\"];\r\n    }).map(item => item.item);\r\n\r\n    sortedItems = distanceItems;\r\n\r\n  }\r\n\r\n  return sortedItems?.[0] ?? false;\r\n\r\n}\r\n\r\nexport function areItemsDifferent(itemA, itemB) {\r\n  const itemSimilarities = game.itempiles.API.ITEM_SIMILARITIES;\r\n  for (const path of itemSimilarities) {\r\n    if (getProperty(itemA, path) !== getProperty(itemB, path) || (!hasProperty(itemA, path) ^ !hasProperty(itemB, path))) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function setSimilarityProperties(obj, item) {\r\n  const itemData = item instanceof Item ? item.toObject() : item;\r\n  setProperty(obj, \"_id\", itemData._id);\r\n  game.itempiles.API.ITEM_SIMILARITIES.forEach(prop => {\r\n    setProperty(obj, prop, getProperty(itemData, prop));\r\n  })\r\n  return obj;\r\n}\r\n\r\nlet itemTypesWithQuantities = false;\r\n\r\nexport function refreshItemTypesThatCanStack() {\r\n  itemTypesWithQuantities = false;\r\n  getItemTypesThatCanStack();\r\n}\r\n\r\nexport function getItemTypesThatCanStack() {\r\n  if (!itemTypesWithQuantities) {\r\n    const unstackableItemTypes = Helpers.getSetting(SETTINGS.UNSTACKABLE_ITEM_TYPES);\r\n    itemTypesWithQuantities = new Set(game.system.template.Item.types.filter(type => {\r\n      const itemTemplate = {\r\n        system: foundry.utils.deepClone(game.system.template.Item[type])\r\n      };\r\n      if (itemTemplate.system?.templates?.length) {\r\n        const templates = foundry.utils.duplicate(itemTemplate.system.templates);\r\n        for (let template of templates) {\r\n          itemTemplate.system = foundry.utils.mergeObject(\r\n            itemTemplate.system,\r\n            foundry.utils.duplicate(game.system.template.Item.templates[template])\r\n          );\r\n        }\r\n      }\r\n      return hasItemQuantity(itemTemplate);\r\n    })).filter(type => !unstackableItemTypes.includes(type));\r\n  }\r\n  return itemTypesWithQuantities;\r\n}\r\n\r\n/**\r\n * Returns a given item's quantity\r\n *\r\n * @param {Item/Object} item\r\n * @returns {number}\r\n */\r\nexport function getItemQuantity(item) {\r\n  const itemData = item instanceof Item ? item.toObject() : item;\r\n  return Number(getProperty(itemData, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE) ?? 0);\r\n}\r\n\r\n\r\n/**\r\n * Returns whether an item has the quantity property\r\n *\r\n * @param {Item/Object} item\r\n * @returns {number}\r\n */\r\nexport function hasItemQuantity(item) {\r\n  const itemData = item instanceof Item ? item.toObject() : item;\r\n  return hasProperty(itemData, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE);\r\n}\r\n\r\n/**\r\n * Returns a given item's quantity\r\n *\r\n * @param {Object} itemData\r\n * @param {Number} quantity\r\n * @param {Boolean} requiresExistingQuantity\r\n * @returns {Object}\r\n */\r\nexport function setItemQuantity(itemData, quantity, requiresExistingQuantity = false) {\r\n  if (!requiresExistingQuantity || getItemTypesThatCanStack().has(itemData.type)) {\r\n    setProperty(itemData, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE, quantity)\r\n  }\r\n  return itemData;\r\n}\r\n\r\n\r\nexport function getItemCost(item) {\r\n  const itemData = item instanceof Item ? item.toObject() : item;\r\n  return getProperty(itemData, game.itempiles.API.ITEM_PRICE_ATTRIBUTE) ?? 0;\r\n}\r\n\r\n/**\r\n * Retrieves all visible tokens on a given location\r\n *\r\n * @param position\r\n * @returns {Array<Token>}\r\n */\r\nexport function getTokensAtLocation(position) {\r\n  const tokens = [...canvas.tokens.placeables].filter(token => token?.mesh?.visible);\r\n  return tokens.filter(token => {\r\n    return position.x >= token.x && position.x < (token.x + (token.document.width * canvas.grid.size))\r\n      && position.y >= token.y && position.y < (token.y + (token.document.height * canvas.grid.size));\r\n  });\r\n}\r\n\r\nexport function distance_between_rect(p1, p2) {\r\n\r\n  const x1 = p1.x;\r\n  const y1 = p1.y;\r\n  const x1b = p1.x + p1.w;\r\n  const y1b = p1.y + p1.h;\r\n\r\n  const x2 = p2.x;\r\n  const y2 = p2.y;\r\n  const x2b = p2.x + p2.w;\r\n  const y2b = p2.y + p2.h;\r\n\r\n  const left = x2b < x1;\r\n  const right = x1b < x2;\r\n  const bottom = y2b < y1;\r\n  const top = y1b < y2;\r\n\r\n  if (top && left) {\r\n    return distance_between({ x: x1, y: y1b }, { x: x2b, y: y2 });\r\n  } else if (left && bottom) {\r\n    return distance_between({ x: x1, y: y1 }, { x: x2b, y: y2b });\r\n  } else if (bottom && right) {\r\n    return distance_between({ x: x1b, y: y1 }, { x: x2, y: y2b });\r\n  } else if (right && top) {\r\n    return distance_between({ x: x1b, y: y1b }, { x: x2, y: y2 });\r\n  } else if (left) {\r\n    return x1 - x2b;\r\n  } else if (right) {\r\n    return x2 - x1b;\r\n  } else if (bottom) {\r\n    return y1 - y2b;\r\n  } else if (top) {\r\n    return y2 - y1b;\r\n  }\r\n\r\n  return 0;\r\n\r\n}\r\n\r\nexport function distance_between(a, b) {\r\n  return new Ray(a, b).distance;\r\n}\r\n\r\nexport function grids_between_tokens(a, b) {\r\n  return Math.floor(distance_between_rect(a, b) / canvas.grid.size) + 1\r\n}\r\n\r\nexport function tokens_close_enough(a, b, maxDistance) {\r\n  const distance = grids_between_tokens(a, b);\r\n  return maxDistance >= distance;\r\n}\r\n\r\nexport function refreshAppsWithDocument(doc, callback) {\r\n  const apps = Object.values(ui.windows).filter(app => app.id.endsWith(doc.id));\r\n  for (const app of apps) {\r\n    if (app[callback]) {\r\n      app[callback]();\r\n    }\r\n  }\r\n}\r\n\r\nexport async function runMacro(macroId, macroData) {\r\n\r\n  // Credit to Otigon, Zhell, Gazkhan and MrVauxs for the code in this section\r\n  let macro;\r\n  if (macroId.startsWith(\"Compendium\")) {\r\n    let packArray = macroId.split(\".\");\r\n    let compendium = game.packs.get(`${packArray[1]}.${packArray[2]}`);\r\n    if (!compendium) {\r\n      throw Helpers.custom_error(`Compendium ${packArray[1]}.${packArray[2]} was not found`);\r\n    }\r\n    let findMacro = (await compendium.getDocuments()).find(m => m.name === packArray[3] || m.id === packArray[3])\r\n    if (!findMacro) {\r\n      throw Helpers.custom_error(`The \"${packArray[3]}\" macro was not found in Compendium ${packArray[1]}.${packArray[2]}`);\r\n    }\r\n    macro = new Macro(findMacro?.toObject());\r\n    macro.ownership.default = CONST.DOCUMENT_PERMISSION_LEVELS.OWNER;\r\n  } else {\r\n    macro = game.macros.getName(macroId);\r\n    if (!macro) {\r\n      throw Helpers.custom_error(`Could not find macro with name \"${macroId}\"`);\r\n    }\r\n  }\r\n\r\n  let result = false;\r\n  try {\r\n    result = await macro.execute(macroData);\r\n  } catch (err) {\r\n    Helpers.custom_warning(`Error when executing macro ${macroId}!\\n${err}`, true);\r\n  }\r\n\r\n  return result;\r\n\r\n}\r\n\r\nexport function getOwnedCharacters(user = false) {\r\n  user = user || game.user;\r\n  return game.actors.filter(actor => {\r\n      return actor.ownership?.[user.id] === CONST.DOCUMENT_PERMISSION_LEVELS.OWNER\r\n        && actor.prototypeToken.actorLink;\r\n    })\r\n    .sort((a, b) => {\r\n      return b._stats.modifiedTime - a._stats.modifiedTime;\r\n    });\r\n}\r\n\r\nexport function getUserCharacter(user = false) {\r\n  user = user || game.user;\r\n  return user.character\r\n    || (user.isGM ? false : (getOwnedCharacters(user)?.[0] ?? false));\r\n}\r\n\r\nexport async function createFoldersFromNames(folders, type = \"Actor\") {\r\n  let lastFolder = false;\r\n  for (const folder of folders) {\r\n    let actualFolder = game.folders.getName(folder);\r\n    if (!actualFolder) {\r\n      const folderData = { name: folder, type, sorting: 'a' };\r\n      if (lastFolder) {\r\n        folderData.parent = lastFolder.id;\r\n      }\r\n      actualFolder = await Folder.create(folderData);\r\n    }\r\n    lastFolder = actualFolder;\r\n  }\r\n\r\n  if (lastFolder) {\r\n    return lastFolder;\r\n  }\r\n}\r\n\r\n\r\nexport function getSourceActorFromDropData(dropData) {\r\n  if (dropData.uuid) {\r\n    const doc = fromUuidSync(dropData.uuid);\r\n    return doc instanceof Actor ? doc : doc.parent;\r\n  } else if (dropData.tokenId) {\r\n    if (dropData.sceneId) {\r\n      const uuid = `Scene.${dropData.sceneId}.Token.${dropData.tokenId}`;\r\n      return fromUuidSync(uuid)?.actor;\r\n    }\r\n    return canvas.tokens.get(dropData.tokenId).actor;\r\n  } else if (dropData.actorId) {\r\n    return game.actors.get(dropData.actorId);\r\n  }\r\n  return false;\r\n}\r\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { getSourceActorFromDropData } from \"../../helpers/utilities.js\";\r\n\r\n  export let actor;\r\n  export let actors;\r\n\r\n  let changingActor = false;\r\n  let multipleActors = actors.length > 1 && !game.user.isGM;\r\n  let hasUnlinkedTokenOwnership = actors.filter(a => !a.prototypeToken.actorLink).length > 0;\r\n\r\n  function setActorFromSelectedToken() {\r\n    if (canvas.tokens.controlled.length === 0) return;\r\n    actor = canvas.tokens.controlled[0].actor;\r\n  }\r\n\r\n  async function dropData(event) {\r\n    counter = 0;\r\n    let data;\r\n    try {\r\n      data = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n    if (data.type !== \"Actor\") return;\r\n    actor = getSourceActorFromDropData(data);\r\n  }\r\n\r\n  let counter = 0;\r\n\r\n  function dragEnter() {\r\n    counter++;\r\n  }\r\n\r\n  function dragLeave() {\r\n    counter--;\r\n  }\r\n\r\n  function preventDefault(event) {\r\n    event.preventDefault();\r\n  }\r\n\r\n</script>\r\n\r\n\r\n<div class=\"item-piles-bottom-divider\">\r\n  <div class=\"form-group item-piles-actor-container align-center-row\"\r\n       class:item-piles-box-highlight={counter > 0}\r\n       on:dragstart={preventDefault}\r\n       on:drop={dropData}\r\n       on:dragover={preventDefault}\r\n       on:dragenter={dragEnter}\r\n       on:dragleave={dragLeave}\r\n  >\r\n    {#if actor}\r\n      <div class=\"align-center-col\">\r\n        {#if actor.img}\r\n          <img src=\"{actor.img}\">\r\n        {/if}\r\n\r\n        {#if multipleActors}\r\n          <span>\r\n            {#if changingActor}\r\n              <select class=\"item-piles-change-actor-select\"\r\n                      bind:value={actor}\r\n                      on:change={() => { changingActor = false }}\r\n              >\r\n                {#each actors as potentialActor (potentialActor.id)}\r\n                <option value=\"{potentialActor}\">{ potentialActor.name }</option>\r\n                {/each}\r\n              </select>\r\n            {:else}\r\n              <a class='item-piles-change-actor item-piles-highlight'\r\n                 on:click={() => { changingActor = true }}>{ actor.name }</a>\r\n            {/if}\r\n          </span>\r\n        {:else}\r\n          <span>{ actor.name }</span>\r\n        {/if}\r\n\r\n      </div>\r\n    {:else}\r\n      <p>{ localize(\"ITEM-PILES.Trade.Prompt.DropActor\") }</p>\r\n    {/if}\r\n  </div>\r\n  {#if hasUnlinkedTokenOwnership}\r\n    <div class=\"item-piles-flexrow\">\r\n      <button type=\"button\" on:click={setActorFromSelectedToken}>\r\n        <i class=\"fas fa-expand\"></i>\r\n        {localize(\"ITEM-PILES.Trade.Prompt.PickToken\")}\r\n      </button>\r\n    </div>\r\n  {/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-actor-container {\r\n    margin-bottom: 1rem;\r\n    min-height: 150px;\r\n    padding: 0.5rem;\r\n    text-align: center;\r\n    border: 1px solid gray;\r\n    border-radius: 5px;\r\n\r\n    img {\r\n      border: 0;\r\n      max-height: 80px;\r\n      max-width: 80px;\r\n      width: auto;\r\n      height: auto;\r\n      border-radius: 5px;\r\n      filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    span {\r\n      font-size: 1.5rem;\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-box-highlight {\r\n    box-shadow: 0 0 20px inset var(--color-shadow-highlight, #ff6400);\r\n  }\r\n\r\n  .item-piles-change-actor-select {\r\n    height: 23px;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { getContext } from \"svelte\";\r\n  import ActorDropSelect from \"./ActorDropSelect.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  export let isPrivate;\r\n  export let users;\r\n  export let user;\r\n  export let actors;\r\n  export let actor;\r\n\r\n  let isGM = game.user.isGM;\r\n\r\n  users = game.users.filter(user => user.active && user !== game.user);\r\n  user = user || users?.[0] || false;\r\n  actors = actors || game.actors.filter(actor => actor.isOwner);\r\n  actor = actor || game.user.character || (!isGM ? actors?.[0] : false);\r\n\r\n  function requestTrade() {\r\n    application.options.resolve({\r\n      user,\r\n      actor,\r\n      isPrivate\r\n    });\r\n    application.close();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<div class=\"item-piles-flexcol trade-dialog\">\r\n\r\n\t\t<p><i class=\"item-piles-header-icon fas fa-handshake\"></i></p>\r\n\r\n\t\t<p style=\"margin-bottom: 1rem\">\r\n\t\t\t<strong style=\"font-size:1.2rem;\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Trade.Prompt.Title\")}\r\n\t\t\t</strong>\r\n\t\t</p>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.User\")}</p>\r\n\r\n\t\t<div class=\"item-piles-bottom-divider\">\r\n\t\t\t<div class=\"form-group align-center-row\">\r\n\t\t\t\t<select name=\"user\" style=\"width: 66%;\" bind:value={user}>\r\n\t\t\t\t\t{#each users as potentialUser (potentialUser.id)}\r\n\t\t\t\t\t\t<option value=\"{potentialUser}\">{potentialUser.name}</option>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"item-piles-bottom-divider\">\r\n\t\t\t<div class=\"form-group align-center-col\">\r\n\t\t\t\t<label class=\"align-center-row\">\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"private\" bind:checked={isPrivate}>\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Trade.Private\")}</span>\r\n\t\t\t\t</label>\r\n\t\t\t\t<small>{localize(\"ITEM-PILES.Trade.PrivateExplanation\")}</small>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if actor}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.PickedActor\")}</p>\r\n\t\t{:else}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.PickActor\")}</p>\r\n\t\t{/if}\r\n\r\n\t\t<ActorDropSelect bind:actor={actor} {actors}/>\r\n\r\n\t\t<footer class=\"sheet-footer item-piles-flexrow\">\r\n\t\t\t<button type=\"button\" on:click|once={requestTrade} disabled={!actor}>\r\n\t\t\t\t<i class=\"fas fa-check\"></i> {localize(\"ITEM-PILES.Trade.Prompt.Label\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</div>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .trade-dialog {\r\n    text-align: center;\r\n  }\r\n\r\n  .item-piles-header-icon {\r\n    font-size: 3rem;\r\n  }\r\n\r\n  .item-piles-actor-container {\r\n    margin-bottom: 0.25rem;\r\n    min-height: 150px;\r\n    padding: 0.5rem;\r\n    text-align: center;\r\n    border: 1px solid gray;\r\n    border-radius: 5px;\r\n\r\n    img {\r\n      border: 0;\r\n      max-height: 80px;\r\n      max-width: 80px;\r\n      width: auto;\r\n      height: auto;\r\n      border-radius: 5px;\r\n      filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    span {\r\n      font-size: 1.5rem;\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-box-highlight {\r\n    box-shadow: 0 0 20px inset var(--color-shadow-highlight, #ff6400);\r\n  }\r\n\r\n  .item-piles-change-actor-select {\r\n    height: 23px;\r\n  }\r\n\r\n  button:disabled {\r\n    opacity: 0.75;\r\n  }\r\n\r\n</style>\r\n","import { writable } from '../store/index.mjs';\nimport { now, loop, assign } from '../internal/index.mjs';\nimport { linear } from '../easing/index.mjs';\n\nfunction is_date(obj) {\n    return Object.prototype.toString.call(obj) === '[object Date]';\n}\n\nfunction tick_spring(ctx, last_value, current_value, target_value) {\n    if (typeof current_value === 'number' || is_date(current_value)) {\n        // @ts-ignore\n        const delta = target_value - current_value;\n        // @ts-ignore\n        const velocity = (current_value - last_value) / (ctx.dt || 1 / 60); // guard div by 0\n        const spring = ctx.opts.stiffness * delta;\n        const damper = ctx.opts.damping * velocity;\n        const acceleration = (spring - damper) * ctx.inv_mass;\n        const d = (velocity + acceleration) * ctx.dt;\n        if (Math.abs(d) < ctx.opts.precision && Math.abs(delta) < ctx.opts.precision) {\n            return target_value; // settled\n        }\n        else {\n            ctx.settled = false; // signal loop to keep ticking\n            // @ts-ignore\n            return is_date(current_value) ?\n                new Date(current_value.getTime() + d) : current_value + d;\n        }\n    }\n    else if (Array.isArray(current_value)) {\n        // @ts-ignore\n        return current_value.map((_, i) => tick_spring(ctx, last_value[i], current_value[i], target_value[i]));\n    }\n    else if (typeof current_value === 'object') {\n        const next_value = {};\n        for (const k in current_value) {\n            // @ts-ignore\n            next_value[k] = tick_spring(ctx, last_value[k], current_value[k], target_value[k]);\n        }\n        // @ts-ignore\n        return next_value;\n    }\n    else {\n        throw new Error(`Cannot spring ${typeof current_value} values`);\n    }\n}\nfunction spring(value, opts = {}) {\n    const store = writable(value);\n    const { stiffness = 0.15, damping = 0.8, precision = 0.01 } = opts;\n    let last_time;\n    let task;\n    let current_token;\n    let last_value = value;\n    let target_value = value;\n    let inv_mass = 1;\n    let inv_mass_recovery_rate = 0;\n    let cancel_task = false;\n    function set(new_value, opts = {}) {\n        target_value = new_value;\n        const token = current_token = {};\n        if (value == null || opts.hard || (spring.stiffness >= 1 && spring.damping >= 1)) {\n            cancel_task = true; // cancel any running animation\n            last_time = now();\n            last_value = new_value;\n            store.set(value = target_value);\n            return Promise.resolve();\n        }\n        else if (opts.soft) {\n            const rate = opts.soft === true ? .5 : +opts.soft;\n            inv_mass_recovery_rate = 1 / (rate * 60);\n            inv_mass = 0; // infinite mass, unaffected by spring forces\n        }\n        if (!task) {\n            last_time = now();\n            cancel_task = false;\n            task = loop(now => {\n                if (cancel_task) {\n                    cancel_task = false;\n                    task = null;\n                    return false;\n                }\n                inv_mass = Math.min(inv_mass + inv_mass_recovery_rate, 1);\n                const ctx = {\n                    inv_mass,\n                    opts: spring,\n                    settled: true,\n                    dt: (now - last_time) * 60 / 1000\n                };\n                const next_value = tick_spring(ctx, last_value, value, target_value);\n                last_time = now;\n                last_value = value;\n                store.set(value = next_value);\n                if (ctx.settled) {\n                    task = null;\n                }\n                return !ctx.settled;\n            });\n        }\n        return new Promise(fulfil => {\n            task.promise.then(() => {\n                if (token === current_token)\n                    fulfil();\n            });\n        });\n    }\n    const spring = {\n        set,\n        update: (fn, opts) => set(fn(target_value, value), opts),\n        subscribe: store.subscribe,\n        stiffness,\n        damping,\n        precision\n    };\n    return spring;\n}\n\nfunction get_interpolator(a, b) {\n    if (a === b || a !== a)\n        return () => a;\n    const type = typeof a;\n    if (type !== typeof b || Array.isArray(a) !== Array.isArray(b)) {\n        throw new Error('Cannot interpolate values of different type');\n    }\n    if (Array.isArray(a)) {\n        const arr = b.map((bi, i) => {\n            return get_interpolator(a[i], bi);\n        });\n        return t => arr.map(fn => fn(t));\n    }\n    if (type === 'object') {\n        if (!a || !b)\n            throw new Error('Object cannot be null');\n        if (is_date(a) && is_date(b)) {\n            a = a.getTime();\n            b = b.getTime();\n            const delta = b - a;\n            return t => new Date(a + t * delta);\n        }\n        const keys = Object.keys(b);\n        const interpolators = {};\n        keys.forEach(key => {\n            interpolators[key] = get_interpolator(a[key], b[key]);\n        });\n        return t => {\n            const result = {};\n            keys.forEach(key => {\n                result[key] = interpolators[key](t);\n            });\n            return result;\n        };\n    }\n    if (type === 'number') {\n        const delta = b - a;\n        return t => a + t * delta;\n    }\n    throw new Error(`Cannot interpolate ${type} values`);\n}\nfunction tweened(value, defaults = {}) {\n    const store = writable(value);\n    let task;\n    let target_value = value;\n    function set(new_value, opts) {\n        if (value == null) {\n            store.set(value = new_value);\n            return Promise.resolve();\n        }\n        target_value = new_value;\n        let previous_task = task;\n        let started = false;\n        let { delay = 0, duration = 400, easing = linear, interpolate = get_interpolator } = assign(assign({}, defaults), opts);\n        if (duration === 0) {\n            if (previous_task) {\n                previous_task.abort();\n                previous_task = null;\n            }\n            store.set(value = target_value);\n            return Promise.resolve();\n        }\n        const start = now() + delay;\n        let fn;\n        task = loop(now => {\n            if (now < start)\n                return true;\n            if (!started) {\n                fn = interpolate(value, new_value);\n                if (typeof duration === 'function')\n                    duration = duration(value, new_value);\n                started = true;\n            }\n            if (previous_task) {\n                previous_task.abort();\n                previous_task = null;\n            }\n            const elapsed = now - start;\n            if (elapsed > duration) {\n                store.set(value = new_value);\n                return false;\n            }\n            // @ts-ignore\n            store.set(value = fn(easing(elapsed / duration)));\n            return true;\n        });\n        return task.promise;\n    }\n    return {\n        set,\n        update: (fn, opts) => set(fn(target_value, value), opts),\n        subscribe: store.subscribe\n    };\n}\n\nexport { spring, tweened };\n","<script>\r\n\r\n  import { localize } from '@typhonjs-fvtt/runtime/svelte/helper';\r\n  import { getContext } from \"svelte\";\r\n  import { tweened } from 'svelte/motion';\r\n  import { linear } from 'svelte/easing';\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import ActorDropSelect from \"./ActorDropSelect.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n\r\n  const { application } = getContext('#external');\r\n\r\n  export let elementRoot;\r\n  export let isPrivate;\r\n  export let tradingActor;\r\n  export let tradingUser;\r\n  export let users;\r\n  export let user;\r\n  export let actors;\r\n  export let actor;\r\n\r\n  let isGM = game.user.isGM;\r\n\r\n  users = game.users.filter(user => user.active && user !== game.user);\r\n  user = user || users?.[0] || false;\r\n  actors = actors || game.actors.filter(actor => actor.isOwner);\r\n  actor = actor || game.user.character || (!isGM ? actors?.[0] : false);\r\n\r\n  let done = false;\r\n\r\n  async function accept() {\r\n    application.options.resolve(actor);\r\n    close();\r\n  }\r\n\r\n  async function decline() {\r\n    application.options.resolve(false);\r\n    close();\r\n  }\r\n\r\n  async function mute() {\r\n    application.options.resolve(\"mute\");\r\n    close();\r\n  }\r\n\r\n  async function disconnected() {\r\n    Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Disconnected\"), true)\r\n    close();\r\n  }\r\n\r\n  const progress = tweened(0, {\r\n    duration: 20000,\r\n    easing: linear\r\n  });\r\n\r\n  $: actualProgress = $progress * 100;\r\n\r\n  let timeout = setTimeout(() => {\r\n    if (done) return;\r\n    progress.set(1);\r\n    timeout = setTimeout(() => {\r\n      if (done) return;\r\n      Helpers.custom_warning(localize(\"ITEM-PILES.Trade.AutoDecline\"), true)\r\n      decline();\r\n    }, 21000)\r\n  }, 14000);\r\n\r\n  const connection = setInterval(() => {\r\n    const user = game.users.get(tradingUser.id)\r\n    if (!user.active) {\r\n      disconnected();\r\n    }\r\n  }, 100);\r\n\r\n  function close() {\r\n    clearInterval(connection);\r\n    clearTimeout(timeout);\r\n    done = true;\r\n    application.close();\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n  <div class=\"item-piles-flexcol trade-dialog\">\r\n\r\n    <p><i class=\"item-piles-header-icon fas fa-handshake\"></i></p>\r\n\r\n    <p style=\"margin-bottom: 1rem\">\r\n      <strong style=\"font-size:1.2rem;\">\r\n        { localize(\"ITEM-PILES.Trade.Request.Title\") }\r\n      </strong>\r\n    </p>\r\n\r\n    <div class=\"item-piles-bottom-divider\">\r\n      {#if isPrivate}\r\n        <p>{@html localize(\"ITEM-PILES.Trade.Request.PrivateContent\", {\r\n          trading_user_name: tradingUser.name,\r\n          trading_actor_name: tradingActor.name\r\n        })}</p>\r\n      {:else}\r\n        <p>{localize(\"ITEM-PILES.Trade.Request.Content\", {\r\n          trading_user_name: tradingUser.name,\r\n          trading_actor_name: tradingActor.name\r\n        })}</p>\r\n      {/if}\r\n      <p>{localize(\"ITEM-PILES.Trade.Request.AcceptQuery\")}</p>\r\n    </div>\r\n\r\n    {#if actor}\r\n      <p>{localize(\"ITEM-PILES.Trade.Prompt.PickedActor\")}</p>\r\n    {:else}\r\n      <p>{localize(\"ITEM-PILES.Trade.Prompt.PickActor\")}</p>\r\n    {/if}\r\n\r\n    <ActorDropSelect bind:actor={actor} {actors}/>\r\n\r\n    <footer class=\"sheet-footer item-piles-flexrow\">\r\n      <button type=\"button\" on:click|once={accept} disabled={!actor}>\r\n        <i class=\"fas fa-check\"></i> {localize(\"ITEM-PILES.Trade.Accept\")}\r\n      </button>\r\n      <button type=\"button\" on:click|once={decline}>\r\n        <i class=\"fas fa-times\"></i> {localize(\"ITEM-PILES.Trade.Decline\")}\r\n      </button>\r\n      <button type=\"button\" on:click|once={mute}>\r\n        <i class=\"fas fa-comment-slash\"></i> {localize(\"ITEM-PILES.Trade.Mute\")}\r\n      </button>\r\n    </footer>\r\n\r\n    <div class=\"item-piles-progress\" style=\"flex: 1 0 auto;\" class:active={actualProgress > 0}>\r\n      <span class=\"progress-bar\" style=\"width: {actualProgress}%;\"></span>\r\n    </div>\r\n  </div>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .trade-dialog {\r\n    text-align: center;\r\n  }\r\n\r\n  .item-piles-header-icon {\r\n    font-size: 3rem;\r\n  }\r\n\r\n  .item-piles-progress {\r\n    width: calc(100% - 4px);\r\n    background: #e1e4e8;\r\n    border-radius: 3px;\r\n    overflow: hidden;\r\n    margin: 0.25rem 2px 0 2px;\r\n    height: 6px;\r\n    display: none;\r\n\r\n    &.active {\r\n      display: block;\r\n    }\r\n\r\n    .progress-bar {\r\n      display: block;\r\n      height: 100%;\r\n      background-color: rgba(255, 20, 20, 0.65);\r\n    }\r\n  }\r\n\r\n  button:disabled {\r\n    opacity: 0.75;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport TradeDialogPrompt from './trade-dialog-prompt.svelte';\r\nimport TradeDialogRequest from './trade-dialog-request.svelte';\r\n\r\nexport class TradePromptDialog extends SvelteApplication {\r\n\r\n  constructor(tradeOptions, options = {}) {\r\n    super({\r\n      svelte: {\r\n        class: TradeDialogPrompt,\r\n        target: document.body,\r\n        props: {\r\n          ...tradeOptions\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    });\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n      width: 400,\r\n      height: \"auto\",\r\n      classes: [\"dialog\", \"item-piles-app\"],\r\n    })\r\n  }\r\n\r\n  static show(tradeOptions, options = {}, dialogData = {}) {\r\n    return new Promise(resolve => {\r\n      options.resolve = resolve;\r\n      new this(tradeOptions, options, dialogData).render(true);\r\n    })\r\n  }\r\n}\r\n\r\nexport class TradeRequestDialog extends SvelteApplication {\r\n\r\n  constructor(tradeOptions, options = {}) {\r\n\r\n    super({\r\n      svelte: {\r\n        class: TradeDialogRequest,\r\n        target: document.body,\r\n        props: {\r\n          ...tradeOptions\r\n        }\r\n      },\r\n      close: () => this.options.resolve?.(null),\r\n      ...options\r\n    });\r\n    this.tradeId = tradeOptions.tradeId;\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      title: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n      width: 400,\r\n      height: \"auto\",\r\n      classes: [\"dialog\"],\r\n    })\r\n  }\r\n\r\n  static show(tradeOptions, options = {}) {\r\n    return new Promise(resolve => {\r\n      options.resolve = resolve;\r\n      new this(tradeOptions, options).render(true);\r\n    })\r\n  }\r\n\r\n  static cancel(tradeId) {\r\n    for (const app of Object.values(ui.windows)) {\r\n      if (app instanceof this && app.tradeId === tradeId) {\r\n        app.options.resolve({ type: \"cancelled\" });\r\n        return app.close();\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n}\r\n","import { writable, get } from 'svelte/store';\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\nimport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\r\nexport default class TradeStore {\r\n\r\n  constructor(instigator, leftTrader, rightTrader, publicTradeId, privateTradeId = false, isPrivate = false) {\r\n\r\n    this.instigator = instigator;\r\n    this.publicTradeId = publicTradeId;\r\n    this.privateTradeId = privateTradeId;\r\n    this.isPrivate = isPrivate;\r\n\r\n    this.leftTraderUser = leftTrader.user;\r\n    this.leftTraderActor = leftTrader.actor;\r\n    this.leftTraderItems = writable(leftTrader.items ?? []);\r\n    this.leftTraderCurrencies = writable(leftTrader.currencies ?? []);\r\n    this.leftTraderItemCurrencies = writable(leftTrader.itemCurrencies ?? []);\r\n    this.leftTraderAccepted = writable(leftTrader.accepted ?? false);\r\n\r\n    this.rightTraderUser = rightTrader.user;\r\n    this.rightTraderActor = rightTrader.actor;\r\n    this.rightTraderItems = writable(rightTrader.items ?? []);\r\n    this.rightTraderCurrencies = writable(rightTrader.currencies ?? []);\r\n    this.rightTraderItemCurrencies = writable(rightTrader.itemCurrencies ?? []);\r\n    this.rightTraderAccepted = writable(rightTrader?.accepted ?? false);\r\n\r\n  }\r\n\r\n  static import(tradeData) {\r\n\r\n    const leftTrader = {\r\n      user: game.users.get(tradeData.leftTraderData.user),\r\n      actor: fromUuidSync(tradeData.leftTraderData.actor),\r\n      items: tradeData.leftTraderData.items,\r\n      currencies: tradeData.leftTraderData.currencies,\r\n      itemCurrencies: tradeData.leftTraderData.itemCurrencies,\r\n      accepted: tradeData.leftTraderData.accepted\r\n    };\r\n\r\n    const rightTrader = {\r\n      user: game.users.get(tradeData.rightTraderData.user),\r\n      actor: fromUuidSync(tradeData.rightTraderData.actor),\r\n      items: tradeData.rightTraderData.items,\r\n      currencies: tradeData.rightTraderData.currencies,\r\n      itemCurrencies: tradeData.rightTraderData.itemCurrencies,\r\n      accepted: tradeData.rightTraderData.accepted\r\n    };\r\n\r\n    return new this(tradeData.instigator, leftTrader, rightTrader, tradeData.publicTradeId);\r\n  }\r\n\r\n  export() {\r\n    return {\r\n      instigator: this.instigator,\r\n      publicTradeId: this.publicTradeId,\r\n      leftTraderData: {\r\n        user: this.leftTraderUser.id,\r\n        actor: Utilities.getUuid(this.leftTraderActor),\r\n        items: get(this.leftTraderItems),\r\n        currencies: get(this.leftTraderCurrencies),\r\n        itemCurrencies: get(this.leftTraderItemCurrencies),\r\n        accepted: get(this.leftTraderAccepted)\r\n      },\r\n      rightTraderData: {\r\n        user: this.rightTraderUser.id,\r\n        actor: Utilities.getUuid(this.rightTraderActor),\r\n        items: get(this.rightTraderItems),\r\n        currencies: get(this.rightTraderCurrencies),\r\n        itemCurrencies: get(this.rightTraderItemCurrencies),\r\n        accepted: get(this.rightTraderAccepted)\r\n      }\r\n    }\r\n  }\r\n\r\n  getTradeData() {\r\n    return {\r\n      sourceActor: this.leftTraderActor,\r\n      targetActor: this.rightTraderActor,\r\n      remove: {\r\n        items: get(this.leftTraderItems).concat(get(this.leftTraderItemCurrencies)),\r\n        attributes: get(this.leftTraderCurrencies)\r\n      }, add: {\r\n        items: get(this.rightTraderItems).concat(get(this.rightTraderItemCurrencies)),\r\n        attributes: get(this.rightTraderCurrencies)\r\n      }\r\n    };\r\n  }\r\n\r\n  get isUserParticipant() {\r\n    return game.user === this.leftTraderUser || game.user === this.rightTraderUser;\r\n  }\r\n\r\n  getExistingCurrencies() {\r\n    return [...get(this.leftTraderCurrencies), ...get(this.leftTraderItemCurrencies)]\r\n  }\r\n\r\n  get tradeIsAccepted() {\r\n    return get(this.leftTraderAccepted) && get(this.rightTraderAccepted);\r\n  }\r\n\r\n  async toggleAccepted() {\r\n    this.leftTraderAccepted.set(!get(this.leftTraderAccepted));\r\n  }\r\n\r\n  updateItems(userId, inItems) {\r\n    if (userId === game.user.id) return;\r\n    this.leftTraderAccepted.set(false);\r\n    this.rightTraderAccepted.set(false);\r\n    if (userId === this.leftTraderUser.id) {\r\n      this.leftTraderItems.set(inItems)\r\n    }\r\n    if (userId === this.rightTraderUser.id) {\r\n      this.rightTraderItems.set(inItems)\r\n    }\r\n  }\r\n\r\n  updateItemCurrencies(userId, itemCurrencies) {\r\n    if (userId === game.user.id) return;\r\n    this.leftTraderAccepted.set(false);\r\n    this.rightTraderAccepted.set(false);\r\n    if (userId === this.leftTraderUser.id) {\r\n      this.leftTraderItemCurrencies.set(itemCurrencies)\r\n    }\r\n    if (userId === this.rightTraderUser.id) {\r\n      this.rightTraderItemCurrencies.set(itemCurrencies)\r\n    }\r\n  }\r\n\r\n  updateCurrencies(userId, inCurrencies) {\r\n    if (userId === game.user.id) return;\r\n    this.leftTraderAccepted.set(false);\r\n    this.rightTraderAccepted.set(false);\r\n    if (userId === this.leftTraderUser.id) {\r\n      this.leftTraderCurrencies.set(inCurrencies)\r\n    }\r\n    if (userId === this.rightTraderUser.id) {\r\n      this.rightTraderCurrencies.set(inCurrencies)\r\n    }\r\n  }\r\n\r\n  updateAcceptedState(userId, state) {\r\n    if (userId === game.user.id) return;\r\n    if (userId === this.leftTraderUser.id) {\r\n      this.leftTraderAccepted.set(state);\r\n    }\r\n    if (userId === this.rightTraderUser.id) {\r\n      this.rightTraderAccepted.set(state);\r\n    }\r\n  }\r\n\r\n  addItem(newItem, { quantity = false, currency = false } = {}) {\r\n\r\n    const items = !currency\r\n      ? get(this.leftTraderItems)\r\n      : get(this.leftTraderItemCurrencies);\r\n\r\n    const item = Utilities.findSimilarItem(items, newItem)\r\n\r\n    const maxQuantity = game.user.isGM ? Infinity : Utilities.getItemQuantity(newItem);\r\n\r\n    if (item && PileUtilities.canItemStack(item)) {\r\n      if (item.quantity >= maxQuantity) return;\r\n      item.quantity = Math.min(quantity ? quantity : item.quantity + 1, maxQuantity);\r\n      item.newQuantity = item.quantity;\r\n      item.maxQuantity = maxQuantity;\r\n    } else if (!item) {\r\n      items.push({\r\n        id: newItem._id ?? newItem.id,\r\n        uuid: newItem.uuid,\r\n        name: newItem.name,\r\n        img: newItem?.img ?? \"\",\r\n        type: newItem?.type,\r\n        currency: currency,\r\n        quantity: quantity ? quantity : 1,\r\n        newQuantity: quantity ? quantity : 1,\r\n        maxQuantity: maxQuantity,\r\n        data: newItem instanceof Item ? newItem.toObject() : newItem\r\n      })\r\n    }\r\n\r\n    if (!currency) {\r\n      this.leftTraderItems.set(items);\r\n    } else {\r\n      this.leftTraderItemCurrencies.set(items);\r\n    }\r\n\r\n  }\r\n\r\n  addAttribute(newCurrency) {\r\n\r\n    const currencies = get(this.leftTraderCurrencies);\r\n\r\n    const existingCurrency = currencies.find(currency => currency.path === newCurrency.path);\r\n\r\n    if (existingCurrency) {\r\n      existingCurrency.quantity = newCurrency.quantity;\r\n      existingCurrency.newQuantity = newCurrency.quantity;\r\n    } else {\r\n      currencies.push(newCurrency);\r\n    }\r\n\r\n    currencies.sort((a, b) => a.index - b.index);\r\n\r\n    this.leftTraderCurrencies.set(currencies);\r\n\r\n  }\r\n\r\n  removeEntry(entry) {\r\n\r\n    if (entry.id) {\r\n\r\n      if (!entry.currency) {\r\n\r\n        const items = get(this.leftTraderItems)\r\n          .filter(item => item.id !== entry.id);\r\n\r\n        this.leftTraderItems.set(items);\r\n\r\n      } else {\r\n\r\n        const items = get(this.leftTraderItemCurrencies)\r\n          .filter(item => item.id !== entry.id);\r\n\r\n        this.leftTraderItemCurrencies.set(items);\r\n\r\n      }\r\n\r\n    } else {\r\n\r\n      const items = get(this.leftTraderCurrencies)\r\n        .filter(currency => currency.path !== entry.path);\r\n\r\n      this.leftTraderCurrencies.set(items);\r\n\r\n    }\r\n\r\n  }\r\n\r\n}\r\n","<script>\r\n\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import SETTINGS from \"../../constants/settings.js\";\r\n\r\n  export let store;\r\n  export let data;\r\n  export let editable = true;\r\n\r\n  const canPreview = data.id && (Helpers.getSetting(SETTINGS.INSPECT_ITEMS_IN_TRADE) || editable)\r\n\r\n  function previewItem() {\r\n    if (!canPreview || !data.id) return;\r\n    const item = store.leftTraderActor.items.get(data.id) ?? store.rightTraderActor.items.get(data.id);\r\n    if (!item) return;\r\n    if (game.user.isGM || item.ownership[game.user.id] === CONST.DOCUMENT_PERMISSION_LEVELS.OWNER) {\r\n      return item.sheet.render(true);\r\n    }\r\n    const cls = item._getSheetClass()\r\n    const sheet = new cls(item, { editable: false })\r\n    return sheet._render(true);\r\n  }\r\n\r\n  function onKeyDown(e) {\r\n    if (e.keyCode === 13) {\r\n      updateQuantity();\r\n    }\r\n  }\r\n\r\n  function updateQuantity() {\r\n    data.quantity = Math.max(0, Math.min(data.maxQuantity, data.newQuantity));\r\n    if (data.quantity === 0) {\r\n      return store.removeEntry(data);\r\n    }\r\n    data.newQuantity = data.quantity;\r\n    data.editing = false;\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:window on:click={() => {\r\n  if(data.editing && editable) updateQuantity();\r\n}}/>\r\n\r\n<div class=\"item-piles-flexrow item-piles-item-row item-piles-even-color\">\r\n\r\n\t{#if editable}\r\n\t\t<div style=\"flex: 0 1 auto; margin: 0 6px;\">\r\n\t\t\t<a class=\"item-piles-clickable-red\" on:click={() => { store.removeEntry(data) }}>\r\n\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<div class=\"item-piles-img-container\">\r\n\t\t<img class=\"item-piles-img\" src=\"{data.img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t<p class:item-piles-clickable-link=\"{canPreview}\" on:click={previewItem}>{data.name}</p>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if editable}\r\n\t\t<div style=\"flex: 0 1 17px; margin: 0 5px;\">\r\n\t\t\t{#if data.editing}\r\n\t\t\t\t<a class=\"item-piles-clickable-green item-piles-confirm-quantity\" on:click=\"{updateQuantity}\">\r\n\t\t\t\t\t<i class=\"fas fa-check\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<div class=\"item-piles-text-right\" class:item-piles-quantity-container={editable}\r\n\t\t\t on:click={(evt) => evt.stopPropagation()}>\r\n\t\t{#if editable}\r\n\t\t\t<div class=\"item-piles-quantity-container\">\r\n\t\t\t\t{#if data.editing}\r\n\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tbind:value={data.newQuantity}\r\n\t\t\t\t\t\t\ton:keydown={onKeyDown}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n            <span class=\"item-piles-quantity-text\"\r\n\t\t\t\t\t\t\t\t\ton:click=\"{ () => { data.editing = true } }\">\r\n              {data.quantity}\r\n            </span>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<span class=\"item-piles-text\" style=\"padding-right:0.5rem;\">{data.quantity}</span>\r\n\t\t{/if}\r\n\t</div>\r\n</div>\r\n","<script>\r\n\r\n  import { fade } from 'svelte/transition';\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import DropZone from \"../components/DropZone.svelte\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import * as Helpers from \"../../helpers/helpers.js\";\r\n  import * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n  import ItemPileSocket from \"../../socket.js\";\r\n  import TradeEntry from \"./TradeEntry.svelte\";\r\n  import DropCurrencyDialog from \"../dialogs/drop-currency-dialog/drop-currency-dialog.js\";\r\n  import * as Utilities from \"../../helpers/utilities.js\";\r\n\r\n  export let elementRoot;\r\n  export let store;\r\n\r\n  const leftItems = store.leftTraderItems;\r\n  const leftCurrencies = store.leftTraderCurrencies;\r\n  const leftItemCurrencies = store.leftTraderItemCurrencies;\r\n  const leftTraderAccepted = store.leftTraderAccepted;\r\n\r\n  const rightItems = store.rightTraderItems;\r\n  const rightCurrencies = store.rightTraderCurrencies;\r\n  const rightItemCurrencies = store.rightTraderItemCurrencies;\r\n  const rightTraderAccepted = store.rightTraderAccepted;\r\n\r\n  let isGM = game.user.isGM;\r\n  let systemHasCurrencies = game.itempiles.API.CURRENCIES.length > 0;\r\n\r\n  async function dropItem(data) {\r\n\r\n    if (data.type !== \"Item\") return;\r\n\r\n    let item = (await Item.implementation.fromDropData(data)).toObject();\r\n\r\n    data.actorId = Utilities.getSourceActorFromDropData(data)?.id;\r\n\r\n    if (!data.actorId && !game.user.isGM) {\r\n      return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.NoSourceDrop\"), true)\r\n    }\r\n\r\n    if (!game.user.isGM && data.actorId && data.actorId !== store.leftTraderActor.id) {\r\n      throw Helpers.custom_error(`You cannot drop items into the trade UI from a different actor than ${store.leftTraderActor.name}!`)\r\n    }\r\n\r\n    const validItem = await PileUtilities.checkItemType(store.rightTraderActor, item, {\r\n      errorText: \"ITEM-PILES.Errors.DisallowedItemTrade\",\r\n      warningTitle: \"ITEM-PILES.Dialogs.TypeWarning.Title\",\r\n      warningContent: \"ITEM-PILES.Dialogs.TypeWarning.TradeContent\"\r\n    });\r\n    if (!validItem) return;\r\n\r\n    const actorItemCurrencyList = PileUtilities.getCurrencyList(store.leftTraderActor).filter(entry => entry.type !== \"attribute\");\r\n    const isCurrency = !!Utilities.findSimilarItem(actorItemCurrencyList.map(item => item.data), validItem);\r\n\r\n    if (!validItem._id) {\r\n      validItem._id = item._id;\r\n    }\r\n\r\n    validItem.uuid = data.uuid;\r\n\r\n    return store.addItem(validItem, { currency: isCurrency });\r\n\r\n  }\r\n\r\n  if (store.isUserParticipant) {\r\n    const itemsUpdatedDebounce = debounce(async (items) => {\r\n      await ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_UPDATE_ITEMS, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, items);\r\n      return executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_UPDATE_ITEMS, store.publicTradeId, game.user.id, items);\r\n    }, 20)\r\n    leftItems.subscribe(itemsUpdatedDebounce)\r\n\r\n    const itemCurrenciesUpdatedDebounce = debounce(async (items) => {\r\n      await ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_UPDATE_ITEM_CURRENCIES, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, items);\r\n      return executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_UPDATE_ITEM_CURRENCIES, store.publicTradeId, game.user.id, items);\r\n    }, 20)\r\n    leftItemCurrencies.subscribe(itemCurrenciesUpdatedDebounce)\r\n\r\n    const attributesUpdatedDebounce = debounce(async (attributes) => {\r\n      await ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_UPDATE_CURRENCIES, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, attributes);\r\n      return executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_UPDATE_CURRENCIES, store.publicTradeId, game.user.id, attributes);\r\n    }, 40)\r\n    leftCurrencies.subscribe(attributesUpdatedDebounce)\r\n\r\n    const acceptedDebounce = debounce(async (acceptedState) => {\r\n      await ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_STATE, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, acceptedState);\r\n      return executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_STATE, store.publicTradeId, game.user.id, acceptedState);\r\n    }, 10)\r\n    leftTraderAccepted.subscribe(acceptedDebounce)\r\n  }\r\n\r\n  async function executeSocketAction(socketHandler, ...args) {\r\n    if (store.isPrivate) {\r\n      return ItemPileSocket.executeForUsers(socketHandler, [store.leftTraderUser.id, store.rightTraderUser.id], ...args);\r\n    }\r\n    return ItemPileSocket.executeForEveryone(socketHandler, ...args);\r\n  }\r\n\r\n  async function addCurrency(asGM = false) {\r\n\r\n    const currenciesToAdd = await DropCurrencyDialog.show(\r\n      store.leftTraderActor,\r\n      store.rightTraderActor,\r\n      {\r\n        existingCurrencies: store.getExistingCurrencies(),\r\n        title: game.i18n.localize(\"ITEM-PILES.Trade.AddCurrency.Title\"),\r\n        content: game.i18n.format(\"ITEM-PILES.Trade.AddCurrency.Content\", { trader_actor_name: store.rightTraderActor.name }),\r\n        button: game.i18n.localize(\"ITEM-PILES.Trade.AddCurrency.Label\"),\r\n        unlimitedCurrencies: asGM\r\n      }\r\n    );\r\n\r\n    if (!currenciesToAdd || (foundry.utils.isEmpty(currenciesToAdd.attributes) && !currenciesToAdd.items.length)) return;\r\n\r\n    currenciesToAdd.items.forEach(item => {\r\n      const itemData = store.leftTraderActor.items.get(item._id).toObject();\r\n      store.addItem(itemData, { quantity: item.quantity, currency: true })\r\n    });\r\n\r\n    const currencies = PileUtilities.getActorCurrencies(store.leftTraderActor, { getAll: asGM })\r\n      .filter(currency => currency.type === \"attribute\");\r\n\r\n    Object.entries(currenciesToAdd.attributes).forEach(([path, quantity]) => {\r\n      const currency = currencies.find(currency => currency.path === path);\r\n      store.addAttribute({\r\n        path: path,\r\n        quantity: quantity,\r\n        newQuantity: quantity,\r\n        name: currency.name,\r\n        img: currency.img,\r\n        maxQuantity: !game.user.isGM ? currency.quantity : Infinity,\r\n        index: currency.index\r\n      });\r\n    });\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t{#if $leftTraderAccepted && $rightTraderAccepted}\r\n\t\t<div class=\"lds-ellipsis\" transition:fade>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<DropZone callback={dropItem}>\r\n\r\n\t\t<div class=\"item-piles-flexcol\">\r\n\r\n\t\t\t<div class=\"item-piles-flexrow\">\r\n\r\n\t\t\t\t<div class=\"col item-piles-flexcol\">\r\n\r\n\t\t\t\t\t<div class=\"character-header item-piles-bottom-divider\">\r\n\t\t\t\t\t\t<img src=\"{store.leftTraderActor.img}\">\r\n\t\t\t\t\t\t<h2 class=\"character-name\">\r\n\t\t\t\t\t\t\t<div>{store.leftTraderActor.name}</div>\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass:accepted={$leftTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-check={$leftTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-times={!$leftTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass=\"fas accepted-icon\"\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\r\n\t\t\t\t\t\t<div class=\"row item-piles-items-list\">\r\n\r\n\t\t\t\t\t\t\t{#if !$leftItems.length && store.isUserParticipant}\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t\t\t\t\t<h3 class=\"item-piles-text-center\">{localize(\"ITEM-PILES.Trade.DragDrop\")}</h3>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t{#each $leftItems as item (item.id)}\r\n\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={store.isUserParticipant}/>\r\n\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if systemHasCurrencies}\r\n\r\n\t\t\t\t\t\t\t<div class=\"row item-piles-items-list item-piles-currency-list\"\r\n\t\t\t\t\t\t\t\t\t class:item-piles-top-divider={$leftCurrencies.length || $leftItemCurrencies.length}>\r\n\r\n\t\t\t\t\t\t\t\t{#if store.isUserParticipant}\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t\t\t\t\t\t\t\t{#if isGM}\r\n\t\t\t\t\t\t\t\t\t\t\t<a on:click={() => { addCurrency(true) }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t class=\"item-piles-text-right item-piles-small-text item-piles-middle item-piles-gm-add-currency\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Trade.GMAddCurrency\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t<a on:click={() => { addCurrency() }}\r\n\t\t\t\t\t\t\t\t\t\t\t class=\"item-piles-text-right item-piles-small-text item-piles-middle item-piles-add-currency\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.AddCurrency\")}\r\n\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#each $leftCurrencies as currency (currency.path)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={currency} {store} editable={store.isUserParticipant}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t\t{#each $leftItemCurrencies as item (item.path)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={store.isUserParticipant}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if store.isUserParticipant}\r\n\r\n\t\t\t\t\t\t<button type=\"button\" style=\"flex:0 1 auto; margin-top: 0.25rem;\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => { store.toggleAccepted(store.leftTraderUser.id) }}>\r\n\t\t\t\t\t\t\t{#if $leftTraderAccepted}\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t\t\t\t{localize(\"Cancel\")}\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-check\"></i>\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Trade.Accept\")}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col item-piles-flexcol\">\r\n\r\n\t\t\t\t\t<div class=\"character-header trader item-piles-bottom-divider\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass:accepted={$rightTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-check={$rightTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-times={!$rightTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass=\"fas accepted-icon\"\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<h2 class=\"character-name\">\r\n\t\t\t\t\t\t\t{store.rightTraderActor.name}\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t<img src=\"{store.rightTraderActor.img}\">\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\r\n\t\t\t\t\t\t<div class=\"row item-piles-items-list\">\r\n\r\n\t\t\t\t\t\t\t{#each $rightItems as item (item.id)}\r\n\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={false}/>\r\n\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if systemHasCurrencies}\r\n\r\n\t\t\t\t\t\t\t<div class=\"row item-piles-items-list item-piles-currency-list\"\r\n\t\t\t\t\t\t\t\t\t class:item-piles-top-divider={$rightCurrencies.length || $rightItemCurrencies.length}>\r\n\r\n\t\t\t\t\t\t\t\t{#each $rightCurrencies as currency (currency.path)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={currency} {store} editable={false}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t\t{#each $rightItemCurrencies as item (item.path)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={false}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</DropZone>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .col {\r\n    flex-direction: column;\r\n    margin: 0 5px;\r\n  }\r\n\r\n  .col:not(:last-child) {\r\n    padding-right: 10px;\r\n    border-right: 1px solid rgba(0, 0, 0, 0.35);\r\n  }\r\n\r\n  .row {\r\n    flex: 1;\r\n  }\r\n\r\n  .row:last-child {\r\n    flex: 0 1 auto;\r\n  }\r\n\r\n  .trader {\r\n\r\n  }\r\n\r\n  .lds-ellipsis {\r\n    position: absolute;\r\n    left: calc(50% - 38px);\r\n    top: calc(50% - 40px);\r\n    display: inline-block;\r\n    width: 80px;\r\n    height: 80px;\r\n  }\r\n\r\n  .lds-ellipsis div {\r\n    position: absolute;\r\n    top: 33px;\r\n    width: 13px;\r\n    height: 13px;\r\n    border-radius: 50%;\r\n    background: #435068;\r\n    animation-timing-function: cubic-bezier(0, 1, 1, 0);\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(1) {\r\n    left: 8px;\r\n    animation: lds-ellipsis1 0.6s infinite;\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(2) {\r\n    left: 8px;\r\n    animation: lds-ellipsis2 0.6s infinite;\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(3) {\r\n    left: 32px;\r\n    animation: lds-ellipsis2 0.6s infinite;\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(4) {\r\n    left: 56px;\r\n    animation: lds-ellipsis3 0.6s infinite;\r\n  }\r\n\r\n  @keyframes lds-ellipsis1 {\r\n    0% {\r\n      transform: scale(0);\r\n    }\r\n    100% {\r\n      transform: scale(1);\r\n    }\r\n  }\r\n\r\n  @keyframes lds-ellipsis3 {\r\n    0% {\r\n      transform: scale(1);\r\n    }\r\n    100% {\r\n      transform: scale(0);\r\n    }\r\n  }\r\n\r\n  @keyframes lds-ellipsis2 {\r\n    0% {\r\n      transform: translate(0, 0);\r\n    }\r\n    100% {\r\n      transform: translate(24px, 0);\r\n    }\r\n  }\r\n\r\n\r\n</style>\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport TradingAppShell from \"./trading-app-shell.svelte\";\r\nimport ItemPileSocket from \"../../socket.js\";\r\n\r\nexport default class TradingApp extends SvelteApplication {\r\n  constructor(store, options = {}, dialogData = {}) {\r\n    super({\r\n      title: game.i18n.format(\"ITEM-PILES.Trade.Between\", {\r\n        actor_1: store.leftTraderActor.name,\r\n        actor_2: store.rightTraderActor.name\r\n      }),\r\n      svelte: {\r\n        class: TradingAppShell,\r\n        target: document.body,\r\n        props: {\r\n          store\r\n        }\r\n      },\r\n      ...options\r\n    }, dialogData);\r\n    this.store = store;\r\n    this.publicTradeId = store.publicTradeId;\r\n  }\r\n\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      zIndex: 100,\r\n      classes: [\"dialog\", \"item-piles-trading-sheet\", \"item-piles\", \"item-piles-app\"],\r\n      width: 800,\r\n      height: \"auto\",\r\n      closeOnSubmit: false\r\n    });\r\n  }\r\n\r\n  async close(options = {}) {\r\n    if (!options?.callback && this.store.isUserParticipant) {\r\n      await ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TRADE_CLOSED, this.publicTradeId, game.user.id);\r\n    }\r\n    return super.close(options)\r\n  }\r\n\r\n  static getActiveApp(publicTradeId) {\r\n    for (const app of Object.values(ui.windows)) {\r\n      if (app instanceof this && app?.publicTradeId === publicTradeId) {\r\n        return app;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport CustomDialog from \"../applications/components/CustomDialog.svelte\";\r\nimport { TradePromptDialog, TradeRequestDialog } from \"../applications/trade-dialogs/trade-dialogs.js\";\r\n\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport * as Helpers from \"../helpers/helpers.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport TradeStore from \"../applications/trading-app/trade-store.js\";\r\nimport TradingApp from \"../applications/trading-app/trading-app.js\";\r\nimport Transaction from \"../helpers/transaction.js\";\r\n\r\nconst mutedUsers = new Set();\r\nconst ongoingTrades = new Map();\r\n\r\nexport default class TradeAPI {\r\n\r\n  static initialize() {\r\n    Hooks.on(\"renderPlayerList\", this._userDisconnected.bind(this));\r\n  }\r\n\r\n  static async _requestTrade(user = false) {\r\n\r\n    // Grab all the active users (not self)\r\n    const users = game.users.filter(user => user.active && user !== game.user);\r\n\r\n    // No users!\r\n    if (!users.length) {\r\n      return TJSDialog.prompt({\r\n        title: game.i18n.localize(\"ITEM-PILES.Trade.Title\"), content: {\r\n          class: CustomDialog, props: {\r\n            header: game.i18n.localize(\"ITEM-PILES.Trade.NoActiveUsers.Title\"),\r\n            content: game.i18n.localize(\"ITEM-PILES.Trade.NoActiveUsers.Content\"),\r\n            icon: \"fas fa-heart-broken\"\r\n          }\r\n        }, modal: true, draggable: false, options: {\r\n          height: \"auto\"\r\n        }\r\n      });\r\n    }\r\n\r\n    let userId;\r\n    let actor;\r\n    let isPrivate;\r\n\r\n    // Find actors you own\r\n    const actors = game.actors.filter(actor => actor.isOwner);\r\n\r\n    // If you only own one actor, and the user was already preselected (through the right click menu in the actors list)\r\n    if (actors.length === 1 && user) {\r\n      userId = user.id;\r\n      actor = actors[0];\r\n      isPrivate = false;\r\n    } else {\r\n      // If you have more than 1 owned actor, prompt to choose which one\r\n      const result = await TradePromptDialog.show({ actors, users, user });\r\n      if (!result) return;\r\n      userId = result.user.id;\r\n      actor = result.actor;\r\n      isPrivate = result.private;\r\n    }\r\n\r\n    if (!actor) return false;\r\n\r\n    actor = Utilities.getActor(actor);\r\n\r\n    const actorOwner = game.users.find(user => user.character === actor && user !== game.user);\r\n    if (actorOwner) {\r\n\r\n      const doContinue = TJSDialog.confirm({\r\n        title: game.i18n.localize(\"ITEM-PILES.Trade.Title\"), content: {\r\n          class: CustomDialog, props: {\r\n            header: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n            content: actorOwner.active ? game.i18n.format(\"ITEM-PILES.Trade.UserActiveCharacterWarning\", {\r\n              actor_name: actor.name, player_name: actorOwner.name\r\n            }) : game.i18n.format(\"ITEM-PILES.Trade.UserCharacterWarning\", {\r\n              actor_name: actor.name, player_name: actorOwner.name\r\n            }),\r\n            icon: \"fas fa-exclamation-triangle\",\r\n          }\r\n        }, modal: true, draggable: false, rejectClose: false, defaultYes: true, options: {\r\n          height: \"auto\"\r\n        }\r\n      });\r\n      if (!doContinue) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    const privateTradeId = randomID();\r\n    const publicTradeId = randomID();\r\n\r\n    // Spawn a cancel dialog\r\n    const cancelDialog = new Dialog({\r\n      title: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n      content: `<p style=\"text-align: center\">${game.i18n.format(\"ITEM-PILES.Trade.OngoingRequest.Content\", { user_name: game.users.get(userId).name })}</p>`,\r\n      buttons: {\r\n        confirm: {\r\n          icon: '<i class=\"fas fa-times\"></i>',\r\n          label: game.i18n.localize(\"ITEM-PILES.Trade.OngoingRequest.Label\"),\r\n          callback: () => {\r\n            ItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.TRADE_REQUEST_CANCELLED, userId, game.user.id, privateTradeId);\r\n          }\r\n        }\r\n      }\r\n    }, {\r\n      top: 50, width: 300\r\n    }).render(true);\r\n\r\n    // Send out the request\r\n    return ItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.TRADE_REQUEST_PROMPT, userId, game.user.id, actor.uuid, privateTradeId, publicTradeId, isPrivate)\r\n      .then(async (data) => {\r\n\r\n        if (data === \"cancelled\") return;\r\n        cancelDialog.close();\r\n\r\n        if (data === \"same-actor\") {\r\n          return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.SameActor\"), true);\r\n        }\r\n\r\n        // If they declined, show warning\r\n        if (!data || !data.fullPrivateTradeId.includes(privateTradeId)) {\r\n          return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Declined\"), true);\r\n        }\r\n\r\n        const traderActor = Utilities.getActor(data.actorUuid);\r\n\r\n        if (traderActor === actor) {\r\n          return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.SameActor\"), true);\r\n        }\r\n\r\n        const store = new TradeStore(game.user.id, {\r\n          user: game.user, actor\r\n        }, {\r\n          user: game.users.get(userId), actor: traderActor\r\n        }, data.fullPublicTradeId, data.fullPrivateTradeId, isPrivate);\r\n\r\n        const [actorSheet, tradeApp] = Helpers.getApplicationPositions(actor.sheet);\r\n\r\n        const app = new TradingApp(store, tradeApp).render(true);\r\n\r\n        ongoingTrades.set(data.fullPublicTradeId, { app, store });\r\n\r\n        actorSheet.byassItemPiles = true;\r\n        actor.sheet.render(true, actorSheet);\r\n\r\n        if (isPrivate) {\r\n          return ItemPileSocket.callHookForUsers(CONSTANTS.HOOKS.TRADE.STARTED, [game.user.id, userId], {\r\n            user: game.user.id, actor: actor.uuid\r\n          }, { user: userId, actor: data.actorUuid }, data.fullPublicTradeId, isPrivate);\r\n        }\r\n\r\n        return ItemPileSocket.callHook(CONSTANTS.HOOKS.TRADE.STARTED, {\r\n          user: game.user.id, actor: actor.uuid\r\n        }, { user: userId, actor: data.actorUuid }, data.fullPublicTradeId, isPrivate);\r\n\r\n      }).catch((err) => {\r\n        console.error(err);\r\n        // If the counterparty disconnected, show that and close dialog\r\n        Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Disconnected\"), true);\r\n        cancelDialog.close()\r\n      });\r\n\r\n  }\r\n\r\n  static async _respondPrompt(tradingUserId, tradingActorUuid, privateTradeId, publicTradeId, isPrivate) {\r\n\r\n    // If the user was previously muted, wait for a random amount of time and respond with false\r\n    if (mutedUsers.has(tradingUserId)) {\r\n      await Helpers.wait(Math.random() * 15000);\r\n      return false;\r\n    }\r\n\r\n    // Complete the private and public trade IDs\r\n    const fullPrivateTradeId = privateTradeId + randomID();\r\n    const fullPublicTradeId = publicTradeId + randomID();\r\n\r\n    const tradingUser = game.users.get(tradingUserId);\r\n    const tradingActor = Utilities.getActor(tradingActorUuid);\r\n\r\n    // Make em pick an actor (if more than one) and accept/decline/mute\r\n    const result = await TradeRequestDialog.show({ tradeId: privateTradeId, tradingUser, tradingActor, isPrivate });\r\n\r\n    if (!result) return false;\r\n\r\n    if (result === \"cancelled\") {\r\n      return \"cancelled\";\r\n    }\r\n\r\n    // If muted, add user to blacklist locally\r\n    if (result === \"mute\") {\r\n      mutedUsers.push(tradingUserId);\r\n      return false;\r\n    }\r\n\r\n    const actor = result.actor ?? result;\r\n\r\n    if (actor === tradingActor) {\r\n      Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.SameActor\"), true);\r\n      return \"same-actor\";\r\n    }\r\n\r\n    const store = new TradeStore(tradingUserId, {\r\n      user: game.user, actor\r\n    }, {\r\n      user: tradingUser, actor: tradingActor\r\n    }, fullPublicTradeId, fullPrivateTradeId, isPrivate);\r\n\r\n    const [actorSheet, tradeApp] = Helpers.getApplicationPositions(actor.sheet);\r\n\r\n    const app = new TradingApp(store, tradeApp).render(true);\r\n\r\n    ongoingTrades.set(fullPublicTradeId, { app, store });\r\n\r\n    actorSheet.byassItemPiles = true;\r\n    actor.sheet.render(true, actorSheet);\r\n\r\n    return {\r\n      fullPrivateTradeId, fullPublicTradeId, actorUuid: result.uuid\r\n    };\r\n\r\n  }\r\n\r\n  static getAppOptions(actor) {\r\n    const midPoint = (window.innerWidth / 2) - 200;\r\n    return {\r\n      actorSheet: { left: midPoint - actor.sheet.position.width - 25 }, tradeApp: { left: midPoint + 25 }\r\n    }\r\n  }\r\n\r\n  static async _tradeCancelled(userId, privateTradeId) {\r\n\r\n    TJSDialog.prompt({\r\n      title: game.i18n.localize(\"ITEM-PILES.Trade.Title\"), content: {\r\n        class: CustomDialog, props: {\r\n          header: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n          content: game.i18n.format(\"ITEM-PILES.Trade.CancelledRequest.Content\", { user_name: game.users.get(userId).name }),\r\n          icon: \"fas fa-exclamation-triangle\"\r\n        }\r\n      }, modal: true, draggable: false, options: {\r\n        height: \"auto\"\r\n      }\r\n    });\r\n\r\n    return TradeRequestDialog.cancel(privateTradeId);\r\n\r\n  }\r\n\r\n  static async _requestTradeData({ tradeId, tradeUser } = {}) {\r\n\r\n    const ongoingTrade = this._getOngoingTrade(tradeId);\r\n    if (ongoingTrade) {\r\n      return ongoingTrade.store.export();\r\n    }\r\n\r\n    const user = game.users.get(tradeUser);\r\n    if (!user?.active) {\r\n      return false;\r\n    }\r\n\r\n    const ongoingTradeData = await ItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.REQUEST_TRADE_DATA, tradeUser, tradeId, game.user.id);\r\n    if (!ongoingTradeData) {\r\n      return false;\r\n    }\r\n\r\n    return ongoingTradeData;\r\n\r\n  }\r\n\r\n  static async _spectateTrade({ tradeId, tradeUser } = {}) {\r\n\r\n    const existingApp = TradingApp.getActiveApp(tradeId);\r\n    if (existingApp) {\r\n      return existingApp.render(false, { focus: true });\r\n    }\r\n\r\n    const ongoingTradeData = await this._requestTradeData({ tradeId, tradeUser });\r\n    if (!ongoingTradeData) {\r\n      if (Helpers.isGMConnected()) {\r\n        ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n      }\r\n      return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Over\"), true);\r\n    }\r\n\r\n    const store = TradeStore.import(ongoingTradeData);\r\n\r\n    const app = new TradingApp(store).render(true);\r\n\r\n    ongoingTrades.set(store.publicTradeId, { app, store });\r\n\r\n  }\r\n\r\n  static async _respondActiveTradeData(tradeId, requesterId) {\r\n    const trade = this._getOngoingTrade(tradeId, requesterId);\r\n    if (!trade) return;\r\n    return trade.store.export();\r\n  }\r\n\r\n  static _getOngoingTrade(tradeId, requesterId = game.user.id) {\r\n    if (!ongoingTrades.has(tradeId)) return false;\r\n    const trade = ongoingTrades.get(tradeId);\r\n    if (!trade.store.isPrivate) {\r\n      return trade;\r\n    }\r\n    if (trade.store.leftTraderUser.id !== requesterId && trade.store.rightTraderUser.id !== requesterId) return false;\r\n    return trade;\r\n  }\r\n\r\n  static async _updateItems(tradeId, userId, items) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n    trade.store.updateItems(userId, items);\r\n  }\r\n\r\n  static async _updateItemCurrencies(tradeId, userId, items) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n    trade.store.updateItemCurrencies(userId, items);\r\n  }\r\n\r\n  static async _updateCurrencies(tradeId, userId, currencies) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n    trade.store.updateCurrencies(userId, currencies);\r\n  }\r\n\r\n  static async _updateAcceptedState(tradeId, userId, status) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n    trade.store.updateAcceptedState(userId, status);\r\n    if (userId === game.user.id && (trade.store.leftTraderUser.id === game.user.id || trade.store.rightTraderUser.id === game.user.id)) {\r\n      if (trade.store.tradeIsAccepted) {\r\n        setTimeout(async () => {\r\n          if (trade.store.tradeIsAccepted) {\r\n            ItemPileSocket.executeForUsers(\r\n              ItemPileSocket.HANDLERS.EXECUTE_TRADE,\r\n              [trade.store.leftTraderUser.id, trade.store.rightTraderUser.id],\r\n              trade.store.publicTradeId,\r\n              trade.store.privateTradeId,\r\n              userId);\r\n          }\r\n        }, 2000);\r\n      }\r\n    }\r\n  }\r\n\r\n  static async _userDisconnected() {\r\n    const tradesToDelete = [];\r\n    const activeUsers = game.users.filter(user => user.active);\r\n    for (let [tradeId, trade] of ongoingTrades) {\r\n      const foundLeft = activeUsers.find(u => u === trade.store.leftTraderUser);\r\n      const foundRight = activeUsers.find(u => u === trade.store.rightTraderUser);\r\n      if (foundLeft && foundRight) continue;\r\n      tradesToDelete.push(tradeId);\r\n      Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Disconnected\"), true);\r\n      await trade.app.close({ callback: true });\r\n      if (foundLeft === game.user || foundRight === game.user) {\r\n        if (Helpers.isGMConnected()) {\r\n          await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n        }\r\n      }\r\n    }\r\n    tradesToDelete.forEach(tradeId => ongoingTrades.delete(tradeId));\r\n  }\r\n\r\n  static async _tradeClosed(tradeId, closeUserId) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n\r\n    if (trade.store.leftTraderUser.id === game.user.id || trade.store.rightTraderUser.id === game.user.id) {\r\n\r\n      if (closeUserId === trade.store.rightTraderUser.id) {\r\n\r\n        TJSDialog.prompt({\r\n          title: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"), content: {\r\n            class: CustomDialog, props: {\r\n              header: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"),\r\n              content: game.i18n.format(\"ITEM-PILES.Trade.Closed.Them\", {\r\n                user_name: trade.store.rightTraderUser.name\r\n              }),\r\n              icon: \"fas fa-exclamation-triangle\",\r\n            }\r\n          }, modal: false, draggable: true, options: {\r\n            height: \"auto\"\r\n          }\r\n        });\r\n\r\n      } else {\r\n\r\n        if (trade.store.isPrivate) {\r\n          const otherUserId = trade.store.leftTraderUser.id === game.user.id ? trade.store.rightTraderUser.id : trade.store.leftTraderUser.id;\r\n          ItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.TRADE_CLOSED, otherUserId, tradeId, game.user.id);\r\n        } else {\r\n          ItemPileSocket.executeForOthers(ItemPileSocket.HANDLERS.TRADE_CLOSED, tradeId, game.user.id);\r\n        }\r\n\r\n        TJSDialog.prompt({\r\n          title: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"), content: {\r\n            class: CustomDialog, props: {\r\n              header: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"),\r\n              content: game.i18n.format(\"ITEM-PILES.Trade.Closed.You\"),\r\n              icon: \"fas fa-exclamation-triangle\",\r\n            }\r\n          }, modal: false, draggable: true, options: {\r\n            height: \"auto\"\r\n          }\r\n        });\r\n\r\n        if (Helpers.isGMConnected()) {\r\n          await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n        }\r\n      }\r\n\r\n    } else {\r\n\r\n      Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Closed.Someone\"), true);\r\n\r\n    }\r\n\r\n    trade.app.close({ callback: true });\r\n    ongoingTrades.delete(tradeId);\r\n  }\r\n\r\n  static async _executeTrade(tradeId, privateId, userId) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n    if (trade.store.privateTradeId !== privateId) return;\r\n    const updates = trade.store.getTradeData();\r\n\r\n    const itemsToAdd = [];\r\n    for (const entry of updates.add.items) {\r\n      let item = updates.targetActor.items.get(entry.id);\r\n      if (!item) {\r\n        item = await fromUuid(entry.uuid);\r\n        if (!item) continue;\r\n      }\r\n      const itemData = item.toObject();\r\n      itemsToAdd.push(Utilities.setItemQuantity(itemData, entry.quantity, true));\r\n    }\r\n\r\n    const itemsToRemove = []\r\n    for (const entry of updates.remove.items) {\r\n      const item = updates.sourceActor.items.get(entry.id);\r\n      if (!item) continue;\r\n      const itemData = item.toObject();\r\n      itemsToRemove.push(Utilities.setItemQuantity(itemData, entry.quantity, true));\r\n    }\r\n\r\n    const transaction = new Transaction(updates.sourceActor);\r\n    await transaction.appendItemChanges(itemsToAdd);\r\n    await transaction.appendItemChanges(itemsToRemove, { remove: true });\r\n    await transaction.appendActorChanges(updates.add.attributes);\r\n    await transaction.appendActorChanges(updates.remove.attributes, { remove: true });\r\n    await transaction.commit();\r\n\r\n    if (trade.store.isPrivate) {\r\n      Hooks.callAll(CONSTANTS.HOOKS.TRADE.COMPLETE, trade.store.instigator, data[0], data[1], tradeId);\r\n      trade.app.close({ callback: true });\r\n      ongoingTrades.delete(tradeId);\r\n    } else if (userId === game.user.id) {\r\n      if (Helpers.isGMConnected()) {\r\n        await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n      }\r\n      return ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TRADE_COMPLETED, tradeId, updates);\r\n    }\r\n  }\r\n\r\n  static async _tradeCompleted(tradeId) {\r\n    const trade = this._getOngoingTrade(tradeId);\r\n    if (!trade) return;\r\n    const data = trade.store.export();\r\n    if (data.instigator === game.user.id) {\r\n      if (trade.store.isPrivate) {\r\n        Hooks.callAll(CONSTANTS.HOOKS.TRADE.COMPLETE, data.instigator, data.leftTraderData, data.rightTraderData, tradeId);\r\n      } else {\r\n        ItemPileSocket.executeForEveryone(\r\n          ItemPileSocket.HANDLERS.CALL_HOOK,\r\n          CONSTANTS.HOOKS.TRADE.COMPLETE,\r\n          trade.store.instigator,\r\n          data.leftTraderData,\r\n          data.rightTraderData,\r\n          tradeId,\r\n          trade.store.isPrivate\r\n        )\r\n      }\r\n    }\r\n    trade.app.close({ callback: true });\r\n    ongoingTrades.delete(tradeId);\r\n  }\r\n\r\n}\r\n\r\n","import SETTINGS from \"../constants/settings.js\";\r\nimport * as Helpers from \"../helpers/helpers.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport TradeAPI from \"./trade-api.js\";\r\nimport * as Util from \"util\";\r\n\r\nexport default class ChatAPI {\r\n\r\n  static initialize() {\r\n\r\n    Helpers.hooks.on(\"preCreateChatMessage\", this._preCreateChatMessage.bind(this));\r\n    Helpers.hooks.on(\"renderChatMessage\", this._renderChatMessage.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.ITEM.TRANSFER, this._outputTransferItem.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.ATTRIBUTE.TRANSFER, this._outputTransferCurrency.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.TRANSFER_EVERYTHING, this._outputTransferEverything.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.PILE.SPLIT_INVENTORY, this._outputSplitItemPileInventory.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.TRADE.STARTED, this._outputTradeStarted.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.TRADE.COMPLETE, this._outputTradeComplete.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.ITEM.TRADE, this._outputMerchantTradeComplete.bind(this));\r\n    Helpers.hooks.on(CONSTANTS.HOOKS.ITEM.GIVE, this._outputGiveItem.bind(this));\r\n\r\n    $(document).on(\"click\", \".item-piles-chat-card .item-piles-collapsible\", async function () {\r\n      if ($(this).attr(\"open\")) return;\r\n      await Helpers.wait(25);\r\n      $(this).parent()[0].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\r\n    });\r\n  }\r\n\r\n  static _preCreateChatMessage(chatMessage) {\r\n\r\n    if (!Helpers.getSetting(SETTINGS.ENABLE_TRADING)) return;\r\n\r\n    const content = chatMessage.content.toLowerCase();\r\n\r\n    if (!(content.startsWith(\"!itempiles\") || content.startsWith(\"!ip\"))) return;\r\n\r\n    const args = content.split(\" \").slice(1);\r\n\r\n    if (args[0] === \"trade\") {\r\n      setTimeout(() => {\r\n        game.itempiles.API.requestTrade();\r\n      });\r\n    }\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  static _renderChatMessage(app, html) {\r\n    html.find(\".item-piles-specate-trade\").click(function () {\r\n      game.itempiles.API.spectateTrade($(this).data());\r\n    });\r\n  }\r\n\r\n  static _disableTradingButton(publicTradeId) {\r\n    const message = Array.from(game.messages).find(message => {\r\n      return getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID) === publicTradeId;\r\n    });\r\n    if (!message) return;\r\n    const update = this._replaceChatContent(message);\r\n    return message.update(update)\r\n  }\r\n\r\n  static async disablePastTradingButtons() {\r\n    if (!game.user.isGM) return;\r\n\r\n    const messages = Array.from(game.messages).filter(message => {\r\n      return getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID);\r\n    });\r\n\r\n    if (!messages.length) return;\r\n    const updates = [];\r\n    for (let message of messages) {\r\n      const update = this._replaceChatContent(message);\r\n      const tradeId = getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID);\r\n      const tradeUsers = getProperty(message, CONSTANTS.FLAGS.TRADE_USERS);\r\n      const bothUsersActive = tradeUsers.filter(userId => game.users.get(userId).active).length === tradeUsers.length;\r\n      if (!bothUsersActive) {\r\n        updates.push(update);\r\n      } else {\r\n        const otherUsers = tradeUsers.filter(userId => userId !== game.user.id);\r\n        const tradeData = await TradeAPI._requestTradeData({ tradeId, tradeUser: otherUsers[0] });\r\n        if (!tradeData) {\r\n          updates.push(update);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!updates.length) return;\r\n\r\n    return ChatMessage.updateDocuments(updates);\r\n\r\n  }\r\n\r\n  static _replaceChatContent(message) {\r\n    const tradeId = getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID);\r\n    const stringToFind = `data-trade-id=\"${tradeId}\"`;\r\n    let content = message.content;\r\n    content = content.replace(stringToFind, \"\");\r\n    content = content.replace(stringToFind, \"disabled\");\r\n    content = content.replace(game.i18n.localize(\"ITEM-PILES.Chat.TradeSpectate\"), game.i18n.localize(\"ITEM-PILES.Chat.SpectateDisabled\"));\r\n    return {\r\n      _id: message.id,\r\n      content,\r\n      [`flags.-=${CONSTANTS.MODULE_NAME}`]: null\r\n    };\r\n  }\r\n\r\n\r\n  /**\r\n   * Outputs to chat based on transferring an item from or to an item pile\r\n   *\r\n   * @param source\r\n   * @param target\r\n   * @param items\r\n   * @param userId\r\n   * @param interactionId\r\n   * @returns {Promise}\r\n   */\r\n  static async _outputTransferItem(source, target, items, userId, interactionId) {\r\n    if (!PileUtilities.isItemPileLootable(source)) return;\r\n    if (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    const [itemData, itemCurrencies] = await this._formatItemData(source, items);\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.PICKUP_CHAT_MESSAGE, source.uuid, target.uuid, itemData, itemCurrencies, userId, interactionId);\r\n  }\r\n\r\n  /**\r\n   * Outputs to chat based on transferring a currency from or to an item pile\r\n   *\r\n   * @param source\r\n   * @param target\r\n   * @param currencies\r\n   * @param userId\r\n   * @param interactionId\r\n   * @returns {Promise}\r\n   */\r\n  static async _outputTransferCurrency(source, target, currencies, userId, interactionId) {\r\n    if (!PileUtilities.isItemPileLootable(source)) return;\r\n    if (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    const currencyData = this._formatCurrencyData(source, currencies);\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.PICKUP_CHAT_MESSAGE, source.uuid, target.uuid, [], currencyData, userId, interactionId);\r\n  }\r\n\r\n  /**\r\n   * Outputs to chat based on giving an item from one actor to another\r\n   *\r\n   * @param source\r\n   * @param target\r\n   * @param item\r\n   * @param userId\r\n   * @returns {Promise}\r\n   */\r\n  static async _outputGiveItem(source, target, item, userId) {\r\n    if (game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    const [itemData, itemCurrencies] = await this._formatItemData(source, [item]);\r\n    return this._giveChatMessage(source, target, itemData.concat(itemCurrencies), userId);\r\n  }\r\n\r\n  /**\r\n   * Outputs to chat based on transferring everything from or to an item pile\r\n   *\r\n   * @param source\r\n   * @param target\r\n   * @param items\r\n   * @param currencies\r\n   * @param userId\r\n   * @param interactionId\r\n   * @returns {Promise}\r\n   */\r\n  static async _outputTransferEverything(source, target, items, currencies, userId, interactionId) {\r\n    if (!PileUtilities.isItemPileLootable(source)) return;\r\n    if (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    const [itemData, itemCurrencies] = await this._formatItemData(source, items);\r\n    const currencyData = this._formatCurrencyData(source, currencies).concat(itemCurrencies);\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.PICKUP_CHAT_MESSAGE, source.uuid, target.uuid, itemData, currencyData, userId, interactionId);\r\n  }\r\n\r\n  static _outputSplitItemPileInventory(source, pileDeltas, actorDeltas, userId) {\r\n    if (!PileUtilities.isItemPileLootable(source)) return;\r\n    if (game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.SPLIT_CHAT_MESSAGE, source.uuid, pileDeltas, actorDeltas, userId);\r\n  }\r\n\r\n  static async _outputTradeStarted(party_1, party_2, publicTradeId, isPrivate) {\r\n    if (party_1.user !== game.user.id || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT) || isPrivate) return;\r\n    return this._outputTradeStartedToChat(party_1, party_2, publicTradeId);\r\n  }\r\n\r\n  static async _outputTradeComplete(instigator, party_1, party_2, publicTradeId, isPrivate) {\r\n    if (!Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    return this._outputTradeCompleteToChat(instigator, party_1, party_2, publicTradeId, isPrivate);\r\n  }\r\n\r\n  static async _outputMerchantTradeComplete(source, target, priceInformation, userId, interactionId) {\r\n    if (!Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    if (!PileUtilities.isItemPileMerchant(source)) return;\r\n    if (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.MERCHANT_TRADE_CHAT_MESSAGE, source.uuid, target.uuid, priceInformation, userId, interactionId);\r\n  }\r\n\r\n  /**\r\n   * Formats item data to a chat friendly structure\r\n   *\r\n   * @param itemPile\r\n   * @param items\r\n   * @param divideBy\r\n   * @returns {Promise<Array>}\r\n   */\r\n  static async _formatItemData(itemPile, items, divideBy = 1) {\r\n    const formattedItems = [];\r\n    const formattedCurrencies = [];\r\n    const currencyList = PileUtilities.getActorCurrencies(itemPile, { getAll: true });\r\n    for (const itemData of items) {\r\n      const tempItem = await Item.implementation.create(itemData.item, { temporary: true });\r\n      const data = {\r\n        name: game.i18n.localize(tempItem.name),\r\n        img: tempItem.img ?? itemData?.item?.img ?? \"\",\r\n        quantity: Math.abs(itemData.quantity) / divideBy\r\n      };\r\n      if (PileUtilities.isItemCurrency(tempItem, { actorCurrencies: currencyList })) {\r\n        formattedCurrencies.push(data)\r\n      } else {\r\n        formattedItems.push(data);\r\n      }\r\n    }\r\n    return [formattedItems, formattedCurrencies];\r\n  }\r\n\r\n  /**\r\n   * Formats currency data to a chat friendly structure\r\n   *\r\n   * @param itemPile\r\n   * @param currencies\r\n   * @param divideBy\r\n   * @returns {Array}\r\n   */\r\n  static _formatCurrencyData(itemPile, currencies, divideBy = 1) {\r\n    const currencyList = PileUtilities.getActorCurrencies(itemPile, { getAll: true });\r\n    return Object.entries(currencies).map(entry => {\r\n      const currency = currencyList.find(currency => currency.id === entry[0]);\r\n      return {\r\n        name: game.i18n.localize(currency.name),\r\n        img: currency.img ?? \"\",\r\n        quantity: Math.abs(entry[1]) / divideBy,\r\n        index: currencyList.indexOf(currency)\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Outputs the transferred data in chat\r\n   *\r\n   * @param sourceUuid\r\n   * @param targetUuid\r\n   * @param items\r\n   * @param currencies\r\n   * @param userId\r\n   * @param interactionId\r\n   * @returns {Promise}\r\n   */\r\n  static async _outputPickupToChat(sourceUuid, targetUuid, items, currencies, userId, interactionId) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const now = (+new Date());\r\n\r\n    // Get all messages younger than 3 hours, and grab the last 10, then reverse them (latest to oldest)\r\n    const messages = Array.from(game.messages).filter(message => (now - message.timestamp) <= (10800000)).slice(-10);\r\n    messages.reverse()\r\n\r\n    for (const message of messages) {\r\n      const flags = getProperty(message, CONSTANTS.FLAGS.PILE);\r\n      if (flags && flags.version && !foundry.utils.isNewerVersion(Helpers.getModuleVersion(), flags.version) && flags.source === sourceUuid && flags.target === targetUuid && flags.interactionId === interactionId) {\r\n        return this._updateExistingPickupMessage(message, sourceActor, targetActor, items, currencies, interactionId)\r\n      }\r\n    }\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/looted.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.Pickup\", { name: targetActor.name }),\r\n      itemPile: sourceActor,\r\n      actor: targetActor,\r\n      items: items,\r\n      currencies: currencies\r\n    });\r\n\r\n    return this._createNewChatMessage(userId, {\r\n      user: game.user.id,\r\n      type: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n      content: chatCardHtml,\r\n      flavor: \"Item Piles\",\r\n      speaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n      [CONSTANTS.FLAGS.PILE]: {\r\n        version: Helpers.getModuleVersion(),\r\n        source: sourceUuid,\r\n        target: targetUuid,\r\n        items: items,\r\n        currencies: currencies,\r\n        interactionId: interactionId\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  static _matchEntries(existingEntries, incomingEntries) {\r\n\r\n    const combinedEntries = existingEntries.map(existingEntry => {\r\n      const foundEntry = incomingEntries.find(item => item.name === existingEntry.name && existingEntry.img === item.img);\r\n      if (foundEntry) {\r\n        existingEntry.quantity += foundEntry.quantity;\r\n        incomingEntries.splice(incomingEntries.indexOf(foundEntry), 1)\r\n      }\r\n      return existingEntry;\r\n    });\r\n\r\n    incomingEntries.forEach(item => combinedEntries.push(item));\r\n\r\n    return combinedEntries;\r\n\r\n  }\r\n\r\n  static async _updateExistingPickupMessage(message, sourceActor, targetActor, items, currencies, interactionId) {\r\n\r\n    const flags = getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\r\n    const newItems = this._matchEntries(flags.items, items);\r\n    const newCurrencies = this._matchEntries(flags.currencies, currencies);\r\n\r\n    newCurrencies.sort((a, b) => {\r\n      return a.index - b.index;\r\n    })\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/looted.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.Pickup\", { name: targetActor.name }),\r\n      itemPile: sourceActor,\r\n      actor: targetActor,\r\n      items: newItems,\r\n      currencies: newCurrencies\r\n    });\r\n\r\n    return message.update({\r\n      content: chatCardHtml,\r\n      [`${CONSTANTS.FLAGS.PILE}.interactionId`]: interactionId,\r\n      [`${CONSTANTS.FLAGS.PILE}.items`]: newItems,\r\n      [`${CONSTANTS.FLAGS.PILE}.currencies`]: newCurrencies,\r\n    });\r\n\r\n  }\r\n\r\n  static async _outputSplitToChat(sourceUuid, pileDeltas, actorDeltas, userId) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n\r\n    const divideBy = Object.values(actorDeltas).length;\r\n\r\n    const [items, itemCurrencies] = await this._formatItemData(sourceActor, pileDeltas.itemDeltas, divideBy);\r\n    const currencies = this._formatCurrencyData(sourceActor, pileDeltas.attributeDeltas, divideBy).concat(itemCurrencies);\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/looted.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.Split\", { num_players: divideBy }),\r\n      itemPile: sourceActor,\r\n      items: items,\r\n      currencies: currencies\r\n    });\r\n\r\n    return this._createNewChatMessage(userId, {\r\n      user: game.user.id,\r\n      type: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n      content: chatCardHtml,\r\n      flavor: \"Item Piles\",\r\n      speaker: ChatMessage.getSpeaker({ alias: game.user.name })\r\n    });\r\n\r\n  }\r\n\r\n  static async _outputTradeStartedToChat(party_1, party_2, publicTradeId) {\r\n\r\n    const party_1_actor = Utilities.getActor(party_1.actor);\r\n    const party_2_actor = Utilities.getActor(party_2.actor);\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/trade-started.html\", {\r\n      party_1_actor,\r\n      party_2_actor,\r\n      publicTradeId,\r\n      userId: game.user.id\r\n    });\r\n\r\n    return this._createNewChatMessage(game.user.id, {\r\n      user: game.user.id,\r\n      type: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n      content: chatCardHtml,\r\n      flavor: \"Item Piles\",\r\n      speaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n      [CONSTANTS.FLAGS.PUBLIC_TRADE_ID]: publicTradeId,\r\n      [CONSTANTS.FLAGS.TRADE_USERS]: [party_1.user, party_2.user]\r\n    });\r\n  }\r\n\r\n  static async _outputTradeCompleteToChat(instigator, party_1, party_2, publicTradeId, isPrivate) {\r\n\r\n    if (instigator !== game.user.id) return;\r\n\r\n    const party_1_actor = Utilities.getActor(party_1.actor);\r\n    const party_1_data = {\r\n      actor: party_1_actor,\r\n      items: party_2.items,\r\n      currencies: party_2.currencies.concat(party_2.itemCurrencies)\r\n    }\r\n    party_1_data.got_nothing = !party_1_data.items.length && !party_1_data.currencies.length;\r\n\r\n    const party_2_actor = Utilities.getActor(party_2.actor);\r\n    const party_2_data = {\r\n      actor: party_2_actor,\r\n      items: party_1.items,\r\n      currencies: party_1.currencies.concat(party_1.itemCurrencies)\r\n    }\r\n    party_2_data.got_nothing = !party_2_data.items.length && !party_2_data.currencies.length;\r\n\r\n    if (party_1.got_nothing && party_2.got_nothing) return;\r\n\r\n    const enableCollapse = (party_1_data.items.length + party_1_data.currencies.length + party_2_data.items.length + party_2_data.currencies.length) > 6;\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/trade-complete.html\", {\r\n      party_1: party_1_data,\r\n      party_2: party_2_data,\r\n      publicTradeId,\r\n      isPrivate,\r\n      enableCollapse\r\n    });\r\n\r\n    return this._createNewChatMessage(game.user.id, {\r\n      user: game.user.id,\r\n      type: isPrivate ? CONST.CHAT_MESSAGE_TYPES.WHISPER : CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n      content: chatCardHtml,\r\n      flavor: \"Item Piles\" + (isPrivate ? \": \" + game.i18n.localize(\"ITEM-PILES.Chat.PrivateTrade\") : \"\"),\r\n      speaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n      whisper: isPrivate ? [party_2.user] : []\r\n    });\r\n\r\n  }\r\n\r\n  static async _outputMerchantTradeToChat(sourceUuid, targetUuid, priceInformation, userId, interactionId) {\r\n\r\n    const sourceActor = Utilities.getActor(sourceUuid);\r\n    const targetActor = Utilities.getActor(targetUuid);\r\n\r\n    const now = (+new Date());\r\n\r\n    priceInformation.id = randomID();\r\n\r\n    // Get all messages younger than 3 hours, and grab the last 10, then reverse them (latest to oldest)\r\n    const messages = Array.from(game.messages).filter(message => (now - message.timestamp) <= (10800000)).slice(-10);\r\n    messages.reverse();\r\n\r\n    for (const message of messages) {\r\n      const flags = getProperty(message, CONSTANTS.FLAGS.PILE);\r\n      if (flags && flags.version && !foundry.utils.isNewerVersion(Helpers.getModuleVersion(), flags.version) && flags.source === sourceUuid && flags.target === targetUuid && flags.interactionId === interactionId) {\r\n        return this._updateExistingMerchantMessage(message, sourceActor, targetActor, priceInformation, interactionId)\r\n      }\r\n    }\r\n\r\n    const pileData = PileUtilities.getActorFlagData(sourceActor);\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/merchant-traded.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.MerchantTraded\", {\r\n        name: targetActor.name,\r\n        merchant: sourceActor.name\r\n      }),\r\n      merchant: {\r\n        name: sourceActor.name,\r\n        img: pileData.merchantImage || sourceActor.img\r\n      },\r\n      actor: targetActor,\r\n      priceInformation: [priceInformation]\r\n    });\r\n\r\n    return this._createNewChatMessage(userId, {\r\n      user: game.user.id,\r\n      type: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n      content: chatCardHtml,\r\n      flavor: \"Item Piles\",\r\n      speaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n      [CONSTANTS.FLAGS.PILE]: {\r\n        version: Helpers.getModuleVersion(),\r\n        source: sourceUuid,\r\n        target: targetUuid,\r\n        priceInformation: [priceInformation],\r\n        interactionId: interactionId\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n  static async _giveChatMessage(source, target, items) {\r\n\r\n    const now = (+new Date());\r\n\r\n    const sourceActor = Utilities.getActor(source);\r\n    const targetActor = Utilities.getActor(target);\r\n\r\n    // Get all messages younger than 1 minute, and grab the last 5, then reverse them (latest to oldest)\r\n    const messages = Array.from(game.messages)\r\n      .filter(message => (now - message.timestamp) <= (60000))\r\n      .slice(-5)\r\n      .reverse();\r\n\r\n    for (const message of messages) {\r\n      const flags = getProperty(message, CONSTANTS.FLAGS.PILE);\r\n      if (flags && flags.version && !foundry.utils.isNewerVersion(Helpers.getModuleVersion(), flags.version) && flags.source === sourceActor.uuid && flags.target === targetActor.uuid && message.isAuthor) {\r\n        return this._updateExistingGiveMessage(message, sourceActor, targetActor, items)\r\n      }\r\n    }\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/gave-items.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.GaveItems\", { source: sourceActor.name, target: targetActor.name }),\r\n      source: sourceActor,\r\n      target: targetActor,\r\n      items: items\r\n    });\r\n\r\n    return this._createNewChatMessage(game.user.id, {\r\n      user: game.user.id,\r\n      type: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n      content: chatCardHtml,\r\n      flavor: \"Item Piles\",\r\n      speaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n      [CONSTANTS.FLAGS.PILE]: {\r\n        version: Helpers.getModuleVersion(),\r\n        source: sourceActor.uuid,\r\n        target: targetActor.uuid,\r\n        items: items\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  static async _updateExistingGiveMessage(message, sourceActor, targetActor, items) {\r\n\r\n    const flags = getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\r\n    const newItems = this._matchEntries(flags.items, items);\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/gave-items.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.GaveItems\", { source: sourceActor.name, target: targetActor.name }),\r\n      source: sourceActor,\r\n      target: targetActor,\r\n      items: newItems\r\n    });\r\n\r\n    return message.update({\r\n      content: chatCardHtml,\r\n      [`${CONSTANTS.FLAGS.PILE}.items`]: newItems\r\n    });\r\n\r\n  }\r\n\r\n  static async _updateExistingMerchantMessage(message, sourceActor, targetActor, incomingPriceInformation, interactionId) {\r\n\r\n    const flags = getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\r\n    const newPriceInformation = flags.priceInformation\r\n      .map(priceInformation => {\r\n        const boughtItem = incomingPriceInformation.buyerReceive[0];\r\n        const foundEntry = Utilities.findSimilarItem(priceInformation.buyerReceive, boughtItem);\r\n        if (foundEntry) {\r\n          if (incomingPriceInformation.primary && priceInformation.primary) {\r\n            foundEntry.quantity += boughtItem.quantity;\r\n            incomingPriceInformation.buyerReceive.splice(0, 1);\r\n            priceInformation.totalCurrencyCost += incomingPriceInformation.totalCurrencyCost;\r\n            priceInformation.basePriceString = PileUtilities.getPriceArray(priceInformation.totalCurrencyCost, priceInformation.finalPrices)\r\n              .filter(price => price.cost).map(price => price.string).join(\" \");\r\n          } else {\r\n            const sameTypePrice = incomingPriceInformation.finalPrices\r\n              .map(price => {\r\n                const foundItem = Utilities.findSimilarItem(priceInformation.buyerReceive, price);\r\n                if (foundItem) {\r\n                  return { foundItem, price }\r\n                }\r\n                return false;\r\n              })\r\n              .filter(Boolean);\r\n            if (sameTypePrice.length) {\r\n              incomingPriceInformation.buyerReceive.splice(0, 1);\r\n              sameTypePrice.forEach(match => {\r\n                match.price.quantity += match.foundItem.quantity;\r\n              });\r\n            }\r\n          }\r\n        }\r\n        return priceInformation;\r\n      })\r\n      .concat([incomingPriceInformation].filter(priceInformation => priceInformation.buyerReceive.length));\r\n\r\n    const pileData = PileUtilities.getActorFlagData(sourceActor);\r\n\r\n    const chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/merchant-traded.html\", {\r\n      message: game.i18n.format(\"ITEM-PILES.Chat.MerchantTraded\", {\r\n        name: targetActor.name,\r\n        merchant: sourceActor.name\r\n      }),\r\n      merchant: {\r\n        name: sourceActor.name,\r\n        img: pileData.merchantImage || sourceActor.img\r\n      },\r\n      actor: targetActor,\r\n      priceInformation: newPriceInformation\r\n    });\r\n\r\n    return message.update({\r\n      content: chatCardHtml,\r\n      [`${CONSTANTS.FLAGS.PILE}.interactionId`]: interactionId,\r\n      [`${CONSTANTS.FLAGS.PILE}.priceInformation`]: newPriceInformation\r\n    });\r\n\r\n  }\r\n\r\n  static _createNewChatMessage(userId, chatData) {\r\n\r\n    if (!chatData.whisper) {\r\n\r\n      const mode = Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT);\r\n\r\n      if (mode > 1) {\r\n        chatData.whisper = Array.from(game.users)\r\n          .filter(user => user.isGM)\r\n          .map(user => user.id);\r\n        if (mode === 2) {\r\n          chatData.whisper.push(userId);\r\n        }\r\n        chatData.type = CONST.CHAT_MESSAGE_TYPES.WHISPER;\r\n      }\r\n\r\n    }\r\n\r\n    return ChatMessage.create(chatData);\r\n\r\n  }\r\n\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport { debug } from \"./helpers/helpers.js\";\r\nimport { stringIsUuid } from \"./helpers/utilities.js\";\r\nimport PrivateAPI from \"./API/private-api.js\";\r\nimport TradeAPI from \"./API/trade-api.js\";\r\nimport ChatAPI from \"./API/chat-api.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\n\r\nexport default class ItemPileSocket {\r\n\r\n  static ready = false;\r\n\r\n  static HANDLERS = {\r\n    /**\r\n     * Generic sockets\r\n     */\r\n    CALL_HOOK: \"callHook\",\r\n    TOGGLE_HOOKS: \"toggleHooks\",\r\n\r\n    /**\r\n     * Chat messages\r\n     */\r\n    PICKUP_CHAT_MESSAGE: \"pickupChatMessage\",\r\n    SPLIT_CHAT_MESSAGE: \"splitChatMessage\",\r\n    MERCHANT_TRADE_CHAT_MESSAGE: \"merchantTradeChatMessage\",\r\n    DISABLE_CHAT_TRADE_BUTTON: \"disableChatTradeButton\",\r\n\r\n    /**\r\n     * Item pile sockets\r\n     */\r\n    CREATE_PILE: \"createItemPile\",\r\n    UPDATE_PILE: \"updateItemPile\",\r\n    UPDATED_PILE: \"updatedPile\",\r\n    DELETE_PILE: \"deleteItemPile\",\r\n    TURN_INTO_PILE: \"turnIntoPiles\",\r\n    REVERT_FROM_PILE: \"revertFromPiles\",\r\n    REFRESH_PILE: \"refreshItemPile\",\r\n    SPLIT_PILE: \"splitItemPileContent\",\r\n\r\n    /**\r\n     * UI sockets\r\n     */\r\n    RENDER_INTERFACE: \"renderItemPileApplication\",\r\n    RERENDER_TOKEN_HUD: \"rerenderTokenHud\",\r\n    USER_OPENED_INTERFACE: \"userOpenedInterface\",\r\n    USER_CLOSED_INTERFACE: \"userClosedInterface\",\r\n\r\n    /**\r\n     * Item & attribute sockets\r\n     */\r\n    GIVE_ITEMS: \"giveItems\",\r\n    GIVE_ITEMS_RESPONSE: \"giveItemsResponse\",\r\n    DROP_ITEMS: \"dropItems\",\r\n    ADD_ITEMS: \"addItems\",\r\n    REMOVE_ITEMS: \"removeItems\",\r\n    TRANSFER_ITEMS: \"transferItems\",\r\n    TRANSFER_ALL_ITEMS: \"transferAllItems\",\r\n    ADD_CURRENCIES: \"addCurrencies\",\r\n    REMOVE_CURRENCIES: \"removeCurrencies\",\r\n    TRANSFER_CURRENCIES: \"transferCurrencies\",\r\n    TRANSFER_ALL_CURRENCIES: \"transferAllCurrencies\",\r\n    SET_ATTRIBUTES: \"setAttributes\",\r\n    ADD_ATTRIBUTES: \"addAttributes\",\r\n    REMOVE_ATTRIBUTES: \"removeAttributes\",\r\n    TRANSFER_ATTRIBUTES: \"transferAttributes\",\r\n    TRANSFER_ALL_ATTRIBUTES: \"transferAllAttributes\",\r\n    TRANSFER_EVERYTHING: \"transferEverything\",\r\n    COMMIT_ACTOR_CHANGES: \"commitActorChanges\",\r\n    ROLL_ITEM_TABLE: \"rollItemTable\",\r\n\r\n    /**\r\n     * Trading sockets\r\n     */\r\n    TRADE_REQUEST_PROMPT: \"tradePrompt\",\r\n    TRADE_REQUEST_CANCELLED: \"tradeCancelled\",\r\n    REQUEST_TRADE_DATA: \"requestTradeData\",\r\n    TRADE_CLOSED: \"publicTradeClosed\",\r\n    PUBLIC_TRADE_UPDATE_ITEMS: \"publicTradeUpdateItems\",\r\n    PUBLIC_TRADE_UPDATE_ITEM_CURRENCIES: \"publicTradeUpdateItemCurrencies\",\r\n    PUBLIC_TRADE_UPDATE_CURRENCIES: \"publicTradeUpdateCurrencies\",\r\n    PUBLIC_TRADE_STATE: \"publicTradeAcceptedState\",\r\n    PRIVATE_TRADE_UPDATE_ITEMS: \"privateTradeUpdateItems\",\r\n    PRIVATE_TRADE_UPDATE_ITEM_CURRENCIES: \"privateTradeUpdateItemCurrencies\",\r\n    PRIVATE_TRADE_UPDATE_CURRENCIES: \"privateTradeUpdateCurrencies\",\r\n    PRIVATE_TRADE_STATE: \"privateTradeAcceptedState\",\r\n    EXECUTE_TRADE: \"executeTrade\",\r\n    TRADE_COMPLETED: \"tradeCompleted\",\r\n\r\n    /**\r\n     * Merchant sockets\r\n     */\r\n    TRADE_ITEMS: \"tradeItems\"\r\n  }\r\n\r\n  static BINDINGS = {\r\n    [this.HANDLERS.CALL_HOOK]: (hook, response, ...args) => callHook(hook, response, ...args),\r\n\r\n    [this.HANDLERS.TOGGLE_HOOKS]: (toggle) => {\r\n      Helpers.hooks.run = toggle;\r\n    },\r\n\r\n    [this.HANDLERS.DROP_ITEMS]: (args) => PrivateAPI._dropItems(args),\r\n    [this.HANDLERS.GIVE_ITEMS]: (...args) => PrivateAPI._giveItems(...args),\r\n    [this.HANDLERS.GIVE_ITEMS_RESPONSE]: (...args) => PrivateAPI._giveItemsResponse(...args),\r\n    [this.HANDLERS.ADD_ITEMS]: (...args) => PrivateAPI._addItems(...args),\r\n    [this.HANDLERS.REMOVE_ITEMS]: (...args) => PrivateAPI._removeItems(...args),\r\n    [this.HANDLERS.TRANSFER_ITEMS]: (...args) => PrivateAPI._transferItems(...args),\r\n    [this.HANDLERS.TRANSFER_ALL_ITEMS]: (...args) => PrivateAPI._transferAllItems(...args),\r\n    [this.HANDLERS.ADD_CURRENCIES]: (...args) => PrivateAPI._addCurrencies(...args),\r\n    [this.HANDLERS.REMOVE_CURRENCIES]: (...args) => PrivateAPI._removeCurrencies(...args),\r\n    [this.HANDLERS.TRANSFER_CURRENCIES]: (...args) => PrivateAPI._transferCurrencies(...args),\r\n    [this.HANDLERS.TRANSFER_ALL_CURRENCIES]: (...args) => PrivateAPI._transferAllCurrencies(...args),\r\n    [this.HANDLERS.SET_ATTRIBUTES]: (...args) => PrivateAPI._setAttributes(...args),\r\n    [this.HANDLERS.ADD_ATTRIBUTES]: (...args) => PrivateAPI._addAttributes(...args),\r\n    [this.HANDLERS.REMOVE_ATTRIBUTES]: (...args) => PrivateAPI._removeAttributes(...args),\r\n    [this.HANDLERS.TRANSFER_ATTRIBUTES]: (...args) => PrivateAPI._transferAttributes(...args),\r\n    [this.HANDLERS.TRANSFER_ALL_ATTRIBUTES]: (...args) => PrivateAPI._transferAllAttributes(...args),\r\n    [this.HANDLERS.TRANSFER_EVERYTHING]: (...args) => PrivateAPI._transferEverything(...args),\r\n    [this.HANDLERS.COMMIT_ACTOR_CHANGES]: (...args) => PrivateAPI._commitActorChanges(...args),\r\n    [this.HANDLERS.ROLL_ITEM_TABLE]: (...args) => PrivateAPI._rollItemTable(...args),\r\n\r\n    [this.HANDLERS.CREATE_PILE]: (...args) => PrivateAPI._createItemPile(...args),\r\n    [this.HANDLERS.UPDATE_PILE]: (...args) => PrivateAPI._updateItemPile(...args),\r\n    [this.HANDLERS.UPDATED_PILE]: (...args) => PrivateAPI._updatedItemPile(...args),\r\n    [this.HANDLERS.DELETE_PILE]: (...args) => PrivateAPI._deleteItemPile(...args),\r\n    [this.HANDLERS.TURN_INTO_PILE]: (...args) => PrivateAPI._turnTokensIntoItemPiles(...args),\r\n    [this.HANDLERS.REVERT_FROM_PILE]: (...args) => PrivateAPI._revertTokensFromItemPiles(...args),\r\n    [this.HANDLERS.SPLIT_PILE]: (...args) => PrivateAPI._splitItemPileContents(...args),\r\n\r\n    [this.HANDLERS.TRADE_REQUEST_PROMPT]: (...args) => TradeAPI._respondPrompt(...args),\r\n    [this.HANDLERS.TRADE_REQUEST_CANCELLED]: (...args) => TradeAPI._tradeCancelled(...args),\r\n    [this.HANDLERS.EXECUTE_TRADE]: (...args) => TradeAPI._executeTrade(...args),\r\n    [this.HANDLERS.TRADE_COMPLETED]: (...args) => TradeAPI._tradeCompleted(...args),\r\n    [this.HANDLERS.REQUEST_TRADE_DATA]: (...args) => TradeAPI._respondActiveTradeData(...args),\r\n    [this.HANDLERS.TRADE_CLOSED]: (...args) => TradeAPI._tradeClosed(...args),\r\n\r\n    [this.HANDLERS.PUBLIC_TRADE_UPDATE_ITEMS]: (...args) => TradeAPI._updateItems(...args),\r\n    [this.HANDLERS.PUBLIC_TRADE_UPDATE_ITEM_CURRENCIES]: (...args) => TradeAPI._updateItemCurrencies(...args),\r\n    [this.HANDLERS.PUBLIC_TRADE_UPDATE_CURRENCIES]: (...args) => TradeAPI._updateCurrencies(...args),\r\n    [this.HANDLERS.PUBLIC_TRADE_STATE]: (...args) => TradeAPI._updateAcceptedState(...args),\r\n\r\n    [this.HANDLERS.PRIVATE_TRADE_UPDATE_ITEMS]: (...args) => TradeAPI._updateItems(...args),\r\n    [this.HANDLERS.PRIVATE_TRADE_UPDATE_ITEM_CURRENCIES]: (...args) => TradeAPI._updateItemCurrencies(...args),\r\n    [this.HANDLERS.PRIVATE_TRADE_UPDATE_CURRENCIES]: (...args) => TradeAPI._updateCurrencies(...args),\r\n    [this.HANDLERS.PRIVATE_TRADE_STATE]: (...args) => TradeAPI._updateAcceptedState(...args),\r\n\r\n    [this.HANDLERS.PICKUP_CHAT_MESSAGE]: (...args) => ChatAPI._outputPickupToChat(...args),\r\n    [this.HANDLERS.SPLIT_CHAT_MESSAGE]: (...args) => ChatAPI._outputSplitToChat(...args),\r\n    [this.HANDLERS.MERCHANT_TRADE_CHAT_MESSAGE]: (...args) => ChatAPI._outputMerchantTradeToChat(...args),\r\n    [this.HANDLERS.DISABLE_CHAT_TRADE_BUTTON]: (...args) => ChatAPI._disableTradingButton(...args),\r\n\r\n    [this.HANDLERS.RENDER_INTERFACE]: (...args) => PrivateAPI._renderItemPileInterface(...args),\r\n    [this.HANDLERS.RERENDER_TOKEN_HUD]: (...args) => PrivateAPI._updateTokenHud(...args),\r\n    [this.HANDLERS.USER_OPENED_INTERFACE]: (...args) => InterfaceTracker.userOpened(...args),\r\n    [this.HANDLERS.USER_CLOSED_INTERFACE]: (...args) => InterfaceTracker.userClosed(...args),\r\n\r\n    [this.HANDLERS.TRADE_ITEMS]: (...args) => PrivateAPI._tradeItems(...args),\r\n\r\n  }\r\n\r\n  static _socket;\r\n\r\n  static initialize() {\r\n    InterfaceTracker.initialize();\r\n    this._socket = socketlib.registerModule(CONSTANTS.MODULE_NAME);\r\n    for (let [key, callback] of Object.entries(this.BINDINGS)) {\r\n      this._socket.register(key, callback);\r\n      debug(`Registered itemPileSocket: ${key}`);\r\n    }\r\n    debug(\"Registered all Item Piles sockets\")\r\n    this.ready = true;\r\n  }\r\n\r\n  static executeAsGM(handler, ...args) {\r\n    if (!Helpers.isGMConnected()) {\r\n      Helpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.NoGMsConnectedAction\", { action: handler }), true);\r\n      return false;\r\n    }\r\n    return this._socket.executeAsGM(handler, ...args);\r\n  }\r\n\r\n  static executeAsUser(handler, userId, ...args) {\r\n    return this._socket.executeAsUser(handler, userId, ...args);\r\n  }\r\n\r\n  static executeForAllGMs(handler, ...args) {\r\n    return this._socket.executeForAllGMs(handler, ...args);\r\n  }\r\n\r\n  static executeForOtherGMs(handler, ...args) {\r\n    return this._socket.executeForOtherGMs(handler, ...args);\r\n  }\r\n\r\n  static executeForEveryone(handler, ...args) {\r\n    return this._socket.executeForEveryone(handler, ...args);\r\n  }\r\n\r\n  static executeForOthers(handler, ...args) {\r\n    return this._socket.executeForOthers(handler, ...args);\r\n  }\r\n\r\n  static executeForUsers(handler, userIds, ...args) {\r\n    return this._socket.executeForUsers(handler, userIds, ...args);\r\n  }\r\n\r\n  static callHook(hook, ...args) {\r\n    if (!Helpers.hooks.run) return;\r\n    return this._socket.executeForEveryone(this.HANDLERS.CALL_HOOK, hook, ...args);\r\n  }\r\n\r\n  static callHookForUsers(hook, users, ...args) {\r\n    if (!Helpers.hooks.run) return;\r\n    return this._socket.executeForUsers(this.HANDLERS.CALL_HOOK, users, hook, ...args);\r\n  }\r\n\r\n}\r\n\r\nasync function callHook(hook, ...args) {\r\n  const newArgs = [];\r\n  for (let arg of args) {\r\n    if (stringIsUuid(arg)) {\r\n      const testArg = fromUuidSync(arg);\r\n      if (testArg) {\r\n        arg = testArg;\r\n      }\r\n    }\r\n    newArgs.push(arg);\r\n  }\r\n  return Hooks.callAll(hook, ...newArgs);\r\n}\r\n\r\nexport const InterfaceTracker = {\r\n\r\n  users: {},\r\n\r\n  initialize() {\r\n    this.users = {};\r\n    Array.from(game.users).forEach(user => {\r\n      this.users[user.id] = new Set();\r\n    });\r\n    Hooks.on(CONSTANTS.HOOKS.OPEN_INTERFACE, (app) => {\r\n      ItemPileSocket.executeForOthers(ItemPileSocket.HANDLERS.USER_OPENED_INTERFACE, game.user.id, app.id);\r\n    });\r\n    Hooks.on(CONSTANTS.HOOKS.CLOSE_INTERFACE, (app) => {\r\n      ItemPileSocket.executeForOthers(ItemPileSocket.HANDLERS.USER_CLOSED_INTERFACE, game.user.id, app.id);\r\n    });\r\n  },\r\n\r\n  userOpened(userId, id) {\r\n    if (!this.users[userId]) return;\r\n    this.users[userId].add(id);\r\n  },\r\n\r\n  userClosed(userId, id) {\r\n    if (!this.users[userId]) return;\r\n    this.users[userId].delete(id);\r\n  },\r\n\r\n  isOpened(id) {\r\n    return Object.values(this.users).some(interfaceList => interfaceList.has(id))\r\n  }\r\n\r\n}\r\n","import CONSTANTS from \"../constants/constants.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport editors from \"../applications/editors/index.js\";\r\n\r\nexport const debounceManager = {\r\n\r\n  debounces: {},\r\n\r\n  setDebounce(id, method) {\r\n    if (this.debounces[id]) {\r\n      return this.debounces[id];\r\n    }\r\n    this.debounces[id] = debounce(function (...args) {\r\n      delete debounceManager.debounces[id];\r\n      return method(...args);\r\n    }, 50);\r\n    return this.debounces[id];\r\n  }\r\n};\r\n\r\nexport const hooks = {\r\n  run: true,\r\n  _hooks: {},\r\n\r\n  async runWithout(callback) {\r\n    await ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TOGGLE_HOOKS, false);\r\n    await callback();\r\n    await ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TOGGLE_HOOKS, true);\r\n  },\r\n\r\n  call(hook, ...args) {\r\n    if (!this.run) return;\r\n    return Hooks.call(hook, ...args);\r\n  },\r\n\r\n  callAll(hook, ...args) {\r\n    if (!this.run) return;\r\n    return Hooks.callAll(hook, ...args);\r\n  },\r\n\r\n  on(hook, callback) {\r\n    Hooks.on(hook, (...args) => {\r\n      if (!this.run) return;\r\n      callback(...args);\r\n    });\r\n  }\r\n}\r\n\r\nexport function getModuleVersion() {\r\n  return game.modules.get(CONSTANTS.MODULE_NAME).version;\r\n}\r\n\r\n/**\r\n *  This function determines if the given parameter is a callable function\r\n *\r\n * @param  {function}   inFunc    The function object to be tested\r\n * @return {boolean}              A boolean whether the function is actually a function\r\n */\r\nexport function isFunction(inFunc) {\r\n  return inFunc && (\r\n    {}.toString.call(inFunc) === '[object Function]'\r\n    ||\r\n    {}.toString.call(inFunc) === '[object AsyncFunction]'\r\n  );\r\n}\r\n\r\nexport function wait(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\n/**\r\n * @param key\r\n * @returns {*}\r\n */\r\nexport function getSetting(key) {\r\n  return game.settings.get(CONSTANTS.MODULE_NAME, key);\r\n}\r\n\r\nexport function setSetting(key, value) {\r\n  if (value === undefined) throw new Error(\"setSetting | value must not be undefined!\");\r\n  return game.settings.set(CONSTANTS.MODULE_NAME, key, value);\r\n}\r\n\r\nexport function debug(msg, args = \"\") {\r\n  if (game.settings.get(CONSTANTS.MODULE_NAME, \"debug\")) {\r\n    console.log(`DEBUG | Item Piles | ${msg}`, args)\r\n  }\r\n}\r\n\r\nexport function custom_notify(message) {\r\n  message = `Item Piles | ${message}`;\r\n  ui.notifications.notify(message, { console: false });\r\n  console.log(message.replace(\"<br>\", \"\\n\"));\r\n}\r\n\r\nexport function custom_warning(warning, notify = false) {\r\n  warning = `Item Piles | ${warning}`;\r\n  if (notify) {\r\n    ui.notifications.warn(warning, { console: false });\r\n  }\r\n  console.warn(warning.replace(\"<br>\", \"\\n\"));\r\n}\r\n\r\nexport function custom_error(error, notify = true) {\r\n  error = `Item Piles | ${error}`;\r\n  if (notify) {\r\n    ui.notifications.error(error, { console: false });\r\n  }\r\n  return new Error(error.replace(\"<br>\", \"\\n\"));\r\n}\r\n\r\nexport function capitalizeFirstLetter(str) {\r\n  return str.slice(0, 1).toUpperCase() + str.slice(1);\r\n}\r\n\r\nexport function isRealNumber(inNumber) {\r\n  return !isNaN(inNumber)\r\n    && typeof inNumber === \"number\"\r\n    && isFinite(inNumber);\r\n}\r\n\r\nexport function isActiveGM(user) {\r\n  return user.active && user.isGM;\r\n}\r\n\r\nexport function getActiveGMs() {\r\n  return game.users.filter(isActiveGM);\r\n}\r\n\r\nexport function isResponsibleGM() {\r\n  if (!game.user.isGM) {\r\n    return false;\r\n  }\r\n  return !getActiveGMs().some(other => other.id < game.user.id);\r\n}\r\n\r\nexport function isGMConnected() {\r\n  return !!Array.from(game.users).find(user => user.isGM && user.active);\r\n}\r\n\r\nexport function roundToDecimals(num, decimals) {\r\n  return Number(Math.round(num + 'e' + decimals) + 'e-' + decimals);\r\n}\r\n\r\nexport function clamp(num, min, max) {\r\n  return Math.max(Math.min(num, max), min);\r\n}\r\n\r\nexport function getActiveApps(id, single = false) {\r\n  const apps = Object.values(ui.windows).filter(app => app.id.startsWith(id) && app._state > Application.RENDER_STATES.CLOSED);\r\n  if (single) {\r\n    return apps?.[0] ?? false;\r\n  }\r\n  return apps;\r\n}\r\n\r\n/**\r\n *  This function linearly interpolates between p1 and p2 based on a normalized value of t\r\n *\r\n * @param  {string}         inFile      The start value\r\n * @param  {object}         inOptions   The end value\r\n * @return {array|boolean}              Interpolated value\r\n */\r\nexport async function getFiles(inFile, { applyWildCard = false, softFail = false } = {}) {\r\n\r\n  let source = 'data';\r\n  const browseOptions = { wildcard: applyWildCard };\r\n\r\n  if (/\\.s3\\./.test(inFile)) {\r\n    source = 's3'\r\n    const { bucket, keyPrefix } = FilePicker.parseS3URL(inFile);\r\n    if (bucket) {\r\n      browseOptions.bucket = bucket;\r\n      inFile = keyPrefix;\r\n    }\r\n  }\r\n\r\n  try {\r\n    return (await FilePicker.browse(source, inFile, browseOptions)).files;\r\n  } catch (err) {\r\n    if (softFail) return false;\r\n    throw custom_error(`Could not get files! | ${err}`);\r\n  }\r\n}\r\n\r\n/**\r\n *  Returns a floating point number between a minimum and maximum value\r\n *\r\n * @param  {number}     min                     The minimum value\r\n * @param  {number}     max                     The maximum value\r\n * @return {number}                             A random value between the range given\r\n */\r\nexport function random_float_between(min, max) {\r\n  const random = Math.random();\r\n  const _max = Math.max(max, min);\r\n  const _min = Math.min(max, min);\r\n  return random * (_max - _min) + _min;\r\n}\r\n\r\n/**\r\n *  Returns an integer between a minimum and maximum value\r\n *\r\n * @param  {number}     min                     The minimum value\r\n * @param  {number}     max                     The maximum value\r\n * @return {int}                                A random integer between the range given\r\n */\r\nexport function random_int_between(min, max) {\r\n  return Math.floor(random_float_between(min, max));\r\n}\r\n\r\n/**\r\n *  Returns a random element in the given array\r\n *\r\n * @param  {array}   inArray                    An array\r\n * @param  {boolean} recurse                    Whether to recurse if the randomly chosen element is also an array\r\n * @return {object}                             A random element from the array\r\n */\r\nexport function random_array_element(inArray, { recurse = false } = {}) {\r\n  let choice = inArray[random_int_between(0, inArray.length)];\r\n  if (recurse && Array.isArray(choice)) {\r\n    return random_array_element(choice, { recurse: true });\r\n  }\r\n  return choice;\r\n}\r\n\r\n\r\nexport function styleFromObject(obj, vars = false) {\r\n  return Object.entries(obj).map(entry => (vars ? \"--\" : \"\") + entry[0] + ': ' + entry[1] + \";\").join(\"\");\r\n}\r\n\r\n\r\nexport function abbreviateNumbers(number, decPlaces = 2) {\r\n\r\n  // 2 decimal places => 100, 3 => 1000, etc\r\n  decPlaces = Math.pow(10, decPlaces)\r\n\r\n  // Enumerate number abbreviations\r\n  let abbrev = ['k', 'm', 'b', 't']\r\n\r\n  // Go through the array backwards, so we do the largest first\r\n  for (let i = abbrev.length - 1; i >= 0; i--) {\r\n\r\n    // Convert array index to \"1000\", \"1000000\", etc\r\n    let size = Math.pow(10, (i + 1) * 3)\r\n\r\n    // If the number is bigger or equal do the abbreviation\r\n    if (size <= number) {\r\n      // Here, we multiply by decPlaces, round, and then divide by decPlaces.\r\n      // This gives us nice rounding to a particular decimal place.\r\n      number = Math.round((number * decPlaces) / size) / decPlaces\r\n\r\n      // Handle special case where we round up to the next abbreviation\r\n      if (number === 1000 && i < abbrev.length - 1) {\r\n        number = 1\r\n        i++\r\n      }\r\n\r\n      // Add the letter for the abbreviation\r\n      number += abbrev[i]\r\n\r\n      // We are done... stop\r\n      break;\r\n    }\r\n  }\r\n\r\n  return number\r\n}\r\n\r\n\r\nexport function timeSince(date) {\r\n  const seconds = Math.floor((new Date() - date) / 1000);\r\n  const intervals = {\r\n    \"d\": 86400,\r\n    \"h\": 3600,\r\n    \"m\": 60\r\n  }\r\n\r\n  for (const [key, value] of Object.entries(intervals)) {\r\n    const interval = seconds / value;\r\n    if (interval > 1) {\r\n      return Math.floor(interval) + key;\r\n    }\r\n  }\r\n\r\n  return Math.ceil(seconds) + \"s\";\r\n}\r\n\r\n\r\nexport function getApplicationPositions(application_1, application_2 = false) {\r\n\r\n  let midPoint = (window.innerWidth / 2);\r\n\r\n  if (!application_2) {\r\n    if (((midPoint - 200) - application_1.position.width - 25) > 0) {\r\n      midPoint -= 200\r\n    }\r\n    return [\r\n      { left: midPoint - application_1.position.width - 25 },\r\n      { left: midPoint + 25 }\r\n    ]\r\n  }\r\n\r\n  const application_1_position = {\r\n    left: application_1.position.left,\r\n    top: application_1.position.top,\r\n    width: application_1.position.width\r\n  };\r\n  const application_2_position = {\r\n    left: application_2.position.left,\r\n    top: application_1.position.top,\r\n    width: application_2.position.width\r\n  };\r\n\r\n  application_2_position.left = application_1_position.left - application_2_position.width - 25;\r\n  if (application_2_position.left < 0) {\r\n    application_2_position.left = application_1_position.left + application_1_position.width + 25\r\n  }\r\n  if ((application_2_position.left + application_2_position.width) > window.innerWidth) {\r\n    application_2_position.left = midPoint - application_2_position.width - 25;\r\n    application_1_position.left = midPoint + 25;\r\n  }\r\n\r\n  return [\r\n    application_1_position,\r\n    application_2_position\r\n  ]\r\n\r\n}\r\n\r\nexport async function openEditor(key, data = false) {\r\n\r\n  const setting = SETTINGS.DEFAULTS()[key];\r\n\r\n  const editor = editors[setting.application];\r\n\r\n  if (!data) {\r\n    data = getSetting(key);\r\n  }\r\n\r\n  const result = await editor.show(data, { ...setting.applicationOptions, onchange: setting.onchange } ?? {});\r\n\r\n  if (setting.onchange && result) setting.onchange(result);\r\n\r\n  return result;\r\n\r\n}\r\n\r\nexport function isCoordinateWithinPosition(x, y, position) {\r\n  return x >= position.left && x < position.left + position.width\r\n    && y >= position.top && y < position.top + position.height;\r\n}\r\n","import * as Helpers from \"./helpers/helpers.js\";\r\nimport * as PileUtilities from \"./helpers/pile-utilities.js\";\r\nimport { isValidItemPile } from \"./helpers/pile-utilities.js\";\r\nimport ItemPileConfig from \"./applications/item-pile-config/item-pile-config.js\";\r\nimport ItemEditor from \"./applications/item-editor/item-editor.js\";\r\nimport SETTINGS from \"./constants/settings.js\";\r\nimport CONSTANTS from \"./constants/constants.js\";\r\nimport UserSelectDialog from \"./applications/dialogs/user-select-dialog/user-select-dialog.js\";\r\n\r\nexport default function registerUIOverrides() {\r\n  Hooks.on(\"renderPlayerList\", addTradeButton);\r\n  Hooks.on(\"getActorDirectoryEntryContext\", insertActorContextMenuItems);\r\n  Hooks.on(\"getActorSheetHeaderButtons\", insertActorHeaderButtons);\r\n  Hooks.on(\"getItemSheetHeaderButtons\", insertItemHeaderButtons);\r\n  Hooks.on(\"renderSidebarTab\", hideTemporaryItems);\r\n  Hooks.on(\"renderTokenHUD\", renderPileHUD);\r\n  Hooks.on(\"hoverToken\", handleTokenBorders);\r\n  Hooks.on(\"controlToken\", handleTokenBorders);\r\n  if (!foundry.utils.isNewerVersion(game.version, \"10.999\")) {\r\n    game.tooltip = new FastTooltipManager();\r\n  }\r\n}\r\n\r\nfunction handleTokenBorders(token) {\r\n  if (!isValidItemPile(token)) return;\r\n  const setting = Helpers.getSetting(SETTINGS.HIDE_TOKEN_BORDER);\r\n  token.border.renderable = token.controlled ||\r\n    (setting !== SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.EVERYONE && (\r\n      setting === SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.SHOW\r\n      ||\r\n      (setting === SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.PLAYERS && game.user.isGM)\r\n    ));\r\n}\r\n\r\nfunction hideTemporaryItems(sidebar) {\r\n  if (sidebar.tabName !== \"items\") return;\r\n  Array.from(game.items).filter(item => {\r\n      return getProperty(item.toObject(), CONSTANTS.FLAGS.TEMPORARY_ITEM);\r\n    })\r\n    .forEach(item => {\r\n      const element = sidebar.element.find(`.directory-item[data-document-id=\"${item.id}\"]`);\r\n      if (!element.length) return;\r\n      if (element.parent().children().length === 1) {\r\n        return element.parent().empty();\r\n      }\r\n      element.find(`.directory-item[data-document-id=\"${item.id}\"]`).remove();\r\n    });\r\n}\r\n\r\nfunction addTradeButton(app, html) {\r\n  if (!Helpers.getSetting(SETTINGS.ENABLE_TRADING) || !Helpers.getSetting(SETTINGS.SHOW_TRADE_BUTTON)) return;\r\n\r\n  const minimalUI = game.modules.get('minimal-ui')?.active;\r\n  const classes = \"item-piles-player-list-trade-button\" + (minimalUI ? \" item-piles-minimal-ui\" : \"\")\r\n  const text = !minimalUI ? \" Request Trade\" : \"\"\r\n  const button = $(`<button type=\"button\" class=\"${classes}\"><i class=\"fas fa-handshake\"></i>${text}</button>`)\r\n\r\n  button.click(() => {\r\n    game.itempiles.API.requestTrade();\r\n  });\r\n  html.append(button);\r\n}\r\n\r\nfunction insertActorContextMenuItems(html, menuItems) {\r\n\r\n  menuItems.push({\r\n    name: \"Item Piles: \" + game.i18n.localize(\"ITEM-PILES.ContextMenu.ShowToPlayers\"),\r\n    icon: `<i class=\"fas fa-eye\"></i>`,\r\n    callback: async (html) => {\r\n      const actorId = html[0].dataset.documentId;\r\n      const actor = game.actors.get(actorId);\r\n      const activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n      if (!activeUsers.length) {\r\n        return Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n      }\r\n      const users = await UserSelectDialog.show();\r\n      if (!users || !users.length) return;\r\n      Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: actor.name }))\r\n      return game.itempiles.API.renderItemPileInterface(actor, { userIds: users, useDefaultCharacter: true });\r\n    },\r\n    condition: (html) => {\r\n      const actorId = html[0].dataset.documentId;\r\n      const actor = game.actors.get(actorId);\r\n      return game.user.isGM && PileUtilities.isValidItemPile(actor);\r\n    }\r\n  }, {\r\n    name: \"Item Piles: \" + game.i18n.localize(\"ITEM-PILES.ContextMenu.RequestTrade\"),\r\n    icon: `<i class=\"fas fa-handshake\"></i>`,\r\n    callback: (html) => {\r\n      const actorId = html[0].dataset.documentId;\r\n      const actor = game.actors.get(actorId);\r\n      const user = Array.from(game.users).find(u => u.character === actor && u.active);\r\n      return game.itempiles.API.requestTrade(user);\r\n    },\r\n    condition: (html) => {\r\n      const actorId = html[0].dataset.documentId;\r\n      const actor = game.actors.get(actorId);\r\n      return Helpers.getSetting(SETTINGS.ENABLE_TRADING)\r\n        && (game.user?.character !== actor || Array.from(game.users).find(u => u.character === actor && u.active));\r\n    }\r\n  });\r\n}\r\n\r\nfunction insertActorHeaderButtons(actorSheet, buttons) {\r\n\r\n  if (!game.user.isGM || Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_BUTTON)) return;\r\n\r\n  let obj = actorSheet.object;\r\n\r\n  buttons.unshift({\r\n    label: Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"\" : \"Configure\",\r\n    icon: \"fas fa-box-open\",\r\n    class: \"item-piles-config-button\",\r\n    onclick: () => {\r\n      ItemPileConfig.show(obj);\r\n    }\r\n  })\r\n}\r\n\r\nfunction insertItemHeaderButtons(itemSheet, buttons) {\r\n\r\n  if (!game.user.isGM || Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_BUTTON)) return;\r\n\r\n  let obj = itemSheet.object;\r\n\r\n  buttons.unshift({\r\n    label: Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"\" : \"Configure\",\r\n    icon: \"fas fa-box-open\",\r\n    class: \"item-piles-config-button\",\r\n    onclick: () => {\r\n      ItemEditor.show(obj);\r\n    }\r\n  })\r\n}\r\n\r\nfunction renderPileHUD(app, html) {\r\n\r\n  const document = app?.object?.document;\r\n\r\n  if (!document) return;\r\n\r\n  if (!PileUtilities.isValidItemPile(document)) return;\r\n\r\n  if (PileUtilities.isItemPileContainer(document)) {\r\n\r\n    const pileData = PileUtilities.getActorFlagData(document);\r\n\r\n    const container = $(`<div class=\"col right\" style=\"right:-130px;\"></div>`);\r\n\r\n    const lock_button = $(`<div class=\"control-icon item-piles\" data-tooltip=\"${game.i18n.localize(\"ITEM-PILES.HUD.ToggleLocked\")}\"><i class=\"fas fa-lock${pileData.locked ? \"\" : \"-open\"}\"></i></div>`);\r\n    lock_button.click(async function () {\r\n      $(this).find('.fas').toggleClass('fa-lock').toggleClass('fa-lock-open');\r\n      await game.itempiles.API.toggleItemPileLocked(document);\r\n    });\r\n    container.append(lock_button);\r\n\r\n    const open_button = $(`<div class=\"control-icon item-piles\" data-tooltip=\"${game.i18n.localize(\"ITEM-PILES.HUD.ToggleClosed\")}\"><i class=\"fas fa-box${pileData.closed ? \"\" : \"-open\"}\"></i></div>`);\r\n    open_button.click(async function () {\r\n      $(this).find('.fas').toggleClass('fa-box').toggleClass('fa-box-open');\r\n      await game.itempiles.API.toggleItemPileClosed(document);\r\n    });\r\n    container.append(open_button);\r\n\r\n    const configure_button = $(`<div class=\"control-icon item-piles\" data-tooltip=\"${game.i18n.localize(\"ITEM-PILES.HUD.Configure\")}\"><i class=\"fas fa-toolbox\"></i></div>`);\r\n    configure_button.click(async function () {\r\n      ItemPileConfig.show(document);\r\n    });\r\n    container.append(configure_button);\r\n\r\n    html.append(container)\r\n\r\n  }\r\n\r\n}\r\n\r\nclass FastTooltipManager extends TooltipManager {\r\n\r\n  /**\r\n   * A cached reference to the global tooltip element\r\n   * @type {HTMLElement}\r\n   */\r\n  tooltip = document.getElementById(\"tooltip\");\r\n\r\n  /**\r\n   * A reference to the HTML element which is currently tool-tipped, if any.\r\n   * @type {HTMLElement|null}\r\n   */\r\n  element = null;\r\n\r\n  /**\r\n   * An amount of margin which is used to offset tooltips from their anchored element.\r\n   * @type {number}\r\n   */\r\n  static TOOLTIP_MARGIN_PX = 5;\r\n\r\n  /**\r\n   * The number of milliseconds delay which activates a tooltip on a \"long hover\".\r\n   * @type {number}\r\n   */\r\n  static TOOLTIP_ACTIVATION_MS = 500;\r\n\r\n  /**\r\n   * The number of milliseconds delay which activates a tooltip on a \"long hover\".\r\n   * @type {number}\r\n   */\r\n  static TOOLTIP_DEACTIVATION_MS = 500;\r\n\r\n  /**\r\n   * The directions in which a tooltip can extend, relative to its tool-tipped element.\r\n   * @enum {string}\r\n   */\r\n  static TOOLTIP_DIRECTIONS = {\r\n    UP: \"UP\",\r\n    DOWN: \"DOWN\",\r\n    LEFT: \"LEFT\",\r\n    RIGHT: \"RIGHT\",\r\n    CENTER: \"CENTER\"\r\n  };\r\n\r\n  /**\r\n   * Is the tooltip currently active?\r\n   * @type {boolean}\r\n   */\r\n  #active = false;\r\n\r\n  /**\r\n   * A reference to a window timeout function when an element is activated.\r\n   * @private\r\n   */\r\n  #activationTimeout;\r\n\r\n  /**\r\n   * A reference to a window timeout function when an element is deactivated.\r\n   * @private\r\n   */\r\n  #deactivationTimeout;\r\n\r\n  /**\r\n   * An element which is pending tooltip activation if hover is sustained\r\n   * @type {HTMLElement|null}\r\n   */\r\n  #pending;\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /**\r\n   * Activate interactivity by listening for hover events on HTML elements which have a data-tooltip defined.\r\n   */\r\n  activateEventListeners() {\r\n    document.body.addEventListener(\"pointerenter\", this.#onActivate.bind(this), true);\r\n    document.body.addEventListener(\"pointerleave\", this.#onDeactivate.bind(this), true);\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /**\r\n   * Handle hover events which activate a tooltipped element.\r\n   * @param {PointerEvent} event    The initiating pointerenter event\r\n   */\r\n  #onActivate(event) {\r\n    if (Tour.tourInProgress) return; // Don't activate tooltips during a tour\r\n    const element = event.target;\r\n    if (!element.dataset.tooltip) {\r\n      // Check if the element has moved out from underneath the cursor and pointerenter has fired on a non-child of the\r\n      // tooltipped element.\r\n      if (this.#active && !this.element.contains(element)) this.#startDeactivation();\r\n      return;\r\n    }\r\n\r\n    // Don't activate tooltips if the element contains an active context menu\r\n    if (element.matches(\"#context-menu\") || element.querySelector(\"#context-menu\")) return;\r\n\r\n    // If the tooltip is currently active, we can move it to a new element immediately\r\n    if (this.#active) this.activate(element);\r\n    else this.#clearDeactivation();\r\n\r\n    // Otherwise, delay activation to determine user intent\r\n    this.#pending = element;\r\n    this.#activationTimeout = window.setTimeout(() => {\r\n      this.activate(element);\r\n    }, Number(element?.dataset?.tooltipActivationSpeed) ?? this.constructor.TOOLTIP_ACTIVATION_MS);\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /**\r\n   * Handle hover events which deactivate a tooltipped element.\r\n   * @param {PointerEvent} event    The initiating pointerleave event\r\n   */\r\n  #onDeactivate(event) {\r\n    if (event.target !== (this.element ?? this.#pending)) return;\r\n    this.#startDeactivation();\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /**\r\n   * Start the deactivation process.\r\n   */\r\n  #startDeactivation() {\r\n    // Clear any existing activation workflow\r\n    window.clearTimeout(this.#activationTimeout);\r\n    this.#pending = this.#activationTimeout = null;\r\n\r\n    // Delay deactivation to confirm whether some new element is now pending\r\n    window.clearTimeout(this.#deactivationTimeout);\r\n    this.#deactivationTimeout = window.setTimeout(() => {\r\n      if (!this.#pending) this.deactivate();\r\n    }, Number(this.element?.dataset?.tooltipDeactivationSpeed) ?? this.constructor.TOOLTIP_DEACTIVATION_MS);\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /**\r\n   * Clear any existing deactivation workflow.\r\n   */\r\n  #clearDeactivation() {\r\n    window.clearTimeout(this.#deactivationTimeout);\r\n    this.#pending = this.#deactivationTimeout = null;\r\n  }\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport { hotkeyActionState } from \"./hotkeys.js\";\r\nimport PrivateAPI from \"./API/private-api.js\";\r\nimport * as PileUtilities from \"./helpers/pile-utilities.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\n\r\nexport default function registerLibwrappers() {\r\n\r\n  libWrapper.register(CONSTANTS.MODULE_NAME, 'Token.prototype._onClickLeft2', function (wrapped, ...args) {\r\n    if (PileUtilities.isValidItemPile(this.document) && hotkeyActionState.openPileInventory) {\r\n      return PrivateAPI._itemPileClicked(this.document);\r\n    }\r\n    return wrapped(...args);\r\n  }, \"MIXED\");\r\n\r\n  const versionIsEleven = foundry.utils.isNewerVersion(game.version, \"10.999\");\r\n\r\n  const overrideMethod = versionIsEleven\r\n    ? `DocumentDirectory.prototype._onClickEntryName`\r\n    : `SidebarDirectory.prototype._onClickDocumentName`;\r\n\r\n  libWrapper.register(CONSTANTS.MODULE_NAME, overrideMethod, function (wrapped, event) {\r\n    event.preventDefault();\r\n    const element = event.currentTarget;\r\n    const documentId = element.parentElement.dataset.documentId;\r\n    const document = this.constructor.collection.get(documentId);\r\n    if (PileUtilities.isValidItemPile(document)) {\r\n      const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_DIRECTORY_CLICK, document);\r\n      if (hookResult === false) return false;\r\n    }\r\n    return wrapped(event);\r\n  }, \"MIXED\");\r\n\r\n  libWrapper.register(CONSTANTS.MODULE_NAME, `ActorSheet.prototype.render`, function (wrapped, forced, options, ...args) {\r\n    const renderItemPileInterface = forced && !options?.bypassItemPiles && PileUtilities.isValidItemPile(this.document) && hotkeyActionState.openPileInventory;\r\n    if (this._state > Application.RENDER_STATES.NONE) {\r\n      if (renderItemPileInterface) {\r\n        wrapped(forced, options, ...args)\r\n      } else {\r\n        return wrapped(forced, options, ...args)\r\n      }\r\n    }\r\n    if (renderItemPileInterface) {\r\n      game.itempiles.API.renderItemPileInterface(this.document, { useDefaultCharacter: true });\r\n      return;\r\n    }\r\n    return wrapped(forced, options, ...args);\r\n  }, \"MIXED\");\r\n\r\n}\r\n","import * as Helpers from \"../helpers/helpers.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport TradeAPI from \"./trade-api.js\";\r\nimport PrivateAPI from \"./private-api.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\n\r\nclass API {\r\n  /**\r\n   * @class API\r\n   */\r\n\r\n  /**\r\n   * The actor class type used for the original item pile actor in this system\r\n   *\r\n   * @returns {string}\r\n   */\r\n  static get ACTOR_CLASS_TYPE() {\r\n    return Helpers.getSetting(SETTINGS.ACTOR_CLASS_TYPE);\r\n  }\r\n\r\n  /**\r\n   * The currencies used in this system\r\n   *\r\n   * @returns {Array<{primary: boolean, name: string, data: Object, img: string, abbreviation: string, exchange: number}>}\r\n   */\r\n  static get CURRENCIES() {\r\n    return Helpers.getSetting(SETTINGS.CURRENCIES);\r\n  }\r\n\r\n  /**\r\n   * The secondary currencies used in this system\r\n   *\r\n   * @returns {Array<{name: string, data: Object, img: string, abbreviation: string}>}\r\n   */\r\n  static get SECONDARY_CURRENCIES() {\r\n    return Helpers.getSetting(SETTINGS.SECONDARY_CURRENCIES);\r\n  }\r\n\r\n  /**\r\n   * The smallest decimal digits shown for any fractional currency amounts. Only used when there is only one currency.\r\n   *\r\n   * @returns {Number}\r\n   */\r\n  static get CURRENCY_DECIMAL_DIGITS() {\r\n    return Helpers.getSetting(SETTINGS.CURRENCY_DECIMAL_DIGITS);\r\n  }\r\n\r\n  /**\r\n   * The attribute used to track the price of items in this system\r\n   *\r\n   * @returns {string}\r\n   */\r\n  static get ITEM_PRICE_ATTRIBUTE() {\r\n    return Helpers.getSetting(SETTINGS.ITEM_PRICE_ATTRIBUTE);\r\n  }\r\n\r\n  /**\r\n   * The attribute used to track the quantity of items you would get for the price of an item\r\n   *\r\n   * @returns {string}\r\n   */\r\n  static get QUANTITY_FOR_PRICE_ATTRIBUTE() {\r\n    return Helpers.getSetting(SETTINGS.QUANTITY_FOR_PRICE_ATTRIBUTE);\r\n  }\r\n\r\n  /**\r\n   * The attribute used to track the quantity of items in this system\r\n   *\r\n   * @returns {string}\r\n   */\r\n  static get ITEM_QUANTITY_ATTRIBUTE() {\r\n    return Helpers.getSetting(SETTINGS.ITEM_QUANTITY_ATTRIBUTE);\r\n  }\r\n\r\n  /**\r\n   * The filters for item types eligible for interaction within this system\r\n   *\r\n   * @returns {Array<{name: string, filters: string}>}\r\n   */\r\n  static get ITEM_FILTERS() {\r\n    return Helpers.getSetting(SETTINGS.ITEM_FILTERS);\r\n  }\r\n\r\n  /**\r\n   * The attributes for detecting item similarities\r\n   *\r\n   * @returns {Array<string>}\r\n   */\r\n  static get ITEM_SIMILARITIES() {\r\n    return Helpers.getSetting(SETTINGS.ITEM_SIMILARITIES);\r\n  }\r\n\r\n  /**\r\n   * The types of items that will always be considered unique when transferring between actors\r\n   *\r\n   * @returns {Array<string>}\r\n   */\r\n  static get UNSTACKABLE_ITEM_TYPES() {\r\n    return Helpers.getSetting(SETTINGS.UNSTACKABLE_ITEM_TYPES);\r\n  }\r\n\r\n  /**\r\n   * The system specific default values for item pile actors created in this system\r\n   *\r\n   * @returns {Object}\r\n   */\r\n  static get PILE_DEFAULTS() {\r\n    return Helpers.getSetting(SETTINGS.PILE_DEFAULTS);\r\n  }\r\n\r\n  /**\r\n   * The system specific default values for item pile tokens created in this system\r\n   *\r\n   * @returns {Object}\r\n   */\r\n  static get TOKEN_FLAG_DEFAULTS() {\r\n    return Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS);\r\n  }\r\n\r\n  /**\r\n   * Sets the actor class type used for the original item pile actor in this system\r\n   *\r\n   * @param {string} inClassType\r\n   * @returns {Promise}\r\n   */\r\n  static async setActorClassType(inClassType) {\r\n    if (typeof inClassType !== \"string\") {\r\n      throw Helpers.custom_error(\"setActorTypeClass | inClassType must be of type string\");\r\n    }\r\n    return Helpers.setSetting(SETTINGS.ACTOR_CLASS_TYPE, inClassType);\r\n  }\r\n\r\n  /**\r\n   * Sets the currencies used in this system\r\n   *\r\n   * @param {Array<Object>} inCurrencies\r\n   * @returns {Promise}\r\n   */\r\n  static async setCurrencies(inCurrencies) {\r\n    if (!Array.isArray(inCurrencies)) {\r\n      throw Helpers.custom_error(\"setCurrencies | inCurrencies must be an array\");\r\n    }\r\n    inCurrencies.forEach(currency => {\r\n      if (typeof currency !== \"object\") {\r\n        throw Helpers.custom_error(\"setCurrencies | each entry in inCurrencies must be of type object\");\r\n      }\r\n      if (typeof currency.primary !== \"boolean\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.primary must be of type boolean\");\r\n      }\r\n      if (typeof currency.name !== \"string\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.name must be of type string\");\r\n      }\r\n      if (typeof currency.abbreviation !== \"string\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.abbreviation must be of type string\");\r\n      }\r\n      if (typeof currency.exchangeRate !== \"number\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.exchangeRate must be of type number\");\r\n      }\r\n      if (typeof currency.data !== \"object\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.data must be of type object\");\r\n      }\r\n      if (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n      }\r\n      if (currency.img && typeof currency.img !== \"string\") {\r\n        throw Helpers.custom_error(\"setCurrencies | currency.img must be of type string\");\r\n      }\r\n    });\r\n    return Helpers.setSetting(SETTINGS.CURRENCIES, inCurrencies);\r\n  }\r\n\r\n  /**\r\n   * Sets the secondary currencies used in this system\r\n   *\r\n   * @param {Array<Object>} inSecondaryCurrencies\r\n   * @returns {Promise}\r\n   */\r\n  static async setSecondaryCurrencies(inSecondaryCurrencies) {\r\n    if (!Array.isArray(inSecondaryCurrencies)) {\r\n      throw Helpers.custom_error(\"setSecondaryCurrencies | inSecondaryCurrencies must be an array\");\r\n    }\r\n    inSecondaryCurrencies.forEach(currency => {\r\n      if (typeof currency !== \"object\") {\r\n        throw Helpers.custom_error(\"setSecondaryCurrencies | each entry in inSecondaryCurrencies must be of type object\");\r\n      }\r\n      if (typeof currency.name !== \"string\") {\r\n        throw Helpers.custom_error(\"setSecondaryCurrencies | currency.name must be of type string\");\r\n      }\r\n      if (typeof currency.abbreviation !== \"string\") {\r\n        throw Helpers.custom_error(\"setSecondaryCurrencies | currency.abbreviation must be of type string\");\r\n      }\r\n      if (typeof currency.data !== \"object\") {\r\n        throw Helpers.custom_error(\"setSecondaryCurrencies | currency.data must be of type object\");\r\n      }\r\n      if (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n        throw Helpers.custom_error(\"setSecondaryCurrencies | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n      }\r\n      if (currency.img && typeof currency.img !== \"string\") {\r\n        throw Helpers.custom_error(\"setSecondaryCurrencies | currency.img must be of type string\");\r\n      }\r\n    });\r\n    return Helpers.setSetting(SETTINGS.SECONDARY_CURRENCIES, inSecondaryCurrencies);\r\n  }\r\n\r\n  /**\r\n   * Set the smallest decimal digits shown for any fractional currency amounts. Only used when there is only one currency.\r\n   *\r\n   * @param {Number} inDecimalDigits\r\n   * @returns {Promise}\r\n   */\r\n  static setCurrencyDecimalDigits(inDecimalDigits) {\r\n    if (typeof inDecimalDigits !== \"number\") {\r\n      throw Helpers.custom_error(\"setCurrencyDecimalDigits | inDecimalDigits must be of type string\");\r\n    }\r\n    return Helpers.setSetting(SETTINGS.CURRENCY_DECIMAL_DIGITS, inDecimalDigits);\r\n  }\r\n\r\n  /**\r\n   * Sets the attribute used to track the quantity of items in this system\r\n   *\r\n   * @param {string} inAttribute\r\n   * @returns {Promise}\r\n   */\r\n  static async setItemQuantityAttribute(inAttribute) {\r\n    if (typeof inAttribute !== \"string\") {\r\n      throw Helpers.custom_error(\"setItemQuantityAttribute | inAttribute must be of type string\");\r\n    }\r\n    return Helpers.setSetting(SETTINGS.ITEM_QUANTITY_ATTRIBUTE, inAttribute);\r\n  }\r\n\r\n  /**\r\n   * Sets the attribute used to track the price of items in this system\r\n   *\r\n   * @param {string} inAttribute\r\n   * @returns {Promise}\r\n   */\r\n  static async setItemPriceAttribute(inAttribute) {\r\n    if (typeof inAttribute !== \"string\") {\r\n      throw Helpers.custom_error(\"setItemPriceAttribute | inAttribute must be of type string\");\r\n    }\r\n    return Helpers.setSetting(SETTINGS.ITEM_PRICE_ATTRIBUTE, inAttribute);\r\n  }\r\n\r\n  /**\r\n   * Sets the attribute used to track the price of items in this system\r\n   *\r\n   * @param {string} inAttribute\r\n   * @returns {Promise}\r\n   */\r\n  static async setQuantityForPriceAttribute(inAttribute) {\r\n    if (typeof inAttribute !== \"string\") {\r\n      throw Helpers.custom_error(\"setQuantityForPriceAttribute | inAttribute must be of type string\");\r\n    }\r\n    return Helpers.setSetting(SETTINGS.QUANTITY_FOR_PRICE_ATTRIBUTE, inAttribute);\r\n  }\r\n\r\n  /**\r\n   * Sets the items filters for interaction within this system\r\n   *\r\n   * @param {Array<{path: string, filters: string}>} inFilters\r\n   * @returns {Promise}\r\n   */\r\n  static async setItemFilters(inFilters) {\r\n    if (!Array.isArray(inFilters)) {\r\n      throw Helpers.custom_error(\"setItemFilters | inFilters must be of type array\");\r\n    }\r\n    inFilters.forEach(filter => {\r\n      if (typeof filter?.path !== \"string\") {\r\n        throw Helpers.custom_error(\"setItemFilters | each entry in inFilters must have a \\\"path\\\" property with a value that is of type string\");\r\n      }\r\n      if (typeof filter?.filters !== \"string\") {\r\n        throw Helpers.custom_error(\"setItemFilters | each entry in inFilters must have a \\\"filters\\\" property with a value that is of type string\");\r\n      }\r\n    });\r\n    return Helpers.setSetting(SETTINGS.ITEM_FILTERS, inFilters);\r\n  }\r\n\r\n  /**\r\n   * Sets the attributes for detecting item similarities\r\n   *\r\n   * @param {Array<string>} inPaths\r\n   * @returns {Promise}\r\n   */\r\n  static async setItemSimilarities(inPaths) {\r\n    if (!Array.isArray(inPaths)) {\r\n      throw Helpers.custom_error(\"setItemSimilarities | inPaths must be of type array\");\r\n    }\r\n    inPaths.forEach(path => {\r\n      if (typeof path !== \"string\") {\r\n        throw Helpers.custom_error(\"setItemSimilarities | each entry in inPaths must be of type string\");\r\n      }\r\n    });\r\n    return Helpers.setSetting(SETTINGS.ITEM_SIMILARITIES, inPaths);\r\n  }\r\n\r\n  /**\r\n   * Sets the types of items that will always be considered unique when transferring between actors\r\n   *\r\n   * @param {Array<string>} inTypes\r\n   * @returns {Promise}\r\n   */\r\n  static async setUnstackableItemTypes(inTypes) {\r\n    if (!Array.isArray(inTypes)) {\r\n      throw Helpers.custom_error(\"setUnstackableItemTypes | inTypes must be of type array\");\r\n    }\r\n    inTypes.forEach(path => {\r\n      if (typeof path !== \"string\") {\r\n        throw Helpers.custom_error(\"setUnstackableItemTypes | each entry in inTypes must be of type string\");\r\n      }\r\n    });\r\n    return Helpers.setSetting(SETTINGS.UNSTACKABLE_ITEM_TYPES, inTypes);\r\n  }\r\n\r\n  /**\r\n   * Sets the types of items that will always be considered unique when transferring between actors\r\n   *\r\n   * @param {Object} inDefaults\r\n   * @returns {Promise}\r\n   */\r\n  static async setPileDefaults(inDefaults) {\r\n    if (typeof inDefaults !== \"object\") {\r\n      throw Helpers.custom_error(\"setPileDefaults | inDefaults must be of type object\");\r\n    }\r\n    const validKeys = new Set(Object.keys(CONSTANTS.PILE_DEFAULTS));\r\n    for (const key of Object.keys(inDefaults)) {\r\n      if (!validKeys.has(key)) {\r\n        throw Helpers.custom_error(`setPileDefaults | ${key} is not a valid pile setting`);\r\n      }\r\n    }\r\n    return Helpers.setSetting(SETTINGS.PILE_DEFAULTS, inDefaults);\r\n  }\r\n\r\n  /**\r\n   * Set the flags that will be applied to any tokens created through item piles\r\n   *\r\n   * @param {Object} inDefaults\r\n   * @returns {Promise}\r\n   */\r\n  static async setTokenFlagDefaults(inDefaults) {\r\n    if (typeof inDefaults !== \"object\") {\r\n      throw Helpers.custom_error(\"setTokenFlagDefaults | inDefaults must be of type object\");\r\n    }\r\n    return Helpers.setSetting(SETTINGS.TOKEN_FLAG_DEFAULTS, inDefaults);\r\n  }\r\n\r\n  /**\r\n   * A combination of all the methods above, but this integrates a system's specific\r\n   * settings more readily into item piles, allowing users to also change the settings\r\n   * afterwards.\r\n   *\r\n   * @param {Object<{\r\n   *   VERSION: string,\r\n   *   ACTOR_CLASS_TYPE: string,\r\n   *   ITEM_QUANTITY_ATTRIBUTE: string,\r\n   *   ITEM_PRICE_ATTRIBUTE: string,\r\n   *   QUANTITY_FOR_PRICE_ATTRIBUTE: string,\r\n   *   ITEM_FILTERS: Array<{path: string, filters: string}>,\r\n   *   ITEM_SIMILARITIES: Array<string>,\r\n   *   UNSTACKABLE_ITEM_TYPES: Array<string>,\r\n   *   PILE_DEFAULTS: Object,\r\n   *   TOKEN_FLAG_DEFAULTS: Object,\r\n   *   ITEM_TRANSFORMER: undefined/Function,\r\n   *   CURRENCIES: Array<{\r\n   *     primary: boolean,\r\n   *     type: string [\"attribute\"/\"item\"],\r\n   *     img: string,\r\n   *     abbreviation: string,\r\n   *     data: Object<{ path: string }|{ uuid: string }|{ item: object }>,\r\n   *     exchangeRate: number\r\n   *   }>,\r\n   *   SECONDARY_CURRENCIES: Array<{\r\n   *     type: string [\"attribute\"/\"item\"],\r\n   *     img: string,\r\n   *     abbreviation: string,\r\n   *     data: Object<{ path: string }|{ uuid: string }|{ item: object }>\r\n   *   }>,\r\n   *   CURRENCY_DECIMAL_DIGITS: undefined/number\r\n   * }>} inData\r\n   */\r\n  static addSystemIntegration(inData) {\r\n\r\n    const data = foundry.utils.mergeObject({\r\n      VERSION: \"\",\r\n      ACTOR_CLASS_TYPE: \"\",\r\n      ITEM_QUANTITY_ATTRIBUTE: \"\",\r\n      ITEM_PRICE_ATTRIBUTE: \"\",\r\n      QUANTITY_FOR_PRICE_ATTRIBUTE: \"flags.item-piles.system.quantityForPrice\",\r\n      ITEM_FILTERS: [],\r\n      ITEM_SIMILARITIES: [],\r\n      UNSTACKABLE_ITEM_TYPES: [],\r\n      PILE_DEFAULTS: {},\r\n      TOKEN_FLAG_DEFAULTS: {},\r\n      ITEM_TRANSFORMER: null,\r\n      CURRENCIES: [],\r\n      SECONDARY_CURRENCIES: [],\r\n      CURRENCY_DECIMAL_DIGITS: 0.00001\r\n    }, inData)\r\n\r\n    if (typeof data[\"VERSION\"] !== \"string\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.VERSION must be of type string\");\r\n    }\r\n\r\n    if (typeof data[\"ACTOR_CLASS_TYPE\"] !== \"string\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.ACTOR_CLASS_TYPE must be of type string\");\r\n    }\r\n\r\n    if (typeof data[\"ITEM_QUANTITY_ATTRIBUTE\"] !== \"string\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.ITEM_QUANTITY_ATTRIBUTE must be of type string\");\r\n    }\r\n\r\n    if (typeof data[\"ITEM_PRICE_ATTRIBUTE\"] !== \"string\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.ITEM_PRICE_ATTRIBUTE must be of type string\");\r\n    }\r\n\r\n    if (data[\"QUANTITY_FOR_PRICE_ATTRIBUTE\"] && typeof data[\"QUANTITY_FOR_PRICE_ATTRIBUTE\"] !== \"string\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.QUANTITY_FOR_PRICE_ATTRIBUTE must be of type string\");\r\n    }\r\n\r\n    if (!Array.isArray(data[\"ITEM_FILTERS\"])) {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.ITEM_FILTERS must be of type array\");\r\n    }\r\n\r\n    data[\"ITEM_FILTERS\"].forEach(filter => {\r\n      if (typeof filter?.path !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | each entry in data.ITEM_FILTERS must have a \\\"path\\\" property with a value that is of type string\");\r\n      }\r\n      if (typeof filter?.filters !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | each entry in data.ITEM_FILTERS must have a \\\"filters\\\" property with a value that is of type string\");\r\n      }\r\n    });\r\n\r\n    if (data['ITEM_TRANSFORMER']) {\r\n      if (!Helpers.isFunction(data['ITEM_TRANSFORMER'])) {\r\n        throw Helpers.custom_error(\"addSystemIntegration | data.ITEM_TRANSFORMER must be of type function\");\r\n      }\r\n      if (typeof data['ITEM_TRANSFORMER']({}) !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | data.ITEM_TRANSFORMER's return value must be of type object\");\r\n      }\r\n    }\r\n\r\n    if (typeof data['PILE_DEFAULTS'] !== \"object\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.PILE_DEFAULTS must be of type object\");\r\n    }\r\n    const validKeys = new Set(Object.keys(CONSTANTS.PILE_DEFAULTS));\r\n    for (const key of Object.keys(data['PILE_DEFAULTS'])) {\r\n      if (!validKeys.has(key)) {\r\n        throw Helpers.custom_error(`addSystemIntegration | data.PILE_DEFAULTS contains illegal key \"${key}\" that is not a valid pile default`);\r\n      }\r\n    }\r\n\r\n    if (typeof data['TOKEN_FLAG_DEFAULTS'] !== \"object\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.TOKEN_FLAG_DEFAULTS must be of type object\");\r\n    }\r\n\r\n    if (!Array.isArray(data['ITEM_SIMILARITIES'])) {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.ITEM_SIMILARITIES must be of type array\");\r\n    }\r\n    data['ITEM_SIMILARITIES'].forEach(path => {\r\n      if (typeof path !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | each entry in data.ITEM_SIMILARITIES must be of type string\");\r\n      }\r\n    });\r\n\r\n    if (data['UNSTACKABLE_ITEM_TYPES']) {\r\n      if (!Array.isArray(data['UNSTACKABLE_ITEM_TYPES'])) {\r\n        throw Helpers.custom_error(\"addSystemIntegration | data.UNSTACKABLE_ITEM_TYPES must be of type array\");\r\n      }\r\n      data['UNSTACKABLE_ITEM_TYPES'].forEach(path => {\r\n        if (typeof path !== \"string\") {\r\n          throw Helpers.custom_error(\"addSystemIntegration | each entry in data.UNSTACKABLE_ITEM_TYPES must be of type string\");\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!Array.isArray(data['CURRENCIES'])) {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.CURRENCIES must be an array\");\r\n    }\r\n    data['CURRENCIES'].forEach(currency => {\r\n      if (typeof currency !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | each entry in data.CURRENCIES must be of type object\");\r\n      }\r\n      if (typeof currency.primary !== \"boolean\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.primary must be of type boolean\");\r\n      }\r\n      if (typeof currency.name !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.name must be of type string\");\r\n      }\r\n      if (typeof currency.abbreviation !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.abbreviation must be of type string\");\r\n      }\r\n      if (typeof currency.exchangeRate !== \"number\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.exchangeRate must be of type number\");\r\n      }\r\n      if (typeof currency.data !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.data must be of type object\");\r\n      }\r\n      if (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n      }\r\n      if (currency.img && typeof currency.img !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.img must be of type string\");\r\n      }\r\n    });\r\n\r\n    if (!Array.isArray(data['SECONDARY_CURRENCIES'])) {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.SECONDARY_CURRENCIES must be an array\");\r\n    }\r\n    data['SECONDARY_CURRENCIES'].forEach(currency => {\r\n      if (typeof currency !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | each entry in data.SECONDARY_CURRENCIES must be of type object\");\r\n      }\r\n      if (typeof currency.name !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.name must be of type string\");\r\n      }\r\n      if (typeof currency.abbreviation !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.abbreviation must be of type string\");\r\n      }\r\n      if (typeof currency.data !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.data must be of type object\");\r\n      }\r\n      if (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n      }\r\n      if (currency.img && typeof currency.img !== \"string\") {\r\n        throw Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.img must be of type string\");\r\n      }\r\n    });\r\n\r\n    if (data[\"CURRENCY_DECIMAL_DIGITS\"] && typeof data['CURRENCY_DECIMAL_DIGITS'] !== \"number\") {\r\n      throw Helpers.custom_error(\"addSystemIntegration | data.CURRENCY_DECIMAL_DIGITS must be of type number\");\r\n    }\r\n\r\n    data['INTEGRATION'] = true;\r\n\r\n    SYSTEMS.addSystem(data);\r\n\r\n    Helpers.debug(`Registered system settings for ${game.system.id}`, data)\r\n\r\n  }\r\n\r\n  static async getPrimaryCurrency(actor = false) {\r\n    if (actor && actor instanceof Actor) {\r\n      return PileUtilities.getActorPrimaryCurrency(actor);\r\n    }\r\n    return this.CURRENCIES.find(currency => currency.primary);\r\n  }\r\n\r\n  /* ================= ITEM PILE METHODS ================= */\r\n\r\n  /**\r\n   * Creates an item pile token at a location, or an item pile actor, or both at the same time.\r\n   *\r\n   * @param {object} options                                          Options to pass to the function\r\n   * @param {object/boolean} [options.position=false]                 Where to create the item pile, with x and y coordinates\r\n   * @param {string/boolean} [options.sceneId=game.user.viewedScene]  Which scene to create the item pile on\r\n   * @param {object} [options.tokenOverrides={}]                      Token data to apply to the newly created token\r\n   * @param {object} [options.actorOverrides={}]                      Actor data to apply to the newly created actor (if unlinked)\r\n   * @param {object} [options.itemPileFlags={}]                       Item pile specific flags to apply to the token and actor\r\n   * @param {Array/boolean} [options.items=false]                     Any items to create on the item pile\r\n   * @param {boolean} [options.createActor=false]                     Whether to create a new item pile actor\r\n   * @param {string/boolean} [options.actor=false]                    The UUID, ID, or name of the actor to use when creating this item pile\r\n   * @param {Array<string>/>string/boolean} [options.folders=false]   The folder to create the actor in, this can be an array of folder names, which will be traversed and created\r\n   *\r\n   * @returns {Promise<string>}\r\n   */\r\n  static async createItemPile({\r\n    position = false,\r\n    sceneId = game.user.viewedScene,\r\n    tokenOverrides = {},\r\n    actorOverrides = {},\r\n    itemPileFlags = {},\r\n    items = false,\r\n    createActor = false,\r\n    actor = false,\r\n    folders = false\r\n  } = {}) {\r\n\r\n    if (position) {\r\n      if (typeof position !== \"object\") {\r\n        throw Helpers.custom_error(`createItemPile | position must be of type object`);\r\n      } else if (!Helpers.isRealNumber(position.x) || !Helpers.isRealNumber(position.y)) {\r\n        throw Helpers.custom_error(`createItemPile | position.x and position.y must be of type numbers`);\r\n      }\r\n    }\r\n\r\n    if (folders) {\r\n      if (!Array.isArray(folders)) {\r\n        folders = [folders];\r\n      }\r\n      folders.forEach(f => {\r\n        if (typeof f !== 'string') {\r\n          throw Helpers.custom_error(`createItemPile | folder must be of type string or array of strings`);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (actor && !createActor) {\r\n      if (typeof actor !== \"string\") {\r\n        throw Helpers.custom_error(`createItemPile | actor must be of type string`);\r\n      }\r\n      let pileActor = await fromUuid(actor);\r\n      if (!pileActor) {\r\n        pileActor = game.actors.getName(actor);\r\n      }\r\n      if (!pileActor) {\r\n        pileActor = game.actors.get(actor);\r\n      }\r\n      if (!pileActor) {\r\n        throw Helpers.custom_error(`createItemPile | Could not find actor with the identifier of \"${actor}\"`);\r\n      }\r\n      actor = pileActor.uuid;\r\n    }\r\n\r\n    if (typeof sceneId !== \"string\") {\r\n      throw Helpers.custom_error(`createItemPile | sceneId must be of type string`);\r\n    }\r\n\r\n    if (typeof tokenOverrides !== \"object\") {\r\n      throw Helpers.custom_error(`createItemPile | tokenOverrides must be of type object`);\r\n    }\r\n\r\n    if (typeof actorOverrides !== \"object\") {\r\n      throw Helpers.custom_error(`createItemPile | tokenOverrides must be of type object`);\r\n    }\r\n\r\n    if (typeof itemPileFlags !== \"object\") {\r\n      throw Helpers.custom_error(`createItemPile | tokenOverrides must be of type object`);\r\n    }\r\n\r\n    if (items) {\r\n      if (!Array.isArray(items)) items = [items]\r\n      items = items.map(item => {\r\n        return item instanceof Item ? item.toObject() : item;\r\n      })\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.CREATE_PILE, {\r\n      sceneId, position, actor, createActor, items, tokenOverrides, actorOverrides, itemPileFlags, folders\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Turns tokens and its actors into item piles\r\n   *\r\n   * @param {Token/TokenDocument/Array<Token/TokenDocument>} targets  The targets to be turned into item piles\r\n   * @param {object} options                                          Options to pass to the function\r\n   * @param {object} options.pileSettings                             Overriding settings to be put on the item piles' settings\r\n   * @param {object/Function} options.tokenSettings                   Overriding settings that will update the tokens' settings\r\n   *\r\n   * @return {Promise<Array>}                                         The uuids of the targets after they were turned into item piles\r\n   */\r\n  static turnTokensIntoItemPiles(targets, { pileSettings = {}, tokenSettings = {} } = {}) {\r\n\r\n    if (!Array.isArray(targets)) targets = [targets];\r\n\r\n    const targetUuids = targets.map(target => {\r\n      if (!(target instanceof Token || target instanceof TokenDocument)) {\r\n        throw Helpers.custom_error(`turnTokensIntoItemPiles | Target must be of type Token or TokenDocument`)\r\n      }\r\n      const targetUuid = Utilities.getUuid(target);\r\n      if (!targetUuid) throw Helpers.custom_error(`turnTokensIntoItemPiles | Could not determine the UUID, please provide a valid target`)\r\n      return targetUuid;\r\n    })\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TURN_INTO_PILE, targetUuids, pileSettings, tokenSettings);\r\n  }\r\n\r\n  /**\r\n   * Reverts tokens from an item pile into a normal token and actor\r\n   *\r\n   * @param {Token/TokenDocument/Array<Token/TokenDocument>} targets  The targets to be reverted from item piles\r\n   * @param {object} options                                          Options to pass to the function\r\n   * @param {object/Function} options.tokenSettings                   Overriding settings that will update the tokens\r\n   *\r\n   * @return {Promise<Array>}                                         The uuids of the targets after they were reverted from being item piles\r\n   */\r\n  static revertTokensFromItemPiles(targets, { tokenSettings = {} } = {}) {\r\n\r\n    if (!Array.isArray(targets)) targets = [targets];\r\n\r\n    const targetUuids = targets.map(target => {\r\n      if (!(target instanceof Token || target instanceof TokenDocument)) {\r\n        throw Helpers.custom_error(`revertTokensFromItemPiles | Target must be of type Token or TokenDocument`)\r\n      }\r\n      const targetUuid = Utilities.getUuid(target);\r\n      if (!targetUuid) throw Helpers.custom_error(`revertTokensFromItemPiles | Could not determine the UUID, please provide a valid target`)\r\n      return targetUuid;\r\n    })\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REVERT_FROM_PILE, targetUuids, tokenSettings);\r\n  }\r\n\r\n  /**\r\n   * Opens a pile if it is enabled and a container\r\n   *\r\n   * @param {Token/TokenDocument} target\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise/boolean}\r\n   */\r\n  static openItemPile(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n    const wasLocked = pileData.locked;\r\n    const wasClosed = pileData.closed;\r\n    pileData.closed = false;\r\n    pileData.locked = false;\r\n    if (wasLocked) {\r\n      const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_UNLOCK, targetActor, pileData, interactingTokenDocument);\r\n      if (hookResult === false) return false;\r\n    }\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_OPEN, targetActor, pileData, interactingTokenDocument);\r\n    if (hookResult === false) return false;\r\n    if (wasClosed && pileData.openSound) {\r\n      let sound = pileData.openSound;\r\n      if (pileData.openSound.includes(\"*\")) {\r\n        sound = Helpers.random_array_element(pileData.openSounds)\r\n      }\r\n      AudioHelper.play({ src: sound }, true)\r\n    }\r\n    return this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n  }\r\n\r\n  /**\r\n   * Closes a pile if it is enabled and a container\r\n   *\r\n   * @param {Token/TokenDocument} target          Target pile to close\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise/boolean}\r\n   */\r\n  static closeItemPile(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n\r\n    const wasOpen = !pileData.closed;\r\n    pileData.closed = true;\r\n\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CLOSE, targetActor, pileData, interactingTokenDocument);\r\n    if (hookResult === false) return false;\r\n\r\n    if (wasOpen && pileData.closeSound) {\r\n      let sound = pileData.closeSound;\r\n      if (pileData.closeSound.includes(\"*\")) {\r\n        sound = Helpers.random_array_element(pileData.closeSounds)\r\n      }\r\n      AudioHelper.play({ src: sound }, true)\r\n    }\r\n\r\n    return this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n  }\r\n\r\n  /**\r\n   * Toggles a pile's closed state if it is enabled and a container\r\n   *\r\n   * @param {Token/TokenDocument} target          Target pile to open or close\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise/boolean}\r\n   */\r\n  static async toggleItemPileClosed(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n    if (pileData.closed) {\r\n      await this.openItemPile(targetActor, interactingTokenDocument);\r\n    } else {\r\n      await this.closeItemPile(targetActor, interactingTokenDocument);\r\n    }\r\n    return !pileData.closed;\r\n  }\r\n\r\n  /**\r\n   * Locks a pile if it is enabled and a container\r\n   *\r\n   * @param {Token/TokenDocument} target          Target pile to lock\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise/boolean}\r\n   */\r\n  static lockItemPile(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n    const wasClosed = pileData.closed;\r\n    pileData.closed = true;\r\n    pileData.locked = true;\r\n    if (!wasClosed) {\r\n      const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CLOSE, targetActor, pileData, interactingTokenDocument);\r\n      if (hookResult === false) return false;\r\n    }\r\n    const hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_LOCK, targetActor, pileData, interactingTokenDocument);\r\n    if (hookResult === false) return false;\r\n    if (!wasClosed && pileData.closeSound) {\r\n      let sound = pileData.closeSound;\r\n      if (pileData.closeSound.includes(\"*\")) {\r\n        sound = Helpers.random_array_element(pileData.closeSounds)\r\n      }\r\n      AudioHelper.play({ src: sound }, true)\r\n    }\r\n    return this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n  }\r\n\r\n  /**\r\n   * Unlocks a pile if it is enabled and a container\r\n   *\r\n   * @param {Token/TokenDocument} target          Target pile to unlock\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise/boolean}\r\n   */\r\n  static unlockItemPile(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n    pileData.locked = false;\r\n    Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_UNLOCK, targetActor, pileData, interactingTokenDocument);\r\n    return this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n  }\r\n\r\n  /**\r\n   * Toggles a pile's locked state if it is enabled and a container\r\n   *\r\n   * @param {Token/TokenDocument} target          Target pile to lock or unlock\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise/boolean}\r\n   */\r\n  static toggleItemPileLocked(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n    if (pileData.locked) {\r\n      return this.unlockItemPile(targetActor, interactingTokenDocument);\r\n    }\r\n    return this.lockItemPile(targetActor, interactingTokenDocument);\r\n  }\r\n\r\n  /**\r\n   * Causes the item pile to play a sound as it was attempted to be opened, but was locked\r\n   *\r\n   * @param {Token/TokenDocument} target\r\n   * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n   *\r\n   * @return {Promise<boolean>}\r\n   */\r\n  static rattleItemPile(target, interactingToken = false) {\r\n    const targetActor = Utilities.getActor(target);\r\n    if (!PileUtilities.isItemPileContainer(target)) return false;\r\n    const interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n    const pileData = PileUtilities.getActorFlagData(targetActor);\r\n\r\n    Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_RATTLE, targetActor, pileData, interactingTokenDocument);\r\n\r\n    if (pileData.lockedSound) {\r\n      let sound = pileData.lockedSound;\r\n      if (pileData.lockedSound.includes(\"*\")) {\r\n        sound = Helpers.random_array_element(pileData.lockedSounds)\r\n      }\r\n      AudioHelper.play({ src: sound }, true);\r\n    }\r\n\r\n    return ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.PILE.RATTLE, Utilities.getUuid(targetActor), pileData, Utilities.getUuid(interactingTokenDocument));\r\n  }\r\n\r\n  /**\r\n   * Whether an item pile is locked. If it is not enabled or not a container, it is always false.\r\n   *\r\n   * @param {Token/TokenDocument} target\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  static isItemPileLocked(target) {\r\n    return PileUtilities.isItemPileLocked(target);\r\n  }\r\n\r\n  /**\r\n   * Whether an item pile is closed. If it is not enabled or not a container, it is always false.\r\n   *\r\n   * @param {Token/TokenDocument} target\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  static isItemPileClosed(target) {\r\n    return PileUtilities.isItemPileClosed(target);\r\n  }\r\n\r\n  /**\r\n   * Whether an item pile is a container. If it is not enabled, it is always false.\r\n   *\r\n   * @param {Token/TokenDocument} target\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  static isItemPileContainer(target) {\r\n    return PileUtilities.isItemPileContainer(target);\r\n  }\r\n\r\n  /**\r\n   * Updates a pile with new data.\r\n   *\r\n   * @param {Actor/TokenDocument} target                                      Target token or actor to update\r\n   * @param {object} newData                                                  New data to update the actor with\r\n   * @param {object} options                                                  Options to pass to the function\r\n   * @param {Token/TokenDocument/boolean} [options.interactingToken=false]    If an actor caused this update, you can pass one here to pass it along to macros that the item pile may run\r\n   * @param {Object/boolean} [options.tokenSettings=false]                    Updates to make to the target token\r\n   *\r\n   * @return {Promise}\r\n   */\r\n  static updateItemPile(target, newData, { interactingToken = false, tokenSettings = false } = {}) {\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`updateItemPile | Could not determine the UUID, please provide a valid target`);\r\n\r\n    const interactingTokenUuid = interactingToken ? Utilities.getUuid(interactingToken) : false;\r\n    if (interactingToken && !interactingTokenUuid) throw Helpers.custom_error(`updateItemPile | Could not determine the UUID, please provide a valid target`);\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.UPDATE_PILE, targetUuid, newData, {\r\n      interactingTokenUuid, tokenSettings\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Deletes a pile, calling the relevant hooks.\r\n   *\r\n   * @param {Token/TokenDocument} target\r\n   *\r\n   * @return {Promise}\r\n   */\r\n  static deleteItemPile(target) {\r\n    if (!PileUtilities.isValidItemPile(target)) {\r\n      throw Helpers.custom_error(`deleteItemPile | This is not an item pile, please provide a valid target`);\r\n    }\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`deleteItemPile | Could not determine the UUID, please provide a valid target`);\r\n    if (!targetUuid.includes(\"Token\")) {\r\n      throw Helpers.custom_error(`deleteItemPile | Please provide a Token or TokenDocument`);\r\n    }\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DELETE_PILE, targetUuid);\r\n  }\r\n\r\n  /**\r\n   * Splits an item pile's content between all players (or a specified set of target actors).\r\n   *\r\n   * @param target {Token/TokenDocument/Actor}                                                  The item pile to split\r\n   * @param {object} options                                                                    Options to pass to the function\r\n   * @param {boolean/TokenDocument/Actor/Array<TokenDocument/Actor>} [options.targets=false]    The targets to receive the split contents\r\n   * @param {boolean/TokenDocument/Actor} [options.instigator=false]                            Whether this was triggered by a specific actor\r\n   *\r\n   * @returns {Promise<object/boolean>}\r\n   */\r\n  static async splitItemPileContents(target, { targets = false, instigator = false } = {}) {\r\n\r\n    if (!PileUtilities.isValidItemPile(target)) return false;\r\n\r\n    const itemPileUuid = Utilities.getUuid(target);\r\n    if (!itemPileUuid) throw Helpers.custom_error(`SplitItemPileContents | Could not determine the UUID, please provide a valid item pile`)\r\n\r\n    const itemPileActor = Utilities.getActor(target);\r\n\r\n    if (targets) {\r\n      if (!Array.isArray(targets)) {\r\n        targets = [targets]\r\n      }\r\n      targets.forEach(actor => {\r\n        if (!(actor instanceof TokenDocument || actor instanceof Actor)) {\r\n          throw Helpers.custom_error(\"SplitItemPileContents | Each of the entries in targets must be of type TokenDocument or Actor\")\r\n        }\r\n      })\r\n      targets = targets.map(target => Utilities.getActor(target));\r\n    }\r\n\r\n    if (instigator && !(instigator instanceof TokenDocument || instigator instanceof Actor)) {\r\n      throw Helpers.custom_error(\"SplitItemPileContents | instigator must be of type TokenDocument or Actor\")\r\n    }\r\n\r\n    const actorUuids = (targets || SharingUtilities.getPlayersForItemPile(itemPileActor)\r\n      .map(u => u.character))\r\n      .map(actor => Utilities.getUuid(actor));\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.SPLIT_PILE, itemPileUuid, actorUuids, game.user.id, instigator);\r\n\r\n  }\r\n\r\n  /* ================= ITEM AND ATTRIBUTE METHODS ================= */\r\n\r\n  /**\r\n   * Adds item to an actor, increasing item quantities if matches were found\r\n   *\r\n   * @param {Actor/TokenDocument/Token} target                  The target to add an item to\r\n   * @param {Array} items                                       An array of objects, with the key \"item\" being an item object or an Item class (the foundry class), with an optional key of \"quantity\" being the amount of the item to add\r\n   * @param {object} options                                    Options to pass to the function\r\n   * @param {boolean} [options.mergeSimilarItems=true]          Whether to merge similar items based on their name and type\r\n   * @param {boolean} [options.removeExistingActorItems=false]  Whether to remove the actor's existing items before adding the new ones\r\n   * @param {boolean} [options.skipVaultLogging=false]          Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n   *\r\n   * @returns {Promise<array>}                                  An array of objects, each containing the item that was added or updated, and the quantity that was added\r\n   */\r\n  static addItems(target, items, {\r\n    mergeSimilarItems = true, removeExistingActorItems = false, skipVaultLogging = false, interactionId = false\r\n  } = {}) {\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`addItems | Could not determine the UUID, please provide a valid target`)\r\n\r\n    const itemsToAdd = []\r\n    items.forEach(itemData => {\r\n\r\n      let item = itemData;\r\n      if (itemData instanceof Item) {\r\n        item = itemData.toObject();\r\n      } else if (itemData.item instanceof Item) {\r\n        item = itemData.item.toObject();\r\n        if (itemData.flags) {\r\n          setProperty(item, CONSTANTS.FLAGS.ITEM, getProperty(itemData, CONSTANTS.FLAGS.ITEM));\r\n        }\r\n      } else if (itemData.item) {\r\n        item = itemData.item;\r\n        if (itemData.flags) {\r\n          setProperty(item, CONSTANTS.FLAGS.ITEM, getProperty(itemData, CONSTANTS.FLAGS.ITEM));\r\n        }\r\n      } else if (itemData.id) {\r\n        item = target.items.get(itemData.id);\r\n        if (item) {\r\n          item = item.toObject();\r\n        } else {\r\n          throw Helpers.custom_error(`addItems | Could not find item with id ${itemData.id} on actor with UUID ${targetUuid}!`)\r\n        }\r\n      }\r\n\r\n      if (itemData?.quantity !== undefined) {\r\n        Utilities.setItemQuantity(item, itemData.quantity, true);\r\n      }\r\n\r\n      const existingItems = mergeSimilarItems ? Utilities.findSimilarItem(itemsToAdd, item) : false;\r\n      if (existingItems && PileUtilities.canItemStack(item, target)) {\r\n        Utilities.setItemQuantity(existingItems, Utilities.getItemQuantity(existingItems) + Utilities.getItemQuantity(item));\r\n      } else {\r\n        itemsToAdd.push(item);\r\n      }\r\n\r\n    });\r\n\r\n    if (interactionId && typeof interactionId !== \"string\") throw Helpers.custom_error(`addItems | interactionId must be of type string`);\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ADD_ITEMS, targetUuid, itemsToAdd, game.user.id, {\r\n      removeExistingActorItems, interactionId, skipVaultLogging\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Subtracts the quantity of items on an actor. If the quantity of an item reaches 0, the item is removed from the actor.\r\n   *\r\n   * @param {Actor/Token/TokenDocument} target                  The target to remove a items from\r\n   * @param {Array} items                                       An array of objects each containing the item id (key \"_id\") and the quantity to remove (key \"quantity\"), or Items (the foundry class) or strings of IDs to remove all quantities of\r\n   * @param {object} options                                    Options to pass to the function\r\n   * @param {boolean} [options.skipVaultLogging=false]          Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n   *\r\n   * @returns {Promise<array>}                                  An array of objects, each containing the item that was removed or updated, the quantity that was removed, and whether the item was deleted\r\n   */\r\n  static removeItems(target, items, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`removeItems | Could not determine the UUID, please provide a valid target`);\r\n\r\n    const targetActorItems = PileUtilities.getActorItems(target, { getItemCurrencies: true });\r\n\r\n    items = items.map(itemData => {\r\n\r\n      let item;\r\n      if (typeof itemData === \"string\" || itemData._id) {\r\n        const itemId = typeof itemData === \"string\" ? itemData : itemData._id;\r\n        item = targetActorItems.find(actorItem => actorItem.id === itemId);\r\n        if (!item) {\r\n          throw Helpers.custom_error(`removeItems | Could not find item with id \"${itemId}\" on target \"${targetUuid}\"`)\r\n        }\r\n        item = item.toObject();\r\n      } else {\r\n        if (itemData.item instanceof Item) {\r\n          item = itemData.item.toObject();\r\n        } else if (itemData instanceof Item) {\r\n          item = itemData.toObject();\r\n        } else {\r\n          item = itemData.item;\r\n        }\r\n        let foundActorItem = targetActorItems.find(actorItem => actorItem.id === item._id);\r\n        if (!foundActorItem) {\r\n          throw Helpers.custom_error(`removeItems | Could not find item with id \"${item._id}\" on target \"${targetUuid}\"`)\r\n        }\r\n      }\r\n\r\n      return {\r\n        _id: item._id, quantity: itemData?.quantity ?? Utilities.getItemQuantity(item)\r\n      }\r\n    });\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`removeItems | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REMOVE_ITEMS, targetUuid, items, game.user.id, {\r\n      interactionId,\r\n      skipVaultLogging\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Transfers items from the source to the target, subtracting a number of quantity from the source's item and adding it to the target's item, deleting items from the source if their quantity reaches 0\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source              The source to transfer the items from\r\n   * @param {Actor/Token/TokenDocument} target              The target to transfer the items to\r\n   * @param {Array} items                                   An array of objects each containing the item id (key \"_id\") and the quantity to transfer (key \"quantity\"), or Items (the foundry class) or strings of IDs to transfer all quantities of\r\n   * @param {object} options                                Options to pass to the function\r\n   * @param {boolean} [options.skipVaultLogging=false]      Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]  The interaction ID of this action\r\n   *\r\n   * @returns {Promise<object>}                             An array of objects, each containing the item that was added or updated, and the quantity that was transferred\r\n   */\r\n  static transferItems(source, target, items, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const sourceUuid = Utilities.getUuid(source);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferItems | Could not determine the UUID, please provide a valid source`)\r\n\r\n    const sourceActorItems = PileUtilities.getActorItems(source, { getItemCurrencies: true });\r\n\r\n    items = items.map(itemData => {\r\n\r\n      let item;\r\n      if (typeof itemData === \"string\" || itemData._id) {\r\n        const itemId = typeof itemData === \"string\" ? itemData : itemData._id;\r\n        item = sourceActorItems.find(actorItem => actorItem.id === itemId);\r\n        if (!item) {\r\n          throw Helpers.custom_error(`transferItems | Could not find item with id \"${itemId}\" on target \"${sourceUuid}\"`)\r\n        }\r\n        item = item.toObject();\r\n      } else if (itemData instanceof Item) {\r\n        item = itemData.toObject();\r\n      } else if (itemData.item instanceof Item) {\r\n        item = itemData.item.toObject();\r\n      } else {\r\n        item = itemData.item;\r\n      }\r\n\r\n      let foundActorItem = sourceActorItems.find(actorItem => actorItem.id === item._id);\r\n      if (!foundActorItem) {\r\n        throw Helpers.custom_error(`transferItems | Could not find item with id \"${item._id}\" on target \"${sourceUuid}\"`)\r\n      }\r\n\r\n      return {\r\n        _id: item._id,\r\n        quantity: Math.max(itemData?.quantity ?? Utilities.getItemQuantity(itemData), 0),\r\n        flags: getProperty(itemData, CONSTANTS.FLAGS.ITEM)\r\n      }\r\n    });\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferItems | Could not determine the UUID, please provide a valid target`)\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferItems | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ITEMS, sourceUuid, targetUuid, items, game.user.id, {\r\n      interactionId, skipVaultLogging\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Transfers all items between the source and the target.\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source                The actor to transfer all items from\r\n   * @param {Actor/Token/TokenDocument} target                The actor to receive all the items\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {Array/boolean} [options.itemFilters=false]       Array of item types disallowed - will default to module settings if none provided\r\n   * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n   *\r\n   * @returns {Promise<array>}                                An array containing all the items that were transferred to the target\r\n   */\r\n  static transferAllItems(source, target, {\r\n    itemFilters = false,\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceUuid = Utilities.getUuid(source);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferAllItems | Could not determine the UUID, please provide a valid source`)\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferAllItems | Could not determine the UUID, please provide a valid target`)\r\n\r\n    if (itemFilters) {\r\n      if (!Array.isArray(itemFilters)) throw Helpers.custom_error(`transferAllItems | itemFilters must be of type array`);\r\n      itemFilters.forEach(entry => {\r\n        if (typeof entry?.path !== \"string\") throw Helpers.custom_error(`transferAllItems | each entry in the itemFilters must have a \"path\" property that is of type string`);\r\n        if (typeof entry?.filter !== \"string\") throw Helpers.custom_error(`transferAllItems | each entry in the itemFilters must have a \"filter\" property that is of type string`);\r\n      })\r\n    }\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferAllItems | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ALL_ITEMS, sourceUuid, targetUuid, game.user.id, {\r\n      itemFilters, skipVaultLogging, interactionId\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Sets attributes on an actor\r\n   *\r\n   * @param {Actor/Token/TokenDocument} target                  The target whose attribute will have their quantity set\r\n   * @param {object} attributes                                 An object with each key being an attribute path, and its value being the quantity to set\r\n   * @param {object} options                                    Options to pass to the function\r\n   * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n   *\r\n   * @returns {Promise<object>}                                 An array containing a key value pair of the attribute path and the quantity of that attribute that was set\r\n   *\r\n   */\r\n  static setAttributes(target, attributes, { interactionId = false } = {}) {\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`setAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n    const targetActor = Utilities.getActor(target);\r\n\r\n    Object.entries(attributes).forEach(entry => {\r\n      const [attribute, quantity] = entry;\r\n      if (!hasProperty(targetActor, attribute)) {\r\n        throw Helpers.custom_error(`setAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n      }\r\n      if (!Helpers.isRealNumber(quantity)) {\r\n        throw Helpers.custom_error(`setAttributes | Attribute \"${attribute}\" must be of type number`);\r\n      }\r\n    });\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`setAttributes | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.SET_ATTRIBUTES, targetUuid, attributes, game.user.id, {\r\n      interactionId\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Adds attributes on an actor\r\n   *\r\n   * @param {Actor/Token/TokenDocument} target                  The target whose attribute will have a set quantity added to it\r\n   * @param {object} attributes                                 An object with each key being an attribute path, and its value being the quantity to add\r\n   * @param {object} options                                    Options to pass to the function\r\n   * @param {boolean} [options.skipVaultLogging=false]          Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n   *\r\n   * @returns {Promise<object>}                                 An array containing a key value pair of the attribute path and the quantity of that attribute that was added\r\n   *\r\n   */\r\n  static addAttributes(target, attributes, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`addAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n    const targetActor = Utilities.getActor(target);\r\n\r\n    Object.entries(attributes).forEach(entry => {\r\n      const [attribute, quantity] = entry;\r\n      if (!hasProperty(targetActor, attribute)) {\r\n        throw Helpers.custom_error(`addAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n      }\r\n      if (!Helpers.isRealNumber(quantity) && quantity > 0) {\r\n        throw Helpers.custom_error(`addAttributes | Attribute \"${attribute}\" must be of type number and greater than 0`);\r\n      }\r\n    });\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`addAttributes | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ADD_ATTRIBUTES, targetUuid, attributes, game.user.id, {\r\n      skipVaultLogging,\r\n      interactionId\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Subtracts attributes on the target\r\n   *\r\n   * @param {Token/TokenDocument} target                      The target whose attributes will be subtracted from\r\n   * @param {Array/object} attributes                         This can be either an array of attributes to subtract (to zero out a given attribute), or an object with each key being an attribute path, and its value being the quantity to subtract\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n   *\r\n   * @returns {Promise<object>}                               An array containing a key value pair of the attribute path and the quantity of that attribute that was removed\r\n   */\r\n  static removeAttributes(target, attributes, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`removeAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n    const targetActor = Utilities.getActor(target);\r\n\r\n    let attributesToSend = {};\r\n    if (Array.isArray(attributes)) {\r\n      attributes.forEach(attribute => {\r\n        if (typeof attribute !== \"string\") {\r\n          throw Helpers.custom_error(`removeAttributes | Each attribute in the array must be of type string`);\r\n        }\r\n        if (!hasProperty(targetActor, attribute)) {\r\n          throw Helpers.custom_error(`removeAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n        }\r\n        attributesToSend[attribute] = Number(getProperty(targetActor, attribute));\r\n      });\r\n    } else {\r\n      Object.entries(attributes).forEach(entry => {\r\n        const [attribute, quantity] = entry;\r\n        if (!hasProperty(targetActor, attribute)) {\r\n          throw Helpers.custom_error(`removeAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n        }\r\n        if (!Helpers.isRealNumber(quantity) && quantity > 0) {\r\n          throw Helpers.custom_error(`removeAttributes | Attribute \"${attribute}\" must be of type number and greater than 0`);\r\n        }\r\n      });\r\n      attributesToSend = attributes;\r\n    }\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`removeAttributes | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REMOVE_ATTRIBUTES, targetUuid, attributesToSend, game.user.id, {\r\n      skipVaultLogging,\r\n      interactionId\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Transfers a set quantity of an attribute from a source to a target, removing it or subtracting from the source and adds it the target\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source                The source to transfer the attribute from\r\n   * @param {Actor/Token/TokenDocument} target                The target to transfer the attribute to\r\n   * @param {Array/object} attributes                         This can be either an array of attributes to transfer (to transfer all of a given attribute), or an object with each key being an attribute path, and its value being the quantity to transfer\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n   *\r\n   * @returns {Promise<object>}                               An object containing a key value pair of each attribute transferred, the key being the attribute path and its value being the quantity that was transferred\r\n   */\r\n  static transferAttributes(source, target, attributes, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const sourceUuid = Utilities.getUuid(source);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferAttributes | Could not determine the UUID, please provide a valid source`);\r\n    const sourceActor = Utilities.getActor(source);\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferAttributes | Could not determine the UUID, please provide a valid target`);\r\n    const targetActor = Utilities.getActor(target);\r\n\r\n    if (Array.isArray(attributes)) {\r\n      attributes.forEach(attribute => {\r\n        if (typeof attribute !== \"string\") {\r\n          throw Helpers.custom_error(`transferAttributes | Each attribute in the array must be of type string`);\r\n        }\r\n        if (!hasProperty(sourceActor, attribute)) {\r\n          throw Helpers.custom_error(`transferAttributes | Could not find attribute ${attribute} on source's actor with UUID \"${targetUuid}\"`);\r\n        }\r\n        if (!hasProperty(targetActor, attribute)) {\r\n          throw Helpers.custom_error(`transferAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n        }\r\n      });\r\n    } else {\r\n      Object.entries(attributes).forEach(entry => {\r\n        const [attribute, quantity] = entry;\r\n        if (!hasProperty(sourceActor, attribute)) {\r\n          throw Helpers.custom_error(`transferAttributes | Could not find attribute ${attribute} on source's actor with UUID \"${targetUuid}\"`);\r\n        }\r\n        if (!hasProperty(targetActor, attribute)) {\r\n          throw Helpers.custom_error(`transferAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n        }\r\n        if (!Helpers.isRealNumber(quantity) && quantity > 0) {\r\n          throw Helpers.custom_error(`transferAttributes | Attribute \"${attribute}\" must be of type number and greater than 0`);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferAttributes | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ATTRIBUTES, sourceUuid, targetUuid, attributes, game.user.id, {\r\n      skipVaultLogging,\r\n      interactionId\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Transfers all dynamic attributes from a source to a target, removing it or subtracting from the source and adding them to the target\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source                The source to transfer the attributes from\r\n   * @param {Actor/Token/TokenDocument} target                The target to transfer the attributes to\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n   *\r\n   * @returns {Promise<object>}                               An object containing a key value pair of each attribute transferred, the key being the attribute path and its value being the quantity that was transferred\r\n   */\r\n  static transferAllAttributes(source, target, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n    const sourceUuid = Utilities.getUuid(source);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferAllAttributes | Could not determine the UUID, please provide a valid source`);\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferAllAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferAllAttributes | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ALL_ATTRIBUTES, sourceUuid, targetUuid, game.user.id, {\r\n      skipVaultLogging,\r\n      interactionId\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Transfers all items and attributes between the source and the target.\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source                The actor to transfer all items and attributes from\r\n   * @param {Actor/Token/TokenDocument} target                The actor to receive all the items and attributes\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {Array/boolean} [options.itemFilters=false]       Array of item types disallowed - will default to module settings if none provided\r\n   * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n   * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n   *\r\n   * @returns {Promise<object>}                               An object containing all items and attributes transferred to the target\r\n   */\r\n  static transferEverything(source, target, {\r\n    itemFilters = false,\r\n    skipVaultLogging = false,\r\n    interactionId = false\r\n  } = {}) {\r\n\r\n    const sourceUuid = Utilities.getUuid(source);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferEverything | Could not determine the UUID, please provide a valid source`);\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferEverything | Could not determine the UUID, please provide a valid target`);\r\n\r\n    if (itemFilters) {\r\n      if (!Array.isArray(itemFilters)) throw Helpers.custom_error(`transferEverything | itemFilters must be of type array`);\r\n      itemFilters.forEach(entry => {\r\n        if (typeof entry?.path !== \"string\") throw Helpers.custom_error(`transferEverything | each entry in the itemFilters must have a \"path\" property that is of type string`);\r\n        if (typeof entry?.filter !== \"string\") throw Helpers.custom_error(`transferEverything | each entry in the itemFilters must have a \"filter\" property that is of type string`);\r\n      })\r\n    }\r\n\r\n    if (interactionId) {\r\n      if (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferEverything | interactionId must be of type string`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_EVERYTHING, sourceUuid, targetUuid, game.user.id, {\r\n      itemFilters, skipVaultLogging, interactionId\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Turns a string of currencies into an array containing the data and quantities for each currency\r\n   *\r\n   * @param {string} currencies                               A string of currencies to convert (eg, \"5gp 25sp\")\r\n   *\r\n   * @returns {Array<object>}                                 An array of object containing the data and quantity for each currency\r\n   */\r\n  static getCurrenciesFromString(currencies) {\r\n    if (typeof currencies !== \"string\") {\r\n      throw Helpers.custom_error(`getCurrenciesFromString | currencies must be of type string`)\r\n    }\r\n    return PileUtilities.getPriceFromString(currencies).currencies;\r\n  }\r\n\r\n  /**\r\n   * Turns a string of currencies into an object containing payment data, and the change an optional target would receive back\r\n   *\r\n   * @param {string} price                                    A string of currencies to convert (eg, \"5gp 25sp\")\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {string/boolean} [options.target=false]           The target whose currencies to check against\r\n   *\r\n   * @returns {object}                                        An object containing the price data\r\n   */\r\n  static getPaymentDataFromString(price, { target = false } = {}) {\r\n\r\n    let targetActor = false;\r\n    if (target) {\r\n      targetActor = Utilities.getActor(target);\r\n      if (!targetActor) throw Helpers.custom_error(`removeCurrencies | Could not determine target actor`);\r\n    }\r\n\r\n    const priceData = PileUtilities.getPriceFromString(price)\r\n    const currenciesToRemove = priceData.currencies.filter(currency => currency.quantity);\r\n    const overallCost = priceData.overallCost;\r\n\r\n    if (!currenciesToRemove.length) {\r\n      throw Helpers.custom_error(`removeCurrencies | Could not determine currencies to remove with string \"${price}\"`);\r\n    }\r\n\r\n    return PileUtilities.getPaymentData({\r\n      purchaseData: [{ cost: overallCost, quantity: 1 }], buyer: targetActor\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Adds currencies to the target\r\n   *\r\n   * @param {Actor/Token/TokenDocument} target                The actor to add the currencies to\r\n   * @param {string} currencies                               A string of currencies to add (eg, \"5gp 25sp\")\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n   *\r\n   * @returns {Promise<object>}                               An object containing the items and attributes added to the target\r\n   */\r\n  static addCurrencies(target, currencies, { interactionId = false } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(target);\r\n    const targetUuid = Utilities.getUuid(targetActor);\r\n    if (!targetUuid) throw Helpers.custom_error(`addCurrency | Could not determine the UUID, please provide a valid target`);\r\n\r\n    if (typeof currencies !== \"string\") {\r\n      throw Helpers.custom_error(`addCurrency | currencies must be of type string`)\r\n    }\r\n\r\n    const currenciesToAdd = PileUtilities.getPriceFromString(currencies).currencies\r\n      .filter(currency => currency.quantity);\r\n\r\n    if (!currenciesToAdd.length) {\r\n      throw Helpers.custom_error(`addCurrency | Could not determine currencies to add with string \"${currencies}\"`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ADD_CURRENCIES, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n  }\r\n\r\n  /**\r\n   * Removes currencies from the target\r\n   *\r\n   * @param {Actor/Token/TokenDocument} target                The actor to remove currencies from\r\n   * @param {string} currencies                               A string of currencies to remove (eg, \"5gp 25sp\")\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {boolean} [options.change=true]                   Whether the actor can get change back\r\n   * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n   *\r\n   * @returns {Promise<object>}                               An object containing the items and attributes removed from the target\r\n   */\r\n  static removeCurrencies(target, currencies, { change = true, interactionId = false } = {}) {\r\n\r\n    const targetActor = Utilities.getActor(target);\r\n    const targetUuid = Utilities.getUuid(targetActor);\r\n    if (!targetUuid) throw Helpers.custom_error(`removeCurrencies | Could not determine the UUID, please provide a valid target`);\r\n\r\n    if (typeof currencies !== \"string\") {\r\n      throw Helpers.custom_error(`removeCurrencies | currencies must be of type string`)\r\n    }\r\n\r\n    const priceData = PileUtilities.getPriceFromString(currencies)\r\n    const currenciesToRemove = priceData.currencies.filter(currency => currency.quantity);\r\n    const overallCost = priceData.overallCost;\r\n\r\n    if (!currenciesToRemove.length) {\r\n      throw Helpers.custom_error(`removeCurrencies | Could not determine currencies to remove with string \"${currencies}\"`);\r\n    }\r\n\r\n    const paymentData = PileUtilities.getPaymentData({\r\n      purchaseData: [{ cost: overallCost, quantity: 1 }], buyer: targetActor\r\n    });\r\n\r\n    if (!paymentData.canBuy) {\r\n      throw Helpers.custom_error(`removeCurrencies | ${targetActor.name} cannot afford \"${currencies}\"`);\r\n    }\r\n\r\n    if (!change && paymentData.buyerChange.length) {\r\n      throw Helpers.custom_error(`removeCurrencies | ${targetActor.name} cannot afford \"${currencies}\" without receiving change!`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REMOVE_CURRENCIES, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n  }\r\n\r\n  /**\r\n   * Transfers currencies between the source and the target.\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source                The actor to transfer currencies from\r\n   * @param {Actor/Token/TokenDocument} target                The actor to receive the currencies\r\n   * @param {string} currencies                               A string of currencies to transfer (eg, \"5gp 25sp\")\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {boolean} [options.change=true]                   Whether the source actor can get change back\r\n   * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n   *\r\n   * @returns {Promise<object>}                               An object containing the items and attributes transferred to the target\r\n   */\r\n  static transferCurrencies(source, target, currencies, { change = true, interactionId = false } = {}) {\r\n\r\n    const sourceActor = Utilities.getActor(source);\r\n    const sourceUuid = Utilities.getUuid(sourceActor);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid source`);\r\n\r\n    const targetActor = Utilities.getActor(target);\r\n    const targetUuid = Utilities.getUuid(targetActor);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid target`);\r\n\r\n    if (typeof currencies !== \"string\") {\r\n      throw Helpers.custom_error(`transferCurrencies | currencies must be of type string`)\r\n    }\r\n\r\n    const priceData = PileUtilities.getPriceFromString(currencies)\r\n    const currenciesToTransfer = priceData.currencies.filter(currency => currency.quantity);\r\n    const overallCost = priceData.overallCost;\r\n\r\n    if (!currenciesToTransfer.length) {\r\n      throw Helpers.custom_error(`transferCurrencies | Could not determine currencies to remove with string \"${currencies}\"`);\r\n    }\r\n\r\n    const paymentData = PileUtilities.getPaymentData({\r\n      purchaseData: [{ cost: overallCost, quantity: 1 }], buyer: sourceActor\r\n    });\r\n\r\n    if (!paymentData.canBuy) {\r\n      throw Helpers.custom_error(`transferCurrencies | ${sourceActor.name} cannot afford to transfer \"${currencies}\"`);\r\n    }\r\n\r\n    if (!change && paymentData.buyerChange.length) {\r\n      throw Helpers.custom_error(`transferCurrencies | ${sourceActor.name} cannot afford to transfer \"${currencies}\" without receiving change!`);\r\n    }\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_CURRENCIES, sourceUuid, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n  }\r\n\r\n  /**\r\n   * Transfers all currencies between the source and the target.\r\n   *\r\n   * @param {Actor/Token/TokenDocument} source                The actor to transfer all currencies from\r\n   * @param {Actor/Token/TokenDocument} target                The actor to receive all the currencies\r\n   * @param {object} options                                  Options to pass to the function\r\n   * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n   *\r\n   * @returns {Promise<object>}                               An object containing all items and attributes transferred to the target\r\n   */\r\n  static transferAllCurrencies(source, target, { interactionId = false } = {}) {\r\n\r\n    const sourceUuid = Utilities.getUuid(source);\r\n    if (!sourceUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid source`);\r\n\r\n    const targetUuid = Utilities.getUuid(target);\r\n    if (!targetUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid target`);\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ALL_CURRENCIES, sourceUuid, targetUuid, game.user.id, { interactionId });\r\n\r\n  }\r\n\r\n  /**\r\n   * Rolls on a table of items and collates them to be able to be added to actors and such\r\n   *\r\n   * @param {string/RollTable} table                              The name, ID, UUID, or the table itself, or an array of such\r\n   * @param {object} options                                      Options to pass to the function\r\n   * @param {string/number} [options.timesToRoll=\"1\"]             The number of times to roll on the tables, which can be a roll formula\r\n   * @param {boolean} [options.resetTable=true]                   Whether to reset the table before rolling it\r\n   * @param {boolean} [options.displayChat=false]                 Whether to display the rolls to the chat\r\n   * @param {object} [options.rollData={}]                        Data to inject into the roll formula\r\n   * @param {Actor/string/boolean} [options.targetActor=false]    The target actor to add the items to, or the UUID of an actor\r\n   * @param {boolean} [options.removeExistingActorItems=false]    Whether to clear the target actor's items before adding the ones rolled\r\n   *\r\n   * @returns {Promise<Array<Item>>}                              An array of object containing the item data and their quantity\r\n   */\r\n  static async rollItemTable(table, {\r\n    timesToRoll = \"1\",\r\n    resetTable = true,\r\n    displayChat = false,\r\n    rollData = {},\r\n    targetActor = false,\r\n    removeExistingActorItems = false\r\n  } = {}) {\r\n\r\n    let rollTable = table;\r\n    if (typeof table === \"string\") {\r\n      let potentialTable = await fromUuid(table);\r\n      if (!potentialTable) {\r\n        potentialTable = game.tables.get(table)\r\n      }\r\n      if (!potentialTable) {\r\n        potentialTable = game.tables.getName(table)\r\n      }\r\n      if (!potentialTable) {\r\n        throw Helpers.custom_error(`rollItemTable | could not find table with string \"${table}\"`);\r\n      }\r\n      if (resetTable && table.startsWith(\"Compendium\")) {\r\n        resetTable = false;\r\n      }\r\n      rollTable = potentialTable;\r\n    }\r\n\r\n    if (!(rollTable instanceof RollTable)) {\r\n      throw Helpers.custom_error(`rollItemTable | table must be of type RollTable`);\r\n    }\r\n\r\n    table = rollTable.uuid;\r\n\r\n    if (!(typeof timesToRoll === \"string\" || typeof timesToRoll === \"number\")) {\r\n      throw Helpers.custom_error(`rollItemTable | timesToRoll must be of type string or number`);\r\n    }\r\n\r\n    if (typeof rollData !== \"object\") {\r\n      throw Helpers.custom_error(`rollItemTable | rollData must be of type object`);\r\n    }\r\n\r\n    if (typeof removeExistingActorItems !== \"boolean\") {\r\n      throw Helpers.custom_error(`rollItemTable | removeExistingActorItems of type boolean`);\r\n    }\r\n\r\n    if (targetActor) {\r\n      targetActor = Utilities.getActor(targetActor);\r\n      if (!(targetActor instanceof Actor)) {\r\n        throw Helpers.custom_error(`rollItemTable | could not find the actor of the target actor`);\r\n      }\r\n    }\r\n\r\n    const items = await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ROLL_ITEM_TABLE, {\r\n      table,\r\n      timesToRoll,\r\n      resetTable,\r\n      displayChat,\r\n      rollData,\r\n      targetActor: Utilities.getUuid(targetActor),\r\n      removeExistingActorItems,\r\n      userId: game.user.id\r\n    });\r\n\r\n    if (items) {\r\n      for (const entry of items) {\r\n        entry.item = targetActor ? targetActor.items.get(entry.item._id) : await Item.implementation.create(entry.item, { temporary: true });\r\n      }\r\n    }\r\n\r\n    return items;\r\n\r\n  }\r\n\r\n  /**\r\n   * Gets all the valid items from a given actor or token, excluding items based on its item type filters\r\n   *\r\n   * @param {Actor/TokenDocument/Token} target      The target to get the items from\r\n   *\r\n   * @returns {Array<Item>}                         Array containing the target's valid items\r\n   */\r\n  static getActorItems(target) {\r\n    return PileUtilities.getActorItems(target);\r\n  }\r\n\r\n  static findSimilarItem(itemsToSearch, itemToFind) {\r\n    return Utilities.findSimilarItem(itemsToSearch, itemToFind);\r\n  }\r\n\r\n  /**\r\n   * Gets the valid currencies from a given actor or token\r\n   *\r\n   * @param {Actor/TokenDocument/Token} target      The target to get the currencies from\r\n   * @param {object} [options]                      Object containing optional parameters\r\n   * @param {Boolean} [options.getAll]              Whether to get all the currencies, regardless of quantity\r\n   *\r\n   * @returns {Array<object>}                       An array of objects containing the data about each currency\r\n   */\r\n  static getActorCurrencies(target, { getAll = false } = {}) {\r\n    return PileUtilities.getActorCurrencies(target, { getAll });\r\n  }\r\n\r\n  static updateTokenHud() {\r\n    return ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.RERENDER_TOKEN_HUD);\r\n  }\r\n\r\n  static requestTrade(user) {\r\n    return TradeAPI._requestTrade(user);\r\n  }\r\n\r\n  static spectateTrade(tradeId) {\r\n    return TradeAPI._spectateTrade(tradeId);\r\n  }\r\n\r\n  /**\r\n   * Renders the appropriate interface for a given actor\r\n   *\r\n   * @param {Actor/TokenDocument} target                      The actor whose interface to render\r\n   * @param {object} options                                  An object containing the options for this method\r\n   * @param {Array<string/User>} [options.userIds]            An array of users or user ids for each user to render the interface for (defaults to only self)\r\n   * @param {Actor/TokenDocument} [options.inspectingTarget]  Sets what actor should be viewing the interface\r\n   * @param {boolean} [options.useDefaultCharacter]           Whether other users should use their assigned character when rendering the interface\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  static renderItemPileInterface(target, {\r\n    userIds = null, inspectingTarget = null, useDefaultCharacter = false\r\n  } = {}) {\r\n\r\n    const targetDocument = Utilities.getDocument(target);\r\n    const targetUuid = Utilities.getUuid(targetDocument);\r\n    if (!targetUuid) throw Helpers.custom_error(`renderItemPileInterface | Could not determine the UUID, please provide a valid target item pile`);\r\n\r\n    if (!PileUtilities.isValidItemPile(targetDocument)) {\r\n      throw Helpers.custom_error(\"renderItemPileInterface | This target is not a valid item pile\")\r\n    }\r\n\r\n    if (!inspectingTarget && !useDefaultCharacter) {\r\n      useDefaultCharacter = true;\r\n    }\r\n\r\n    if (inspectingTarget && useDefaultCharacter) {\r\n      throw Helpers.custom_error(\"renderItemPileInterface | You cannot force users to use both their default character and a specific character to inspect the pile\")\r\n    }\r\n\r\n    const inspectingTargetUuid = inspectingTarget ? Utilities.getUuid(inspectingTarget) : false;\r\n    if (inspectingTarget && !inspectingTargetUuid) throw Helpers.custom_error(`renderItemPileInterface | Could not determine the UUID, please provide a valid inspecting target`);\r\n\r\n    if (!Array.isArray(userIds)) {\r\n      if (userIds === null) {\r\n        userIds = [game.user.id];\r\n      } else {\r\n        userIds = [userIds]\r\n      }\r\n    } else {\r\n      userIds = userIds.map(user => {\r\n        return user instanceof User ? user.id : user;\r\n      })\r\n    }\r\n\r\n    if (!game.user.isGM) {\r\n      if (userIds.length > 1 || !userIds.includes(game.user.id)) {\r\n        throw Helpers.custom_error(`renderItemPileInterface | You are not a GM, so you cannot force others to render an item pile's interface`);\r\n      }\r\n      userIds = [game.user.id];\r\n    }\r\n\r\n    if (userIds.length === 1 && userIds[0] === game.user.id) {\r\n      return PrivateAPI._renderItemPileInterface(targetUuid, {\r\n        inspectingTargetUuid, useDefaultCharacter, remote: true\r\n      })\r\n    }\r\n\r\n    for (const userId of userIds) {\r\n      const user = game.users.get(userId);\r\n      if (!user) throw Helpers.custom_error(`renderItemPileInterface | No user with ID \"${userId}\" exists`);\r\n      if (user.isGM) continue;\r\n      if (useDefaultCharacter) {\r\n        if (!user.character) {\r\n          Helpers.custom_warning(`renderItemPileInterface | User \"${user.name}\" has no default character`, true);\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    return ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.RENDER_INTERFACE, userIds, targetUuid, {\r\n      inspectingTargetUuid, useDefaultCharacter, remote: true\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   *  Get the prices array for a given item\r\n   *\r\n   * @param {Item} item                             Item to get the price for\r\n   * @param {object} options                        Options to pass to the function\r\n   * @param {Actor/boolean} [options.seller=false]  Actor that is selling the item\r\n   * @param {Actor/boolean} [options.buyer=false]   Actor that is buying the item\r\n   * @param {number} [options.quantity=1]           Quantity of item to buy\r\n   *\r\n   * @returns {Array}                               Array containing all the different purchase options for this item\r\n   */\r\n  static getPricesForItem(item, { seller = false, buyer = false, quantity = 1 } = {}) {\r\n\r\n    if (!(item instanceof Item)) {\r\n      throw Helpers.custom_error(\"getPricesForItem | The given item must be of type Item\");\r\n    }\r\n\r\n    if (seller) {\r\n      seller = Utilities.getActor(seller);\r\n      if (!seller) {\r\n        throw Helpers.custom_error(\"getPricesForItem | Could not determine actor for the seller\");\r\n      }\r\n    } else {\r\n      if (!item.parent) {\r\n        throw Helpers.custom_error(\"getPricesForItem | If no seller was given, the item must belong to an actor\");\r\n      }\r\n      seller = Utilities.getActor(item.parent);\r\n    }\r\n\r\n    if (buyer) {\r\n      buyer = Utilities.getActor(buyer);\r\n      if (!buyer) {\r\n        throw Helpers.custom_error(`getPricesForItem | Could not determine the actor for the buyer`);\r\n      }\r\n    }\r\n\r\n    return PileUtilities.getPriceData({ item, seller, buyer, quantity });\r\n\r\n  }\r\n\r\n  /**\r\n   * Trades multiple items between one actor to another, and currencies and/or change is exchanged between them\r\n   *\r\n   * @param {Actor/Token/TokenDocument} seller                                                    The actor that is selling the item\r\n   * @param {Actor/Token/TokenDocument} buyer                                                     The actor that is buying the item\r\n   * @param {Array<Object<{ item: Item/string, quantity: number, paymentIndex: number }>>} items  An array of objects containing the item or the id of the\r\n   *                                                                                              item to be sold, the quantity to be sold, and the payment\r\n   *                                                                                              index to be used\r\n   * @param {string/boolean} [interactionId=false]                                                The ID of this interaction\r\n   *\r\n   * @returns {Promise<Object>}                       The items that were created and the attributes that were changed\r\n   */\r\n  static tradeItems(seller, buyer, items, { interactionId = false } = {}) {\r\n\r\n    const sellerActor = Utilities.getActor(seller);\r\n    const sellerUuid = Utilities.getUuid(sellerActor);\r\n    if (!sellerUuid) {\r\n      throw Helpers.custom_error(`tradeItems | Could not determine the UUID of the seller, please provide a valid actor or token`, true);\r\n    }\r\n\r\n    const buyerActor = Utilities.getActor(buyer);\r\n    const buyerUuid = Utilities.getUuid(buyer);\r\n    if (!buyerUuid) {\r\n      throw Helpers.custom_error(`tradeItems | Could not determine the UUID of the buyer, please provide a valid actor or token`, true);\r\n    }\r\n\r\n    const itemsToSell = items.map(data => {\r\n\r\n      data = foundry.utils.mergeObject({\r\n        item: \"\", quantity: 1, paymentIndex: 0\r\n      }, data);\r\n\r\n      if (!data.item) {\r\n        throw Helpers.custom_error(`tradeItems | You must provide an item!`, true);\r\n      }\r\n\r\n      let actorItem;\r\n      if (typeof data.item === \"string\") {\r\n        actorItem = sellerActor.items.get(data.item) || sellerActor.items.getName(data.item);\r\n        if (!actorItem) {\r\n          throw Helpers.custom_error(`tradeItems | Could not find item on seller with identifier \"${data.item}\"`);\r\n        }\r\n      } else {\r\n        actorItem = sellerActor.items.get(data.item instanceof Item ? data.item.id : data.item._id) || sellerActor.items.getName(data.item.name);\r\n        if (!actorItem) {\r\n          throw Helpers.custom_error(`tradeItems | Could not find provided item on seller`);\r\n        }\r\n      }\r\n\r\n      const itemPrices = PileUtilities.getPriceData({\r\n        item: actorItem, seller: sellerActor, buyer: buyerActor, quantity: data.quantity\r\n      });\r\n      if (itemPrices.length) {\r\n        if (data.paymentIndex >= itemPrices.length || data.paymentIndex < 0) {\r\n          throw Helpers.custom_error(`tradeItems | That payment index does not exist on ${actorItem.name}`, true);\r\n        }\r\n\r\n        const selectedPrice = itemPrices[data.paymentIndex];\r\n        if (data.quantity > selectedPrice.maxQuantity) {\r\n          throw Helpers.custom_error(`tradeItems | The buyer actor cannot afford ${data.quantity} of ${actorItem.name} (max ${selectedPrice.maxQuantity})`, true);\r\n        }\r\n      }\r\n\r\n      return {\r\n        id: actorItem.id, quantity: data.quantity, paymentIndex: data.paymentIndex\r\n      };\r\n\r\n    });\r\n\r\n    return ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRADE_ITEMS, sellerUuid, buyerUuid, itemsToSell, game.user.id, { interactionId });\r\n\r\n  }\r\n\r\n  static async registerItemPileType(type, label, flags = []) {\r\n    game.i18n.translations['ITEM-PILES'].Types[type] = \"Custom: \" + label;\r\n    CONSTANTS.CUSTOM_PILE_TYPES[type] = flags;\r\n  }\r\n\r\n  static isItemInvalid(item) {\r\n    return PileUtilities.isItemInvalid(item);\r\n  }\r\n\r\n  static canItemStack(item) {\r\n    return PileUtilities.canItemStack(item);\r\n  }\r\n\r\n  static getVaultGridData(vaultActor) {\r\n    return PileUtilities.getVaultGridData(vaultActor);\r\n  }\r\n\r\n  static getActorFlagData(actor) {\r\n    return PileUtilities.getActorFlagData(actor);\r\n  }\r\n\r\n}\r\n\r\nexport default API;\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport { custom_warning, getSetting } from \"./helpers/helpers.js\";\r\nimport * as PileUtilities from \"./helpers/pile-utilities.js\";\r\nimport SETTINGS from \"./constants/settings.js\";\r\n\r\nexport default async function runMigrations() {\r\n\r\n  const sortedMigrations = Object.entries(migrations)\r\n    .sort((a, b) => {\r\n      return isNewerVersion(b[0], a[0]) ? -1 : 1;\r\n    });\r\n\r\n  for (const [version, migration] of sortedMigrations) {\r\n    try {\r\n      await migration(version);\r\n    } catch (err) {\r\n      console.error(err);\r\n      custom_warning(`Something went wrong when migrating to version ${version}. Please check the console for the error!`, true)\r\n    }\r\n  }\r\n}\r\n\r\nfunction getItemPileActorsOfLowerVersion(version) {\r\n  return PileUtilities.getItemPileActors((a) => {\r\n    const actorFlagVersion = getProperty(a, CONSTANTS.FLAGS.VERSION) || \"1.0.0\";\r\n    return getProperty(a, CONSTANTS.FLAGS.PILE)?.enabled && isNewerVersion(version, actorFlagVersion);\r\n  })\r\n}\r\n\r\nfunction getItemPileTokensOfLowerVersion(version) {\r\n  return PileUtilities.getItemPileTokens((token) => {\r\n    try {\r\n      const actorFlagVersion = getProperty(token, CONSTANTS.FLAGS.VERSION) || \"1.0.0\";\r\n      return token.actor && isNewerVersion(version, actorFlagVersion);\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n  })\r\n}\r\n\r\nfunction filterValidItems(items, version) {\r\n  return items.filter(item => {\r\n    const itemFlagVersion = getProperty(item, CONSTANTS.FLAGS.VERSION);\r\n    return (itemFlagVersion && isNewerVersion(version, itemFlagVersion))\r\n      || (!itemFlagVersion && hasProperty(item, CONSTANTS.FLAGS.ITEM));\r\n  });\r\n}\r\n\r\nfunction getActorValidItems(actor, version) {\r\n  return filterValidItems(actor.items, version);\r\n}\r\n\r\nconst migrations = {\r\n\r\n  \"2.4.0\": async (version) => {\r\n\r\n    const actors = getItemPileActorsOfLowerVersion(version);\r\n\r\n    const actorUpdates = actors.map(a => {\r\n      const flagData = {\r\n        [CONSTANTS.FLAGS.PILE]: PileUtilities.cleanFlagData(PileUtilities.migrateFlagData(a)),\r\n        [CONSTANTS.FLAGS.VERSION]: version\r\n      }\r\n      if (a.actorLink) {\r\n        flagData[\"token\"] = foundry.utils.deepClone(flagData);\r\n      }\r\n      return {\r\n        _id: a.id,\r\n        ...flagData\r\n      };\r\n    });\r\n\r\n    if (actorUpdates.length) {\r\n      console.log(`Item Piles | Migrating ${actorUpdates.length} actors to version ${version}...`)\r\n    }\r\n\r\n    await Actor.updateDocuments(actorUpdates);\r\n\r\n    const { allTokensOnScenes, validTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n    for (const [sceneId, tokens] of validTokensOnScenes) {\r\n      const scene = game.scenes.get(sceneId)\r\n      const updates = [];\r\n      for (const token of tokens) {\r\n        const flagData = {\r\n          [CONSTANTS.FLAGS.PILE]: PileUtilities.cleanFlagData(PileUtilities.migrateFlagData(token.actor)),\r\n          [CONSTANTS.FLAGS.VERSION]: version,\r\n        }\r\n        updates.push({\r\n          _id: token.id,\r\n          ...flagData,\r\n          actorData: {\r\n            ...flagData\r\n          }\r\n        });\r\n      }\r\n      console.log(`Item Piles | Migrating ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n      await scene.updateEmbeddedDocuments(\"Token\", updates);\r\n    }\r\n\r\n    const invalidTokensOnScenes = allTokensOnScenes.map(([scene, tokens]) => [\r\n      scene,\r\n      tokens.filter(token => {\r\n        try {\r\n          const actorFlagVersion = getProperty(token, CONSTANTS.FLAGS.VERSION) || \"1.0.0\";\r\n          return !token.actor || isNewerVersion(version, actorFlagVersion);\r\n        } catch (err) {\r\n          return true;\r\n        }\r\n      })\r\n    ]).filter(([_, tokens]) => tokens.length);\r\n\r\n    for (const [sceneId, tokens] of invalidTokensOnScenes) {\r\n\r\n      const scene = game.scenes.get(sceneId);\r\n\r\n      let deletions = [];\r\n      let updates = [];\r\n      for (const token of tokens) {\r\n\r\n        const flagData = {\r\n          [CONSTANTS.FLAGS.PILE]: PileUtilities.cleanFlagData(PileUtilities.migrateFlagData(token)),\r\n          [CONSTANTS.FLAGS.VERSION]: version,\r\n        }\r\n\r\n        let tokenActor = game.actors.get(token.actorId);\r\n        if (!tokenActor) {\r\n          tokenActor = game.actors.get(getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID));\r\n        }\r\n        if (!tokenActor) {\r\n          deletions.push(token.id);\r\n          continue;\r\n        }\r\n\r\n        const update = {\r\n          _id: token.id,\r\n          actorLink: false,\r\n          actorId: tokenActor.id,\r\n          actorData: {\r\n            ...flagData,\r\n            items: []\r\n          },\r\n          ...flagData\r\n        }\r\n\r\n        for (let itemData of token.actorData?.items ?? []) {\r\n          const item = await Item.implementation.create(itemData, { temporary: true });\r\n          update.actorData.items.push(item.toObject());\r\n        }\r\n\r\n        updates.push(update);\r\n\r\n        await token.update({\r\n          actorLink: true\r\n        });\r\n      }\r\n\r\n      await scene.updateEmbeddedDocuments(\"Token\", updates);\r\n      await scene.deleteEmbeddedDocuments(\"Token\", deletions);\r\n\r\n      console.log(`Item Piles | Fixing ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n\r\n    }\r\n\r\n    if (invalidTokensOnScenes.length && invalidTokensOnScenes.some(([sceneId]) => sceneId === game.user.viewedScene)) {\r\n      ui.notifications.notify(\"Item Piles | Attempted to fix some broken tokens on various scenes. If the current scene fails to load, please refresh.\")\r\n    }\r\n  },\r\n\r\n  \"2.4.17\": async (version) => {\r\n\r\n    const items = filterValidItems(game.items);\r\n\r\n    const itemUpdates = items.map(item => {\r\n      const flags = getProperty(item, CONSTANTS.FLAGS.ITEM);\r\n      flags.infiniteQuantity = \"default\";\r\n      return PileUtilities.updateItemData(item, { flags }, { version, returnUpdate: true });\r\n    });\r\n\r\n    if (itemUpdates.length) {\r\n      console.log(`Item Piles | Migrating ${itemUpdates.length} items to version ${version}...`)\r\n    }\r\n\r\n    await Item.updateDocuments(itemUpdates);\r\n\r\n    const actors = getItemPileActorsOfLowerVersion(version);\r\n\r\n    const actorItemUpdates = actors.map(actor => {\r\n\r\n      const itemPileItems = getActorValidItems(actor, version)\r\n\r\n      return {\r\n        actor,\r\n        items: itemPileItems.map(item => {\r\n          const flags = getProperty(item, CONSTANTS.FLAGS.ITEM);\r\n          flags.infiniteQuantity = \"default\";\r\n          return PileUtilities.updateItemData(item, { flags }, { version, returnUpdate: true });\r\n        })\r\n      }\r\n\r\n    }).filter(update => update.items.length);\r\n\r\n    if (actorItemUpdates.length) {\r\n      console.log(`Item Piles | Migrating ${actorItemUpdates.length} item pile actors' items to version ${version}...`)\r\n    }\r\n\r\n    for (const { actor, items } of actorItemUpdates) {\r\n      await actor.updateEmbeddedDocuments(\"Item\", items);\r\n    }\r\n\r\n    const { validTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n    for (const [sceneId, tokens] of validTokensOnScenes) {\r\n\r\n      const updates = tokens.map(token => {\r\n        const itemPileItems = getActorValidItems(token.actor, version);\r\n        return {\r\n          token,\r\n          update: {\r\n            [CONSTANTS.FLAGS.VERSION]: version,\r\n            actorData: {\r\n              [CONSTANTS.FLAGS.VERSION]: version,\r\n            }\r\n          },\r\n          items: itemPileItems.map(item => {\r\n            const flags = PileUtilities.getItemFlagData(item);\r\n            flags.infiniteQuantity = \"default\";\r\n            return PileUtilities.updateItemData(item, { flags }, { version, returnUpdate: true });\r\n          })\r\n        }\r\n      });\r\n\r\n      console.log(`Item Piles | Migrating ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n\r\n      for (const { token, update, items } of updates) {\r\n        await token.update(update);\r\n        await token.actor.updateEmbeddedDocuments(\"Item\", items)\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  \"2.6.1\": async (version) => {\r\n\r\n    const actors = getItemPileActorsOfLowerVersion(version);\r\n\r\n    const actorUpdates = actors.map(a => {\r\n      const flags = getProperty(a, CONSTANTS.FLAGS.PILE);\r\n      if (flags?.itemTypePriceModifiers) {\r\n        flags.itemTypePriceModifiers = flags.itemTypePriceModifiers.map(priceModifier => {\r\n          const custom = Object.keys(CONFIG.Item.typeLabels).indexOf(priceModifier.type) === -1;\r\n          priceModifier.category = custom ? priceModifier.type : \"\";\r\n          priceModifier.type = custom ? \"custom\" : priceModifier.type;\r\n          return priceModifier;\r\n        })\r\n      }\r\n      const flagData = {\r\n        [CONSTANTS.FLAGS.PILE]: flags,\r\n        [CONSTANTS.FLAGS.VERSION]: version\r\n      }\r\n      if (a.actorLink) {\r\n        flagData[\"token\"] = foundry.utils.deepClone(flagData);\r\n      }\r\n      return {\r\n        _id: a.id,\r\n        ...flagData\r\n      };\r\n    });\r\n\r\n    if (actorUpdates.length) {\r\n      console.log(`Item Piles | Migrating ${actorUpdates.length} actors to version ${version}...`)\r\n    }\r\n\r\n    await Actor.updateDocuments(actorUpdates);\r\n\r\n    const { validTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n    for (const [sceneId, tokens] of validTokensOnScenes) {\r\n      const scene = game.scenes.get(sceneId)\r\n      const updates = [];\r\n      for (const token of tokens) {\r\n        const flags = getProperty(token, CONSTANTS.FLAGS.PILE);\r\n        if (flags?.itemTypePriceModifiers) {\r\n          flags.itemTypePriceModifiers = flags.itemTypePriceModifiers.map(priceModifier => {\r\n            const custom = Object.keys(CONFIG.Item.typeLabels).indexOf(priceModifier.type) === -1;\r\n            priceModifier.category = custom ? priceModifier.type : \"\";\r\n            priceModifier.type = custom ? \"custom\" : priceModifier.type;\r\n            return priceModifier;\r\n          })\r\n        }\r\n        const flagData = {\r\n          [CONSTANTS.FLAGS.PILE]: flags,\r\n          [CONSTANTS.FLAGS.VERSION]: version,\r\n        }\r\n        updates.push({\r\n          _id: token.id,\r\n          ...flagData,\r\n          actorData: {\r\n            ...flagData\r\n          }\r\n        });\r\n      }\r\n      console.log(`Item Piles | Migrating ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n      await scene.updateEmbeddedDocuments(\"Token\", updates);\r\n    }\r\n\r\n  }\r\n\r\n};\r\n","import \"./styles/styles.scss\";\n\nimport CONSTANTS from \"./constants/constants.js\";\nimport registerUIOverrides from \"./foundry-ui-overrides.js\";\nimport registerLibwrappers from \"./libwrapper.js\";\nimport { applySystemSpecificStyles, checkSystem, patchCurrencySettings, registerSettings } from \"./settings.js\";\nimport { registerHotkeysPost, registerHotkeysPre } from \"./hotkeys.js\";\nimport Socket from \"./socket.js\";\nimport API from \"./API/api.js\";\nimport TradeAPI from \"./API/trade-api.js\";\nimport ChatAPI from \"./API/chat-api.js\";\nimport PrivateAPI from \"./API/private-api.js\";\nimport * as Helpers from \"./helpers/helpers.js\";\nimport runMigrations from \"./migrations.js\"\n\nimport ItemPileConfig from \"./applications/item-pile-config/item-pile-config.js\";\nimport ItemEditor from \"./applications/item-editor/item-editor.js\";\nimport { setupPlugins } from \"./plugins/main.js\";\nimport SettingsShim from \"./applications/settings-app/settings-app.js\";\nimport { setupCaches } from \"./helpers/caches.js\";\nimport { isValidItemPile } from \"./helpers/pile-utilities.js\";\n\nHooks.once(\"init\", async () => {\n  registerSettings();\n  registerHotkeysPre();\n  registerLibwrappers();\n  registerUIOverrides();\n  setupCaches();\n  setupPlugins(\"init\");\n});\n\nHooks.once(\"ready\", () => {\n\n  setTimeout(() => {\n\n    game.itempiles = {\n      API,\n      hooks: CONSTANTS.HOOKS,\n      flags: CONSTANTS.FLAGS,\n      pile_types: CONSTANTS.PILE_TYPES,\n      pile_flag_defaults: CONSTANTS.PILE_DEFAULTS,\n      item_flag_defaults: CONSTANTS.ITEM_DEFAULTS,\n      apps: {\n        ItemPileConfig,\n        ItemEditor\n      }\n    };\n    window.ItemPiles = {\n      API: API\n    };\n\n    if (game.user.isGM) {\n      if (!game.modules.get('lib-wrapper')?.active) {\n        let word = \"install and activate\";\n        if (game.modules.get('lib-wrapper')) word = \"activate\";\n        throw Helpers.custom_error(`Item Piles requires the 'libWrapper' module. Please ${word} it.`)\n      }\n\n      if (!game.modules.get('socketlib')?.active) {\n        let word = \"install and activate\";\n        if (game.modules.get('socketlib')) word = \"activate\";\n        throw Helpers.custom_error(`Item Piles requires the 'socketlib' module. Please ${word} it.`)\n      }\n    }\n\n    if (!Helpers.isGMConnected()) {\n      Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoGMsConnected\"), true)\n    }\n\n    Socket.initialize();\n    PrivateAPI.initialize();\n    TradeAPI.initialize();\n    ChatAPI.initialize();\n\n    registerHotkeysPost();\n    setupCaches();\n    setupPlugins(\"ready\");\n\n    ChatAPI.disablePastTradingButtons();\n\n    Hooks.callAll(CONSTANTS.HOOKS.READY);\n\n  }, 100);\n\n});\n\nHooks.once(CONSTANTS.HOOKS.READY, async () => {\n  setTimeout(async () => {\n    if (game.user.isGM) {\n      await checkSystem();\n      await patchCurrencySettings();\n      await runMigrations();\n    }\n    // game.itempiles.API.renderItemPileInterface(game.actors.getName(\"Merchant\"));\n    // new SettingsShim().render(true);\n    applySystemSpecificStyles();\n  }, 500);\n});\n\nHooks.on(CONSTANTS.HOOKS.RESET_SETTINGS, async () => {\n  for (let setting of game.settings.storage.get(\"world\").filter(setting => setting.key.includes('item-piles'))) {\n    await setting.delete();\n  }\n  checkSystem();\n})\n"],"names":["index","version","data","now","loop","element","text","hash","next","tick","wait","detach","init","create_each_block","insert","update","instance","create_fragment","debug","promise","document","children","writable","subscribe","run","storage","readable","writable$2","get","derived","constants.animateKeys","constants.relativeRegex","lerp","duration","ease","interpolate","options","linear","constants.transformOriginDefault","constants.transformKeysBitwise","constants.transformKeys","s_VALIDATION_DATA","constants.transformOrigins","parent","constants.numericDefaults","constants.setNumericDefaults","application","draggable","s_STYLE_KEY","cssVariables","styles","active","ctx","create_if_block","s_REGEX_HTML","booleanStore","dragDefault","storeResizing","create_if_block_1","preventDefault","autoClose","create_if_block_4","create_if_block_2","create_if_block_3","create_if_block_6","create_if_block_5","Helpers.custom_error","Utilities.findSimilarItem","Helpers.custom_notify","SETTINGS","CurrenciesEditorShell","ItemFiltersShell","StringListEditorShell","PriceModifiersEditorShell","draggedEl","resetScrolling","scrollIfNeeded","INTERVAL_MS","DEFAULT_DROP_ZONE_TYPE","DEFAULT_DROP_TARGET_STYLE","typeToDropZones","dzToConfig","registerDropZone","unregisterDropZone","handleDrop","dndzone","INSTRUCTION_IDs","pointerDndZone","keyboardDndZone","flipDurationMs","Utilities.getActor","PileUtilities.isValidItemPile","PileUtilities.getActorFlagData","Utilities.getUserCharacter","PileUtilities.getActorItems","PileUtilities.getActorCurrencies","Utilities.setItemQuantity","PileUtilities.isItemPileEmpty","sharingData","Utilities.setSimilarityProperties","Utilities.getItemQuantity","Utilities.getUuid","canItemStack","PileUtilities.canItemStack","DropItemDialogShell","func","func_2","PileUtilities.getCurrencyList","existingCurrency","DropCurrencyDialogShell","PileUtilities.isItemCurrency","item","PileUtilities.getItemPileActors","PileUtilities.getItemPileTokens","PileUtilities.rollMerchantTables","PileUtilities.getItemFlagData","previousState","SharingUtilities.getItemSharesLeftForActor","Utilities.hasItemQuantity","PileUtilities.getItemCurrencyData","Helpers.getModuleVersion","SharingUtilities.getAttributeSharesLeftForActor","SharingUtilities.getItemPileSharingData","PileUtilities.isItemPileMerchant","PileUtilities.isItemInvalid","pileItem","SharingUtilities.updateItemPileSharingData","create_if_block_10","create_if_block_9","create_if_block_8","SharingUtilities.getPlayersForItemPile","Helpers.custom_warning","PileUtilities.isItemPileContainer","SharingUtilities.canItemPileBeSplit","dispatch","Plugins","content","click_handler_3","i","PileUtilities.getPaymentData","TradeMerchantItemDialogShell","quantityForPriceProp","Helpers.setSetting","Helpers.getSetting","PileUtilities.updateItemData","ItemEditorShell","PileUtilities.updateItemPileData","PileUtilities.getPriceData","TextEditorDialogShell","create_if_block_7","tables","Helpers.abbreviateNumbers","PileUtilities.checkItemType","UserSelectDialogShell","MerchantAppShell","Helpers.hooks","Helpers.getActiveApps","Helpers.styleFromObject","PileUtilities.getActorVaultLog","access","PileUtilities.getVaultGridData","helpers.debug","_","Utilities.areItemsDifferent","VaultAccessEditorShell","clearVaultLog","PileUtilities.clearVaultLog","Helpers.timeSince","Helpers.getApplicationPositions","func_1","VaultShell","ItemTypePriceModifiersShell","MerchantColumnsEditorShell","SharingUtilities.clearItemPileSharingData","Helpers.getFiles","ItemPileConfigShell","ItemPileInventoryShell","canvas","Helpers.random_array_element","PileUtilities.getItemPileTokenScale","PileUtilities.getItemPileTokenImage","PileUtilities.getItemPileName","PileUtilities.isItemPileVault","PileUtilities.updateVaultLog","PileUtilities.shouldItemPileBeDeleted","Utilities.getToken","PileUtilities.isItemPileLootable","SharingUtilities.setItemPileSharingData","PileUtilities.getPriceFromString","sourceIsItemPile","Utilities.createFoldersFromNames","Helpers.wait","Helpers.isFunction","Helpers.isResponsibleGM","PileUtilities.shouldEvaluateChange","Helpers.debounceManager","Utilities.getDocument","Helpers.debug","target","Utilities.runMacro","Utilities.getSourceActorFromDropData","Utilities.getTokensAtLocation","user","Helpers.getActiveGMs","Utilities.distance_between_rect","GiveItemsShell","Helpers.isGMConnected","Utilities.tokens_close_enough","Utilities.grids_between_tokens","BankVaultApp","rollData","token","Utilities.getItemTypesThatCanStack","cost","Helpers.roundToDecimals","Utilities.getItemCost","payment","currency","PricePresetEditorShell","UnstackableItemTypesEditorShell","StylesEditorShell","VaultStylesEditorShell","helpers.getSetting","helpers.setSetting","SettingsShell","actor","TradeDialogPrompt","TradeDialogRequest","previewItem","TradingAppShell","message","PileUtilities.getPriceArray","html","PileUtilities.getActorPrimaryCurrency","Helpers.isRealNumber","hookResult","PileUtilities.isItemPileLocked","PileUtilities.isItemPileClosed","PileUtilities.cleanFlagData","PileUtilities.migrateFlagData","items","Socket","setting"],"mappings":"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UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,KAAK,EAAE,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,GAAG,GAAG,KAAK,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,GAAG,GAAG,KAAK,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,GAAG,GAAG,KAAK,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,GAAG,GAAG,KAAK,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,GAAG,GAAG,KAAK,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,UAAU,KAAK,IAAI,GAAK,KAAK,IAAI,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","x_google_ignoreList":[33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,135,136,137,138,139,140,141,142,173,225]}